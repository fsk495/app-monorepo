(self.webpackChunkweb=self.webpackChunkweb||[]).push([[17617],{78887:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CLIENT_CONTEXT:()=>Ro,CLIENT_STORAGE_OPTIONS:()=>Mo,CLIENT_STORAGE_PREFIX:()=>Oo,IWeb3Wallet:()=>No,IWeb3WalletEngine:()=>xo,IWeb3WalletEvents:()=>Po,PROTOCOL:()=>So,PROTOCOL_VERSION:()=>Io,REQUEST_CONTEXT:()=>To,Web3Wallet:()=>ko,default:()=>Co});var n=r(80753),i=r(45754),o=r(11987),s=r(95058),a=r(34795),u=r(87371),c=r(68079),l=r(56666),h=r(22699),f=r.n(h),d=r(68385),p=r(67660),g=r(52500),y=r(5774);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.default)(this,r)}}var m=function(e){(0,i.default)(r,e);var t=v(r);function r(e){var r;return(r=t.call(this)).opts=e,r.protocol="wc",r.version=2,r}return(0,u.default)(r)}(y.IEvents),b=((0,u.default)((function(e,t,r){this.core=e,this.logger=t})),function(e){(0,i.default)(r,e);var t=v(r);function r(e,r){var n;return(n=t.call(this)).core=e,n.logger=r,n.records=new Map,n}return(0,u.default)(r)}(y.IEvents)),E=(0,u.default)((function(e,t){this.logger=e,this.core=t})),_=function(e){(0,i.default)(r,e);var t=v(r);function r(e,r){var n;return(n=t.call(this)).relayer=e,n.logger=r,n}return(0,u.default)(r)}(y.IEvents),w=function(e){(0,i.default)(r,e);var t=v(r);function r(e){return t.call(this)}return(0,u.default)(r)}(y.IEvents),S=(0,u.default)((function(e,t,r,n){this.core=e,this.logger=t,this.name=r})),I=((0,u.default)((function(){this.map=new Map})),function(e){(0,i.default)(r,e);var t=v(r);function r(e,r){var n;return(n=t.call(this)).relayer=e,n.logger=r,n}return(0,u.default)(r)}(y.IEvents)),R=((0,u.default)((function(e,t){this.core=e,this.logger=t})),function(e){(0,i.default)(r,e);var t=v(r);function r(e,r){var n;return(n=t.call(this)).core=e,n.logger=r,n}return(0,u.default)(r)}(y.IEvents)),O=((0,u.default)((function(e,t){this.logger=e,this.core=t})),(0,u.default)((function(e,t){this.projectId=e,this.logger=t}))),M=(function(e){(0,i.default)(r,e);var t=v(r);function r(){return t.call(this)}(0,u.default)(r)}(f()),(0,u.default)((function(e){this.opts=e,this.protocol="wc",this.version=2})),function(e){(0,i.default)(r,e);var t=v(r);function r(){return t.call(this)}(0,u.default)(r)}(h.EventEmitter),(0,u.default)((function(e){this.client=e})),r(42325)),T=r(53179),P=r(96234),N=r(18779),x=r(43133),A=r(61863),C=r(74932),k=r(36381),D=r(49466),U=r(54924),L=r(42537),j=r(45415),B=(r(7047),r(34126)),q=r(60220);var V="base10",z="base16",$="base64pad",K="utf8",W=0,H=1,F=0,J=1,G=12,Y=32;function Z(){var e=(0,A.randomBytes)(Y);return(0,D.toString)(e,z)}function X(e){var t=(0,C.hash)((0,D.fromString)(e,z));return(0,D.toString)(t,z)}function Q(e){var t=(0,C.hash)((0,D.fromString)(e,K));return(0,D.toString)(t,z)}function ee(e){return Number((0,D.toString)(e,V))}function te(e){var t=function(e){return(0,D.fromString)(`${e}`,V)}(typeof e.type<"u"?e.type:W);if(ee(t)===H&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");var r=typeof e.senderPublicKey<"u"?(0,D.fromString)(e.senderPublicKey,z):void 0,n=typeof e.iv<"u"?(0,D.fromString)(e.iv,z):(0,A.randomBytes)(G);return function(e){if(ee(e.type)===H){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return(0,D.toString)((0,D.concat)([e.type,e.senderPublicKey,e.iv,e.sealed]),$)}return(0,D.toString)((0,D.concat)([e.type,e.iv,e.sealed]),$)}({type:t,sealed:new N.ChaCha20Poly1305((0,D.fromString)(e.symKey,z)).seal(n,(0,D.fromString)(e.message,K)),iv:n,senderPublicKey:r})}function re(e){var t=(0,D.fromString)(e,$),r=t.slice(F,J),n=J;if(ee(r)===H){var i=n+Y,o=i+G,s=t.slice(n,i),a=t.slice(i,o);return{type:r,sealed:t.slice(o),iv:a,senderPublicKey:s}}var u=n+G,c=t.slice(n,u);return{type:r,sealed:t.slice(u),iv:c}}function ne(e){var t=(null==e?void 0:e.type)||W;if(t===H){if(typeof(null==e?void 0:e.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(null==e?void 0:e.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:null==e?void 0:e.senderPublicKey,receiverPublicKey:null==e?void 0:e.receiverPublicKey}}function ie(e){return e.type===H&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}var oe=Object.defineProperty,se=Object.getOwnPropertySymbols,ae=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable,ce=function(e,t,r){return t in e?oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},le=function(e,t){for(var r in t||(t={}))ae.call(t,r)&&ce(e,r,t[r]);if(se)for(var r of se(t))ue.call(t,r)&&ce(e,r,t[r]);return e},he="ReactNative",fe={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},de="js";function pe(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function ge(){return!(0,j.getDocument)()&&!!(0,j.getNavigator)()&&navigator.product===he}function ye(){return!pe()&&!!(0,j.getNavigator)()}function ve(){return ge()?fe.reactNative:pe()?fe.node:ye()?fe.browser:fe.unknown}function me(e,t,r){var n=function(){var e=(0,U.detect)();if(null===e)return"unknown";var t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[t,e.name,e.version].join("-"):[t,e.version].join("-")}(),i=function(){var e,t=ve();return t===fe.browser?[t,(null==(e=(0,j.getLocation)())?void 0:e.host)||"unknown"].join(":"):t}();return[[e,t].join("-"),[de,r].join("-"),n,i].join("/")}function be(e){var t=e.protocol,r=e.version,n=e.relayUrl,i=e.sdkVersion,o=e.auth,s=e.projectId,a=e.useOnCloseEvent,u=n.split("?"),c={auth:o,ua:me(t,r,i),projectId:s,useOnCloseEvent:a||void 0},l=function(e,t){var r=B.parse(e);return r=le(le({},r),t),B.stringify(r)}(u[1]||"",c);return u[0]+"?"+l}function Ee(e){return Object.fromEntries(e.entries())}function _e(e){return new Map(Object.entries(e))}function we(e,t,r){return new Promise(function(){var n=(0,a.default)((function*(n,i){var o=setTimeout((function(){return i(new Error(r))}),t);try{var s;n(yield e)}catch(s){i(s)}clearTimeout(o)}));return function(e,t){return n.apply(this,arguments)}}())}function Se(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function Ie(e,t){return(0,L.fromMiliseconds)((t||Date.now())+(0,L.toMiliseconds)(e))}function Re(e){return Date.now()>=(0,L.toMiliseconds)(e)}function Oe(e,t){return`${e}${t?`:${t}`:""}`}function Me(e){return(null==e?void 0:e.relay)||{protocol:"irn"}}function Te(e){var t=q.RELAY_JSONRPC[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}var Pe=Object.defineProperty,Ne=Object.getOwnPropertySymbols,xe=Object.prototype.hasOwnProperty,Ae=Object.prototype.propertyIsEnumerable,Ce=function(e,t,r){return t in e?Pe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r};function ke(e){var t={},r="relay"+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-");return Object.keys(e).forEach((function(n){if(n.startsWith(r)){var i=n.replace(r,""),o=e[n];t[i]=o}})),t}function De(e){return e.startsWith("//")?e.substring(2):e}function Ue(e){return`${e.protocol}:${e.topic}@${e.version}?`+B.stringify(function(e,t){for(var r in t||(t={}))xe.call(t,r)&&Ce(e,r,t[r]);if(Ne)for(var r of Ne(t))Ae.call(t,r)&&Ce(e,r,t[r]);return e}({symKey:e.symKey},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",r={};return Object.keys(e).forEach((function(n){var i="relay"+t+n;e[n]&&(r[i]=e[n])})),r}(e.relay)))}Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var Le={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},je={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Be(e,t){var r=je[e],n=r.message;return{message:t?`${n} ${t}`:n,code:r.code}}function qe(e,t){var r=Le[e],n=r.message;return{message:t?`${n} ${t}`:n,code:r.code}}function Ve(e,t){return!!Array.isArray(e)&&(!(typeof t<"u"&&e.length)||e.every(t))}function ze(e){return typeof e>"u"}function $e(e,t){return!(!t||!ze(e))||"string"==typeof e&&Boolean(e.trim().length)}function Ke(e,t){return!(!t||!ze(e))||"number"==typeof e&&!isNaN(e)}function We(e){if($e(e,!1))try{return typeof new URL(e)<"u"}catch(t){return!1}return!1}function He(e){return typeof e<"u"&&null!==typeof e}var Fe=r(21061),Je=r(55494),Ge=r(46328),Ye=r(33958),Ze=r.n(Ye);function Xe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.default)(this,r)}}function Qe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function et(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(r),!0).forEach((function(t){(0,l.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var tt=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,u=e.charAt(0),c=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===u;)n++,t++;for(var o=(e.length-t)*c+1>>>0,s=new Uint8Array(o);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,f=o-1;(0!==l||h<i)&&-1!==f;f--,h++)l+=a*s[f]>>>0,s[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var p=new Uint8Array(n+(o-d)),g=n;d!==o;)p[g++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*l+1>>>0,c=new Uint8Array(s);i!==o;){for(var h=t[i],f=0,d=s-1;(0!==h||f<n)&&-1!==d;d--,f++)h+=256*c[d]>>>0,c[d]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=f,i++}for(var p=s-n;p!==s&&0===c[p];)p++;for(var g=u.repeat(r);p<s;++p)g+=e.charAt(c[p]);return g},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}},rt=tt,nt=function(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},it=function(){function e(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}return e.prototype.encode=function(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")},(0,u.default)(e)}(),ot=function(){function e(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}var t=e.prototype;return t.decode=function(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")},t.or=function(e){return at(this,e)},(0,u.default)(e)}(),st=function(){function e(e){this.decoders=e}var t=e.prototype;return t.or=function(e){return at(this,e)},t.decode=function(e){var t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)},(0,u.default)(e)}(),at=function(e,t){var r,n;return new st(et(et({},e.decoders||((r={})[e.prefix]=e,r)),t.decoders||((n={})[t.prefix]=t,n)))},ut=function(){function e(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new it(e,t,r),this.decoder=new ot(e,t,n)}var t=e.prototype;return t.encode=function(e){return this.encoder.encode(e)},t.decode=function(e){return this.decoder.decode(e)},(0,u.default)(e)}(),ct=function(e){var t=e.name,r=e.prefix,n=e.encode,i=e.decode;return new ut(t,r,n,i)},lt=function(e){var t=e.prefix,r=e.name,n=e.alphabet,i=rt(n,r),o=i.encode,s=i.decode;return ct({prefix:t,name:r,encode:o,decode:function(e){return nt(s(e))}})},ht=function(e){var t=e.name,r=e.prefix,n=e.bitsPerChar,i=e.alphabet;return ct({prefix:r,name:t,encode:function(e){return function(e,t,r){for(var n="="===t[t.length-1],i=(1<<r)-1,o="",s=0,a=0,u=0;u<e.length;++u)for(a=a<<8|e[u],s+=8;s>r;)o+=t[i&a>>(s-=r)];if(s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o}(e,i,n)},decode:function(e){return function(e,t,r,n){for(var i={},o=0;o<t.length;++o)i[t[o]]=o;for(var s=e.length;"="===e[s-1];)--s;for(var a=new Uint8Array(s*r/8|0),u=0,c=0,l=0,h=0;h<s;++h){var f=i[e[h]];if(void 0===f)throw new SyntaxError(`Non-${n} character`);c=c<<r|f,(u+=r)>=8&&(u-=8,a[l++]=255&c>>u)}if(u>=r||255&c<<8-u)throw new SyntaxError("Unexpected end of data");return a}(e,i,n,t)}})},ft=ct({prefix:"\0",name:"identity",encode:function(e){return function(e){return(new TextDecoder).decode(e)}(e)},decode:function(e){return function(e){return(new TextEncoder).encode(e)}(e)}}),dt=Object.freeze({__proto__:null,identity:ft}),pt=ht({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),gt=Object.freeze({__proto__:null,base2:pt}),yt=ht({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),vt=Object.freeze({__proto__:null,base8:yt}),mt=lt({prefix:"9",name:"base10",alphabet:"0123456789"}),bt=Object.freeze({__proto__:null,base10:mt}),Et=ht({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),_t=ht({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),wt=Object.freeze({__proto__:null,base16:Et,base16upper:_t}),St=ht({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),It=ht({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Rt=ht({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ot=ht({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Mt=ht({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Tt=ht({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Pt=ht({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Nt=ht({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),xt=ht({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),At=Object.freeze({__proto__:null,base32:St,base32upper:It,base32pad:Rt,base32padupper:Ot,base32hex:Mt,base32hexupper:Tt,base32hexpad:Pt,base32hexpadupper:Nt,base32z:xt}),Ct=lt({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),kt=lt({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Dt=Object.freeze({__proto__:null,base36:Ct,base36upper:kt}),Ut=lt({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Lt=lt({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),jt=Object.freeze({__proto__:null,base58btc:Ut,base58flickr:Lt}),Bt=ht({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),qt=ht({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Vt=ht({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),zt=ht({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),$t=Object.freeze({__proto__:null,base64:Bt,base64pad:qt,base64url:Vt,base64urlpad:zt}),Kt=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),Wt=Kt.reduce((function(e,t,r){return e[r]=t,e}),[]),Ht=Kt.reduce((function(e,t,r){return e[t.codePointAt(0)]=r,e}),[]);var Ft=ct({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce((function(e,t){return e+=Wt[t]}),"")},decode:function(e){var t=[];for(var r of e){var n=Ht[r.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}}),Jt=Object.freeze({__proto__:null,base256emoji:Ft}),Gt=function e(t,r,n){r=r||[];for(var i=n=n||0;t>=Xt;)r[n++]=255&t|Yt,t/=128;for(;t&Zt;)r[n++]=255&t|Yt,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},Yt=128,Zt=-128,Xt=Math.pow(2,31);var Qt=function e(t,r){var n,i=0,o=0,s=r=r||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=o<28?(n&tr)<<o:(n&tr)*Math.pow(2,o),o+=7}while(n>=er);return e.bytes=s-r,i},er=128,tr=127;var rr=Math.pow(2,7),nr=Math.pow(2,14),ir=Math.pow(2,21),or=Math.pow(2,28),sr=Math.pow(2,35),ar=Math.pow(2,42),ur=Math.pow(2,49),cr=Math.pow(2,56),lr=Math.pow(2,63),hr={encode:Gt,decode:Qt,encodingLength:function(e){return e<rr?1:e<nr?2:e<ir?3:e<or?4:e<sr?5:e<ar?6:e<ur?7:e<cr?8:e<lr?9:10}},fr=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return hr.encode(e,t,r),t},dr=function(e){return hr.encodingLength(e)},pr=function(e,t){var r=t.byteLength,n=dr(e),i=n+dr(r),o=new Uint8Array(i+r);return fr(e,o,0),fr(r,o,n),o.set(t,i),new gr(e,r,t,o)},gr=(0,u.default)((function(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n})),yr=function(e){var t=e.name,r=e.code,n=e.encode;return new vr(t,r,n)},vr=function(){function e(e,t,r){this.name=e,this.code=t,this.encode=r}return e.prototype.digest=function(e){var t=this;if(e instanceof Uint8Array){var r=this.encode(e);return r instanceof Uint8Array?pr(this.code,r):r.then((function(e){return pr(t.code,e)}))}throw Error("Unknown type, must be binary type")},(0,u.default)(e)}(),mr=function(e){return function(){var t=(0,a.default)((function*(t){return new Uint8Array(yield crypto.subtle.digest(e,t))}));return function(e){return t.apply(this,arguments)}}()},br=yr({name:"sha2-256",code:18,encode:mr("SHA-256")}),Er=yr({name:"sha2-512",code:19,encode:mr("SHA-512")}),_r=Object.freeze({__proto__:null,sha256:br,sha512:Er}),wr=nt,Sr={code:0,name:"identity",encode:wr,digest:function(e){return pr(0,wr(e))}},Ir=Object.freeze({__proto__:null,identity:Sr});new TextEncoder,new TextDecoder;var Rr=et(et(et(et(et(et(et(et(et(et({},dt),gt),vt),bt),wt),At),Dt),jt),$t),Jt);function Or(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Mr(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}et(et({},_r),Ir);var Tr=Mr("utf8","u",(function(e){return"u"+new TextDecoder("utf8").decode(e)}),(function(e){return(new TextEncoder).encode(e.substring(1))})),Pr=Mr("ascii","a",(function(e){for(var t="a",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(function(e){for(var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?Or(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),Nr=et({utf8:Tr,"utf-8":Tr,hex:Rr.base16,latin1:Pr,ascii:Pr,binary:Pr},Rr);var xr="core",Ar=`wc@2:${xr}:`,Cr="error",kr={database:":memory:"},Dr="client_ed25519_seed",Ur=L.ONE_DAY,Lr=L.SIX_HOURS,jr="wss://relay.walletconnect.com",Br="relayer_message",qr="relayer_message_ack",Vr="relayer_connect",zr="relayer_disconnect",$r="relayer_error",Kr="relayer_connection_stalled",Wr="relayer_transport_closed",Hr="relayer_publish",Fr="payload",Jr="connect",Gr="disconnect",Yr="error",Zr=L.ONE_SECOND/2,Xr="subscription_created",Qr="subscription_deleted",en="subscription_sync",tn="subscription_resubscribed",rn=(L.THIRTY_DAYS,1e3*L.FIVE_SECONDS),nn=(L.THIRTY_DAYS,{wc_pairingDelete:{req:{ttl:L.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:L.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:L.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:L.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:L.ONE_DAY,prompt:!1,tag:0},res:{ttl:L.ONE_DAY,prompt:!1,tag:0}}}),on="history_created",sn="history_updated",an="history_deleted",un="history_sync",cn="expirer_created",ln="expirer_deleted",hn="expirer_expired",fn="expirer_sync",dn=(L.ONE_DAY,"verify-api"),pn="https://verify.walletconnect.com",gn=function(){function e(e,t){var r=this;this.core=e,this.logger=t,this.keychain=new Map,this.name="keychain",this.version="0.3",this.initialized=!1,this.storagePrefix=Ar,this.init=(0,a.default)((function*(){if(!r.initialized){var e=yield r.getKeyChain();typeof e<"u"&&(r.keychain=e),r.initialized=!0}})),this.has=function(e){return r.isInitialized(),r.keychain.has(e)},this.set=function(){var e=(0,a.default)((function*(e,t){r.isInitialized(),r.keychain.set(e,t),yield r.persist()}));return function(t,r){return e.apply(this,arguments)}}(),this.get=function(e){r.isInitialized();var t=r.keychain.get(e);if(typeof t>"u"){var n=Be("NO_MATCHING_KEY",`${r.name}: ${e}`).message;throw new Error(n)}return t},this.del=function(){var e=(0,a.default)((function*(e){r.isInitialized(),r.keychain.delete(e),yield r.persist()}));return function(t){return e.apply(this,arguments)}}(),this.core=e,this.logger=(0,g.generateChildLogger)(t,this.name)}var t=e.prototype;return t.setKeyChain=function(){var e=(0,a.default)((function*(e){yield this.core.storage.setItem(this.storageKey,Ee(e))}));return function(t){return e.apply(this,arguments)}}(),t.getKeyChain=function(){var e=(0,a.default)((function*(){var e=yield this.core.storage.getItem(this.storageKey);return typeof e<"u"?_e(e):void 0}));return function(){return e.apply(this,arguments)}}(),t.persist=function(){var e=(0,a.default)((function*(){yield this.setKeyChain(this.keychain)}));return function(){return e.apply(this,arguments)}}(),t.isInitialized=function(){if(!this.initialized){var e=Be("NOT_INITIALIZED",this.name).message;throw new Error(e)}},(0,u.default)(e,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+"//"+this.name}}]),e}(),yn=function(){function e(e,t,r){var n=this;this.core=e,this.logger=t,this.name="crypto",this.initialized=!1,this.init=(0,a.default)((function*(){n.initialized||(yield n.keychain.init(),n.initialized=!0)})),this.hasKeys=function(e){return n.isInitialized(),n.keychain.has(e)},this.getClientId=(0,a.default)((function*(){n.isInitialized();var e=yield n.getClientSeed(),t=T.generateKeyPair(e);return T.encodeIss(t.publicKey)})),this.generateKeyPair=function(){n.isInitialized();var e=function(){var e=k.generateKeyPair();return{privateKey:(0,D.toString)(e.secretKey,z),publicKey:(0,D.toString)(e.publicKey,z)}}();return n.setPrivateKey(e.publicKey,e.privateKey)},this.signJWT=function(){var e=(0,a.default)((function*(e){n.isInitialized();var t=yield n.getClientSeed(),r=T.generateKeyPair(t),i=Z(),o=Ur;return yield T.signJWT(i,e,o,r)}));return function(t){return e.apply(this,arguments)}}(),this.generateSharedKey=function(e,t,r){n.isInitialized();var i=function(e,t){var r=k.sharedKey((0,D.fromString)(e,z),(0,D.fromString)(t,z)),n=new x.HKDF(C.SHA256,r).expand(Y);return(0,D.toString)(n,z)}(n.getPrivateKey(e),t);return n.setSymKey(i,r)},this.setSymKey=function(){var e=(0,a.default)((function*(e,t){n.isInitialized();var r=t||X(e);return yield n.keychain.set(r,e),r}));return function(t,r){return e.apply(this,arguments)}}(),this.deleteKeyPair=function(){var e=(0,a.default)((function*(e){n.isInitialized(),yield n.keychain.del(e)}));return function(t){return e.apply(this,arguments)}}(),this.deleteSymKey=function(){var e=(0,a.default)((function*(e){n.isInitialized(),yield n.keychain.del(e)}));return function(t){return e.apply(this,arguments)}}(),this.encode=function(){var e=(0,a.default)((function*(e,t,r){n.isInitialized();var i=ne(r),o=(0,M.safeJsonStringify)(t);if(ie(i)){var s=i.senderPublicKey,a=i.receiverPublicKey;e=yield n.generateSharedKey(s,a)}var u=n.getSymKey(e);return te({type:i.type,symKey:u,message:o,senderPublicKey:i.senderPublicKey})}));return function(t,r,n){return e.apply(this,arguments)}}(),this.decode=function(){var e=(0,a.default)((function*(e,t,r){n.isInitialized();var i=function(e,t){var r=re(e);return ne({type:ee(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?(0,D.toString)(r.senderPublicKey,z):void 0,receiverPublicKey:null==t?void 0:t.receiverPublicKey})}(t,r);if(ie(i)){var o=i.receiverPublicKey,s=i.senderPublicKey;e=yield n.generateSharedKey(o,s)}var a=function(e){var t=new N.ChaCha20Poly1305((0,D.fromString)(e.symKey,z)),r=re(e.encoded),n=r.sealed,i=r.iv,o=t.open(i,n);if(null===o)throw new Error("Failed to decrypt");return(0,D.toString)(o,K)}({symKey:n.getSymKey(e),encoded:t});return(0,M.safeJsonParse)(a)}));return function(t,r,n){return e.apply(this,arguments)}}(),this.getPayloadType=function(e){return ee(re(e).type)},this.getPayloadSenderPublicKey=function(e){var t=re(e);return t.senderPublicKey?(0,D.toString)(t.senderPublicKey,z):void 0},this.core=e,this.logger=(0,g.generateChildLogger)(t,this.name),this.keychain=r||new gn(this.core,this.logger)}var t=e.prototype;return t.setPrivateKey=function(){var e=(0,a.default)((function*(e,t){return yield this.keychain.set(e,t),e}));return function(t,r){return e.apply(this,arguments)}}(),t.getPrivateKey=function(e){return this.keychain.get(e)},t.getClientSeed=function(){var e=(0,a.default)((function*(){var e="";try{e=this.keychain.get(Dr)}catch(t){e=Z(),yield this.keychain.set(Dr,e)}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",r=Nr[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Or(globalThis.Buffer.from(e,"utf-8"))}(e,"base16")}));return function(){return e.apply(this,arguments)}}(),t.getSymKey=function(e){return this.keychain.get(e)},t.isInitialized=function(){if(!this.initialized){var e=Be("NOT_INITIALIZED",this.name).message;throw new Error(e)}},(0,u.default)(e,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}}]),e}(),vn=function(e){(0,i.default)(r,e);var t=Xe(r);function r(e,r){var n;return(n=t.call(this,e,r)).logger=e,n.core=r,n.messages=new Map,n.name="messages",n.version="0.3",n.initialized=!1,n.storagePrefix=Ar,n.init=(0,a.default)((function*(){if(!n.initialized){n.logger.trace("Initialized");try{var e=yield n.getRelayerMessages();typeof e<"u"&&(n.messages=e),n.logger.debug(`Successfully Restored records for ${n.name}`),n.logger.trace({type:"method",method:"restore",size:n.messages.size})}catch(e){n.logger.debug(`Failed to Restore records for ${n.name}`),n.logger.error(e)}finally{n.initialized=!0}}})),n.set=function(){var e=(0,a.default)((function*(e,t){n.isInitialized();var r=Q(t),i=n.messages.get(e);return typeof i>"u"&&(i={}),typeof i[r]<"u"||(i[r]=t,n.messages.set(e,i),yield n.persist()),r}));return function(t,r){return e.apply(this,arguments)}}(),n.get=function(e){n.isInitialized();var t=n.messages.get(e);return typeof t>"u"&&(t={}),t},n.has=function(e,t){return n.isInitialized(),typeof n.get(e)[Q(t)]<"u"},n.del=function(){var e=(0,a.default)((function*(e){n.isInitialized(),n.messages.delete(e),yield n.persist()}));return function(t){return e.apply(this,arguments)}}(),n.logger=(0,g.generateChildLogger)(e,n.name),n.core=r,n}var n=r.prototype;return n.setRelayerMessages=function(){var e=(0,a.default)((function*(e){yield this.core.storage.setItem(this.storageKey,Ee(e))}));return function(t){return e.apply(this,arguments)}}(),n.getRelayerMessages=function(){var e=(0,a.default)((function*(){var e=yield this.core.storage.getItem(this.storageKey);return typeof e<"u"?_e(e):void 0}));return function(){return e.apply(this,arguments)}}(),n.persist=function(){var e=(0,a.default)((function*(){yield this.setRelayerMessages(this.messages)}));return function(){return e.apply(this,arguments)}}(),n.isInitialized=function(){if(!this.initialized){var e=Be("NOT_INITIALIZED",this.name).message;throw new Error(e)}},(0,u.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+"//"+this.name}}]),r}(E),mn=function(e){(0,i.default)(r,e);var t=Xe(r);function r(e,r){var n;return(n=t.call(this,e,r)).relayer=e,n.logger=r,n.events=new h.EventEmitter,n.name="publisher",n.queue=new Map,n.publishTimeout=1e4,n.publish=function(){var e=(0,a.default)((function*(e,t,r){n.logger.debug("Publishing Payload"),n.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:r}});try{var i=(null==r?void 0:r.ttl)||Lr,o=Me(r),s=(null==r?void 0:r.prompt)||!1,a=(null==r?void 0:r.tag)||0,u=(null==r?void 0:r.id)||(0,Je.getBigIntRpcId)().toString(),c={topic:e,message:t,opts:{ttl:i,relay:o,prompt:s,tag:a,id:u}};n.queue.set(u,c);try{yield yield we(n.rpcPublish(e,t,i,o,s,a,u),n.publishTimeout),n.relayer.events.emit(Hr,c)}catch(l){return n.logger.debug("Publishing Payload stalled"),void n.relayer.events.emit(Kr)}n.logger.debug("Successfully Published Payload"),n.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:r}})}catch(i){throw n.logger.debug("Failed to Publish Payload"),n.logger.error(i),i}}));return function(t,r,n){return e.apply(this,arguments)}}(),n.on=function(e,t){n.events.on(e,t)},n.once=function(e,t){n.events.once(e,t)},n.off=function(e,t){n.events.off(e,t)},n.removeListener=function(e,t){n.events.removeListener(e,t)},n.relayer=e,n.logger=(0,g.generateChildLogger)(r,n.name),n.registerEventListeners(),n}var n=r.prototype;return n.rpcPublish=function(e,t,r,n,i,o,s){var a,u,c,l,h={method:Te(n.protocol).publish,params:{topic:e,message:t,ttl:r,prompt:i,tag:o},id:s};return ze(null==(a=h.params)?void 0:a.prompt)&&(null==(u=h.params)||delete u.prompt),ze(null==(c=h.params)?void 0:c.tag)&&(null==(l=h.params)||delete l.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:h}),this.relayer.request(h)},n.onPublish=function(e){this.queue.delete(e)},n.checkQueue=function(){var e=this;this.queue.forEach(function(){var t=(0,a.default)((function*(t){var r=t.topic,n=t.message,i=t.opts;yield e.publish(r,n,i)}));return function(e){return t.apply(this,arguments)}}())},n.registerEventListeners=function(){var e=this;this.relayer.core.heartbeat.on(p.HEARTBEAT_EVENTS.pulse,(function(){e.checkQueue()})),this.relayer.on(qr,(function(t){e.onPublish(t.id.toString())}))},(0,u.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}}]),r}(_),bn=function(){function e(){var e=this;this.map=new Map,this.set=function(t,r){var n=e.get(t);e.exists(t,r)||e.map.set(t,[].concat((0,c.default)(n),[r]))},this.get=function(t){return e.map.get(t)||[]},this.exists=function(t,r){return e.get(t).includes(r)},this.delete=function(t,r){if(typeof r>"u")e.map.delete(t);else if(e.map.has(t)){var n=e.get(t);if(e.exists(t,r)){var i=n.filter((function(e){return e!==r}));i.length?e.map.set(t,i):e.map.delete(t)}}},this.clear=function(){e.map.clear()}}return(0,u.default)(e,[{key:"topics",get:function(){return Array.from(this.map.keys())}}]),e}(),En=Object.defineProperty,_n=Object.defineProperties,wn=Object.getOwnPropertyDescriptors,Sn=Object.getOwnPropertySymbols,In=Object.prototype.hasOwnProperty,Rn=Object.prototype.propertyIsEnumerable,On=function(e,t,r){return t in e?En(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Mn=function(e,t){for(var r in t||(t={}))In.call(t,r)&&On(e,r,t[r]);if(Sn)for(var r of Sn(t))Rn.call(t,r)&&On(e,r,t[r]);return e},Tn=function(e,t){return _n(e,wn(t))},Pn=function(e){(0,i.default)(r,e);var t=Xe(r);function r(e,r){var n;return(n=t.call(this,e,r)).relayer=e,n.logger=r,n.subscriptions=new Map,n.topicMap=new bn,n.events=new h.EventEmitter,n.name="subscription",n.version="0.3",n.pending=new Map,n.cached=[],n.initialized=!1,n.pendingSubscriptionWatchLabel="pending_sub_watch_label",n.pollingInterval=20,n.storagePrefix=Ar,n.subscribeTimeout=1e4,n.restartInProgress=!1,n.batchSubscribeTopicsLimit=500,n.init=(0,a.default)((function*(){n.initialized||(n.logger.trace("Initialized"),yield n.restart(),n.registerEventListeners(),n.onEnable(),n.clientId=yield n.relayer.core.crypto.getClientId())})),n.subscribe=function(){var e=(0,a.default)((function*(e,t){yield n.restartToComplete(),n.isInitialized(),n.logger.debug("Subscribing Topic"),n.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{var r=Me(t),i={topic:e,relay:r};n.pending.set(e,i);var o=yield n.rpcSubscribe(e,r);return n.onSubscribe(o,i),n.logger.debug("Successfully Subscribed Topic"),n.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}}),o}catch(r){throw n.logger.debug("Failed to Subscribe Topic"),n.logger.error(r),r}}));return function(t,r){return e.apply(this,arguments)}}(),n.unsubscribe=function(){var e=(0,a.default)((function*(e,t){yield n.restartToComplete(),n.isInitialized(),typeof(null==t?void 0:t.id)<"u"?yield n.unsubscribeById(e,t.id,t):yield n.unsubscribeByTopic(e,t)}));return function(t,r){return e.apply(this,arguments)}}(),n.isSubscribed=function(){var e=(0,a.default)((function*(e){return!!n.topics.includes(e)||(yield new Promise((function(t,r){var i=new L.Watch;i.start(n.pendingSubscriptionWatchLabel);var o=setInterval((function(){!n.pending.has(e)&&n.topics.includes(e)&&(clearInterval(o),i.stop(n.pendingSubscriptionWatchLabel),t(!0)),i.elapsed(n.pendingSubscriptionWatchLabel)>=rn&&(clearInterval(o),i.stop(n.pendingSubscriptionWatchLabel),r(new Error("Subscription resolution timeout")))}),n.pollingInterval)})).catch((function(){return!1})))}));return function(t){return e.apply(this,arguments)}}(),n.on=function(e,t){n.events.on(e,t)},n.once=function(e,t){n.events.once(e,t)},n.off=function(e,t){n.events.off(e,t)},n.removeListener=function(e,t){n.events.removeListener(e,t)},n.restart=(0,a.default)((function*(){n.restartInProgress=!0,yield n.restore(),yield n.reset(),n.restartInProgress=!1})),n.relayer=e,n.logger=(0,g.generateChildLogger)(r,n.name),n.clientId="",n}var n=r.prototype;return n.hasSubscription=function(e,t){var r=!1;try{r=this.getSubscription(e).topic===t}catch(n){}return r},n.onEnable=function(){this.cached=[],this.initialized=!0},n.onDisable=function(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()},n.unsubscribeByTopic=function(){var e=(0,a.default)((function*(e,t){var r=this,n=this.topicMap.get(e);yield Promise.all(n.map(function(){var n=(0,a.default)((function*(n){return yield r.unsubscribeById(e,n,t)}));return function(e){return n.apply(this,arguments)}}()))}));return function(t,r){return e.apply(this,arguments)}}(),n.unsubscribeById=function(){var e=(0,a.default)((function*(e,t,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{var n=Me(r);yield this.rpcUnsubscribe(e,t,n);var i=qe("USER_DISCONNECTED",`${this.name}, ${e}`);yield this.onUnsubscribe(e,t,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}));return function(t,r,n){return e.apply(this,arguments)}}(),n.rpcSubscribe=function(){var e=(0,a.default)((function*(e,t){var r={method:Te(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{yield yield we(this.relayer.request(r),this.subscribeTimeout)}catch(n){this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Kr)}return Q(e+this.clientId)}));return function(t,r){return e.apply(this,arguments)}}(),n.rpcBatchSubscribe=function(){var e=(0,a.default)((function*(e){if(e.length){var t={method:Te(e[0].relay.protocol).batchSubscribe,params:{topics:e.map((function(e){return e.topic}))}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{return yield yield we(this.relayer.request(t),this.subscribeTimeout)}catch(r){this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Kr)}}}));return function(t){return e.apply(this,arguments)}}(),n.rpcUnsubscribe=function(e,t,r){var n={method:Te(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)},n.onSubscribe=function(e,t){this.setSubscription(e,Tn(Mn({},t),{id:e})),this.pending.delete(t.topic)},n.onBatchSubscribe=function(e){var t=this;e.length&&e.forEach((function(e){t.setSubscription(e.id,Mn({},e)),t.pending.delete(e.topic)}))},n.onUnsubscribe=function(){var e=(0,a.default)((function*(e,t,r){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,r),yield this.relayer.messages.del(e)}));return function(t,r,n){return e.apply(this,arguments)}}(),n.setRelayerSubscriptions=function(){var e=(0,a.default)((function*(e){yield this.relayer.core.storage.setItem(this.storageKey,e)}));return function(t){return e.apply(this,arguments)}}(),n.getRelayerSubscriptions=function(){var e=(0,a.default)((function*(){return yield this.relayer.core.storage.getItem(this.storageKey)}));return function(){return e.apply(this,arguments)}}(),n.setSubscription=function(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))},n.addSubscription=function(e,t){this.subscriptions.set(e,Mn({},t)),this.topicMap.set(t.topic,e),this.events.emit(Xr,t)},n.getSubscription=function(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});var t=this.subscriptions.get(e);if(!t){var r=Be("NO_MATCHING_KEY",`${this.name}: ${e}`).message;throw new Error(r)}return t},n.deleteSubscription=function(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});var r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(Qr,Tn(Mn({},r),{reason:t}))},n.persist=function(){var e=(0,a.default)((function*(){yield this.setRelayerSubscriptions(this.values),this.events.emit(en)}));return function(){return e.apply(this,arguments)}}(),n.reset=function(){var e=(0,a.default)((function*(){if(this.cached.length)for(var e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit),t=0;t<e;t++){var r=this.cached.splice(0,this.batchSubscribeTopicsLimit);yield this.batchSubscribe(r)}this.events.emit(tn)}));return function(){return e.apply(this,arguments)}}(),n.restore=function(){var e=(0,a.default)((function*(){try{var e=yield this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){var t=Be("RESTORE_WILL_OVERRIDE",this.name).message;throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}));return function(){return e.apply(this,arguments)}}(),n.batchSubscribe=function(){var e=(0,a.default)((function*(e){if(e.length){var t=yield this.rpcBatchSubscribe(e);Ve(t)&&this.onBatchSubscribe(t.map((function(t,r){return Tn(Mn({},e[r]),{id:t})})))}}));return function(t){return e.apply(this,arguments)}}(),n.onConnect=function(){var e=(0,a.default)((function*(){this.restartInProgress||(yield this.restart(),this.onEnable())}));return function(){return e.apply(this,arguments)}}(),n.onDisconnect=function(){this.onDisable()},n.checkPending=function(){var e=(0,a.default)((function*(){if(!this.relayer.transportExplicitlyClosed){var e=[];this.pending.forEach((function(t){e.push(t)})),yield this.batchSubscribe(e)}}));return function(){return e.apply(this,arguments)}}(),n.registerEventListeners=function(){var e=this;this.relayer.core.heartbeat.on(p.HEARTBEAT_EVENTS.pulse,(0,a.default)((function*(){yield e.checkPending()}))),this.relayer.on(Vr,(0,a.default)((function*(){yield e.onConnect()}))),this.relayer.on(zr,(function(){e.onDisconnect()})),this.events.on(Xr,function(){var t=(0,a.default)((function*(t){var r=Xr;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,data:t}),yield e.persist()}));return function(e){return t.apply(this,arguments)}}()),this.events.on(Qr,function(){var t=(0,a.default)((function*(t){var r=Qr;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,data:t}),yield e.persist()}));return function(e){return t.apply(this,arguments)}}())},n.isInitialized=function(){if(!this.initialized){var e=Be("NOT_INITIALIZED",this.name).message;throw new Error(e)}},n.restartToComplete=function(){var e=(0,a.default)((function*(){var e=this;this.restartInProgress&&(yield new Promise((function(t){var r=setInterval((function(){e.restartInProgress||(clearInterval(r),t())}),e.pollingInterval)})))}));return function(){return e.apply(this,arguments)}}(),(0,u.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+"//"+this.name}},{key:"length",get:function(){return this.subscriptions.size}},{key:"ids",get:function(){return Array.from(this.subscriptions.keys())}},{key:"values",get:function(){return Array.from(this.subscriptions.values())}},{key:"topics",get:function(){return this.topicMap.topics}}]),r}(I),Nn=Object.defineProperty,xn=Object.getOwnPropertySymbols,An=Object.prototype.hasOwnProperty,Cn=Object.prototype.propertyIsEnumerable,kn=function(e,t,r){return t in e?Nn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Dn=function(e){(0,i.default)(r,e);var t=Xe(r);function r(e){var r;return(r=t.call(this,e)).protocol="wc",r.version=2,r.events=new h.EventEmitter,r.name="relayer",r.transportExplicitlyClosed=!1,r.initialized=!1,r.reconnecting=!1,r.connectionStatusPollingInterval=20,r.staleConnectionErrors=["socket hang up","socket stalled"],r.request=function(){var e=(0,a.default)((function*(e){r.logger.debug("Publishing Request Payload");try{return yield r.toEstablishConnection(),yield r.provider.request(e)}catch(t){throw r.logger.debug("Failed to Publish Request"),r.logger.error(t),t}}));return function(t){return e.apply(this,arguments)}}(),r.core=e.core,r.logger=typeof e.logger<"u"&&"string"!=typeof e.logger?(0,g.generateChildLogger)(e.logger,r.name):(0,g.pino)((0,g.getDefaultLoggerOptions)({level:e.logger||"error"})),r.messages=new vn(r.logger,e.core),r.subscriber=new Pn((0,n.default)(r),r.logger),r.publisher=new mn((0,n.default)(r),r.logger),r.relayUrl=(null==e?void 0:e.relayUrl)||jr,r.projectId=e.projectId,r.provider={},r}var o=r.prototype;return o.init=function(){var e=(0,a.default)((function*(){var e=this;this.logger.trace("Initialized"),yield this.createProvider(),yield Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0,setTimeout((0,a.default)((function*(){0===e.subscriber.topics.length&&(e.logger.info("No topics subscribted to after init, closing transport"),yield e.transportClose(),e.transportExplicitlyClosed=!1)})),1e4)}));return function(){return e.apply(this,arguments)}}(),o.publish=function(){var e=(0,a.default)((function*(e,t,r){this.isInitialized(),yield this.publisher.publish(e,t,r),yield this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}));return function(t,r,n){return e.apply(this,arguments)}}(),o.subscribe=function(){var e=(0,a.default)((function*(e,t){var r=this;this.isInitialized();var n="";return yield Promise.all([new Promise((function(t){r.subscriber.once(Xr,(function(r){r.topic===e&&t()}))})),new Promise(function(){var i=(0,a.default)((function*(i){n=yield r.subscriber.subscribe(e,t),i()}));return function(e){return i.apply(this,arguments)}}())]),n}));return function(t,r){return e.apply(this,arguments)}}(),o.unsubscribe=function(){var e=(0,a.default)((function*(e,t){this.isInitialized(),yield this.subscriber.unsubscribe(e,t)}));return function(t,r){return e.apply(this,arguments)}}(),o.on=function(e,t){this.events.on(e,t)},o.once=function(e,t){this.events.once(e,t)},o.off=function(e,t){this.events.off(e,t)},o.removeListener=function(e,t){this.events.removeListener(e,t)},o.transportClose=function(){var e=(0,a.default)((function*(){this.transportExplicitlyClosed=!0,this.connected&&(yield this.provider.disconnect(),this.events.emit(Wr))}));return function(){return e.apply(this,arguments)}}(),o.transportOpen=function(){var e=(0,a.default)((function*(e){var t=this;if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=e||this.relayUrl,this.reconnecting=!0;try{yield Promise.all([new Promise((function(e){t.initialized||e(),t.subscriber.once(tn,(function(){e()}))})),yield Promise.race([new Promise(function(){var e=(0,a.default)((function*(e,r){yield we(t.provider.connect(),5e3,"socket stalled").catch((function(e){return r(e)})).then((function(){return e()})).finally((function(){return t.removeListener(Wr,t.rejectTransportOpen)}))}));return function(t,r){return e.apply(this,arguments)}}()),new Promise((function(e){return t.once(Wr,t.rejectTransportOpen)}))])])}catch(n){this.logger.error(n);var r=n;if(!this.isConnectionStalled(r.message))throw n;this.events.emit(Wr)}finally{this.reconnecting=!1}}}));return function(t){return e.apply(this,arguments)}}(),o.restartTransport=function(){var e=(0,a.default)((function*(e){var t=this;this.transportExplicitlyClosed||(this.relayUrl=e||this.relayUrl,this.connected&&(yield Promise.all([new Promise((function(e){t.provider.once(Gr,(function(){e()}))})),this.transportClose()])),yield this.createProvider(),yield this.transportOpen())}));return function(t){return e.apply(this,arguments)}}(),o.isConnectionStalled=function(e){return this.staleConnectionErrors.some((function(t){return e.includes(t)}))},o.rejectTransportOpen=function(){throw new Error("closeTransport called before connection was established")},o.createProvider=function(){var e=(0,a.default)((function*(){var e=yield this.core.crypto.signJWT(this.relayUrl);this.provider=new Fe.JsonRpcProvider(new Ge.default(be({sdkVersion:"2.7.6",protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}));return function(){return e.apply(this,arguments)}}(),o.recordMessageEvent=function(){var e=(0,a.default)((function*(e){var t=e.topic,r=e.message;yield this.messages.set(t,r)}));return function(t){return e.apply(this,arguments)}}(),o.shouldIgnoreMessageEvent=function(){var e=(0,a.default)((function*(e){var t=e.topic,r=e.message;return!(yield this.subscriber.isSubscribed(t))||this.messages.has(t,r)}));return function(t){return e.apply(this,arguments)}}(),o.onProviderPayload=function(){var e=(0,a.default)((function*(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),(0,Je.isJsonRpcRequest)(e)){if(!e.method.endsWith("_subscription"))return;var t=e.params,r=t.data,n={topic:r.topic,message:r.message,publishedAt:r.publishedAt};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(function(e,t){for(var r in t||(t={}))An.call(t,r)&&kn(e,r,t[r]);if(xn)for(var r of xn(t))Cn.call(t,r)&&kn(e,r,t[r]);return e}({type:"event",event:t.id},n)),this.events.emit(t.id,n),yield this.acknowledgePayload(e),yield this.onMessageEvent(n)}else(0,Je.isJsonRpcResponse)(e)&&this.events.emit(qr,e)}));return function(t){return e.apply(this,arguments)}}(),o.onMessageEvent=function(){var e=(0,a.default)((function*(e){(yield this.shouldIgnoreMessageEvent(e))||(this.events.emit(Br,e),yield this.recordMessageEvent(e))}));return function(t){return e.apply(this,arguments)}}(),o.acknowledgePayload=function(){var e=(0,a.default)((function*(e){var t=(0,Je.formatJsonRpcResult)(e.id,!0);yield this.provider.connection.send(t)}));return function(t){return e.apply(this,arguments)}}(),o.registerProviderListeners=function(){var e=this;this.provider.on(Fr,(function(t){return e.onProviderPayload(t)})),this.provider.on(Jr,(function(){e.events.emit(Vr)})),this.provider.on(Gr,(function(){e.onProviderDisconnect()})),this.provider.on(Yr,(function(t){e.logger.error(t),e.events.emit($r,t)}))},o.registerEventListeners=function(){var e=this;this.events.on(Kr,(0,a.default)((function*(){yield e.restartTransport()})))},o.onProviderDisconnect=function(){this.events.emit(zr),this.attemptToReconnect()},o.attemptToReconnect=function(){var e=this;this.transportExplicitlyClosed||setTimeout((0,a.default)((function*(){yield e.restartTransport()})),(0,L.toMiliseconds)(Zr))},o.isInitialized=function(){if(!this.initialized){var e=Be("NOT_INITIALIZED",this.name).message;throw new Error(e)}},o.toEstablishConnection=function(){var e=(0,a.default)((function*(){var e=this;if(!this.connected){if(this.connecting)return yield new Promise((function(t){var r=setInterval((function(){e.connected&&(clearInterval(r),t())}),e.connectionStatusPollingInterval)}));yield this.restartTransport()}}));return function(){return e.apply(this,arguments)}}(),(0,u.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"connected",get:function(){return this.provider.connection.connected}},{key:"connecting",get:function(){return this.provider.connection.connecting}}]),r}(w),Un=Object.defineProperty,Ln=Object.getOwnPropertySymbols,jn=Object.prototype.hasOwnProperty,Bn=Object.prototype.propertyIsEnumerable,qn=function(e,t,r){return t in e?Un(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Vn=function(e,t){for(var r in t||(t={}))jn.call(t,r)&&qn(e,r,t[r]);if(Ln)for(var r of Ln(t))Bn.call(t,r)&&qn(e,r,t[r]);return e},zn=function(e){(0,i.default)(r,e);var t=Xe(r);function r(e,r,n){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ar,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;return(i=t.call(this,e,r,n,o)).core=e,i.logger=r,i.name=n,i.map=new Map,i.version="0.3",i.cached=[],i.initialized=!1,i.storagePrefix=Ar,i.init=(0,a.default)((function*(){i.initialized||(i.logger.trace("Initialized"),yield i.restore(),i.cached.forEach((function(e){i.getKey&&null!==e&&!ze(e)?i.map.set(i.getKey(e),e):function(e){var t;return null==(t=null==e?void 0:e.proposer)?void 0:t.publicKey}(e)?i.map.set(e.id,e):function(e){return null==e?void 0:e.topic}(e)&&i.map.set(e.topic,e)})),i.cached=[],i.initialized=!0)})),i.set=function(){var e=(0,a.default)((function*(e,t){i.isInitialized(),i.map.has(e)?yield i.update(e,t):(i.logger.debug("Setting value"),i.logger.trace({type:"method",method:"set",key:e,value:t}),i.map.set(e,t),yield i.persist())}));return function(t,r){return e.apply(this,arguments)}}(),i.get=function(e){return i.isInitialized(),i.logger.debug("Getting value"),i.logger.trace({type:"method",method:"get",key:e}),i.getData(e)},i.getAll=function(e){return i.isInitialized(),e?i.values.filter((function(t){return Object.keys(e).every((function(r){return Ze()(t[r],e[r])}))})):i.values},i.update=function(){var e=(0,a.default)((function*(e,t){i.isInitialized(),i.logger.debug("Updating value"),i.logger.trace({type:"method",method:"update",key:e,update:t});var r=Vn(Vn({},i.getData(e)),t);i.map.set(e,r),yield i.persist()}));return function(t,r){return e.apply(this,arguments)}}(),i.delete=function(){var e=(0,a.default)((function*(e,t){i.isInitialized(),i.map.has(e)&&(i.logger.debug("Deleting value"),i.logger.trace({type:"method",method:"delete",key:e,reason:t}),i.map.delete(e),yield i.persist())}));return function(t,r){return e.apply(this,arguments)}}(),i.logger=(0,g.generateChildLogger)(r,i.name),i.storagePrefix=o,i.getKey=s,i}var n=r.prototype;return n.setDataStore=function(){var e=(0,a.default)((function*(e){yield this.core.storage.setItem(this.storageKey,e)}));return function(t){return e.apply(this,arguments)}}(),n.getDataStore=function(){var e=(0,a.default)((function*(){return yield this.core.storage.getItem(this.storageKey)}));return function(){return e.apply(this,arguments)}}(),n.getData=function(e){var t=this.map.get(e);if(!t){var r=Be("NO_MATCHING_KEY",`${this.name}: ${e}`).message;throw this.logger.error(r),new Error(r)}return t},n.persist=function(){var e=(0,a.default)((function*(){yield this.setDataStore(this.values)}));return function(){return e.apply(this,arguments)}}(),n.restore=function(){var e=(0,a.default)((function*(){try{var e=yield this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){var t=Be("RESTORE_WILL_OVERRIDE",this.name).message;throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}));return function(){return e.apply(this,arguments)}}(),n.isInitialized=function(){if(!this.initialized){var e=Be("NOT_INITIALIZED",this.name).message;throw new Error(e)}},(0,u.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+"//"+this.name}},{key:"length",get:function(){return this.map.size}},{key:"keys",get:function(){return Array.from(this.map.keys())}},{key:"values",get:function(){return Array.from(this.map.values())}}]),r}(S),$n=function(){function e(e,t){var r=this;this.core=e,this.logger=t,this.name="pairing",this.version="0.3",this.events=new(f()),this.initialized=!1,this.storagePrefix=Ar,this.ignoredPayloadTypes=[H],this.registeredMethods=[],this.init=(0,a.default)((function*(){r.initialized||(yield r.pairings.init(),yield r.cleanup(),r.registerRelayerEvents(),r.registerExpirerEvents(),r.initialized=!0,r.logger.trace("Initialized"))})),this.register=function(e){var t=e.methods;r.isInitialized(),r.registeredMethods=(0,c.default)(new Set([].concat((0,c.default)(r.registeredMethods),(0,c.default)(t))))},this.create=(0,a.default)((function*(){r.isInitialized();var e=Z(),t=yield r.core.crypto.setSymKey(e),n=Ie(L.FIVE_MINUTES),i={protocol:"irn"},o={topic:t,expiry:n,relay:i,active:!1},s=Ue({protocol:r.core.protocol,version:r.core.version,topic:t,symKey:e,relay:i});return yield r.pairings.set(t,o),yield r.core.relayer.subscribe(t),r.core.expirer.set(t,n),{topic:t,uri:s}})),this.pair=function(){var e=(0,a.default)((function*(e){r.isInitialized(),r.isValidPair(e);var t=function(e){var t=e.indexOf(":"),r=-1!==e.indexOf("?")?e.indexOf("?"):void 0,n=e.substring(0,t),i=e.substring(t+1,r).split("@"),o=typeof r<"u"?e.substring(r):"",s=B.parse(o);return{protocol:n,topic:De(i[0]),version:parseInt(i[1],10),symKey:s.symKey,relay:ke(s)}}(e.uri),n=t.topic,i=t.symKey,o=t.relay;if(r.pairings.keys.includes(n))throw new Error(`Pairing already exists: ${n}`);if(r.core.crypto.hasKeys(n))throw new Error(`Keychain already exists: ${n}`);var s=Ie(L.FIVE_MINUTES),a={topic:n,relay:o,expiry:s,active:!1};return yield r.pairings.set(n,a),yield r.core.crypto.setSymKey(i,n),yield r.core.relayer.subscribe(n,{relay:o}),r.core.expirer.set(n,s),e.activatePairing&&(yield r.activate({topic:n})),a}));return function(t){return e.apply(this,arguments)}}(),this.activate=function(){var e=(0,a.default)((function*(e){var t=e.topic;r.isInitialized();var n=Ie(L.THIRTY_DAYS);yield r.pairings.update(t,{active:!0,expiry:n}),r.core.expirer.set(t,n)}));return function(t){return e.apply(this,arguments)}}(),this.ping=function(){var e=(0,a.default)((function*(e){r.isInitialized(),yield r.isValidPing(e);var t=e.topic;if(r.pairings.keys.includes(t)){var n=yield r.sendRequest(t,"wc_pairingPing",{}),i=function(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L.FIVE_MINUTES,i=arguments.length>1?arguments[1]:void 0,o=(0,L.toMiliseconds)(n||L.FIVE_MINUTES);return{resolve:function(t){r&&e&&(clearTimeout(r),e(t))},reject:function(e){r&&t&&(clearTimeout(r),t(e))},done:function(){return new Promise((function(n,s){r=setTimeout((function(){s(new Error(i))}),o),e=n,t=s}))}}}(),o=i.done,s=i.resolve,a=i.reject;r.events.once(Oe("pairing_ping",n),(function(e){var t=e.error;t?a(t):s()})),yield o()}}));return function(t){return e.apply(this,arguments)}}(),this.updateExpiry=function(){var e=(0,a.default)((function*(e){var t=e.topic,n=e.expiry;r.isInitialized(),yield r.pairings.update(t,{expiry:n})}));return function(t){return e.apply(this,arguments)}}(),this.updateMetadata=function(){var e=(0,a.default)((function*(e){var t=e.topic,n=e.metadata;r.isInitialized(),yield r.pairings.update(t,{peerMetadata:n})}));return function(t){return e.apply(this,arguments)}}(),this.getPairings=function(){return r.isInitialized(),r.pairings.values},this.disconnect=function(){var e=(0,a.default)((function*(e){r.isInitialized(),yield r.isValidDisconnect(e);var t=e.topic;r.pairings.keys.includes(t)&&(yield r.sendRequest(t,"wc_pairingDelete",qe("USER_DISCONNECTED")),yield r.deletePairing(t))}));return function(t){return e.apply(this,arguments)}}(),this.sendRequest=function(){var e=(0,a.default)((function*(e,t,n){var i=(0,Je.formatJsonRpcRequest)(t,n),o=yield r.core.crypto.encode(e,i),s=nn[t].req;return r.core.history.set(e,i),r.core.relayer.publish(e,o,s),i.id}));return function(t,r,n){return e.apply(this,arguments)}}(),this.sendResult=function(){var e=(0,a.default)((function*(e,t,n){var i=(0,Je.formatJsonRpcResult)(e,n),o=yield r.core.crypto.encode(t,i),s=yield r.core.history.get(t,e),a=nn[s.request.method].res;yield r.core.relayer.publish(t,o,a),yield r.core.history.resolve(i)}));return function(t,r,n){return e.apply(this,arguments)}}(),this.sendError=function(){var e=(0,a.default)((function*(e,t,n){var i=(0,Je.formatJsonRpcError)(e,n),o=yield r.core.crypto.encode(t,i),s=yield r.core.history.get(t,e),a=nn[s.request.method]?nn[s.request.method].res:nn.unregistered_method.res;yield r.core.relayer.publish(t,o,a),yield r.core.history.resolve(i)}));return function(t,r,n){return e.apply(this,arguments)}}(),this.deletePairing=function(){var e=(0,a.default)((function*(e,t){yield r.core.relayer.unsubscribe(e),yield Promise.all([r.pairings.delete(e,qe("USER_DISCONNECTED")),r.core.crypto.deleteSymKey(e),t?Promise.resolve():r.core.expirer.del(e)])}));return function(t,r){return e.apply(this,arguments)}}(),this.cleanup=(0,a.default)((function*(){var e=r.pairings.getAll().filter((function(e){return Re(e.expiry)}));yield Promise.all(e.map((function(e){return r.deletePairing(e.topic)})))})),this.onRelayEventRequest=function(e){var t=e.topic,n=e.payload,i=n.method;if(r.pairings.keys.includes(t))switch(i){case"wc_pairingPing":return r.onPairingPingRequest(t,n);case"wc_pairingDelete":return r.onPairingDeleteRequest(t,n);default:return r.onUnknownRpcMethodRequest(t,n)}},this.onRelayEventResponse=function(){var e=(0,a.default)((function*(e){var t=e.topic,n=e.payload,i=(yield r.core.history.get(t,n.id)).request.method;if(r.pairings.keys.includes(t)){if("wc_pairingPing"===i)return r.onPairingPingResponse(t,n);return r.onUnknownRpcMethodResponse(i)}}));return function(t){return e.apply(this,arguments)}}(),this.onPairingPingRequest=function(){var e=(0,a.default)((function*(e,t){var n=t.id;try{r.isValidPing({topic:e}),yield r.sendResult(n,e,!0),r.events.emit("pairing_ping",{id:n,topic:e})}catch(E){yield r.sendError(n,e,E),r.logger.error(E)}}));return function(t,r){return e.apply(this,arguments)}}(),this.onPairingPingResponse=function(e,t){var n=t.id;setTimeout((function(){(0,Je.isJsonRpcResult)(t)?r.events.emit(Oe("pairing_ping",n),{}):(0,Je.isJsonRpcError)(t)&&r.events.emit(Oe("pairing_ping",n),{error:t.error})}),500)},this.onPairingDeleteRequest=function(){var e=(0,a.default)((function*(e,t){var n=t.id;try{r.isValidDisconnect({topic:e}),yield r.deletePairing(e),r.events.emit("pairing_delete",{id:n,topic:e})}catch(E){yield r.sendError(n,e,E),r.logger.error(E)}}));return function(t,r){return e.apply(this,arguments)}}(),this.onUnknownRpcMethodRequest=function(){var e=(0,a.default)((function*(e,t){var n=t.id,i=t.method;try{if(r.registeredMethods.includes(i))return;var o=qe("WC_METHOD_UNSUPPORTED",i);yield r.sendError(n,e,o),r.logger.error(o)}catch(o){yield r.sendError(n,e,o),r.logger.error(o)}}));return function(t,r){return e.apply(this,arguments)}}(),this.onUnknownRpcMethodResponse=function(e){r.registeredMethods.includes(e)||r.logger.error(qe("WC_METHOD_UNSUPPORTED",e))},this.isValidPair=function(e){if(!He(e)){var t=Be("MISSING_OR_INVALID",`pair() params: ${e}`).message;throw new Error(t)}if(!We(e.uri)){var r=Be("MISSING_OR_INVALID",`pair() uri: ${e.uri}`).message;throw new Error(r)}},this.isValidPing=function(){var e=(0,a.default)((function*(e){if(!He(e)){var t=Be("MISSING_OR_INVALID",`ping() params: ${e}`).message;throw new Error(t)}var n=e.topic;yield r.isValidPairingTopic(n)}));return function(t){return e.apply(this,arguments)}}(),this.isValidDisconnect=function(){var e=(0,a.default)((function*(e){if(!He(e)){var t=Be("MISSING_OR_INVALID",`disconnect() params: ${e}`).message;throw new Error(t)}var n=e.topic;yield r.isValidPairingTopic(n)}));return function(t){return e.apply(this,arguments)}}(),this.isValidPairingTopic=function(){var e=(0,a.default)((function*(e){if(!$e(e,!1)){var t=Be("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`).message;throw new Error(t)}if(!r.pairings.keys.includes(e)){var n=Be("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`).message;throw new Error(n)}if(Re(r.pairings.get(e).expiry)){yield r.deletePairing(e);var i=Be("EXPIRED",`pairing topic: ${e}`).message;throw new Error(i)}}));return function(t){return e.apply(this,arguments)}}(),this.core=e,this.logger=(0,g.generateChildLogger)(t,this.name),this.pairings=new zn(this.core,this.logger,this.name,this.storagePrefix)}var t=e.prototype;return t.isInitialized=function(){if(!this.initialized){var e=Be("NOT_INITIALIZED",this.name).message;throw new Error(e)}},t.registerRelayerEvents=function(){var e=this;this.core.relayer.on(Br,function(){var t=(0,a.default)((function*(t){var r=t.topic,n=t.message;if(!e.ignoredPayloadTypes.includes(e.core.crypto.getPayloadType(n))){var i=yield e.core.crypto.decode(r,n);(0,Je.isJsonRpcRequest)(i)?(e.core.history.set(r,i),e.onRelayEventRequest({topic:r,payload:i})):(0,Je.isJsonRpcResponse)(i)&&(yield e.core.history.resolve(i),e.onRelayEventResponse({topic:r,payload:i}))}}));return function(e){return t.apply(this,arguments)}}())},t.registerExpirerEvents=function(){var e=this;this.core.expirer.on(hn,function(){var t=(0,a.default)((function*(t){var r=function(e){var t=e.split(":"),r=(0,P.default)(t,2),n=r[0],i=r[1],o={id:void 0,topic:void 0};if("topic"===n&&"string"==typeof i)o.topic=i;else{if("id"!==n||!Number.isInteger(Number(i)))throw new Error(`Invalid target, expected id:number or topic:string, got ${n}:${i}`);o.id=Number(i)}return o}(t.target),n=r.topic;n&&e.pairings.keys.includes(n)&&(yield e.deletePairing(n,!0),e.events.emit("pairing_expire",{topic:n}))}));return function(e){return t.apply(this,arguments)}}())},(0,u.default)(e,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}}]),e}(),Kn=function(e){(0,i.default)(r,e);var t=Xe(r);function r(e,r){var n;return(n=t.call(this,e,r)).core=e,n.logger=r,n.records=new Map,n.events=new h.EventEmitter,n.name="history",n.version="0.3",n.cached=[],n.initialized=!1,n.storagePrefix=Ar,n.init=(0,a.default)((function*(){n.initialized||(n.logger.trace("Initialized"),yield n.restore(),n.cached.forEach((function(e){return n.records.set(e.id,e)})),n.cached=[],n.registerEventListeners(),n.initialized=!0)})),n.set=function(e,t,r){if(n.isInitialized(),n.logger.debug("Setting JSON-RPC request history record"),n.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:r}),!n.records.has(t.id)){var i={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:r};n.records.set(i.id,i),n.events.emit(on,i)}},n.resolve=function(){var e=(0,a.default)((function*(e){if(n.isInitialized(),n.logger.debug("Updating JSON-RPC response history record"),n.logger.trace({type:"method",method:"update",response:e}),n.records.has(e.id)){var t=yield n.getRecord(e.id);typeof t.response>"u"&&(t.response=(0,Je.isJsonRpcError)(e)?{error:e.error}:{result:e.result},n.records.set(t.id,t),n.events.emit(sn,t))}}));return function(t){return e.apply(this,arguments)}}(),n.get=function(){var e=(0,a.default)((function*(e,t){return n.isInitialized(),n.logger.debug("Getting record"),n.logger.trace({type:"method",method:"get",topic:e,id:t}),yield n.getRecord(t)}));return function(t,r){return e.apply(this,arguments)}}(),n.delete=function(e,t){n.isInitialized(),n.logger.debug("Deleting record"),n.logger.trace({type:"method",method:"delete",id:t}),n.values.forEach((function(r){if(r.topic===e){if(typeof t<"u"&&r.id!==t)return;n.records.delete(r.id),n.events.emit(an,r)}}))},n.exists=function(){var e=(0,a.default)((function*(e,t){return n.isInitialized(),!!n.records.has(t)&&(yield n.getRecord(t)).topic===e}));return function(t,r){return e.apply(this,arguments)}}(),n.on=function(e,t){n.events.on(e,t)},n.once=function(e,t){n.events.once(e,t)},n.off=function(e,t){n.events.off(e,t)},n.removeListener=function(e,t){n.events.removeListener(e,t)},n.logger=(0,g.generateChildLogger)(r,n.name),n}var n=r.prototype;return n.setJsonRpcRecords=function(){var e=(0,a.default)((function*(e){yield this.core.storage.setItem(this.storageKey,e)}));return function(t){return e.apply(this,arguments)}}(),n.getJsonRpcRecords=function(){var e=(0,a.default)((function*(){return yield this.core.storage.getItem(this.storageKey)}));return function(){return e.apply(this,arguments)}}(),n.getRecord=function(e){this.isInitialized();var t=this.records.get(e);if(!t){var r=Be("NO_MATCHING_KEY",`${this.name}: ${e}`).message;throw new Error(r)}return t},n.persist=function(){var e=(0,a.default)((function*(){yield this.setJsonRpcRecords(this.values),this.events.emit(un)}));return function(){return e.apply(this,arguments)}}(),n.restore=function(){var e=(0,a.default)((function*(){try{var e=yield this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){var t=Be("RESTORE_WILL_OVERRIDE",this.name).message;throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}));return function(){return e.apply(this,arguments)}}(),n.registerEventListeners=function(){var e=this;this.events.on(on,(function(t){var r=on;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,record:t}),e.persist()})),this.events.on(sn,(function(t){var r=sn;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,record:t}),e.persist()})),this.events.on(an,(function(t){var r=an;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,record:t}),e.persist()}))},n.isInitialized=function(){if(!this.initialized){var e=Be("NOT_INITIALIZED",this.name).message;throw new Error(e)}},(0,u.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+"//"+this.name}},{key:"size",get:function(){return this.records.size}},{key:"keys",get:function(){return Array.from(this.records.keys())}},{key:"values",get:function(){return Array.from(this.records.values())}},{key:"pending",get:function(){var e=[];return this.values.forEach((function(t){if(!(typeof t.response<"u")){var r={topic:t.topic,request:(0,Je.formatJsonRpcRequest)(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)}})),e}}]),r}(b),Wn=function(e){(0,i.default)(r,e);var t=Xe(r);function r(e,r){var n;return(n=t.call(this,e,r)).core=e,n.logger=r,n.expirations=new Map,n.events=new h.EventEmitter,n.name="expirer",n.version="0.3",n.cached=[],n.initialized=!1,n.storagePrefix=Ar,n.init=(0,a.default)((function*(){n.initialized||(n.logger.trace("Initialized"),yield n.restore(),n.cached.forEach((function(e){return n.expirations.set(e.target,e)})),n.cached=[],n.registerEventListeners(),n.initialized=!0)})),n.has=function(e){try{var t=n.formatTarget(e);return typeof n.getExpiration(t)<"u"}catch(r){return!1}},n.set=function(e,t){n.isInitialized();var r=n.formatTarget(e),i={target:r,expiry:t};n.expirations.set(r,i),n.checkExpiry(r,i),n.events.emit(cn,{target:r,expiration:i})},n.get=function(e){n.isInitialized();var t=n.formatTarget(e);return n.getExpiration(t)},n.del=function(e){if(n.isInitialized(),n.has(e)){var t=n.formatTarget(e),r=n.getExpiration(t);n.expirations.delete(t),n.events.emit(ln,{target:t,expiration:r})}},n.on=function(e,t){n.events.on(e,t)},n.once=function(e,t){n.events.once(e,t)},n.off=function(e,t){n.events.off(e,t)},n.removeListener=function(e,t){n.events.removeListener(e,t)},n.logger=(0,g.generateChildLogger)(r,n.name),n}var n=r.prototype;return n.formatTarget=function(e){if("string"==typeof e)return function(e){return Se("topic",e)}(e);if("number"==typeof e)return function(e){return Se("id",e)}(e);var t=Be("UNKNOWN_TYPE","Target type: "+typeof e).message;throw new Error(t)},n.setExpirations=function(){var e=(0,a.default)((function*(e){yield this.core.storage.setItem(this.storageKey,e)}));return function(t){return e.apply(this,arguments)}}(),n.getExpirations=function(){var e=(0,a.default)((function*(){return yield this.core.storage.getItem(this.storageKey)}));return function(){return e.apply(this,arguments)}}(),n.persist=function(){var e=(0,a.default)((function*(){yield this.setExpirations(this.values),this.events.emit(fn)}));return function(){return e.apply(this,arguments)}}(),n.restore=function(){var e=(0,a.default)((function*(){try{var e=yield this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){var t=Be("RESTORE_WILL_OVERRIDE",this.name).message;throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}));return function(){return e.apply(this,arguments)}}(),n.getExpiration=function(e){var t=this.expirations.get(e);if(!t){var r=Be("NO_MATCHING_KEY",`${this.name}: ${e}`).message;throw this.logger.error(r),new Error(r)}return t},n.checkExpiry=function(e,t){var r=t.expiry;(0,L.toMiliseconds)(r)-Date.now()<=0&&this.expire(e,t)},n.expire=function(e,t){this.expirations.delete(e),this.events.emit(hn,{target:e,expiration:t})},n.checkExpirations=function(){var e=this;this.core.relayer.connected&&this.expirations.forEach((function(t,r){return e.checkExpiry(r,t)}))},n.registerEventListeners=function(){var e=this;this.core.heartbeat.on(p.HEARTBEAT_EVENTS.pulse,(function(){return e.checkExpirations()})),this.events.on(cn,(function(t){var r=cn;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,data:t}),e.persist()})),this.events.on(hn,(function(t){var r=hn;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,data:t}),e.persist()})),this.events.on(ln,(function(t){var r=ln;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,data:t}),e.persist()}))},n.isInitialized=function(){if(!this.initialized){var e=Be("NOT_INITIALIZED",this.name).message;throw new Error(e)}},(0,u.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+"//"+this.name}},{key:"length",get:function(){return this.expirations.size}},{key:"keys",get:function(){return Array.from(this.expirations.keys())}},{key:"values",get:function(){return Array.from(this.expirations.values())}}]),r}(R),Hn=function(e){(0,i.default)(r,e);var t=Xe(r);function r(e,r){var n;return(n=t.call(this,e,r)).projectId=e,n.logger=r,n.name=dn,n.initialized=!1,n.init=function(){var e=(0,a.default)((function*(e){ge()||!ye()||(n.verifyUrl=(null==e?void 0:e.verifyUrl)||pn,yield n.createIframe())}));return function(t){return e.apply(this,arguments)}}(),n.register=function(){var e=(0,a.default)((function*(e){var t;n.initialized||(yield n.init()),n.iframe&&(null==(t=n.iframe.contentWindow)||t.postMessage(e.attestationId,n.verifyUrl),n.logger.info(`postMessage sent: ${e.attestationId} ${n.verifyUrl}`))}));return function(t){return e.apply(this,arguments)}}(),n.resolve=function(){var e=(0,a.default)((function*(e){var t;if(n.isDevEnv)return"";n.logger.info(`resolving attestation: ${e.attestationId}`);var r=n.startAbortTimer(L.FIVE_SECONDS),i=yield fetch(`${n.verifyUrl}/attestation/${e.attestationId}`,{signal:n.abortController.signal});return clearTimeout(r),200===i.status?null==(t=yield i.json())?void 0:t.origin:""}));return function(t){return e.apply(this,arguments)}}(),n.createIframe=(0,a.default)((function*(){try{yield Promise.race([new Promise((function(e,t){if(document.getElementById(dn))return e();var r=document.createElement("iframe");r.setAttribute("id",dn),r.setAttribute("src",`${n.verifyUrl}/${n.projectId}`),r.style.display="none",r.addEventListener("load",(function(){n.initialized=!0,e()})),r.addEventListener("error",(function(e){t(e)})),document.body.append(r),n.iframe=r})),new Promise((function(e){setTimeout((function(){return e("iframe load timeout")}),(0,L.toMiliseconds)(L.ONE_SECOND/2))}))])}catch(e){n.logger.error(`Verify iframe failed to load: ${n.verifyUrl}`),n.logger.error(e)}})),n.logger=(0,g.generateChildLogger)(r,n.name),n.verifyUrl=pn,n.abortController=new AbortController,n.isDevEnv=pe()&&{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"web-embed",slug:"web-embed",version:"0.0.1",web:{},description:"Multi-chain support for BTC/ETH/BNB/NEAR/Polygon/Solana/Avalanche/Fantom and others",sdkVersion:"49.0.0",platforms:["ios","android","web"]},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.IS_VITEST,n}return r.prototype.startAbortTimer=function(e){var t=this;return setTimeout((function(){return t.abortController.abort()}),(0,L.toMiliseconds)(e))},(0,u.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}}]),r}(O),Fn=Object.defineProperty,Jn=Object.getOwnPropertySymbols,Gn=Object.prototype.hasOwnProperty,Yn=Object.prototype.propertyIsEnumerable,Zn=function(e,t,r){return t in e?Fn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Xn=function(e,t){for(var r in t||(t={}))Gn.call(t,r)&&Zn(e,r,t[r]);if(Jn)for(var r of Jn(t))Yn.call(t,r)&&Zn(e,r,t[r]);return e},Qn=function(e){(0,i.default)(r,e);var t=Xe(r);function r(e){var r;(r=t.call(this,e)).protocol="wc",r.version=2,r.name=xr,r.events=new h.EventEmitter,r.initialized=!1,r.on=function(e,t){return r.events.on(e,t)},r.once=function(e,t){return r.events.once(e,t)},r.off=function(e,t){return r.events.off(e,t)},r.removeListener=function(e,t){return r.events.removeListener(e,t)},r.projectId=null==e?void 0:e.projectId,r.relayUrl=(null==e?void 0:e.relayUrl)||jr;var i=typeof(null==e?void 0:e.logger)<"u"&&"string"!=typeof(null==e?void 0:e.logger)?e.logger:(0,g.pino)((0,g.getDefaultLoggerOptions)({level:(null==e?void 0:e.logger)||Cr}));return r.logger=(0,g.generateChildLogger)(i,r.name),r.heartbeat=new p.HeartBeat,r.crypto=new yn((0,n.default)(r),r.logger,null==e?void 0:e.keychain),r.history=new Kn((0,n.default)(r),r.logger),r.expirer=new Wn((0,n.default)(r),r.logger),r.storage=null!=e&&e.storage?e.storage:new d.default(Xn(Xn({},kr),null==e?void 0:e.storageOptions)),r.relayer=new Dn({core:(0,n.default)(r),logger:r.logger,relayUrl:r.relayUrl,projectId:r.projectId}),r.pairing=new $n((0,n.default)(r),r.logger),r.verify=new Hn(r.projectId||"",r.logger),r}r.init=function(){var e=(0,a.default)((function*(e){var t=new r(e);return yield t.initialize(),t}));return function(t){return e.apply(this,arguments)}}();var o=r.prototype;return o.start=function(){var e=(0,a.default)((function*(){this.initialized||(yield this.initialize())}));return function(){return e.apply(this,arguments)}}(),o.initialize=function(){var e=(0,a.default)((function*(){this.logger.trace("Initialized");try{yield this.crypto.init(),yield this.history.init(),yield this.expirer.init(),yield this.relayer.init(),yield this.heartbeat.init(),yield this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}));return function(){return e.apply(this,arguments)}}(),(0,u.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}}]),r}(m),ei=Qn,ti=r(3686),ri=r(13390),ni=r(12405),ii=r.n(ni);function oi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.default)(this,r)}}var si=(0,u.default)((function(e){this.client=e})),ai=(0,u.default)((function(e){this.opts=e})),ui="https://rpc.walletconnect.com/v1",ci={wc_authRequest:{req:{ttl:L.ONE_DAY,prompt:!0,tag:3e3},res:{ttl:L.ONE_DAY,prompt:!1,tag:3001}}},li={min:L.FIVE_MINUTES,max:L.SEVEN_DAYS},hi="authClient",fi="wc@1:auth:",di=`${fi}:PUB_KEY`;L.ONE_DAY;function pi(e){return null==e?void 0:e.split(":")}function gi(e){var t=e&&pi(e);if(t)return t.pop()}function yi(){return yi=(0,a.default)((function*(e,t,r,n,i){switch(r.t){case"eip191":return function(e,t,r){return(0,ri.recoverAddress)((0,ti.hashMessage)(t),r).toLowerCase()===e.toLowerCase()}(e,t,r.s);case"eip1271":return yield function(e,t,r,n,i){return vi.apply(this,arguments)}(e,t,r.s,n,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}})),yi.apply(this,arguments)}function vi(){return vi=(0,a.default)((function*(e,t,r,n,i){try{var o="0x1626ba7e",s=r.substring(2),a=o+(0,ti.hashMessage)(t).substring(2)+"00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000041"+s,u=yield ii()(`${ui}/?chainId=${n}&projectId=${i}`,{method:"POST",body:JSON.stringify({id:Date.now()+Math.floor(1e3*Math.random()),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:a},"latest"]})}),c=(yield u.json()).result;return!!c&&c.slice(0,10).toLowerCase()===o.toLowerCase()}catch(o){return console.error("isValidEip1271Signature: ",o),!1}})),vi.apply(this,arguments)}function mi(e){return e.getAll().filter((function(e){return"requester"in e}))}function bi(e,t){return mi(e).find((function(e){return e.id===t}))}function Ei(e){var t=We(e.aud),r=new RegExp(`${e.domain}`).test(e.aud),n=!!e.nonce,i=!e.type||"eip4361"===e.type,o=e.expiry;if(o&&!function(e,t){return Ke(e,!1)&&e<=t.max&&e>=t.min}(o,li)){var s=Be("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${li.min} and ${li.max}`).message;throw new Error(s)}return!!(t&&r&&n&&i)}var _i=Object.defineProperty,wi=Object.defineProperties,Si=Object.getOwnPropertyDescriptors,Ii=Object.getOwnPropertySymbols,Ri=Object.prototype.hasOwnProperty,Oi=Object.prototype.propertyIsEnumerable,Mi=function(e,t,r){return t in e?_i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Ti=function(e,t){for(var r in t||(t={}))Ri.call(t,r)&&Mi(e,r,t[r]);if(Ii)for(var r of Ii(t))Oi.call(t,r)&&Mi(e,r,t[r]);return e},Pi=function(e,t){return wi(e,Si(t))},Ni=function(e){(0,i.default)(r,e);var t=oi(r);function r(e){var r;return(r=t.call(this,e)).initialized=!1,r.name="authEngine",r.init=function(){r.initialized||(r.registerRelayerEvents(),r.client.core.pairing.register({methods:Object.keys(ci)}),r.initialized=!0)},r.request=function(){var e=(0,a.default)((function*(e,t){if(r.isInitialized(),!Ei(e))throw new Error("Invalid request");if(null!=t&&t.topic)return yield r.requestOnKnownPairing(t.topic,e);var n=e.chainId,i=e.statement,o=e.aud,s=e.domain,a=e.nonce,u=e.type,c=yield r.client.core.pairing.create(),l=c.topic,h=c.uri;r.client.logger.info({message:"Generated new pairing",pairing:{topic:l,uri:h}});var f=yield r.client.core.crypto.generateKeyPair(),d=X(f);yield r.client.authKeys.set(di,{responseTopic:d,publicKey:f}),yield r.client.pairingTopics.set(d,{topic:d,pairingTopic:l}),yield r.client.core.relayer.subscribe(d),r.client.logger.info(`sending request to new pairing topic: ${l}`);var p=yield r.sendRequest(l,"wc_authRequest",{payloadParams:{type:null!=u?u:"eip4361",chainId:n,statement:i,aud:o,domain:s,version:"1",nonce:a,iat:(new Date).toISOString()},requester:{publicKey:f,metadata:r.client.metadata}},{},e.expiry);return r.client.logger.info(`sent request to new pairing topic: ${l}`),{uri:h,id:p}}));return function(t,r){return e.apply(this,arguments)}}(),r.respond=function(){var e=(0,a.default)((function*(e,t){if(r.isInitialized(),!function(e,t){return!!bi(t,e.id)}(e,r.client.requests))throw new Error("Invalid response");var n=bi(r.client.requests,e.id),i=n.requester.publicKey,o=yield r.client.core.crypto.generateKeyPair(),s=X(i),a={type:H,receiverPublicKey:i,senderPublicKey:o};if("error"in e)yield r.sendError(n.id,s,e,a);else{var u={h:{t:"eip4361"},p:Pi(Ti({},n.cacaoPayload),{iss:t}),s:e.signature},c=yield r.sendResult(n.id,s,u,a);yield r.client.requests.set(c,Ti({id:c},u))}}));return function(t,r){return e.apply(this,arguments)}}(),r.getPendingRequests=function(){return mi(r.client.requests)},r.formatMessage=function(e,t){r.client.logger.debug(`formatMessage, cacao is: ${JSON.stringify(e)}`);var n=`${e.domain} wants you to sign in with your Ethereum account:`,i=gi(t),o=e.statement,s=`URI: ${e.aud}`,a=`Version: ${e.version}`,u=`Chain ID: ${function(e){var t=e&&pi(e);if(t)return t[3]}(t)}`,c=`Nonce: ${e.nonce}`,l=`Issued At: ${e.iat}`,h=e.resources&&e.resources.length>0?`Resources:\n${e.resources.map((function(e){return`- ${e}`})).join("\n")}`:void 0;return[n,i,"",o,"",s,a,u,c,l,h].filter((function(e){return null!=e})).join("\n")},r.setExpiry=function(){var e=(0,a.default)((function*(e,t){r.client.core.pairing.pairings.keys.includes(e)&&(yield r.client.core.pairing.updateExpiry({topic:e,expiry:t})),r.client.core.expirer.set(e,t)}));return function(t,r){return e.apply(this,arguments)}}(),r.sendRequest=function(){var e=(0,a.default)((function*(e,t,n,i,o){var s=(0,Je.formatJsonRpcRequest)(t,n),a=yield r.client.core.crypto.encode(e,s,i),u=ci[t].req;return o&&(u.ttl=o),r.client.core.history.set(e,s),yield r.client.core.relayer.publish(e,a,u),s.id}));return function(t,r,n,i,o){return e.apply(this,arguments)}}(),r.sendResult=function(){var e=(0,a.default)((function*(e,t,n,i){var o=(0,Je.formatJsonRpcResult)(e,n),s=yield r.client.core.crypto.encode(t,o,i),a=yield r.client.core.history.get(t,e),u=ci[a.request.method].res;return yield r.client.core.relayer.publish(t,s,u),yield r.client.core.history.resolve(o),o.id}));return function(t,r,n,i){return e.apply(this,arguments)}}(),r.sendError=function(){var e=(0,a.default)((function*(e,t,n,i){var o=(0,Je.formatJsonRpcError)(e,n.error),s=yield r.client.core.crypto.encode(t,o,i),a=yield r.client.core.history.get(t,e),u=ci[a.request.method].res;return yield r.client.core.relayer.publish(t,s,u),yield r.client.core.history.resolve(o),o.id}));return function(t,r,n,i){return e.apply(this,arguments)}}(),r.requestOnKnownPairing=function(){var e=(0,a.default)((function*(e,t){var n=r.client.core.pairing.pairings.getAll({active:!0}).find((function(t){return t.topic===e}));if(!n)throw new Error(`Could not find pairing for provided topic ${e}`);var i=r.client.authKeys.get(di).publicKey,o=t.chainId,s=t.statement,a=t.aud,u=t.domain,c=t.nonce,l=t.type,h=yield r.sendRequest(n.topic,"wc_authRequest",{payloadParams:{type:null!=l?l:"eip4361",chainId:o,statement:s,aud:a,domain:u,version:"1",nonce:c,iat:(new Date).toISOString()},requester:{publicKey:i,metadata:r.client.metadata}},{},t.expiry);return r.client.logger.info(`sent request to known pairing topic: ${n.topic}`),{id:h}}));return function(t,r){return e.apply(this,arguments)}}(),r.onRelayEventRequest=function(e){var t=e.topic,n=e.payload,i=n.method;return"wc_authRequest"===i?r.onAuthRequest(t,n):r.client.logger.info(`Unsupported request method ${i}`)},r.onRelayEventResponse=function(){var e=(0,a.default)((function*(e){var t=e.topic,n=e.payload,i=(yield r.client.core.history.get(t,n.id)).request.method;return"wc_authRequest"===i?r.onAuthResponse(t,n):r.client.logger.info(`Unsupported response method ${i}`)}));return function(t){return e.apply(this,arguments)}}(),r.onAuthRequest=function(){var e=(0,a.default)((function*(e,t){var n=t.params,i=n.requester,o=n.payloadParams,s=o.resources,a=o.statement,u=o.aud,c=o.domain,l=o.version,h=o.nonce,f=o.iat,d=o.chainId;r.client.logger.info({type:"onAuthRequest",topic:e,payload:t});try{var p={aud:u,domain:c,version:l,nonce:h,iat:f,statement:a,resources:s,chainId:d};yield r.client.requests.set(t.id,{requester:i,id:t.id,cacaoPayload:p}),r.client.emit("auth_request",{id:t.id,topic:e,params:{requester:i,cacaoPayload:p}})}catch(p){yield r.sendError(t.id,e,p),r.client.logger.error(p)}}));return function(t,r){return e.apply(this,arguments)}}(),r.onAuthResponse=function(){var e=(0,a.default)((function*(e,t){var n=t.id;if(r.client.logger.info({type:"onAuthResponse",topic:e,response:t}),(0,Je.isJsonRpcResult)(t)){var i=r.client.pairingTopics.get(e).pairingTopic;yield r.client.core.pairing.activate({topic:i});var o=t.result,s=o.s,a=o.p;yield r.client.requests.set(n,Ti({id:n},t.result));var u=r.formatMessage(a,a.iss);r.client.logger.debug("reconstructed message:\n",JSON.stringify(u)),r.client.logger.debug("payload.iss:",a.iss),r.client.logger.debug("signature:",s);var c=gi(a.iss),l=function(e){var t=e&&pi(e);if(t)return t[2]+":"+t[3]}(a.iss);if(!c)throw new Error("Could not derive address from `payload.iss`");if(!l)throw new Error("Could not derive chainId from `payload.iss`");r.client.logger.debug("walletAddress extracted from `payload.iss`:",c),(yield function(e,t,r,n,i){return yi.apply(this,arguments)}(c,u,s,l,r.client.projectId))?r.client.emit("auth_response",{id:n,topic:e,params:t}):r.client.emit("auth_response",{id:n,topic:e,params:{message:"Invalid signature",code:-1}})}else(0,Je.isJsonRpcError)(t)&&r.client.emit("auth_response",{id:n,topic:e,params:t})}));return function(t,r){return e.apply(this,arguments)}}(),r}var n=r.prototype;return n.isInitialized=function(){if(!this.initialized){var e=Be("NOT_INITIALIZED",this.name).message;throw new Error(e)}},n.registerRelayerEvents=function(){var e=this;this.client.core.relayer.on(Br,function(){var t=(0,a.default)((function*(t){var r=t.topic,n=t.message,i=e.client.authKeys.keys.includes(di)?e.client.authKeys.get(di):{responseTopic:void 0,publicKey:void 0},o=i.responseTopic,s=i.publicKey;if(o&&r!==o)e.client.logger.debug("[Auth] Ignoring message from unknown topic",r);else{var a=yield e.client.core.crypto.decode(r,n,{receiverPublicKey:s});(0,Je.isJsonRpcRequest)(a)?(e.client.core.history.set(r,a),e.onRelayEventRequest({topic:r,payload:a})):(0,Je.isJsonRpcResponse)(a)&&(yield e.client.core.history.resolve(a),e.onRelayEventResponse({topic:r,payload:a}))}}));return function(e){return t.apply(this,arguments)}}())},(0,u.default)(r)}(si),xi=function(e){(0,i.default)(r,e);var t=oi(r);function r(e){var r;(r=t.call(this,e)).protocol="wc",r.version=1,r.name=hi,r.events=new h.EventEmitter,r.emit=function(e,t){return r.events.emit(e,t)},r.on=function(e,t){return r.events.on(e,t)},r.once=function(e,t){return r.events.once(e,t)},r.off=function(e,t){return r.events.off(e,t)},r.removeListener=function(e,t){return r.events.removeListener(e,t)},r.request=function(){var e=(0,a.default)((function*(e,t){try{return yield r.engine.request(e,t)}catch(m){throw r.logger.error(m.message),m}}));return function(t,r){return e.apply(this,arguments)}}(),r.respond=function(){var e=(0,a.default)((function*(e,t){try{return yield r.engine.respond(e,t)}catch(m){throw r.logger.error(m.message),m}}));return function(t,r){return e.apply(this,arguments)}}(),r.getPendingRequests=function(){try{return r.engine.getPendingRequests()}catch(e){throw r.logger.error(e.message),e}},r.formatMessage=function(e,t){try{return r.engine.formatMessage(e,t)}catch(m){throw r.logger.error(m.message),m}};var i=typeof e.logger<"u"&&"string"!=typeof e.logger?e.logger:(0,g.pino)((0,g.getDefaultLoggerOptions)({level:e.logger||"error"}));return r.name=(null==e?void 0:e.name)||hi,r.metadata=e.metadata,r.projectId=e.projectId,r.core=e.core||new ei(e),r.logger=(0,g.generateChildLogger)(i,r.name),r.authKeys=new zn(r.core,r.logger,"authKeys",fi,(function(){return di})),r.pairingTopics=new zn(r.core,r.logger,"pairingTopics",fi),r.requests=new zn(r.core,r.logger,"requests",fi),r.engine=new Ni((0,n.default)(r)),r}return r.init=function(){var e=(0,a.default)((function*(e){var t=new r(e);return yield t.initialize(),t}));return function(t){return e.apply(this,arguments)}}(),r.prototype.initialize=function(){var e=(0,a.default)((function*(){this.logger.trace("Initialized");try{yield this.core.start(),yield this.authKeys.init(),yield this.requests.init(),yield this.pairingTopics.init(),yield this.engine.init(),this.logger.info("AuthClient Initialization Success"),this.logger.info({authClient:this})}catch(e){throw this.logger.info("AuthClient Initialization Failure"),this.logger.error(e.message),e}}));return function(){return e.apply(this,arguments)}}(),(0,u.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}}]),r}(ai);var Ai=xi,Ci=r(17406),ki=r(17742),Di=r(63554);function Ui(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.default)(this,r)}}var Li,ji="client",Bi=`wc@2:${ji}:`,qi=ji,Vi="error",zi=(L.THIRTY_DAYS,L.SEVEN_DAYS),$i={wc_sessionPropose:{req:{ttl:L.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:L.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:L.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:L.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:L.ONE_DAY,prompt:!1,tag:1104},res:{ttl:L.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:L.ONE_DAY,prompt:!1,tag:1106},res:{ttl:L.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:L.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:L.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:L.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:L.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:L.ONE_DAY,prompt:!1,tag:1112},res:{ttl:L.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:L.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:L.THIRTY_SECONDS,prompt:!1,tag:1115}}},Ki={min:L.FIVE_MINUTES,max:L.SEVEN_DAYS},Wi=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"],Hi=Object.defineProperty,Fi=Object.defineProperties,Ji=Object.getOwnPropertyDescriptors,Gi=Object.getOwnPropertySymbols,Yi=Object.prototype.hasOwnProperty,Zi=Object.prototype.propertyIsEnumerable,Xi=function(e,t,r){return t in e?Hi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Qi=function(e,t){for(var r in t||(t={}))Yi.call(t,r)&&Xi(e,r,t[r]);if(Gi)for(var r of Gi(t))Zi.call(t,r)&&Xi(e,r,t[r]);return e},eo=function(e,t){return Fi(e,Ji(t))},to=function(e){(0,i.default)(r,e);var t=Ui(r);function r(e){var r;return(r=t.call(this,e)).name="engine",r.events=new(f()),r.initialized=!1,r.ignoredPayloadTypes=[Di.TYPE_1],r.init=(0,a.default)((function*(){r.initialized||(yield r.cleanup(),r.registerRelayerEvents(),r.registerExpirerEvents(),r.client.core.pairing.register({methods:Object.keys($i)}),r.initialized=!0)})),r.connect=function(){var e=(0,a.default)((function*(e){r.isInitialized();var t=eo(Qi({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});yield r.isValidConnect(t);var n,i=t.pairingTopic,o=t.requiredNamespaces,s=t.optionalNamespaces,u=t.sessionProperties,c=t.relays,l=i,h=!1;if(l&&(h=r.client.core.pairing.pairings.get(l).active),!l||!h){var f=yield r.client.core.pairing.create(),d=f.topic,p=f.uri;l=d,n=p}var g=yield r.client.core.crypto.generateKeyPair(),y=Qi({requiredNamespaces:o,optionalNamespaces:s,relays:null!=c?c:[{protocol:Ci.RELAYER_DEFAULT_PROTOCOL}],proposer:{publicKey:g,metadata:r.client.metadata}},u&&{sessionProperties:u}),v=(0,Di.createDelayedPromise)(L.FIVE_MINUTES,"Proposal expired"),m=v.reject,b=v.resolve,E=v.done;if(r.events.once((0,Di.engineEvent)("session_connect"),function(){var e=(0,a.default)((function*(e){var t=e.error,n=e.session;if(t)m(t);else if(n){n.self.publicKey=g;var i=eo(Qi({},n),{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces});yield r.client.session.set(n.topic,i),yield r.setExpiry(n.topic,n.expiry),l&&(yield r.client.core.pairing.updateMetadata({topic:l,metadata:n.peer.metadata})),b(i)}}));return function(t){return e.apply(this,arguments)}}()),!l){var _=(0,Di.getInternalError)("NO_MATCHING_KEY",`connect() pairing topic: ${l}`).message;throw new Error(_)}var w=yield r.sendRequest(l,"wc_sessionPropose",y),S=(0,Di.calcExpiry)(L.FIVE_MINUTES);return yield r.setProposal(w,Qi({id:w,expiry:S},y)),{uri:n,approval:E}}));return function(t){return e.apply(this,arguments)}}(),r.pair=function(){var e=(0,a.default)((function*(e){return r.isInitialized(),yield r.client.core.pairing.pair(e)}));return function(t){return e.apply(this,arguments)}}(),r.approve=function(){var e=(0,a.default)((function*(e){r.isInitialized(),yield r.isValidApprove(e);var t=e.id,n=e.relayProtocol,i=e.namespaces,o=e.sessionProperties,s=r.client.proposal.get(t),a=s.pairingTopic,u=s.proposer,c=s.requiredNamespaces,l=s.optionalNamespaces;a=a||"",(0,Di.isValidObject)(c)||(c=(0,Di.getRequiredNamespacesFromNamespaces)(i,"approve()"));var h=yield r.client.core.crypto.generateKeyPair(),f=u.publicKey,d=yield r.client.core.crypto.generateSharedKey(h,f);a&&t&&(yield r.client.core.pairing.updateMetadata({topic:a,metadata:u.metadata}),yield r.sendResult(t,a,{relay:{protocol:null!=n?n:"irn"},responderPublicKey:h}),yield r.client.proposal.delete(t,(0,Di.getSdkError)("USER_DISCONNECTED")),yield r.client.core.pairing.activate({topic:a}));var p=Qi({relay:{protocol:null!=n?n:"irn"},namespaces:i,requiredNamespaces:c,optionalNamespaces:l,pairingTopic:a,controller:{publicKey:h,metadata:r.client.metadata},expiry:(0,Di.calcExpiry)(zi)},o&&{sessionProperties:o});yield r.client.core.relayer.subscribe(d),yield r.sendRequest(d,"wc_sessionSettle",p);var g=eo(Qi({},p),{topic:d,pairingTopic:a,acknowledged:!1,self:p.controller,peer:{publicKey:u.publicKey,metadata:u.metadata},controller:h});return yield r.client.session.set(d,g),yield r.setExpiry(d,(0,Di.calcExpiry)(zi)),{topic:d,acknowledged:function(){return new Promise((function(e){return e(r.client.session.get(d))}))}}}));return function(t){return e.apply(this,arguments)}}(),r.reject=function(){var e=(0,a.default)((function*(e){r.isInitialized(),yield r.isValidReject(e);var t=e.id,n=e.reason,i=r.client.proposal.get(t).pairingTopic;i&&(yield r.sendError(t,i,n),yield r.client.proposal.delete(t,(0,Di.getSdkError)("USER_DISCONNECTED")))}));return function(t){return e.apply(this,arguments)}}(),r.update=function(){var e=(0,a.default)((function*(e){r.isInitialized(),yield r.isValidUpdate(e);var t=e.topic,n=e.namespaces,i=yield r.sendRequest(t,"wc_sessionUpdate",{namespaces:n}),o=(0,Di.createDelayedPromise)(),s=o.done,a=o.resolve,u=o.reject;return r.events.once((0,Di.engineEvent)("session_update",i),(function(e){var t=e.error;t?u(t):a()})),yield r.client.session.update(t,{namespaces:n}),{acknowledged:s}}));return function(t){return e.apply(this,arguments)}}(),r.extend=function(){var e=(0,a.default)((function*(e){r.isInitialized(),yield r.isValidExtend(e);var t=e.topic,n=yield r.sendRequest(t,"wc_sessionExtend",{}),i=(0,Di.createDelayedPromise)(),o=i.done,s=i.resolve,a=i.reject;return r.events.once((0,Di.engineEvent)("session_extend",n),(function(e){var t=e.error;t?a(t):s()})),yield r.setExpiry(t,(0,Di.calcExpiry)(zi)),{acknowledged:o}}));return function(t){return e.apply(this,arguments)}}(),r.request=function(){var e=(0,a.default)((function*(e){r.isInitialized(),yield r.isValidRequest(e);var t=e.chainId,n=e.request,i=e.topic,o=e.expiry,s=yield r.sendRequest(i,"wc_sessionRequest",{request:n,chainId:t},o),a=(0,Di.createDelayedPromise)(o),u=a.done,c=a.resolve,l=a.reject;return r.events.once((0,Di.engineEvent)("session_request",s),(function(e){var t=e.error,r=e.result;t?l(t):c(r)})),r.client.events.emit("session_request_sent",{topic:i,request:n,chainId:t,id:s}),yield u()}));return function(t){return e.apply(this,arguments)}}(),r.respond=function(){var e=(0,a.default)((function*(e){r.isInitialized(),yield r.isValidRespond(e);var t=e.topic,n=e.response,i=n.id;(0,Je.isJsonRpcResult)(n)?yield r.sendResult(i,t,n.result):(0,Je.isJsonRpcError)(n)&&(yield r.sendError(i,t,n.error)),r.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0})}));return function(t){return e.apply(this,arguments)}}(),r.ping=function(){var e=(0,a.default)((function*(e){r.isInitialized(),yield r.isValidPing(e);var t=e.topic;if(r.client.session.keys.includes(t)){var n=yield r.sendRequest(t,"wc_sessionPing",{}),i=(0,Di.createDelayedPromise)(),o=i.done,s=i.resolve,a=i.reject;r.events.once((0,Di.engineEvent)("session_ping",n),(function(e){var t=e.error;t?a(t):s()})),yield o()}else r.client.core.pairing.pairings.keys.includes(t)&&(yield r.client.core.pairing.ping({topic:t}))}));return function(t){return e.apply(this,arguments)}}(),r.emit=function(){var e=(0,a.default)((function*(e){r.isInitialized(),yield r.isValidEmit(e);var t=e.topic,n=e.event,i=e.chainId;yield r.sendRequest(t,"wc_sessionEvent",{event:n,chainId:i})}));return function(t){return e.apply(this,arguments)}}(),r.disconnect=function(){var e=(0,a.default)((function*(e){r.isInitialized(),yield r.isValidDisconnect(e);var t=e.topic;r.client.session.keys.includes(t)?(yield r.sendRequest(t,"wc_sessionDelete",(0,Di.getSdkError)("USER_DISCONNECTED")),yield r.deleteSession(t)):yield r.client.core.pairing.disconnect({topic:t})}));return function(t){return e.apply(this,arguments)}}(),r.find=function(e){return r.isInitialized(),r.client.session.getAll().filter((function(t){return(0,Di.isSessionCompatible)(t,e)}))},r.getPendingSessionRequests=function(){return r.isInitialized(),r.client.pendingRequest.getAll()},r.deleteSession=function(){var e=(0,a.default)((function*(e,t){var n=r.client.session.get(e).self;yield r.client.core.relayer.unsubscribe(e),yield Promise.all([r.client.session.delete(e,(0,Di.getSdkError)("USER_DISCONNECTED")),r.client.core.crypto.deleteKeyPair(n.publicKey),r.client.core.crypto.deleteSymKey(e),t?Promise.resolve():r.client.core.expirer.del(e)])}));return function(t,r){return e.apply(this,arguments)}}(),r.deleteProposal=function(){var e=(0,a.default)((function*(e,t){yield Promise.all([r.client.proposal.delete(e,(0,Di.getSdkError)("USER_DISCONNECTED")),t?Promise.resolve():r.client.core.expirer.del(e)])}));return function(t,r){return e.apply(this,arguments)}}(),r.deletePendingSessionRequest=function(){var e=(0,a.default)((function*(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];yield Promise.all([r.client.pendingRequest.delete(e,t),n?Promise.resolve():r.client.core.expirer.del(e)])}));return function(t,r){return e.apply(this,arguments)}}(),r.setExpiry=function(){var e=(0,a.default)((function*(e,t){r.client.session.keys.includes(e)&&(yield r.client.session.update(e,{expiry:t})),r.client.core.expirer.set(e,t)}));return function(t,r){return e.apply(this,arguments)}}(),r.setProposal=function(){var e=(0,a.default)((function*(e,t){yield r.client.proposal.set(e,t),r.client.core.expirer.set(e,t.expiry)}));return function(t,r){return e.apply(this,arguments)}}(),r.setPendingSessionRequest=function(){var e=(0,a.default)((function*(e){var t=$i.wc_sessionRequest.req.ttl,n=e.id,i=e.topic,o=e.params;yield r.client.pendingRequest.set(n,{id:n,topic:i,params:o}),t&&r.client.core.expirer.set(n,(0,Di.calcExpiry)(t))}));return function(t){return e.apply(this,arguments)}}(),r.sendRequest=function(){var e=(0,a.default)((function*(e,t,n,i){var o=(0,Je.formatJsonRpcRequest)(t,n);if((0,Di.isBrowser)()&&Wi.includes(t)){var s=(0,Di.hashMessage)(JSON.stringify(o));yield r.client.core.verify.register({attestationId:s})}var a=yield r.client.core.crypto.encode(e,o),u=$i[t].req;return i&&(u.ttl=i),r.client.core.history.set(e,o),r.client.core.relayer.publish(e,a,u),o.id}));return function(t,r,n,i){return e.apply(this,arguments)}}(),r.sendResult=function(){var e=(0,a.default)((function*(e,t,n){var i=(0,Je.formatJsonRpcResult)(e,n),o=yield r.client.core.crypto.encode(t,i),s=yield r.client.core.history.get(t,e),a=$i[s.request.method].res;r.client.core.relayer.publish(t,o,a),yield r.client.core.history.resolve(i)}));return function(t,r,n){return e.apply(this,arguments)}}(),r.sendError=function(){var e=(0,a.default)((function*(e,t,n){var i=(0,Je.formatJsonRpcError)(e,n),o=yield r.client.core.crypto.encode(t,i),s=yield r.client.core.history.get(t,e),a=$i[s.request.method].res;r.client.core.relayer.publish(t,o,a),yield r.client.core.history.resolve(i)}));return function(t,r,n){return e.apply(this,arguments)}}(),r.cleanup=(0,a.default)((function*(){var e=[],t=[];r.client.session.getAll().forEach((function(t){(0,Di.isExpired)(t.expiry)&&e.push(t.topic)})),r.client.proposal.getAll().forEach((function(e){(0,Di.isExpired)(e.expiry)&&t.push(e.id)})),yield Promise.all([].concat((0,c.default)(e.map((function(e){return r.deleteSession(e)}))),(0,c.default)(t.map((function(e){return r.deleteProposal(e)})))))})),r.onRelayEventRequest=function(e){var t=e.topic,n=e.payload,i=n.method;switch(i){case"wc_sessionPropose":return r.onSessionProposeRequest(t,n);case"wc_sessionSettle":return r.onSessionSettleRequest(t,n);case"wc_sessionUpdate":return r.onSessionUpdateRequest(t,n);case"wc_sessionExtend":return r.onSessionExtendRequest(t,n);case"wc_sessionPing":return r.onSessionPingRequest(t,n);case"wc_sessionDelete":return r.onSessionDeleteRequest(t,n);case"wc_sessionRequest":return r.onSessionRequest(t,n);case"wc_sessionEvent":return r.onSessionEventRequest(t,n);default:return r.client.logger.info(`Unsupported request method ${i}`)}},r.onRelayEventResponse=function(){var e=(0,a.default)((function*(e){var t=e.topic,n=e.payload,i=(yield r.client.core.history.get(t,n.id)).request.method;switch(i){case"wc_sessionPropose":return r.onSessionProposeResponse(t,n);case"wc_sessionSettle":return r.onSessionSettleResponse(t,n);case"wc_sessionUpdate":return r.onSessionUpdateResponse(t,n);case"wc_sessionExtend":return r.onSessionExtendResponse(t,n);case"wc_sessionPing":return r.onSessionPingResponse(t,n);case"wc_sessionRequest":return r.onSessionRequestResponse(t,n);default:return r.client.logger.info(`Unsupported response method ${i}`)}}));return function(t){return e.apply(this,arguments)}}(),r.onSessionProposeRequest=function(){var e=(0,a.default)((function*(e,t){var n=t.params,i=t.id;try{r.isValidConnect(Qi({},t.params));var o=(0,Di.calcExpiry)(L.FIVE_MINUTES),s=Qi({id:i,pairingTopic:e,expiry:o},n);yield r.setProposal(i,s);var a=(0,Di.hashMessage)(JSON.stringify(t)),u=yield r.getVerifyContext(a,s.proposer.metadata);r.client.events.emit("session_proposal",{id:i,params:s,context:u})}catch(o){yield r.sendError(i,e,o),r.client.logger.error(o)}}));return function(t,r){return e.apply(this,arguments)}}(),r.onSessionProposeResponse=function(){var e=(0,a.default)((function*(e,t){var n=t.id;if((0,Je.isJsonRpcResult)(t)){var i=t.result;r.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:i});var o=r.client.proposal.get(n);r.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:o});var s=o.proposer.publicKey;r.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:s});var a=i.responderPublicKey;r.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:a});var u=yield r.client.core.crypto.generateSharedKey(s,a);r.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:u});var c=yield r.client.core.relayer.subscribe(u);r.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:c}),yield r.client.core.pairing.activate({topic:e})}else(0,Je.isJsonRpcError)(t)&&(yield r.client.proposal.delete(n,(0,Di.getSdkError)("USER_DISCONNECTED")),r.events.emit((0,Di.engineEvent)("session_connect"),{error:t.error}))}));return function(t,r){return e.apply(this,arguments)}}(),r.onSessionSettleRequest=function(){var e=(0,a.default)((function*(e,t){var n=t.id,i=t.params;try{r.isValidSessionSettleRequest(i);var o=t.params,s=o.relay,a=o.controller,u=o.expiry,c=o.namespaces,l=o.requiredNamespaces,h=o.optionalNamespaces,f=o.sessionProperties,d=o.pairingTopic,p=Qi({topic:e,relay:s,expiry:u,namespaces:c,acknowledged:!0,pairingTopic:d,requiredNamespaces:l,optionalNamespaces:h,controller:a.publicKey,self:{publicKey:"",metadata:r.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},f&&{sessionProperties:f});yield r.sendResult(t.id,e,!0),r.events.emit((0,Di.engineEvent)("session_connect"),{session:p})}catch(s){yield r.sendError(n,e,s),r.client.logger.error(s)}}));return function(t,r){return e.apply(this,arguments)}}(),r.onSessionSettleResponse=function(){var e=(0,a.default)((function*(e,t){var n=t.id;(0,Je.isJsonRpcResult)(t)?(yield r.client.session.update(e,{acknowledged:!0}),r.events.emit((0,Di.engineEvent)("session_approve",n),{})):(0,Je.isJsonRpcError)(t)&&(yield r.client.session.delete(e,(0,Di.getSdkError)("USER_DISCONNECTED")),r.events.emit((0,Di.engineEvent)("session_approve",n),{error:t.error}))}));return function(t,r){return e.apply(this,arguments)}}(),r.onSessionUpdateRequest=function(){var e=(0,a.default)((function*(e,t){var n=t.params,i=t.id;try{r.isValidUpdate(Qi({topic:e},n)),yield r.client.session.update(e,{namespaces:n.namespaces}),yield r.sendResult(i,e,!0),r.client.events.emit("session_update",{id:i,topic:e,params:n})}catch(m){yield r.sendError(i,e,m),r.client.logger.error(m)}}));return function(t,r){return e.apply(this,arguments)}}(),r.onSessionUpdateResponse=function(e,t){var n=t.id;(0,Je.isJsonRpcResult)(t)?r.events.emit((0,Di.engineEvent)("session_update",n),{}):(0,Je.isJsonRpcError)(t)&&r.events.emit((0,Di.engineEvent)("session_update",n),{error:t.error})},r.onSessionExtendRequest=function(){var e=(0,a.default)((function*(e,t){var n=t.id;try{r.isValidExtend({topic:e}),yield r.setExpiry(e,(0,Di.calcExpiry)(zi)),yield r.sendResult(n,e,!0),r.client.events.emit("session_extend",{id:n,topic:e})}catch(i){yield r.sendError(n,e,i),r.client.logger.error(i)}}));return function(t,r){return e.apply(this,arguments)}}(),r.onSessionExtendResponse=function(e,t){var n=t.id;(0,Je.isJsonRpcResult)(t)?r.events.emit((0,Di.engineEvent)("session_extend",n),{}):(0,Je.isJsonRpcError)(t)&&r.events.emit((0,Di.engineEvent)("session_extend",n),{error:t.error})},r.onSessionPingRequest=function(){var e=(0,a.default)((function*(e,t){var n=t.id;try{r.isValidPing({topic:e}),yield r.sendResult(n,e,!0),r.client.events.emit("session_ping",{id:n,topic:e})}catch(i){yield r.sendError(n,e,i),r.client.logger.error(i)}}));return function(t,r){return e.apply(this,arguments)}}(),r.onSessionPingResponse=function(e,t){var n=t.id;setTimeout((function(){(0,Je.isJsonRpcResult)(t)?r.events.emit((0,Di.engineEvent)("session_ping",n),{}):(0,Je.isJsonRpcError)(t)&&r.events.emit((0,Di.engineEvent)("session_ping",n),{error:t.error})}),500)},r.onSessionDeleteRequest=function(){var e=(0,a.default)((function*(e,t){var n=t.id;try{r.isValidDisconnect({topic:e,reason:t.params}),yield Promise.all([new Promise((function(t){r.client.core.relayer.once(Ci.RELAYER_EVENTS.publish,(0,a.default)((function*(){t(yield r.deleteSession(e))})))})),r.sendResult(n,e,!0)]),r.client.events.emit("session_delete",{id:n,topic:e})}catch(i){yield r.sendError(n,e,i),r.client.logger.error(i)}}));return function(t,r){return e.apply(this,arguments)}}(),r.onSessionRequest=function(){var e=(0,a.default)((function*(e,t){var n=t.id,i=t.params;try{r.isValidRequest(Qi({topic:e},i)),yield r.setPendingSessionRequest({id:n,topic:e,params:i});var o=(0,Di.hashMessage)(JSON.stringify(t)),s=r.client.session.get(e),a=yield r.getVerifyContext(o,s.peer.metadata);r.client.events.emit("session_request",{id:n,topic:e,params:i,context:a})}catch(o){yield r.sendError(n,e,o),r.client.logger.error(o)}}));return function(t,r){return e.apply(this,arguments)}}(),r.onSessionRequestResponse=function(e,t){var n=t.id;(0,Je.isJsonRpcResult)(t)?r.events.emit((0,Di.engineEvent)("session_request",n),{result:t.result}):(0,Je.isJsonRpcError)(t)&&r.events.emit((0,Di.engineEvent)("session_request",n),{error:t.error})},r.onSessionEventRequest=function(){var e=(0,a.default)((function*(e,t){var n=t.id,i=t.params;try{r.isValidEmit(Qi({topic:e},i)),r.client.events.emit("session_event",{id:n,topic:e,params:i})}catch(m){yield r.sendError(n,e,m),r.client.logger.error(m)}}));return function(t,r){return e.apply(this,arguments)}}(),r.isValidConnect=function(){var e=(0,a.default)((function*(e){if(!(0,Di.isValidParams)(e)){var t=(0,Di.getInternalError)("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`).message;throw new Error(t)}var n=e.pairingTopic,i=e.requiredNamespaces,o=e.optionalNamespaces,s=e.sessionProperties,a=e.relays;if((0,Di.isUndefined)(n)||(yield r.isValidPairingTopic(n)),!(0,Di.isValidRelays)(a,!0)){var u=(0,Di.getInternalError)("MISSING_OR_INVALID",`connect() relays: ${a}`).message;throw new Error(u)}!(0,Di.isUndefined)(i)&&0!==(0,Di.isValidObject)(i)&&r.validateNamespaces(i,"requiredNamespaces"),!(0,Di.isUndefined)(o)&&0!==(0,Di.isValidObject)(o)&&r.validateNamespaces(o,"optionalNamespaces"),(0,Di.isUndefined)(s)||r.validateSessionProps(s,"sessionProperties")}));return function(t){return e.apply(this,arguments)}}(),r.validateNamespaces=function(e,t){var r=(0,Di.isValidRequiredNamespaces)(e,"connect()",t);if(r)throw new Error(r.message)},r.isValidApprove=function(){var e=(0,a.default)((function*(e){if(!(0,Di.isValidParams)(e))throw new Error((0,Di.getInternalError)("MISSING_OR_INVALID",`approve() params: ${e}`).message);var t=e.id,n=e.namespaces,i=e.relayProtocol,o=e.sessionProperties;yield r.isValidProposalId(t);var s=r.client.proposal.get(t),a=(0,Di.isValidNamespaces)(n,"approve()");if(a)throw new Error(a.message);var u=(0,Di.isConformingNamespaces)(s.requiredNamespaces,n,"approve()");if(u)throw new Error(u.message);if(!(0,Di.isValidString)(i,!0)){var c=(0,Di.getInternalError)("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`).message;throw new Error(c)}(0,Di.isUndefined)(o)||r.validateSessionProps(o,"sessionProperties")}));return function(t){return e.apply(this,arguments)}}(),r.isValidReject=function(){var e=(0,a.default)((function*(e){if(!(0,Di.isValidParams)(e)){var t=(0,Di.getInternalError)("MISSING_OR_INVALID",`reject() params: ${e}`).message;throw new Error(t)}var n=e.id,i=e.reason;if(yield r.isValidProposalId(n),!(0,Di.isValidErrorReason)(i)){var o=(0,Di.getInternalError)("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`).message;throw new Error(o)}}));return function(t){return e.apply(this,arguments)}}(),r.isValidSessionSettleRequest=function(e){if(!(0,Di.isValidParams)(e)){var t=(0,Di.getInternalError)("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`).message;throw new Error(t)}var r=e.relay,n=e.controller,i=e.namespaces,o=e.expiry;if(!(0,Di.isValidRelay)(r)){var s=(0,Di.getInternalError)("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string").message;throw new Error(s)}var a=(0,Di.isValidController)(n,"onSessionSettleRequest()");if(a)throw new Error(a.message);var u=(0,Di.isValidNamespaces)(i,"onSessionSettleRequest()");if(u)throw new Error(u.message);if((0,Di.isExpired)(o)){var c=(0,Di.getInternalError)("EXPIRED","onSessionSettleRequest()").message;throw new Error(c)}},r.isValidUpdate=function(){var e=(0,a.default)((function*(e){if(!(0,Di.isValidParams)(e)){var t=(0,Di.getInternalError)("MISSING_OR_INVALID",`update() params: ${e}`).message;throw new Error(t)}var n=e.topic,i=e.namespaces;yield r.isValidSessionTopic(n);var o=r.client.session.get(n),s=(0,Di.isValidNamespaces)(i,"update()");if(s)throw new Error(s.message);var a=(0,Di.isConformingNamespaces)(o.requiredNamespaces,i,"update()");if(a)throw new Error(a.message)}));return function(t){return e.apply(this,arguments)}}(),r.isValidExtend=function(){var e=(0,a.default)((function*(e){if(!(0,Di.isValidParams)(e)){var t=(0,Di.getInternalError)("MISSING_OR_INVALID",`extend() params: ${e}`).message;throw new Error(t)}var n=e.topic;yield r.isValidSessionTopic(n)}));return function(t){return e.apply(this,arguments)}}(),r.isValidRequest=function(){var e=(0,a.default)((function*(e){if(!(0,Di.isValidParams)(e)){var t=(0,Di.getInternalError)("MISSING_OR_INVALID",`request() params: ${e}`).message;throw new Error(t)}var n=e.topic,i=e.request,o=e.chainId,s=e.expiry;yield r.isValidSessionTopic(n);var a=r.client.session.get(n).namespaces;if(!(0,Di.isValidNamespacesChainId)(a,o)){var u=(0,Di.getInternalError)("MISSING_OR_INVALID",`request() chainId: ${o}`).message;throw new Error(u)}if(!(0,Di.isValidRequest)(i)){var c=(0,Di.getInternalError)("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`).message;throw new Error(c)}if(!(0,Di.isValidNamespacesRequest)(a,o,i.method)){var l=(0,Di.getInternalError)("MISSING_OR_INVALID",`request() method: ${i.method}`).message;throw new Error(l)}if(s&&!(0,Di.isValidRequestExpiry)(s,Ki)){var h=(0,Di.getInternalError)("MISSING_OR_INVALID",`request() expiry: ${s}. Expiry must be a number (in seconds) between ${Ki.min} and ${Ki.max}`).message;throw new Error(h)}}));return function(t){return e.apply(this,arguments)}}(),r.isValidRespond=function(){var e=(0,a.default)((function*(e){if(!(0,Di.isValidParams)(e)){var t=(0,Di.getInternalError)("MISSING_OR_INVALID",`respond() params: ${e}`).message;throw new Error(t)}var n=e.topic,i=e.response;if(yield r.isValidSessionTopic(n),!(0,Di.isValidResponse)(i)){var o=(0,Di.getInternalError)("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`).message;throw new Error(o)}}));return function(t){return e.apply(this,arguments)}}(),r.isValidPing=function(){var e=(0,a.default)((function*(e){if(!(0,Di.isValidParams)(e)){var t=(0,Di.getInternalError)("MISSING_OR_INVALID",`ping() params: ${e}`).message;throw new Error(t)}var n=e.topic;yield r.isValidSessionOrPairingTopic(n)}));return function(t){return e.apply(this,arguments)}}(),r.isValidEmit=function(){var e=(0,a.default)((function*(e){if(!(0,Di.isValidParams)(e)){var t=(0,Di.getInternalError)("MISSING_OR_INVALID",`emit() params: ${e}`).message;throw new Error(t)}var n=e.topic,i=e.event,o=e.chainId;yield r.isValidSessionTopic(n);var s=r.client.session.get(n).namespaces;if(!(0,Di.isValidNamespacesChainId)(s,o)){var a=(0,Di.getInternalError)("MISSING_OR_INVALID",`emit() chainId: ${o}`).message;throw new Error(a)}if(!(0,Di.isValidEvent)(i)){var u=(0,Di.getInternalError)("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`).message;throw new Error(u)}if(!(0,Di.isValidNamespacesEvent)(s,o,i.name)){var c=(0,Di.getInternalError)("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`).message;throw new Error(c)}}));return function(t){return e.apply(this,arguments)}}(),r.isValidDisconnect=function(){var e=(0,a.default)((function*(e){if(!(0,Di.isValidParams)(e)){var t=(0,Di.getInternalError)("MISSING_OR_INVALID",`disconnect() params: ${e}`).message;throw new Error(t)}var n=e.topic;yield r.isValidSessionOrPairingTopic(n)}));return function(t){return e.apply(this,arguments)}}(),r.getVerifyContext=function(){var e=(0,a.default)((function*(e,t){var n={verified:{verifyUrl:t.verifyUrl||"",validation:"UNKNOWN",origin:t.url||""}};try{var i=yield r.client.core.verify.resolve({attestationId:e,verifyUrl:t.verifyUrl});i&&(n.verified.origin=i,n.verified.validation=i===t.url?"VALID":"INVALID")}catch(i){r.client.logger.error(i)}return r.client.logger.info(`Verify context: ${JSON.stringify(n)}`),n}));return function(t,r){return e.apply(this,arguments)}}(),r.validateSessionProps=function(e,t){Object.values(e).forEach((function(e){if(!(0,Di.isValidString)(e,!1)){var r=(0,Di.getInternalError)("MISSING_OR_INVALID",`${t} must be in Record<string, string> format. Received: ${JSON.stringify(e)}`).message;throw new Error(r)}}))},r}var n=r.prototype;return n.isInitialized=function(){if(!this.initialized){var e=(0,Di.getInternalError)("NOT_INITIALIZED",this.name).message;throw new Error(e)}},n.registerRelayerEvents=function(){var e=this;this.client.core.relayer.on(Ci.RELAYER_EVENTS.message,function(){var t=(0,a.default)((function*(t){var r=t.topic,n=t.message;if(!e.ignoredPayloadTypes.includes(e.client.core.crypto.getPayloadType(n))){var i=yield e.client.core.crypto.decode(r,n);(0,Je.isJsonRpcRequest)(i)?(e.client.core.history.set(r,i),e.onRelayEventRequest({topic:r,payload:i})):(0,Je.isJsonRpcResponse)(i)&&(yield e.client.core.history.resolve(i),e.onRelayEventResponse({topic:r,payload:i}))}}));return function(e){return t.apply(this,arguments)}}())},n.registerExpirerEvents=function(){var e=this;this.client.core.expirer.on(Ci.EXPIRER_EVENTS.expired,function(){var t=(0,a.default)((function*(t){var r=(0,Di.parseExpirerTarget)(t.target),n=r.topic,i=r.id;if(i&&e.client.pendingRequest.keys.includes(i))return yield e.deletePendingSessionRequest(i,(0,Di.getInternalError)("EXPIRED"),!0);n?e.client.session.keys.includes(n)&&(yield e.deleteSession(n,!0),e.client.events.emit("session_expire",{topic:n})):i&&(yield e.deleteProposal(i,!0),e.client.events.emit("proposal_expire",{id:i}))}));return function(e){return t.apply(this,arguments)}}())},n.isValidPairingTopic=function(e){if(!(0,Di.isValidString)(e,!1)){var t=(0,Di.getInternalError)("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`).message;throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){var r=(0,Di.getInternalError)("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`).message;throw new Error(r)}if((0,Di.isExpired)(this.client.core.pairing.pairings.get(e).expiry)){var n=(0,Di.getInternalError)("EXPIRED",`pairing topic: ${e}`).message;throw new Error(n)}},n.isValidSessionTopic=function(){var e=(0,a.default)((function*(e){if(!(0,Di.isValidString)(e,!1)){var t=(0,Di.getInternalError)("MISSING_OR_INVALID",`session topic should be a string: ${e}`).message;throw new Error(t)}if(!this.client.session.keys.includes(e)){var r=(0,Di.getInternalError)("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`).message;throw new Error(r)}if((0,Di.isExpired)(this.client.session.get(e).expiry)){yield this.deleteSession(e);var n=(0,Di.getInternalError)("EXPIRED",`session topic: ${e}`).message;throw new Error(n)}}));return function(t){return e.apply(this,arguments)}}(),n.isValidSessionOrPairingTopic=function(){var e=(0,a.default)((function*(e){if(this.client.session.keys.includes(e))yield this.isValidSessionTopic(e);else{if(!this.client.core.pairing.pairings.keys.includes(e)){if((0,Di.isValidString)(e,!1)){var t=(0,Di.getInternalError)("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`).message;throw new Error(t)}var r=(0,Di.getInternalError)("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`).message;throw new Error(r)}this.isValidPairingTopic(e)}}));return function(t){return e.apply(this,arguments)}}(),n.isValidProposalId=function(){var e=(0,a.default)((function*(e){if(!(0,Di.isValidId)(e)){var t=(0,Di.getInternalError)("MISSING_OR_INVALID",`proposal id should be a number: ${e}`).message;throw new Error(t)}if(!this.client.proposal.keys.includes(e)){var r=(0,Di.getInternalError)("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`).message;throw new Error(r)}if((0,Di.isExpired)(this.client.proposal.get(e).expiry)){yield this.deleteProposal(e);var n=(0,Di.getInternalError)("EXPIRED",`proposal id: ${e}`).message;throw new Error(n)}}));return function(t){return e.apply(this,arguments)}}(),(0,u.default)(r)}(ki.IEngine),ro=function(e){(0,i.default)(r,e);var t=Ui(r);function r(e,r){var n;return(n=t.call(this,e,r,"proposal",Bi)).core=e,n.logger=r,n}return(0,u.default)(r)}(Ci.Store),no=function(e){(0,i.default)(r,e);var t=Ui(r);function r(e,r){var n;return(n=t.call(this,e,r,"session",Bi)).core=e,n.logger=r,n}return(0,u.default)(r)}(Ci.Store),io=function(e){(0,i.default)(r,e);var t=Ui(r);function r(e,r){var n;return(n=t.call(this,e,r,"request",Bi,(function(e){return e.id}))).core=e,n.logger=r,n}return(0,u.default)(r)}(Ci.Store),oo=function(e){(0,i.default)(r,e);var t=Ui(r);function r(e){var r;(r=t.call(this,e)).protocol="wc",r.version=2,r.name=qi,r.events=new h.EventEmitter,r.on=function(e,t){return r.events.on(e,t)},r.once=function(e,t){return r.events.once(e,t)},r.off=function(e,t){return r.events.off(e,t)},r.removeListener=function(e,t){return r.events.removeListener(e,t)},r.removeAllListeners=function(e){return r.events.removeAllListeners(e)},r.connect=function(){var e=(0,a.default)((function*(e){try{return yield r.engine.connect(e)}catch(t){throw r.logger.error(t.message),t}}));return function(t){return e.apply(this,arguments)}}(),r.pair=function(){var e=(0,a.default)((function*(e){try{return yield r.engine.pair(e)}catch(t){throw r.logger.error(t.message),t}}));return function(t){return e.apply(this,arguments)}}(),r.approve=function(){var e=(0,a.default)((function*(e){try{return yield r.engine.approve(e)}catch(t){throw r.logger.error(t.message),t}}));return function(t){return e.apply(this,arguments)}}(),r.reject=function(){var e=(0,a.default)((function*(e){try{return yield r.engine.reject(e)}catch(t){throw r.logger.error(t.message),t}}));return function(t){return e.apply(this,arguments)}}(),r.update=function(){var e=(0,a.default)((function*(e){try{return yield r.engine.update(e)}catch(t){throw r.logger.error(t.message),t}}));return function(t){return e.apply(this,arguments)}}(),r.extend=function(){var e=(0,a.default)((function*(e){try{return yield r.engine.extend(e)}catch(t){throw r.logger.error(t.message),t}}));return function(t){return e.apply(this,arguments)}}(),r.request=function(){var e=(0,a.default)((function*(e){try{return yield r.engine.request(e)}catch(t){throw r.logger.error(t.message),t}}));return function(t){return e.apply(this,arguments)}}(),r.respond=function(){var e=(0,a.default)((function*(e){try{return yield r.engine.respond(e)}catch(t){throw r.logger.error(t.message),t}}));return function(t){return e.apply(this,arguments)}}(),r.ping=function(){var e=(0,a.default)((function*(e){try{return yield r.engine.ping(e)}catch(t){throw r.logger.error(t.message),t}}));return function(t){return e.apply(this,arguments)}}(),r.emit=function(){var e=(0,a.default)((function*(e){try{return yield r.engine.emit(e)}catch(t){throw r.logger.error(t.message),t}}));return function(t){return e.apply(this,arguments)}}(),r.disconnect=function(){var e=(0,a.default)((function*(e){try{return yield r.engine.disconnect(e)}catch(t){throw r.logger.error(t.message),t}}));return function(t){return e.apply(this,arguments)}}(),r.find=function(e){try{return r.engine.find(e)}catch(t){throw r.logger.error(t.message),t}},r.getPendingSessionRequests=function(){try{return r.engine.getPendingSessionRequests()}catch(e){throw r.logger.error(e.message),e}},r.name=(null==e?void 0:e.name)||qi,r.metadata=(null==e?void 0:e.metadata)||(0,Di.getAppMetadata)();var i=typeof(null==e?void 0:e.logger)<"u"&&"string"!=typeof(null==e?void 0:e.logger)?e.logger:(0,g.pino)((0,g.getDefaultLoggerOptions)({level:(null==e?void 0:e.logger)||Vi}));return r.core=(null==e?void 0:e.core)||new Ci.Core(e),r.logger=(0,g.generateChildLogger)(i,r.name),r.session=new no(r.core,r.logger),r.proposal=new ro(r.core,r.logger),r.pendingRequest=new io(r.core,r.logger),r.engine=new to((0,n.default)(r)),r}return r.init=function(){var e=(0,a.default)((function*(e){var t=new r(e);return yield t.initialize(),t}));return function(t){return e.apply(this,arguments)}}(),r.prototype.initialize=function(){var e=(0,a.default)((function*(){this.logger.trace("Initialized");try{yield this.core.start(),yield this.session.init(),yield this.proposal.init(),yield this.pendingRequest.init(),yield this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}));return function(){return e.apply(this,arguments)}}(),(0,u.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"pairing",get:function(){return this.core.pairing.pairings}}]),r}(ki.ISignClient),so=oo,ao={exports:{}},uo="object"==typeof Reflect?Reflect:null,co=uo&&"function"==typeof uo.apply?uo.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};Li=uo&&"function"==typeof uo.ownKeys?uo.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var lo=Number.isNaN||function(e){return e!==e};function ho(){ho.init.call(this)}ao.exports=ho,ao.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}wo(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&wo(e,"error",t,r)}(e,i,{once:!0})}))},ho.EventEmitter=ho,ho.prototype._events=void 0,ho.prototype._eventsCount=0,ho.prototype._maxListeners=void 0;var fo=10;function po(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function go(e){return void 0===e._maxListeners?ho.defaultMaxListeners:e._maxListeners}function yo(e,t,r,n){var i,o,s;if(po(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=go(e))>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,function(e){console&&console.warn&&console.warn(e)}(a)}return e}function vo(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function mo(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=vo.bind(n);return i.listener=r,n.wrapFn=i,i}function bo(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):_o(i,i.length)}function Eo(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function _o(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function wo(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(ho,"defaultMaxListeners",{enumerable:!0,get:function(){return fo},set:function(e){if("number"!=typeof e||e<0||lo(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");fo=e}}),ho.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ho.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||lo(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},ho.prototype.getMaxListeners=function(){return go(this)},ho.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[e];if(void 0===a)return!1;if("function"==typeof a)co(a,this,t);else{var u=a.length,c=_o(a,u);for(r=0;r<u;++r)co(c[r],this,t)}return!0},ho.prototype.addListener=function(e,t){return yo(this,e,t,!1)},ho.prototype.on=ho.prototype.addListener,ho.prototype.prependListener=function(e,t){return yo(this,e,t,!0)},ho.prototype.once=function(e,t){return po(t),this.on(e,mo(this,e,t)),this},ho.prototype.prependOnceListener=function(e,t){return po(t),this.prependListener(e,mo(this,e,t)),this},ho.prototype.removeListener=function(e,t){var r,n,i,o,s;if(po(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},ho.prototype.off=ho.prototype.removeListener,ho.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},ho.prototype.listeners=function(e){return bo(this,e,!0)},ho.prototype.rawListeners=function(e){return bo(this,e,!1)},ho.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):Eo.call(e,t)},ho.prototype.listenerCount=Eo,ho.prototype.eventNames=function(){return this._eventsCount>0?Li(this._events):[]};const So="wc",Io=2,Ro="Web3Wallet",Oo=`${So}@2:${Ro}:`,Mo={database:":memory:"},To="request";class Po extends ao.exports{constructor(){super()}}class No{constructor(e){this.opts=e}}class xo{constructor(e){this.client=e}}class Ao extends xo{constructor(e){super(e),this.init=async()=>{this.signClient=await so.init({core:this.client.core,metadata:this.client.metadata}),this.authClient=await Ai.init({core:this.client.core,projectId:"",metadata:this.client.metadata}),this.initializeEventListeners()},this.pair=async e=>{await this.client.core.pairing.pair(e)},this.approveSession=async e=>{const{topic:t,acknowledged:r}=await this.signClient.approve({id:e.id,namespaces:e.namespaces});return await r(),this.signClient.session.get(t)},this.rejectSession=async e=>await this.signClient.reject(e),this.updateSession=async e=>await(await this.signClient.update(e)).acknowledged(),this.extendSession=async e=>await(await this.signClient.extend(e)).acknowledged(),this.respondSessionRequest=async e=>await this.signClient.respond(e),this.disconnectSession=async e=>await this.signClient.disconnect(e),this.emitSessionEvent=async e=>await this.signClient.emit(e),this.getActiveSessions=()=>this.signClient.session.getAll().reduce(((e,t)=>(e[t.topic]=t,e)),{}),this.getPendingSessionProposals=()=>this.signClient.proposal.getAll(),this.getPendingSessionRequests=()=>this.signClient.getPendingSessionRequests(),this.respondAuthRequest=async(e,t)=>await this.authClient.respond(e,t),this.getPendingAuthRequests=()=>this.authClient.requests.getAll().filter((e=>"requester"in e)),this.formatMessage=(e,t)=>this.authClient.formatMessage(e,t),this.onSessionRequest=e=>{this.client.events.emit("session_request",e)},this.onSessionProposal=e=>{this.client.events.emit("session_proposal",e)},this.onSessionDelete=e=>{this.client.events.emit("session_delete",e)},this.onAuthRequest=e=>{this.client.events.emit("auth_request",e)},this.initializeEventListeners=()=>{this.signClient.events.on("session_proposal",this.onSessionProposal),this.signClient.events.on("session_request",this.onSessionRequest),this.signClient.events.on("session_delete",this.onSessionDelete),this.authClient.on("auth_request",this.onAuthRequest)},this.signClient={},this.authClient={}}}class Co extends No{constructor(e){super(e),this.events=new ao.exports,this.on=(e,t)=>this.events.on(e,t),this.once=(e,t)=>this.events.once(e,t),this.off=(e,t)=>this.events.off(e,t),this.removeListener=(e,t)=>this.events.removeListener(e,t),this.pair=async e=>{try{return await this.engine.pair(e)}catch(m){throw this.logger.error(m.message),m}},this.approveSession=async e=>{try{return await this.engine.approveSession(e)}catch(m){throw this.logger.error(m.message),m}},this.rejectSession=async e=>{try{return await this.engine.rejectSession(e)}catch(m){throw this.logger.error(m.message),m}},this.updateSession=async e=>{try{return await this.engine.updateSession(e)}catch(m){throw this.logger.error(m.message),m}},this.extendSession=async e=>{try{return await this.engine.extendSession(e)}catch(m){throw this.logger.error(m.message),m}},this.respondSessionRequest=async e=>{try{return await this.engine.respondSessionRequest(e)}catch(m){throw this.logger.error(m.message),m}},this.disconnectSession=async e=>{try{return await this.engine.disconnectSession(e)}catch(m){throw this.logger.error(m.message),m}},this.emitSessionEvent=async e=>{try{return await this.engine.emitSessionEvent(e)}catch(m){throw this.logger.error(m.message),m}},this.getActiveSessions=()=>{try{return this.engine.getActiveSessions()}catch(e){throw this.logger.error(e.message),e}},this.getPendingSessionProposals=()=>{try{return this.engine.getPendingSessionProposals()}catch(e){throw this.logger.error(e.message),e}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(e){throw this.logger.error(e.message),e}},this.respondAuthRequest=async(e,t)=>{try{return await this.engine.respondAuthRequest(e,t)}catch(r){throw this.logger.error(r.message),r}},this.getPendingAuthRequests=()=>{try{return this.engine.getPendingAuthRequests()}catch(e){throw this.logger.error(e.message),e}},this.formatMessage=(e,t)=>{try{return this.engine.formatMessage(e,t)}catch(r){throw this.logger.error(r.message),r}},this.metadata=e.metadata,this.name=e.name||Ro,this.core=e.core,this.logger=this.core.logger,this.engine=new Ao(this)}static async init(e){const t=new Co(e);return await t.initialize(),t}async initialize(){this.logger.trace("Initialized");try{await this.engine.init(),this.logger.info("Web3Wallet Initialization Success")}catch(e){throw this.logger.info("Web3Wallet Initialization Failure"),this.logger.error(e.message),e}}}const ko=Co},8377:(e,t,r)=>{"use strict";r.r(t);var n=r(5010),i={};for(const o in n)"default"!==o&&(i[o]=()=>n[o]);r.d(t,i)},32897:(e,t,r)=>{"use strict";r.r(t),r.d(t,{assert:()=>a.assert,isConstantTime:()=>a.isConstantTime,pkcs7:()=>o.pkcs7});var n=r(8377),i={};for(const u in n)"default"!==u&&(i[u]=()=>n[u]);r.d(t,i);var o=r(53629),s=r(96122);i={};for(const u in s)["default","pkcs7"].indexOf(u)<0&&(i[u]=()=>s[u]);r.d(t,i);var a=r(86121)},53629:(e,t,r)=>{"use strict";r.r(t),r.d(t,{pkcs7:()=>i});const n=[[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],[15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],[14,14,14,14,14,14,14,14,14,14,14,14,14,14],[13,13,13,13,13,13,13,13,13,13,13,13,13],[12,12,12,12,12,12,12,12,12,12,12,12],[11,11,11,11,11,11,11,11,11,11,11],[10,10,10,10,10,10,10,10,10,10],[9,9,9,9,9,9,9,9,9],[8,8,8,8,8,8,8,8],[7,7,7,7,7,7,7],[6,6,6,6,6,6],[5,5,5,5,5],[4,4,4,4],[3,3,3],[2,2],[1]],i={pad(e){const t=n[e.byteLength%16||0],r=new Uint8Array(e.byteLength+t.length);return r.set(e),r.set(t,e.byteLength),r},unpad:e=>e.subarray(0,e.byteLength-e[e.byteLength-1])}},96122:()=>{},86121:(e,t,r)=>{"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}r.r(t),r.d(t,{assert:()=>n,isConstantTime:()=>i})},71232:(e,t,r)=>{"use strict";r.r(t),r.d(t,{addHexPrefix:()=>he,arrayToBinary:()=>R,arrayToBuffer:()=>_,arrayToHex:()=>w,arrayToNumber:()=>I,arrayToUtf8:()=>S,binaryToArray:()=>z,binaryToBuffer:()=>V,binaryToHex:()=>$,binaryToNumber:()=>W,binaryToUtf8:()=>K,bufferToArray:()=>y,bufferToBinary:()=>E,bufferToHex:()=>v,bufferToNumber:()=>b,bufferToUtf8:()=>m,calcByteLength:()=>ne,concatArrays:()=>ee,concatBuffers:()=>Q,getEncoding:()=>X,getType:()=>Z,hexToArray:()=>M,hexToBinary:()=>N,hexToBuffer:()=>O,hexToNumber:()=>P,hexToUtf8:()=>T,isArrayBuffer:()=>Y,isBinaryString:()=>H,isBuffer:()=>J,isHexString:()=>F,isTypedArray:()=>G,numberToArray:()=>L,numberToBinary:()=>q,numberToBuffer:()=>U,numberToHex:()=>j,numberToUtf8:()=>B,padLeft:()=>ue,padRight:()=>ce,removeHexLeadingZeros:()=>de,removeHexPrefix:()=>le,sanitizeBytes:()=>ae,sanitizeHex:()=>fe,splitBytes:()=>ie,swapBytes:()=>oe,swapHex:()=>se,trimLeft:()=>te,trimRight:()=>re,utf8ToArray:()=>A,utf8ToBinary:()=>D,utf8ToBuffer:()=>x,utf8ToHex:()=>C,utf8ToNumber:()=>k});var n=r(30775),i=r.n(n),o=r(78743),s=r.n(o),a=r(48834).Buffer;const u="hex",c="utf8",l="binary",h="buffer",f="array",d="typed-array",p="array-buffer",g="0";function y(e){return new Uint8Array(e)}function v(e,t=!1){const r=e.toString(u);return t?he(r):r}function m(e){return e.toString(c)}function b(e){return e.readUIntBE(0,e.length)}function E(e){return R(y(e))}function _(e){return s()(e)}function w(e,t=!1){return v(_(e),t)}function S(e){return m(_(e))}function I(e){return b(_(e))}function R(e){return Array.from(e).map(q).join("")}function O(e){return a.from(le(e),u)}function M(e){return y(O(e))}function T(e){return m(O(e))}function P(e){return I(M(e))}function N(e){return R(M(e))}function x(e){return a.from(e,c)}function A(e){return y(x(e))}function C(e,t=!1){return v(x(e),t)}function k(e){const t=parseInt(e,10);return function(e,t){if(!e)throw new Error(t)}(!function(e){return"undefined"===typeof e}(t),"Number can only safely store up to 53 bits"),t}function D(e){return R(A(e))}function U(e){return V(q(e))}function L(e){return z(q(e))}function j(e,t){return $(q(e),t)}function B(e){return`${e}`}function q(e){return ae((e>>>0).toString(2))}function V(e){return _(z(e))}function z(e){return new Uint8Array(ie(e).map((e=>parseInt(e,2))))}function $(e,t){return w(z(e),t)}function K(e){return S(z(e))}function W(e){return I(z(e))}function H(e){return!("string"!==typeof e||!new RegExp(/^[01]+$/).test(e))&&e.length%8===0}function F(e,t){return!("string"!==typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&(!t||e.length===2+2*t)}function J(e){return a.isBuffer(e)}function G(e){return i().strict(e)&&!J(e)}function Y(e){return!G(e)&&!J(e)&&"undefined"!==typeof e.byteLength}function Z(e){return J(e)?h:G(e)?d:Y(e)?p:Array.isArray(e)?f:typeof e}function X(e){return H(e)?l:F(e)?u:c}function Q(...e){return a.concat(e)}function ee(...e){let t=[];return e.forEach((e=>t=t.concat(Array.from(e)))),new Uint8Array([...t])}function te(e,t){const r=e.length-t;return r>0&&(e=e.slice(r)),e}function re(e,t){return e.slice(0,t)}function ne(e,t=8){const r=e%t;return r?(e-r)/t*t+t:e}function ie(e,t=8){const r=ae(e).match(new RegExp(`.{${t}}`,"gi"));return Array.from(r||[])}function oe(e){return ie(e).map(pe).join("")}function se(e){return $(oe(N(e)))}function ae(e,t=8,r=g){return ue(e,ne(e.length,t),r)}function ue(e,t,r=g){return ge(e,t,!0,r)}function ce(e,t,r=g){return ge(e,t,!1,r)}function le(e){return e.replace(/^0x/,"")}function he(e){return e.startsWith("0x")?e:`0x${e}`}function fe(e){return(e=ae(e=le(e),2))&&(e=he(e)),e}function de(e){const t=e.startsWith("0x");return e=(e=le(e)).startsWith(g)?e.substring(1):e,t?he(e):e}function pe(e){return e.split("").reverse().join("")}function ge(e,t,r,n=g){const i=t-e.length;let o=e;if(i>0){const t=n.repeat(i);o=r?t+e:e+t}return o}},45086:(e,t,r)=>{"use strict";function n(){return(null===r.g||void 0===r.g?void 0:r.g.crypto)||(null===r.g||void 0===r.g?void 0:r.g.msCrypto)||{}}function i(){const e=n();return e.subtle||e.webkitSubtle}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowserCryptoAvailable=t.getSubtleCrypto=t.getBrowerCrypto=void 0,t.getBrowerCrypto=n,t.getSubtleCrypto=i,t.isBrowserCryptoAvailable=function(){return!!n()&&!!i()}},64250:(e,t)=>{"use strict";function r(){return"undefined"===typeof document&&"undefined"!==typeof navigator&&"ReactNative"===navigator.product}function n(){return"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowser=t.isNode=t.isReactNative=void 0,t.isReactNative=r,t.isNode=n,t.isBrowser=function(){return!r()&&!n()}},5010:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(5163);n.__exportStar(r(45086),t),n.__exportStar(r(64250),t)},5774:(e,t,r)=>{"use strict";r.r(t),r.d(t,{IEvents:()=>n});class n{}},33843:(e,t,r)=>{"use strict";r.r(t),r.d(t,{IEvents:()=>n.IEvents});var n=r(5774)},57052:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HEARTBEAT_EVENTS=t.HEARTBEAT_INTERVAL=void 0;const n=r(42537);t.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,t.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"}},13566:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});r(5163).__exportStar(r(57052),t)},47798:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeartBeat=void 0;const n=r(5163),i=r(22699),o=r(42537),s=r(87826),a=r(13566);class u extends s.IHeartBeat{constructor(e){super(e),this.events=new i.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(null===e||void 0===e?void 0:e.interval)||a.HEARTBEAT_INTERVAL}static init(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=new u(e);return yield t.init(),t}))}init(){return n.__awaiter(this,void 0,void 0,(function*(){yield this.initialize()}))}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}initialize(){return n.__awaiter(this,void 0,void 0,(function*(){this.intervalRef=setInterval((()=>this.pulse()),o.toMiliseconds(this.interval))}))}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}t.HeartBeat=u},67660:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(5163);n.__exportStar(r(47798),t),n.__exportStar(r(87826),t),n.__exportStar(r(13566),t)},81829:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IHeartBeat=void 0;const n=r(33843);class i extends n.IEvents{constructor(e){super()}}t.IHeartBeat=i},87826:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});r(5163).__exportStar(r(81829),t)},60084:(e,t,r)=>{"use strict";r.r(t),r.d(t,{decrypt:()=>S,encrypt:()=>w,generateKey:()=>E,verifyHmac:()=>_});var n=r(5010);const i=256,o=256,s="AES-CBC",a=`SHA-${i}`,u="HMAC",c="encrypt",l="decrypt",h="sign",f="verify";async function d(e,t=s){return n.getSubtleCrypto().importKey("raw",e,function(e){return e===s?{length:i,name:s}:{hash:{name:a},name:u}}(t),!0,function(e){return e===s?[c,l]:[h,f]}(t))}async function p(e,t){const r=n.getSubtleCrypto(),i=await d(e,u),s=await r.sign({length:o,name:u},i,t);return new Uint8Array(s)}function g(e,t,r){return async function(e,t,r){const i=n.getSubtleCrypto(),o=await d(t,s),a=await i.encrypt({iv:e,name:s},o,r);return new Uint8Array(a)}(e,t,r)}function y(e,t,r){return async function(e,t,r){const i=n.getSubtleCrypto(),o=await d(t,s),a=await i.decrypt({iv:e,name:s},o,r);return new Uint8Array(a)}(e,t,r)}r(32897);async function v(e,t){return await p(e,t)}var m=r(71232),b=r(74220);async function E(e){const t=function(e){return n.getBrowerCrypto().getRandomValues(new Uint8Array(e))}((e||256)/8);return(0,b.convertBufferToArrayBuffer)(m.arrayToBuffer(t))}async function _(e,t){const r=m.hexToArray(e.data),n=m.hexToArray(e.iv),i=m.hexToArray(e.hmac),o=m.arrayToHex(i,!1),s=m.concatArrays(r,n),a=await v(t,s),u=m.arrayToHex(a,!1);return m.removeHexPrefix(o)===m.removeHexPrefix(u)}async function w(e,t,r){const n=m.bufferToArray((0,b.convertArrayBufferToBuffer)(t)),i=r||await E(128),o=m.bufferToArray((0,b.convertArrayBufferToBuffer)(i)),s=m.arrayToHex(o,!1),a=JSON.stringify(e),u=m.utf8ToArray(a),c=await g(o,n,u),l=m.arrayToHex(c,!1),h=m.concatArrays(c,o),f=await v(n,h);return{data:l,hmac:m.arrayToHex(f,!1),iv:s}}async function S(e,t){const r=m.bufferToArray((0,b.convertArrayBufferToBuffer)(t));if(!r)throw new Error("Missing key: required for decryption");if(!await _(e,r))return null;const n=m.hexToArray(e.data),i=m.hexToArray(e.iv),o=await y(i,r,n),s=m.arrayToUtf8(o);let a;try{a=JSON.parse(s)}catch(u){return null}return a}},21061:(e,t,r)=>{"use strict";r.r(t),r.d(t,{JsonRpcProvider:()=>o,default:()=>s});var n=r(22699),i=r(55494);class o extends i.IJsonRpcProvider{constructor(e){super(e),this.events=new n.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict((0,i.formatJsonRpcRequest)(e.method,e.params||[],e.id||(0,i.getBigIntRpcId)().toString()),t)}async requestStrict(e,t){return new Promise((async(r,n)=>{if(!this.connection.connected)try{await this.open()}catch(o){n(o)}this.events.on(`${e.id}`,(e=>{(0,i.isJsonRpcError)(e)?n(e.error):r(e.result)}));try{await this.connection.send(e,t)}catch(o){n(o)}}))}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),(0,i.isJsonRpcResponse)(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&3e3===e.code&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),"string"===typeof e&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",(e=>this.onPayload(e))),this.connection.on("close",(e=>this.onClose(e))),this.connection.on("error",(e=>this.events.emit("error",e))),this.connection.on("register_error",(e=>this.onClose())),this.hasRegisteredEventListeners=!0)}}const s=o},16392:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DEFAULT_ERROR:()=>f,INTERNAL_ERROR:()=>a,INVALID_PARAMS:()=>s,INVALID_REQUEST:()=>i,METHOD_NOT_FOUND:()=>o,PARSE_ERROR:()=>n,RESERVED_ERROR_CODES:()=>c,SERVER_ERROR:()=>u,SERVER_ERROR_CODE_RANGE:()=>l,STANDARD_ERROR_MAP:()=>h});const n="PARSE_ERROR",i="INVALID_REQUEST",o="METHOD_NOT_FOUND",s="INVALID_PARAMS",a="INTERNAL_ERROR",u="SERVER_ERROR",c=[-32700,-32600,-32601,-32602,-32603],l=[-32e3,-32099],h={[n]:{code:-32700,message:"Parse error"},[i]:{code:-32600,message:"Invalid Request"},[o]:{code:-32601,message:"Method not found"},[s]:{code:-32602,message:"Invalid params"},[a]:{code:-32603,message:"Internal error"},[u]:{code:-32e3,message:"Server error"}},f=u},36786:(e,t,r)=>{"use strict";r.r(t),r.d(t,{isNodeJs:()=>o});var n=r(5010),i={};for(const s in n)["default","isNodeJs"].indexOf(s)<0&&(i[s]=()=>n[s]);r.d(t,i);const o=n.isNode},38588:(e,t,r)=>{"use strict";r.r(t),r.d(t,{getError:()=>a,getErrorByCode:()=>u,isReservedErrorCode:()=>o,isServerErrorCode:()=>i,isValidErrorCode:()=>s,parseConnectionError:()=>l,validateJsonRpcError:()=>c});var n=r(16392);function i(e){return e<=n.SERVER_ERROR_CODE_RANGE[0]&&e>=n.SERVER_ERROR_CODE_RANGE[1]}function o(e){return n.RESERVED_ERROR_CODES.includes(e)}function s(e){return"number"===typeof e}function a(e){return Object.keys(n.STANDARD_ERROR_MAP).includes(e)?n.STANDARD_ERROR_MAP[e]:n.STANDARD_ERROR_MAP[n.DEFAULT_ERROR]}function u(e){const t=Object.values(n.STANDARD_ERROR_MAP).find((t=>t.code===e));return t||n.STANDARD_ERROR_MAP[n.DEFAULT_ERROR]}function c(e){if("undefined"===typeof e.error.code)return{valid:!1,error:"Missing code for JSON-RPC error"};if("undefined"===typeof e.error.message)return{valid:!1,error:"Missing message for JSON-RPC error"};if(!s(e.error.code))return{valid:!1,error:`Invalid error code type for JSON-RPC: ${e.error.code}`};if(o(e.error.code)){const t=u(e.error.code);if(t.message!==n.STANDARD_ERROR_MAP[n.DEFAULT_ERROR].message&&e.error.message===t.message)return{valid:!1,error:`Invalid error code message for JSON-RPC: ${e.error.code}`}}return{valid:!0}}function l(e,t,r){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):e}},47234:(e,t,r)=>{"use strict";r.r(t),r.d(t,{formatErrorMessage:()=>l,formatJsonRpcError:()=>c,formatJsonRpcRequest:()=>a,formatJsonRpcResult:()=>u,getBigIntRpcId:()=>s,payloadId:()=>o});var n=r(38588),i=r(16392);function o(e=3){return Date.now()*Math.pow(10,e)+Math.floor(Math.random()*Math.pow(10,e))}function s(e=6){return BigInt(o(e))}function a(e,t,r){return{id:r||o(),jsonrpc:"2.0",method:e,params:t}}function u(e,t){return{id:e,jsonrpc:"2.0",result:t}}function c(e,t,r){return{id:e,jsonrpc:"2.0",error:l(t,r)}}function l(e,t){return"undefined"===typeof e?(0,n.getError)(i.INTERNAL_ERROR):("string"===typeof e&&(e=Object.assign(Object.assign({},(0,n.getError)(i.SERVER_ERROR)),{message:e})),"undefined"!==typeof t&&(e.data=t),(0,n.isReservedErrorCode)(e.code)&&(e=(0,n.getErrorByCode)(e.code)),e)}},55494:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DEFAULT_ERROR:()=>n.DEFAULT_ERROR,IBaseJsonRpcProvider:()=>c.IBaseJsonRpcProvider,IEvents:()=>c.IEvents,IJsonRpcConnection:()=>c.IJsonRpcConnection,IJsonRpcProvider:()=>c.IJsonRpcProvider,INTERNAL_ERROR:()=>n.INTERNAL_ERROR,INVALID_PARAMS:()=>n.INVALID_PARAMS,INVALID_REQUEST:()=>n.INVALID_REQUEST,METHOD_NOT_FOUND:()=>n.METHOD_NOT_FOUND,PARSE_ERROR:()=>n.PARSE_ERROR,RESERVED_ERROR_CODES:()=>n.RESERVED_ERROR_CODES,SERVER_ERROR:()=>n.SERVER_ERROR,SERVER_ERROR_CODE_RANGE:()=>n.SERVER_ERROR_CODE_RANGE,STANDARD_ERROR_MAP:()=>n.STANDARD_ERROR_MAP,formatErrorMessage:()=>a.formatErrorMessage,formatJsonRpcError:()=>a.formatJsonRpcError,formatJsonRpcRequest:()=>a.formatJsonRpcRequest,formatJsonRpcResult:()=>a.formatJsonRpcResult,getBigIntRpcId:()=>a.getBigIntRpcId,getError:()=>i.getError,getErrorByCode:()=>i.getErrorByCode,isHttpUrl:()=>l.isHttpUrl,isJsonRpcError:()=>h.isJsonRpcError,isJsonRpcPayload:()=>h.isJsonRpcPayload,isJsonRpcRequest:()=>h.isJsonRpcRequest,isJsonRpcResponse:()=>h.isJsonRpcResponse,isJsonRpcResult:()=>h.isJsonRpcResult,isJsonRpcValidationInvalid:()=>h.isJsonRpcValidationInvalid,isLocalhostUrl:()=>l.isLocalhostUrl,isReservedErrorCode:()=>i.isReservedErrorCode,isServerErrorCode:()=>i.isServerErrorCode,isValidDefaultRoute:()=>u.isValidDefaultRoute,isValidErrorCode:()=>i.isValidErrorCode,isValidLeadingWildcardRoute:()=>u.isValidLeadingWildcardRoute,isValidRoute:()=>u.isValidRoute,isValidTrailingWildcardRoute:()=>u.isValidTrailingWildcardRoute,isValidWildcardRoute:()=>u.isValidWildcardRoute,isWsUrl:()=>l.isWsUrl,parseConnectionError:()=>i.parseConnectionError,payloadId:()=>a.payloadId,validateJsonRpcError:()=>i.validateJsonRpcError});var n=r(16392),i=r(38588),o=r(36786),s={};for(const f in o)["default","DEFAULT_ERROR","INTERNAL_ERROR","INVALID_PARAMS","INVALID_REQUEST","METHOD_NOT_FOUND","PARSE_ERROR","RESERVED_ERROR_CODES","SERVER_ERROR","SERVER_ERROR_CODE_RANGE","STANDARD_ERROR_MAP","getError","getErrorByCode","isReservedErrorCode","isServerErrorCode","isValidErrorCode","parseConnectionError","validateJsonRpcError"].indexOf(f)<0&&(s[f]=()=>o[f]);r.d(t,s);var a=r(47234),u=r(13525),c=r(62146),l=r(43321),h=r(8270)},13525:(e,t,r)=>{"use strict";function n(e){return e.includes("*")?o(e):!/\W/g.test(e)}function i(e){return"*"===e}function o(e){return!!i(e)||!!e.includes("*")&&(2===e.split("*").length&&1===e.split("*").filter((e=>""===e.trim())).length)}function s(e){return!i(e)&&o(e)&&!e.split("*")[0].trim()}function a(e){return!i(e)&&o(e)&&!e.split("*")[1].trim()}r.r(t),r.d(t,{isValidDefaultRoute:()=>i,isValidLeadingWildcardRoute:()=>s,isValidRoute:()=>n,isValidTrailingWildcardRoute:()=>a,isValidWildcardRoute:()=>o})},62146:(e,t,r)=>{"use strict";r.r(t),r.d(t,{IBaseJsonRpcProvider:()=>o,IEvents:()=>n,IJsonRpcConnection:()=>i,IJsonRpcProvider:()=>s});class n{}class i extends n{constructor(e){super()}}class o extends n{constructor(){super()}}class s extends o{constructor(e){super()}}},43321:(e,t,r)=>{"use strict";r.r(t),r.d(t,{isHttpUrl:()=>s,isLocalhostUrl:()=>u,isWsUrl:()=>a});const n="^https?:",i="^wss?:";function o(e,t){const r=function(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(t&&t.length)return t[0]}(e);return"undefined"!==typeof r&&new RegExp(t).test(r)}function s(e){return o(e,n)}function a(e){return o(e,i)}function u(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}},8270:(e,t,r)=>{"use strict";function n(e){return"object"===typeof e&&"id"in e&&"jsonrpc"in e&&"2.0"===e.jsonrpc}function i(e){return n(e)&&"method"in e}function o(e){return n(e)&&(s(e)||a(e))}function s(e){return"result"in e}function a(e){return"error"in e}function u(e){return"error"in e&&!1===e.valid}r.r(t),r.d(t,{isJsonRpcError:()=>a,isJsonRpcPayload:()=>n,isJsonRpcRequest:()=>i,isJsonRpcResponse:()=>o,isJsonRpcResult:()=>s,isJsonRpcValidationInvalid:()=>u})},46328:(e,t,r)=>{"use strict";r.r(t),r.d(t,{WsConnection:()=>a,default:()=>u});var n=r(22699),i=r(42325),o=r(55494);const s="undefined"!==typeof r.g&&"undefined"!==typeof r.g.WebSocket?r.g.WebSocket:"undefined"!==typeof window&&"undefined"!==typeof window.WebSocket?window.WebSocket:r(18071);class a{constructor(e){if(this.url=e,this.events=new n.EventEmitter,this.registering=!1,!(0,o.isWsUrl)(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return"undefined"!==typeof this.socket}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise(((e,t)=>{"undefined"!==typeof this.socket?(this.socket.onclose=t=>{this.onClose(t),e()},this.socket.close()):t(new Error("Connection already closed"))}))}async send(e,t){"undefined"===typeof this.socket&&(this.socket=await this.register());try{this.socket.send((0,i.safeJsonStringify)(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!(0,o.isWsUrl)(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise(((e,t)=>{this.events.once("register_error",(e=>{this.resetMaxListeners(),t(e)})),this.events.once("open",(()=>{if(this.resetMaxListeners(),"undefined"===typeof this.socket)return t(new Error("WebSocket connection is missing or invalid"));e(this.socket)}))}))}return this.url=e,this.registering=!0,new Promise(((t,r)=>{const n=(0,o.isReactNative)()?void 0:{rejectUnauthorized:!(0,o.isLocalhostUrl)(e)},i=new s(e,[],n);"undefined"!==typeof window||"undefined"!==typeof serviceWorker&&serviceWorker instanceof ServiceWorker?i.onerror=e=>{const t=e;r(this.emitError(t.error))}:i.on("error",(e=>{r(this.emitError(e))})),i.onopen=()=>{this.onOpen(i),t(i)}}))}onOpen(e){e.onmessage=e=>this.onPayload(e),e.onclose=e=>this.onClose(e),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if("undefined"===typeof e.data)return;const t="string"===typeof e.data?(0,i.safeJsonParse)(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const r=this.parseError(t),n=r.message||r.toString(),i=(0,o.formatJsonRpcError)(e,n);this.events.emit("payload",i)}parseError(e,t=this.url){return(0,o.parseConnectionError)(e,t,"WS")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}emitError(e){const t=this.parseError(new Error((null===e||void 0===e?void 0:e.message)||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",t),t}}const u=a},68385:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyValueStorage=void 0;const n=r(5163),i=r(26041),o=n.__importDefault(r(12585)),s=r(21833);class a{constructor(){this.localStorage=o.default}getKeys(){return n.__awaiter(this,void 0,void 0,(function*(){return Object.keys(this.localStorage)}))}getEntries(){return n.__awaiter(this,void 0,void 0,(function*(){return Object.entries(this.localStorage).map(s.parseEntry)}))}getItem(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=this.localStorage.getItem(e);if(null!==t)return i.safeJsonParse(t)}))}setItem(e,t){return n.__awaiter(this,void 0,void 0,(function*(){this.localStorage.setItem(e,i.safeJsonStringify(t))}))}removeItem(e){return n.__awaiter(this,void 0,void 0,(function*(){this.localStorage.removeItem(e)}))}}t.KeyValueStorage=a,t.default=a},12585:(e,t,r)=>{"use strict";!function(){let t;function n(){}t=n,t.prototype.getItem=function(e){return this.hasOwnProperty(e)?String(this[e]):null},t.prototype.setItem=function(e,t){this[e]=String(t)},t.prototype.removeItem=function(e){delete this[e]},t.prototype.clear=function(){const e=this;Object.keys(e).forEach((function(t){e[t]=void 0,delete e[t]}))},t.prototype.key=function(e){return e=e||0,Object.keys(this)[e]},t.prototype.__defineGetter__("length",(function(){return Object.keys(this).length})),"undefined"!==typeof r.g&&r.g.localStorage?e.exports=r.g.localStorage:"undefined"!==typeof window&&window.localStorage?e.exports=window.localStorage:e.exports=new n}()},21833:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(5163);n.__exportStar(r(72073),t),n.__exportStar(r(50863),t)},72073:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IKeyValueStorage=void 0;t.IKeyValueStorage=class{}},50863:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseEntry=void 0;const n=r(26041);t.parseEntry=function(e){var t;return[e[0],n.safeJsonParse(null!==(t=e[1])&&void 0!==t?t:"")]}},47337:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PINO_CUSTOM_CONTEXT_KEY=t.PINO_LOGGER_DEFAULTS=void 0,t.PINO_LOGGER_DEFAULTS={level:"info"},t.PINO_CUSTOM_CONTEXT_KEY="custom_context"},52500:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const n=r(5163),i=n.__importDefault(r(69413));Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return i.default}}),n.__exportStar(r(47337),t),n.__exportStar(r(48846),t)},48846:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateChildLogger=t.formatChildLoggerContext=t.getLoggerContext=t.setBrowserLoggerContext=t.getBrowserLoggerContext=t.getDefaultLoggerOptions=void 0;const n=r(47337);function i(e,t=n.PINO_CUSTOM_CONTEXT_KEY){return e[t]||""}function o(e,t,r=n.PINO_CUSTOM_CONTEXT_KEY){return e[r]=t,e}function s(e,t=n.PINO_CUSTOM_CONTEXT_KEY){let r="";return r="undefined"===typeof e.bindings?i(e,t):e.bindings().context||"",r}function a(e,t,r=n.PINO_CUSTOM_CONTEXT_KEY){const i=s(e,r);return i.trim()?`${i}/${t}`:t}t.getDefaultLoggerOptions=function(e){return Object.assign(Object.assign({},e),{level:(null===e||void 0===e?void 0:e.level)||n.PINO_LOGGER_DEFAULTS.level})},t.getBrowserLoggerContext=i,t.setBrowserLoggerContext=o,t.getLoggerContext=s,t.formatChildLoggerContext=a,t.generateChildLogger=function(e,t,r=n.PINO_CUSTOM_CONTEXT_KEY){const i=a(e,t,r);return o(e.child({context:i}),i,r)}},86679:(e,t,r)=>{"use strict";r.r(t),r.d(t,{generateKeyPair:()=>u,signJWT:()=>c,verifyJWT:()=>l});var n=r(27728),i=r(61863),o=r(42537),s=r(37593),a=r(1569);function u(e=(0,i.randomBytes)(s.KEY_PAIR_SEED_LENGTH)){return n.generateKeyPairFromSeed(e)}async function c(e,t,r,i,u=(0,o.fromMiliseconds)(Date.now())){const c={alg:s.JWT_IRIDIUM_ALG,typ:s.JWT_IRIDIUM_TYP},l={iss:(0,a.encodeIss)(i.publicKey),sub:e,aud:t,iat:u,exp:u+r},h=(0,a.encodeData)({header:c,payload:l}),f=n.sign(i.secretKey,h);return(0,a.encodeJWT)({header:c,payload:l,signature:f})}async function l(e){const{header:t,payload:r,data:i,signature:o}=(0,a.decodeJWT)(e);if(t.alg!==s.JWT_IRIDIUM_ALG||t.typ!==s.JWT_IRIDIUM_TYP)throw new Error("JWT must use EdDSA algorithm");const u=(0,a.decodeIss)(r.iss);return n.verify(u,i,o)}},37593:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DATA_ENCODING:()=>u,DID_DELIMITER:()=>c,DID_METHOD:()=>h,DID_PREFIX:()=>l,JSON_ENCODING:()=>a,JWT_DELIMITER:()=>o,JWT_ENCODING:()=>s,JWT_IRIDIUM_ALG:()=>n,JWT_IRIDIUM_TYP:()=>i,KEY_PAIR_SEED_LENGTH:()=>y,MULTICODEC_ED25519_BASE:()=>d,MULTICODEC_ED25519_ENCODING:()=>f,MULTICODEC_ED25519_HEADER:()=>p,MULTICODEC_ED25519_LENGTH:()=>g});const n="EdDSA",i="JWT",o=".",s="base64url",a="utf8",u="utf8",c=":",l="did",h="key",f="base58btc",d="z",p="K36",g=32,y=32},53179:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DATA_ENCODING:()=>i.DATA_ENCODING,DID_DELIMITER:()=>i.DID_DELIMITER,DID_METHOD:()=>i.DID_METHOD,DID_PREFIX:()=>i.DID_PREFIX,JSON_ENCODING:()=>i.JSON_ENCODING,JWT_DELIMITER:()=>i.JWT_DELIMITER,JWT_ENCODING:()=>i.JWT_ENCODING,JWT_IRIDIUM_ALG:()=>i.JWT_IRIDIUM_ALG,JWT_IRIDIUM_TYP:()=>i.JWT_IRIDIUM_TYP,KEY_PAIR_SEED_LENGTH:()=>i.KEY_PAIR_SEED_LENGTH,MULTICODEC_ED25519_BASE:()=>i.MULTICODEC_ED25519_BASE,MULTICODEC_ED25519_ENCODING:()=>i.MULTICODEC_ED25519_ENCODING,MULTICODEC_ED25519_HEADER:()=>i.MULTICODEC_ED25519_HEADER,MULTICODEC_ED25519_LENGTH:()=>i.MULTICODEC_ED25519_LENGTH,decodeData:()=>a.decodeData,decodeIss:()=>a.decodeIss,decodeJSON:()=>a.decodeJSON,decodeJWT:()=>a.decodeJWT,decodeSig:()=>a.decodeSig,encodeData:()=>a.encodeData,encodeIss:()=>a.encodeIss,encodeJSON:()=>a.encodeJSON,encodeJWT:()=>a.encodeJWT,encodeSig:()=>a.encodeSig,generateKeyPair:()=>n.generateKeyPair,signJWT:()=>n.signJWT,verifyJWT:()=>n.verifyJWT});var n=r(86679),i=r(37593),o=r(3947),s={};for(const u in o)["default","generateKeyPair","signJWT","verifyJWT","DATA_ENCODING","DID_DELIMITER","DID_METHOD","DID_PREFIX","JSON_ENCODING","JWT_DELIMITER","JWT_ENCODING","JWT_IRIDIUM_ALG","JWT_IRIDIUM_TYP","KEY_PAIR_SEED_LENGTH","MULTICODEC_ED25519_BASE","MULTICODEC_ED25519_ENCODING","MULTICODEC_ED25519_HEADER","MULTICODEC_ED25519_LENGTH"].indexOf(u)<0&&(s[u]=()=>o[u]);r.d(t,s);var a=r(1569)},3947:()=>{},1569:(e,t,r)=>{"use strict";r.r(t),r.d(t,{decodeData:()=>g,decodeIss:()=>h,decodeJSON:()=>u,decodeJWT:()=>v,decodeSig:()=>d,encodeData:()=>p,encodeIss:()=>l,encodeJSON:()=>c,encodeJWT:()=>y,encodeSig:()=>f});var n=r(31080),i=r(53832),o=r(28807),s=r(42325),a=r(37593);function u(e){return(0,s.safeJsonParse)((0,i.toString)((0,o.fromString)(e,a.JWT_ENCODING),a.JSON_ENCODING))}function c(e){return(0,i.toString)((0,o.fromString)((0,s.safeJsonStringify)(e),a.JSON_ENCODING),a.JWT_ENCODING)}function l(e){const t=(0,o.fromString)(a.MULTICODEC_ED25519_HEADER,a.MULTICODEC_ED25519_ENCODING),r=a.MULTICODEC_ED25519_BASE+(0,i.toString)((0,n.concat)([t,e]),a.MULTICODEC_ED25519_ENCODING);return[a.DID_PREFIX,a.DID_METHOD,r].join(a.DID_DELIMITER)}function h(e){const[t,r,n]=e.split(a.DID_DELIMITER);if(t!==a.DID_PREFIX||r!==a.DID_METHOD)throw new Error('Issuer must be a DID with method "key"');if(n.slice(0,1)!==a.MULTICODEC_ED25519_BASE)throw new Error("Issuer must be a key in mulicodec format");const s=(0,o.fromString)(n.slice(1),a.MULTICODEC_ED25519_ENCODING);if((0,i.toString)(s.slice(0,2),a.MULTICODEC_ED25519_ENCODING)!==a.MULTICODEC_ED25519_HEADER)throw new Error('Issuer must be a public key with type "Ed25519"');const u=s.slice(2);if(u.length!==a.MULTICODEC_ED25519_LENGTH)throw new Error("Issuer must be a public key with length 32 bytes");return u}function f(e){return(0,i.toString)(e,a.JWT_ENCODING)}function d(e){return(0,o.fromString)(e,a.JWT_ENCODING)}function p(e){return(0,o.fromString)([c(e.header),c(e.payload)].join(a.JWT_DELIMITER),a.DATA_ENCODING)}function g(e){const t=(0,i.toString)(e,a.DATA_ENCODING).split(a.JWT_DELIMITER);return{header:u(t[0]),payload:u(t[1])}}function y(e){return[c(e.header),c(e.payload),f(e.signature)].join(a.JWT_DELIMITER)}function v(e){const t=e.split(a.JWT_DELIMITER);return{header:u(t[0]),payload:u(t[1]),signature:d(t[2]),data:(0,o.fromString)(t.slice(0,2).join(a.JWT_DELIMITER),a.DATA_ENCODING)}}},42325:(e,t,r)=>{"use strict";r.r(t),r.d(t,{safeJsonParse:()=>o,safeJsonStringify:()=>s});const n=e=>JSON.stringify(e,((e,t)=>"bigint"===typeof t?t.toString()+"n":t)),i=e=>{const t=e.replace(/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,'$1"$2n"$3');return JSON.parse(t,((e,t)=>"string"===typeof t&&t.match(/^\d+n$/)?BigInt(t.substring(0,t.length-1)):t))};function o(e){if("string"!==typeof e)throw new Error("Cannot safe json parse value of type "+typeof e);try{return i(e)}catch(t){return e}}function s(e){return"string"===typeof e?e:n(e)||""}},17781:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var n=r(74220);const i=class{constructor(){this._eventEmitters=[],"undefined"!==typeof window&&"undefined"!==typeof window.addEventListener&&(window.addEventListener("online",(()=>this.trigger("online"))),window.addEventListener("offline",(()=>this.trigger("offline"))))}on(e,t){this._eventEmitters.push({event:e,callback:t})}trigger(e){let t=[];e&&(t=this._eventEmitters.filter((t=>t.event===e))),t.forEach((e=>{e.callback()}))}},o="undefined"!==typeof r.g.WebSocket?r.g.WebSocket:r(18071);const s=class{constructor(e){if(this.opts=e,this._queue=[],this._events=[],this._subscriptions=[],this._protocol=e.protocol,this._version=e.version,this._url="",this._netMonitor=null,this._socket=null,this._nextSocket=null,this._subscriptions=e.subscriptions||[],this._netMonitor=e.netMonitor||new i,!e.url||"string"!==typeof e.url)throw new Error("Missing or invalid WebSocket url");this._url=e.url,this._netMonitor.on("online",(()=>this._socketCreate()))}set readyState(e){}get readyState(){return this._socket?this._socket.readyState:-1}set connecting(e){}get connecting(){return 0===this.readyState}set connected(e){}get connected(){return 1===this.readyState}set closing(e){}get closing(){return 2===this.readyState}set closed(e){}get closed(){return 3===this.readyState}open(){this._socketCreate()}close(){this._socketClose()}send(e,t,r){if(!t||"string"!==typeof t)throw new Error("Missing or invalid topic field");this._socketSend({topic:t,type:"pub",payload:e,silent:!!r})}subscribe(e){this._socketSend({topic:e,type:"sub",payload:"",silent:!0})}on(e,t){this._events.push({event:e,callback:t})}_socketCreate(){if(this._nextSocket)return;const e=function(e,t,r){var i,o;const s=e.startsWith("https")?e.replace("https","wss"):e.startsWith("http")?e.replace("http","ws"):e,a=s.split("?"),u=(0,n.isBrowser)()?{protocol:t,version:r,env:"browser",host:(null===(i=(0,n.getLocation)())||void 0===i?void 0:i.host)||""}:{protocol:t,version:r,env:(null===(o=(0,n.detectEnv)())||void 0===o?void 0:o.name)||""},c=(0,n.appendToQueryString)((0,n.getQueryString)(a[1]||""),u);return a[0]+"?"+c}(this._url,this._protocol,this._version);if(this._nextSocket=new o(e),!this._nextSocket)throw new Error("Failed to create socket");this._nextSocket.onmessage=e=>this._socketReceive(e),this._nextSocket.onopen=()=>this._socketOpen(),this._nextSocket.onerror=e=>this._socketError(e),this._nextSocket.onclose=()=>{setTimeout((()=>{this._nextSocket=null,this._socketCreate()}),1e3)}}_socketOpen(){this._socketClose(),this._socket=this._nextSocket,this._nextSocket=null,this._queueSubscriptions(),this._pushQueue()}_socketClose(){this._socket&&(this._socket.onclose=()=>{},this._socket.close())}_socketSend(e){const t=JSON.stringify(e);this._socket&&1===this._socket.readyState?this._socket.send(t):(this._setToQueue(e),this._socketCreate())}async _socketReceive(e){let t;try{t=JSON.parse(e.data)}catch(r){return}if(this._socketSend({topic:t.topic,type:"ack",payload:"",silent:!0}),this._socket&&1===this._socket.readyState){const e=this._events.filter((e=>"message"===e.event));e&&e.length&&e.forEach((e=>e.callback(t)))}}_socketError(e){const t=this._events.filter((e=>"error"===e.event));t&&t.length&&t.forEach((t=>t.callback(e)))}_queueSubscriptions(){this._subscriptions.forEach((e=>this._queue.push({topic:e,type:"sub",payload:"",silent:!0}))),this._subscriptions=this.opts.subscriptions||[]}_setToQueue(e){this._queue.push(e)}_pushQueue(){this._queue.forEach((e=>this._socketSend(e))),this._queue=[]}}},26996:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CORE_CONTEXT:()=>Pr,CORE_DEFAULT:()=>xr,CORE_PROTOCOL:()=>Mr,CORE_STORAGE_OPTIONS:()=>Ar,CORE_STORAGE_PREFIX:()=>Nr,CORE_VERSION:()=>Tr,CRYPTO_CLIENT_SEED:()=>kr,CRYPTO_CONTEXT:()=>Cr,CRYPTO_JWT_TTL:()=>Dr,Core:()=>ni,Crypto:()=>bn,EXPIRER_CONTEXT:()=>fn,EXPIRER_DEFAULT_TTL:()=>gn,EXPIRER_EVENTS:()=>dn,EXPIRER_STORAGE_VERSION:()=>pn,Expirer:()=>Jn,HISTORY_CONTEXT:()=>ln,HISTORY_EVENTS:()=>cn,HISTORY_STORAGE_VERSION:()=>hn,JsonRpcHistory:()=>Fn,KEYCHAIN_CONTEXT:()=>Ur,KEYCHAIN_STORAGE_VERSION:()=>Lr,KeyChain:()=>mn,MESSAGES_CONTEXT:()=>jr,MESSAGES_STORAGE_VERSION:()=>Br,MessageTracker:()=>En,PAIRING_CONTEXT:()=>on,PAIRING_DEFAULT_TTL:()=>an,PAIRING_RPC_OPTS:()=>un,PAIRING_STORAGE_VERSION:()=>sn,PENDING_SUB_RESOLUTION_TIMEOUT:()=>nn,PUBLISHER_CONTEXT:()=>Vr,PUBLISHER_DEFAULT_TTL:()=>qr,Pairing:()=>Hn,RELAYER_CONTEXT:()=>Wr,RELAYER_DEFAULT_LOGGER:()=>$r,RELAYER_DEFAULT_PROTOCOL:()=>zr,RELAYER_DEFAULT_RELAY_URL:()=>Kr,RELAYER_EVENTS:()=>Hr,RELAYER_PROVIDER_EVENTS:()=>Jr,RELAYER_RECONNECT_TIMEOUT:()=>Gr,RELAYER_SDK_VERSION:()=>Zr,RELAYER_STORAGE_OPTIONS:()=>Yr,RELAYER_SUBSCRIBER_SUFFIX:()=>Fr,Relayer:()=>jn,STORE_STORAGE_VERSION:()=>Xr,SUBSCRIBER_CONTEXT:()=>tn,SUBSCRIBER_DEFAULT_TTL:()=>en,SUBSCRIBER_EVENTS:()=>Qr,SUBSCRIBER_STORAGE_VERSION:()=>rn,Store:()=>Wn,Subscriber:()=>An,VERIFY_CONTEXT:()=>yn,VERIFY_SERVER:()=>vn,Verify:()=>Gn,default:()=>ri});var n=r(80753),i=r(68079),o=r(45754),s=r(11987),a=r(95058),u=r(34795),c=r(56666),l=r(87371),h=r(22699),f=r.n(h),d=r(68385),p=r(67660),g=r(52500),y=r(5774);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,a.default)(e);if(t){var i=(0,a.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var m=function(e){(0,o.default)(r,e);var t=v(r);function r(e){var r;return(r=t.call(this)).opts=e,r.protocol="wc",r.version=2,r}return(0,l.default)(r)}(y.IEvents),b=((0,l.default)((function(e,t,r){this.core=e,this.logger=t})),function(e){(0,o.default)(r,e);var t=v(r);function r(e,r){var n;return(n=t.call(this)).core=e,n.logger=r,n.records=new Map,n}return(0,l.default)(r)}(y.IEvents)),E=(0,l.default)((function(e,t){this.logger=e,this.core=t})),_=function(e){(0,o.default)(r,e);var t=v(r);function r(e,r){var n;return(n=t.call(this)).relayer=e,n.logger=r,n}return(0,l.default)(r)}(y.IEvents),w=function(e){(0,o.default)(r,e);var t=v(r);function r(e){return t.call(this)}return(0,l.default)(r)}(y.IEvents),S=(0,l.default)((function(e,t,r,n){this.core=e,this.logger=t,this.name=r})),I=((0,l.default)((function(){this.map=new Map})),function(e){(0,o.default)(r,e);var t=v(r);function r(e,r){var n;return(n=t.call(this)).relayer=e,n.logger=r,n}return(0,l.default)(r)}(y.IEvents)),R=((0,l.default)((function(e,t){this.core=e,this.logger=t})),function(e){(0,o.default)(r,e);var t=v(r);function r(e,r){var n;return(n=t.call(this)).core=e,n.logger=r,n}return(0,l.default)(r)}(y.IEvents)),O=((0,l.default)((function(e,t){this.logger=e,this.core=t})),(0,l.default)((function(e,t){this.projectId=e,this.logger=t}))),M=(function(e){(0,o.default)(r,e);var t=v(r);function r(){return t.call(this)}(0,l.default)(r)}(f()),(0,l.default)((function(e){this.opts=e,this.protocol="wc",this.version=2})),function(e){(0,o.default)(r,e);var t=v(r);function r(){return t.call(this)}(0,l.default)(r)}(h.EventEmitter),(0,l.default)((function(e){this.client=e})),r(42325)),T=r(53179),P=r(96234),N=r(18779),x=r(43133),A=r(61863),C=r(74932),k=r(36381),D=r(49466),U=r(54924),L=r(42537),j=r(45415),B=(r(7047),r(34126)),q=r(60220);var V="base10",z="base16",$="base64pad",K="utf8",W=0,H=1,F=0,J=1,G=12,Y=32;function Z(){var e=(0,A.randomBytes)(Y);return(0,D.toString)(e,z)}function X(e){var t=(0,C.hash)((0,D.fromString)(e,K));return(0,D.toString)(t,z)}function Q(e){return Number((0,D.toString)(e,V))}function ee(e){var t=function(e){return(0,D.fromString)(`${e}`,V)}(typeof e.type<"u"?e.type:W);if(Q(t)===H&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");var r=typeof e.senderPublicKey<"u"?(0,D.fromString)(e.senderPublicKey,z):void 0,n=typeof e.iv<"u"?(0,D.fromString)(e.iv,z):(0,A.randomBytes)(G);return function(e){if(Q(e.type)===H){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return(0,D.toString)((0,D.concat)([e.type,e.senderPublicKey,e.iv,e.sealed]),$)}return(0,D.toString)((0,D.concat)([e.type,e.iv,e.sealed]),$)}({type:t,sealed:new N.ChaCha20Poly1305((0,D.fromString)(e.symKey,z)).seal(n,(0,D.fromString)(e.message,K)),iv:n,senderPublicKey:r})}function te(e){var t=(0,D.fromString)(e,$),r=t.slice(F,J),n=J;if(Q(r)===H){var i=n+Y,o=i+G,s=t.slice(n,i),a=t.slice(i,o);return{type:r,sealed:t.slice(o),iv:a,senderPublicKey:s}}var u=n+G,c=t.slice(n,u);return{type:r,sealed:t.slice(u),iv:c}}function re(e){var t=(null==e?void 0:e.type)||W;if(t===H){if(typeof(null==e?void 0:e.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(null==e?void 0:e.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:null==e?void 0:e.senderPublicKey,receiverPublicKey:null==e?void 0:e.receiverPublicKey}}function ne(e){return e.type===H&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}var ie=Object.defineProperty,oe=Object.getOwnPropertySymbols,se=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable,ue=function(e,t,r){return t in e?ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},ce=function(e,t){for(var r in t||(t={}))se.call(t,r)&&ue(e,r,t[r]);if(oe)for(var r of oe(t))ae.call(t,r)&&ue(e,r,t[r]);return e},le="ReactNative",he={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},fe="js";function de(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function pe(){return!(0,j.getDocument)()&&!!(0,j.getNavigator)()&&navigator.product===le}function ge(){return!de()&&!!(0,j.getNavigator)()}function ye(){return pe()?he.reactNative:de()?he.node:ge()?he.browser:he.unknown}function ve(e,t,r){var n=function(){var e=(0,U.detect)();if(null===e)return"unknown";var t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[t,e.name,e.version].join("-"):[t,e.version].join("-")}(),i=function(){var e,t=ye();return t===he.browser?[t,(null==(e=(0,j.getLocation)())?void 0:e.host)||"unknown"].join(":"):t}();return[[e,t].join("-"),[fe,r].join("-"),n,i].join("/")}function me(e){var t=e.protocol,r=e.version,n=e.relayUrl,i=e.sdkVersion,o=e.auth,s=e.projectId,a=e.useOnCloseEvent,u=n.split("?"),c={auth:o,ua:ve(t,r,i),projectId:s,useOnCloseEvent:a||void 0},l=function(e,t){var r=B.parse(e);return r=ce(ce({},r),t),B.stringify(r)}(u[1]||"",c);return u[0]+"?"+l}function be(e){return Object.fromEntries(e.entries())}function Ee(e){return new Map(Object.entries(e))}function _e(e,t,r){return new Promise(function(){var n=(0,u.default)((function*(n,i){var o=setTimeout((function(){return i(new Error(r))}),t);try{var s;n(yield e)}catch(s){i(s)}clearTimeout(o)}));return function(e,t){return n.apply(this,arguments)}}())}function we(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function Se(e,t){return(0,L.fromMiliseconds)((t||Date.now())+(0,L.toMiliseconds)(e))}function Ie(e){return Date.now()>=(0,L.toMiliseconds)(e)}function Re(e,t){return`${e}${t?`:${t}`:""}`}function Oe(e){return(null==e?void 0:e.relay)||{protocol:"irn"}}function Me(e){var t=q.RELAY_JSONRPC[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}var Te=Object.defineProperty,Pe=Object.getOwnPropertySymbols,Ne=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable,Ae=function(e,t,r){return t in e?Te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r};function Ce(e){var t={},r="relay"+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-");return Object.keys(e).forEach((function(n){if(n.startsWith(r)){var i=n.replace(r,""),o=e[n];t[i]=o}})),t}function ke(e){return`${e.protocol}:${e.topic}@${e.version}?`+B.stringify(function(e,t){for(var r in t||(t={}))Ne.call(t,r)&&Ae(e,r,t[r]);if(Pe)for(var r of Pe(t))xe.call(t,r)&&Ae(e,r,t[r]);return e}({symKey:e.symKey},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",r={};return Object.keys(e).forEach((function(n){var i="relay"+t+n;e[n]&&(r[i]=e[n])})),r}(e.relay)))}Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var De={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Ue={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Le(e,t){var r=Ue[e],n=r.message;return{message:t?`${n} ${t}`:n,code:r.code}}function je(e,t){var r=De[e],n=r.message;return{message:t?`${n} ${t}`:n,code:r.code}}function Be(e,t){return!!Array.isArray(e)&&(!(typeof t<"u"&&e.length)||e.every(t))}function qe(e){return typeof e>"u"}function Ve(e,t){return!(!t||!qe(e))||"string"==typeof e&&Boolean(e.trim().length)}function ze(e){return typeof e<"u"&&null!==typeof e}var $e=r(21061),Ke=r(55494),We=r(46328),He=r(33958),Fe=r.n(He);function Je(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,a.default)(e);if(t){var i=(0,a.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}function Ge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ye(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(r),!0).forEach((function(t){(0,c.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ge(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ze=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,u=e.charAt(0),c=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===u;)n++,t++;for(var o=(e.length-t)*c+1>>>0,s=new Uint8Array(o);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,f=o-1;(0!==l||h<i)&&-1!==f;f--,h++)l+=a*s[f]>>>0,s[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var p=new Uint8Array(n+(o-d)),g=n;d!==o;)p[g++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*l+1>>>0,c=new Uint8Array(s);i!==o;){for(var h=t[i],f=0,d=s-1;(0!==h||f<n)&&-1!==d;d--,f++)h+=256*c[d]>>>0,c[d]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=f,i++}for(var p=s-n;p!==s&&0===c[p];)p++;for(var g=u.repeat(r);p<s;++p)g+=e.charAt(c[p]);return g},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}},Xe=Ze,Qe=function(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},et=function(){function e(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}return e.prototype.encode=function(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")},(0,l.default)(e)}(),tt=function(){function e(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}var t=e.prototype;return t.decode=function(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")},t.or=function(e){return nt(this,e)},(0,l.default)(e)}(),rt=function(){function e(e){this.decoders=e}var t=e.prototype;return t.or=function(e){return nt(this,e)},t.decode=function(e){var t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)},(0,l.default)(e)}(),nt=function(e,t){var r,n;return new rt(Ye(Ye({},e.decoders||((r={})[e.prefix]=e,r)),t.decoders||((n={})[t.prefix]=t,n)))},it=function(){function e(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new et(e,t,r),this.decoder=new tt(e,t,n)}var t=e.prototype;return t.encode=function(e){return this.encoder.encode(e)},t.decode=function(e){return this.decoder.decode(e)},(0,l.default)(e)}(),ot=function(e){var t=e.name,r=e.prefix,n=e.encode,i=e.decode;return new it(t,r,n,i)},st=function(e){var t=e.prefix,r=e.name,n=e.alphabet,i=Xe(n,r),o=i.encode,s=i.decode;return ot({prefix:t,name:r,encode:o,decode:function(e){return Qe(s(e))}})},at=function(e){var t=e.name,r=e.prefix,n=e.bitsPerChar,i=e.alphabet;return ot({prefix:r,name:t,encode:function(e){return function(e,t,r){for(var n="="===t[t.length-1],i=(1<<r)-1,o="",s=0,a=0,u=0;u<e.length;++u)for(a=a<<8|e[u],s+=8;s>r;)o+=t[i&a>>(s-=r)];if(s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o}(e,i,n)},decode:function(e){return function(e,t,r,n){for(var i={},o=0;o<t.length;++o)i[t[o]]=o;for(var s=e.length;"="===e[s-1];)--s;for(var a=new Uint8Array(s*r/8|0),u=0,c=0,l=0,h=0;h<s;++h){var f=i[e[h]];if(void 0===f)throw new SyntaxError(`Non-${n} character`);c=c<<r|f,(u+=r)>=8&&(u-=8,a[l++]=255&c>>u)}if(u>=r||255&c<<8-u)throw new SyntaxError("Unexpected end of data");return a}(e,i,n,t)}})},ut=ot({prefix:"\0",name:"identity",encode:function(e){return function(e){return(new TextDecoder).decode(e)}(e)},decode:function(e){return function(e){return(new TextEncoder).encode(e)}(e)}}),ct=Object.freeze({__proto__:null,identity:ut}),lt=at({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),ht=Object.freeze({__proto__:null,base2:lt}),ft=at({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),dt=Object.freeze({__proto__:null,base8:ft}),pt=st({prefix:"9",name:"base10",alphabet:"0123456789"}),gt=Object.freeze({__proto__:null,base10:pt}),yt=at({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),vt=at({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),mt=Object.freeze({__proto__:null,base16:yt,base16upper:vt}),bt=at({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Et=at({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),_t=at({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),wt=at({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),St=at({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),It=at({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Rt=at({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ot=at({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Mt=at({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Tt=Object.freeze({__proto__:null,base32:bt,base32upper:Et,base32pad:_t,base32padupper:wt,base32hex:St,base32hexupper:It,base32hexpad:Rt,base32hexpadupper:Ot,base32z:Mt}),Pt=st({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Nt=st({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),xt=Object.freeze({__proto__:null,base36:Pt,base36upper:Nt}),At=st({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ct=st({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),kt=Object.freeze({__proto__:null,base58btc:At,base58flickr:Ct}),Dt=at({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ut=at({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Lt=at({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),jt=at({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Bt=Object.freeze({__proto__:null,base64:Dt,base64pad:Ut,base64url:Lt,base64urlpad:jt}),qt=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),Vt=qt.reduce((function(e,t,r){return e[r]=t,e}),[]),zt=qt.reduce((function(e,t,r){return e[t.codePointAt(0)]=r,e}),[]);var $t=ot({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce((function(e,t){return e+=Vt[t]}),"")},decode:function(e){var t=[];for(var r of e){var n=zt[r.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}}),Kt=Object.freeze({__proto__:null,base256emoji:$t}),Wt=function e(t,r,n){r=r||[];for(var i=n=n||0;t>=Jt;)r[n++]=255&t|Ht,t/=128;for(;t&Ft;)r[n++]=255&t|Ht,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},Ht=128,Ft=-128,Jt=Math.pow(2,31);var Gt=function e(t,r){var n,i=0,o=0,s=r=r||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=o<28?(n&Zt)<<o:(n&Zt)*Math.pow(2,o),o+=7}while(n>=Yt);return e.bytes=s-r,i},Yt=128,Zt=127;var Xt=Math.pow(2,7),Qt=Math.pow(2,14),er=Math.pow(2,21),tr=Math.pow(2,28),rr=Math.pow(2,35),nr=Math.pow(2,42),ir=Math.pow(2,49),or=Math.pow(2,56),sr=Math.pow(2,63),ar={encode:Wt,decode:Gt,encodingLength:function(e){return e<Xt?1:e<Qt?2:e<er?3:e<tr?4:e<rr?5:e<nr?6:e<ir?7:e<or?8:e<sr?9:10}},ur=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ar.encode(e,t,r),t},cr=function(e){return ar.encodingLength(e)},lr=function(e,t){var r=t.byteLength,n=cr(e),i=n+cr(r),o=new Uint8Array(i+r);return ur(e,o,0),ur(r,o,n),o.set(t,i),new hr(e,r,t,o)},hr=(0,l.default)((function(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n})),fr=function(e){var t=e.name,r=e.code,n=e.encode;return new dr(t,r,n)},dr=function(){function e(e,t,r){this.name=e,this.code=t,this.encode=r}return e.prototype.digest=function(e){var t=this;if(e instanceof Uint8Array){var r=this.encode(e);return r instanceof Uint8Array?lr(this.code,r):r.then((function(e){return lr(t.code,e)}))}throw Error("Unknown type, must be binary type")},(0,l.default)(e)}(),pr=function(e){return function(){var t=(0,u.default)((function*(t){return new Uint8Array(yield crypto.subtle.digest(e,t))}));return function(e){return t.apply(this,arguments)}}()},gr=fr({name:"sha2-256",code:18,encode:pr("SHA-256")}),yr=fr({name:"sha2-512",code:19,encode:pr("SHA-512")}),vr=Object.freeze({__proto__:null,sha256:gr,sha512:yr}),mr=Qe,br={code:0,name:"identity",encode:mr,digest:function(e){return lr(0,mr(e))}},Er=Object.freeze({__proto__:null,identity:br});new TextEncoder,new TextDecoder;var _r=Ye(Ye(Ye(Ye(Ye(Ye(Ye(Ye(Ye(Ye({},ct),ht),dt),gt),mt),Tt),xt),kt),Bt),Kt);function wr(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Sr(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}Ye(Ye({},vr),Er);var Ir=Sr("utf8","u",(function(e){return"u"+new TextDecoder("utf8").decode(e)}),(function(e){return(new TextEncoder).encode(e.substring(1))})),Rr=Sr("ascii","a",(function(e){for(var t="a",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(function(e){for(var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?wr(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),Or=Ye({utf8:Ir,"utf-8":Ir,hex:_r.base16,latin1:Rr,ascii:Rr,binary:Rr},_r);var Mr="wc",Tr=2,Pr="core",Nr=`${Mr}@2:${Pr}:`,xr={name:Pr,logger:"error"},Ar={database:":memory:"},Cr="crypto",kr="client_ed25519_seed",Dr=L.ONE_DAY,Ur="keychain",Lr="0.3",jr="messages",Br="0.3",qr=L.SIX_HOURS,Vr="publisher",zr="irn",$r="error",Kr="wss://relay.walletconnect.com",Wr="relayer",Hr={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Fr="_subscription",Jr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Gr=L.ONE_SECOND/2,Yr={database:":memory:"},Zr="2.7.3",Xr="0.3",Qr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},en=L.THIRTY_DAYS,tn="subscription",rn="0.3",nn=1e3*L.FIVE_SECONDS,on="pairing",sn="0.3",an=L.THIRTY_DAYS,un={wc_pairingDelete:{req:{ttl:L.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:L.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:L.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:L.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:L.ONE_DAY,prompt:!1,tag:0},res:{ttl:L.ONE_DAY,prompt:!1,tag:0}}},cn={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},ln="history",hn="0.3",fn="expirer",dn={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},pn="0.3",gn=L.ONE_DAY,yn="verify-api",vn="https://verify.walletconnect.com",mn=function(){function e(e,t){var r=this;this.core=e,this.logger=t,this.keychain=new Map,this.name=Ur,this.version=Lr,this.initialized=!1,this.storagePrefix=Nr,this.init=(0,u.default)((function*(){if(!r.initialized){var e=yield r.getKeyChain();typeof e<"u"&&(r.keychain=e),r.initialized=!0}})),this.has=function(e){return r.isInitialized(),r.keychain.has(e)},this.set=function(){var e=(0,u.default)((function*(e,t){r.isInitialized(),r.keychain.set(e,t),yield r.persist()}));return function(t,r){return e.apply(this,arguments)}}(),this.get=function(e){r.isInitialized();var t=r.keychain.get(e);if(typeof t>"u"){var n=Le("NO_MATCHING_KEY",`${r.name}: ${e}`).message;throw new Error(n)}return t},this.del=function(){var e=(0,u.default)((function*(e){r.isInitialized(),r.keychain.delete(e),yield r.persist()}));return function(t){return e.apply(this,arguments)}}(),this.core=e,this.logger=(0,g.generateChildLogger)(t,this.name)}var t=e.prototype;return t.setKeyChain=function(){var e=(0,u.default)((function*(e){yield this.core.storage.setItem(this.storageKey,be(e))}));return function(t){return e.apply(this,arguments)}}(),t.getKeyChain=function(){var e=(0,u.default)((function*(){var e=yield this.core.storage.getItem(this.storageKey);return typeof e<"u"?Ee(e):void 0}));return function(){return e.apply(this,arguments)}}(),t.persist=function(){var e=(0,u.default)((function*(){yield this.setKeyChain(this.keychain)}));return function(){return e.apply(this,arguments)}}(),t.isInitialized=function(){if(!this.initialized){var e=Le("NOT_INITIALIZED",this.name).message;throw new Error(e)}},(0,l.default)(e,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+"//"+this.name}}]),e}(),bn=function(){function e(e,t,r){var n=this;this.core=e,this.logger=t,this.name=Cr,this.initialized=!1,this.init=(0,u.default)((function*(){n.initialized||(yield n.keychain.init(),n.initialized=!0)})),this.hasKeys=function(e){return n.isInitialized(),n.keychain.has(e)},this.getClientId=(0,u.default)((function*(){n.isInitialized();var e=yield n.getClientSeed(),t=T.generateKeyPair(e);return T.encodeIss(t.publicKey)})),this.generateKeyPair=function(){n.isInitialized();var e=function(){var e=k.generateKeyPair();return{privateKey:(0,D.toString)(e.secretKey,z),publicKey:(0,D.toString)(e.publicKey,z)}}();return n.setPrivateKey(e.publicKey,e.privateKey)},this.signJWT=function(){var e=(0,u.default)((function*(e){n.isInitialized();var t=yield n.getClientSeed(),r=T.generateKeyPair(t),i=Z(),o=Dr;return yield T.signJWT(i,e,o,r)}));return function(t){return e.apply(this,arguments)}}(),this.generateSharedKey=function(e,t,r){n.isInitialized();var i=function(e,t){var r=k.sharedKey((0,D.fromString)(e,z),(0,D.fromString)(t,z)),n=new x.HKDF(C.SHA256,r).expand(Y);return(0,D.toString)(n,z)}(n.getPrivateKey(e),t);return n.setSymKey(i,r)},this.setSymKey=function(){var e=(0,u.default)((function*(e,t){n.isInitialized();var r=t||function(e){var t=(0,C.hash)((0,D.fromString)(e,z));return(0,D.toString)(t,z)}(e);return yield n.keychain.set(r,e),r}));return function(t,r){return e.apply(this,arguments)}}(),this.deleteKeyPair=function(){var e=(0,u.default)((function*(e){n.isInitialized(),yield n.keychain.del(e)}));return function(t){return e.apply(this,arguments)}}(),this.deleteSymKey=function(){var e=(0,u.default)((function*(e){n.isInitialized(),yield n.keychain.del(e)}));return function(t){return e.apply(this,arguments)}}(),this.encode=function(){var e=(0,u.default)((function*(e,t,r){n.isInitialized();var i=re(r),o=(0,M.safeJsonStringify)(t);if(ne(i)){var s=i.senderPublicKey,a=i.receiverPublicKey;e=yield n.generateSharedKey(s,a)}var u=n.getSymKey(e);return ee({type:i.type,symKey:u,message:o,senderPublicKey:i.senderPublicKey})}));return function(t,r,n){return e.apply(this,arguments)}}(),this.decode=function(){var e=(0,u.default)((function*(e,t,r){n.isInitialized();var i=function(e,t){var r=te(e);return re({type:Q(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?(0,D.toString)(r.senderPublicKey,z):void 0,receiverPublicKey:null==t?void 0:t.receiverPublicKey})}(t,r);if(ne(i)){var o=i.receiverPublicKey,s=i.senderPublicKey;e=yield n.generateSharedKey(o,s)}var a=function(e){var t=new N.ChaCha20Poly1305((0,D.fromString)(e.symKey,z)),r=te(e.encoded),n=r.sealed,i=r.iv,o=t.open(i,n);if(null===o)throw new Error("Failed to decrypt");return(0,D.toString)(o,K)}({symKey:n.getSymKey(e),encoded:t});return(0,M.safeJsonParse)(a)}));return function(t,r,n){return e.apply(this,arguments)}}(),this.getPayloadType=function(e){return Q(te(e).type)},this.getPayloadSenderPublicKey=function(e){var t=te(e);return t.senderPublicKey?(0,D.toString)(t.senderPublicKey,z):void 0},this.core=e,this.logger=(0,g.generateChildLogger)(t,this.name),this.keychain=r||new mn(this.core,this.logger)}var t=e.prototype;return t.setPrivateKey=function(){var e=(0,u.default)((function*(e,t){return yield this.keychain.set(e,t),e}));return function(t,r){return e.apply(this,arguments)}}(),t.getPrivateKey=function(e){return this.keychain.get(e)},t.getClientSeed=function(){var e=(0,u.default)((function*(){var e="";try{e=this.keychain.get(kr)}catch(t){e=Z(),yield this.keychain.set(kr,e)}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",r=Or[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):wr(globalThis.Buffer.from(e,"utf-8"))}(e,"base16")}));return function(){return e.apply(this,arguments)}}(),t.getSymKey=function(e){return this.keychain.get(e)},t.isInitialized=function(){if(!this.initialized){var e=Le("NOT_INITIALIZED",this.name).message;throw new Error(e)}},(0,l.default)(e,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}}]),e}(),En=function(e){(0,o.default)(r,e);var t=Je(r);function r(e,r){var n;return(n=t.call(this,e,r)).logger=e,n.core=r,n.messages=new Map,n.name=jr,n.version=Br,n.initialized=!1,n.storagePrefix=Nr,n.init=(0,u.default)((function*(){if(!n.initialized){n.logger.trace("Initialized");try{var e=yield n.getRelayerMessages();typeof e<"u"&&(n.messages=e),n.logger.debug(`Successfully Restored records for ${n.name}`),n.logger.trace({type:"method",method:"restore",size:n.messages.size})}catch(e){n.logger.debug(`Failed to Restore records for ${n.name}`),n.logger.error(e)}finally{n.initialized=!0}}})),n.set=function(){var e=(0,u.default)((function*(e,t){n.isInitialized();var r=X(t),i=n.messages.get(e);return typeof i>"u"&&(i={}),typeof i[r]<"u"||(i[r]=t,n.messages.set(e,i),yield n.persist()),r}));return function(t,r){return e.apply(this,arguments)}}(),n.get=function(e){n.isInitialized();var t=n.messages.get(e);return typeof t>"u"&&(t={}),t},n.has=function(e,t){return n.isInitialized(),typeof n.get(e)[X(t)]<"u"},n.del=function(){var e=(0,u.default)((function*(e){n.isInitialized(),n.messages.delete(e),yield n.persist()}));return function(t){return e.apply(this,arguments)}}(),n.logger=(0,g.generateChildLogger)(e,n.name),n.core=r,n}var n=r.prototype;return n.setRelayerMessages=function(){var e=(0,u.default)((function*(e){yield this.core.storage.setItem(this.storageKey,be(e))}));return function(t){return e.apply(this,arguments)}}(),n.getRelayerMessages=function(){var e=(0,u.default)((function*(){var e=yield this.core.storage.getItem(this.storageKey);return typeof e<"u"?Ee(e):void 0}));return function(){return e.apply(this,arguments)}}(),n.persist=function(){var e=(0,u.default)((function*(){yield this.setRelayerMessages(this.messages)}));return function(){return e.apply(this,arguments)}}(),n.isInitialized=function(){if(!this.initialized){var e=Le("NOT_INITIALIZED",this.name).message;throw new Error(e)}},(0,l.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+"//"+this.name}}]),r}(E),_n=function(e){(0,o.default)(r,e);var t=Je(r);function r(e,r){var n;return(n=t.call(this,e,r)).relayer=e,n.logger=r,n.events=new h.EventEmitter,n.name=Vr,n.queue=new Map,n.publishTimeout=1e4,n.publish=function(){var e=(0,u.default)((function*(e,t,r){n.logger.debug("Publishing Payload"),n.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:r}});try{var i=(null==r?void 0:r.ttl)||qr,o=Oe(r),s=(null==r?void 0:r.prompt)||!1,a=(null==r?void 0:r.tag)||0,u={topic:e,message:t,opts:{ttl:i,relay:o,prompt:s,tag:a}},c=X(t);n.queue.set(c,u);try{yield yield _e(n.rpcPublish(e,t,i,o,s,a),n.publishTimeout),n.relayer.events.emit(Hr.publish,u)}catch(l){return n.logger.debug("Publishing Payload stalled"),void n.relayer.events.emit(Hr.connection_stalled)}n.onPublish(c,u),n.logger.debug("Successfully Published Payload"),n.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:r}})}catch(i){throw n.logger.debug("Failed to Publish Payload"),n.logger.error(i),i}}));return function(t,r,n){return e.apply(this,arguments)}}(),n.on=function(e,t){n.events.on(e,t)},n.once=function(e,t){n.events.once(e,t)},n.off=function(e,t){n.events.off(e,t)},n.removeListener=function(e,t){n.events.removeListener(e,t)},n.relayer=e,n.logger=(0,g.generateChildLogger)(r,n.name),n.registerEventListeners(),n}var n=r.prototype;return n.rpcPublish=function(e,t,r,n,i,o){var s,a,u,c,l={method:Me(n.protocol).publish,params:{topic:e,message:t,ttl:r,prompt:i,tag:o}};return qe(null==(s=l.params)?void 0:s.prompt)&&(null==(a=l.params)||delete a.prompt),qe(null==(u=l.params)?void 0:u.tag)&&(null==(c=l.params)||delete c.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:l}),this.relayer.request(l)},n.onPublish=function(e,t){this.queue.delete(e)},n.checkQueue=function(){var e=this;this.queue.forEach(function(){var t=(0,u.default)((function*(t){var r=t.topic,n=t.message,i=t.opts;yield e.publish(r,n,i)}));return function(e){return t.apply(this,arguments)}}())},n.registerEventListeners=function(){var e=this;this.relayer.core.heartbeat.on(p.HEARTBEAT_EVENTS.pulse,(function(){e.checkQueue()}))},(0,l.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}}]),r}(_),wn=function(){function e(){var e=this;this.map=new Map,this.set=function(t,r){var n=e.get(t);e.exists(t,r)||e.map.set(t,[].concat((0,i.default)(n),[r]))},this.get=function(t){return e.map.get(t)||[]},this.exists=function(t,r){return e.get(t).includes(r)},this.delete=function(t,r){if(typeof r>"u")e.map.delete(t);else if(e.map.has(t)){var n=e.get(t);if(e.exists(t,r)){var i=n.filter((function(e){return e!==r}));i.length?e.map.set(t,i):e.map.delete(t)}}},this.clear=function(){e.map.clear()}}return(0,l.default)(e,[{key:"topics",get:function(){return Array.from(this.map.keys())}}]),e}(),Sn=Object.defineProperty,In=Object.defineProperties,Rn=Object.getOwnPropertyDescriptors,On=Object.getOwnPropertySymbols,Mn=Object.prototype.hasOwnProperty,Tn=Object.prototype.propertyIsEnumerable,Pn=function(e,t,r){return t in e?Sn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Nn=function(e,t){for(var r in t||(t={}))Mn.call(t,r)&&Pn(e,r,t[r]);if(On)for(var r of On(t))Tn.call(t,r)&&Pn(e,r,t[r]);return e},xn=function(e,t){return In(e,Rn(t))},An=function(e){(0,o.default)(r,e);var t=Je(r);function r(e,r){var n;return(n=t.call(this,e,r)).relayer=e,n.logger=r,n.subscriptions=new Map,n.topicMap=new wn,n.events=new h.EventEmitter,n.name=tn,n.version=rn,n.pending=new Map,n.cached=[],n.initialized=!1,n.pendingSubscriptionWatchLabel="pending_sub_watch_label",n.pollingInterval=20,n.storagePrefix=Nr,n.subscribeTimeout=1e4,n.restartInProgress=!1,n.batchSubscribeTopicsLimit=500,n.init=(0,u.default)((function*(){n.initialized||(n.logger.trace("Initialized"),yield n.restart(),n.registerEventListeners(),n.onEnable(),n.clientId=yield n.relayer.core.crypto.getClientId())})),n.subscribe=function(){var e=(0,u.default)((function*(e,t){yield n.restartToComplete(),n.isInitialized(),n.logger.debug("Subscribing Topic"),n.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{var r=Oe(t),i={topic:e,relay:r};n.pending.set(e,i);var o=yield n.rpcSubscribe(e,r);return n.onSubscribe(o,i),n.logger.debug("Successfully Subscribed Topic"),n.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}}),o}catch(r){throw n.logger.debug("Failed to Subscribe Topic"),n.logger.error(r),r}}));return function(t,r){return e.apply(this,arguments)}}(),n.unsubscribe=function(){var e=(0,u.default)((function*(e,t){yield n.restartToComplete(),n.isInitialized(),typeof(null==t?void 0:t.id)<"u"?yield n.unsubscribeById(e,t.id,t):yield n.unsubscribeByTopic(e,t)}));return function(t,r){return e.apply(this,arguments)}}(),n.isSubscribed=function(){var e=(0,u.default)((function*(e){return!!n.topics.includes(e)||(yield new Promise((function(t,r){var i=new L.Watch;i.start(n.pendingSubscriptionWatchLabel);var o=setInterval((function(){!n.pending.has(e)&&n.topics.includes(e)&&(clearInterval(o),i.stop(n.pendingSubscriptionWatchLabel),t(!0)),i.elapsed(n.pendingSubscriptionWatchLabel)>=nn&&(clearInterval(o),i.stop(n.pendingSubscriptionWatchLabel),r(!1))}),n.pollingInterval)})))}));return function(t){return e.apply(this,arguments)}}(),n.on=function(e,t){n.events.on(e,t)},n.once=function(e,t){n.events.once(e,t)},n.off=function(e,t){n.events.off(e,t)},n.removeListener=function(e,t){n.events.removeListener(e,t)},n.restart=(0,u.default)((function*(){n.restartInProgress=!0,yield n.restore(),yield n.reset(),n.restartInProgress=!1})),n.relayer=e,n.logger=(0,g.generateChildLogger)(r,n.name),n.clientId="",n}var n=r.prototype;return n.hasSubscription=function(e,t){var r=!1;try{r=this.getSubscription(e).topic===t}catch(n){}return r},n.onEnable=function(){this.cached=[],this.initialized=!0},n.onDisable=function(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()},n.unsubscribeByTopic=function(){var e=(0,u.default)((function*(e,t){var r=this,n=this.topicMap.get(e);yield Promise.all(n.map(function(){var n=(0,u.default)((function*(n){return yield r.unsubscribeById(e,n,t)}));return function(e){return n.apply(this,arguments)}}()))}));return function(t,r){return e.apply(this,arguments)}}(),n.unsubscribeById=function(){var e=(0,u.default)((function*(e,t,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{var n=Oe(r);yield this.rpcUnsubscribe(e,t,n);var i=je("USER_DISCONNECTED",`${this.name}, ${e}`);yield this.onUnsubscribe(e,t,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}));return function(t,r,n){return e.apply(this,arguments)}}(),n.rpcSubscribe=function(){var e=(0,u.default)((function*(e,t){var r={method:Me(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{yield yield _e(this.relayer.request(r),this.subscribeTimeout)}catch(n){this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Hr.connection_stalled)}return X(e+this.clientId)}));return function(t,r){return e.apply(this,arguments)}}(),n.rpcBatchSubscribe=function(){var e=(0,u.default)((function*(e){if(e.length){var t={method:Me(e[0].relay.protocol).batchSubscribe,params:{topics:e.map((function(e){return e.topic}))}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{return yield yield _e(this.relayer.request(t),this.subscribeTimeout)}catch(r){this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Hr.connection_stalled)}}}));return function(t){return e.apply(this,arguments)}}(),n.rpcUnsubscribe=function(e,t,r){var n={method:Me(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)},n.onSubscribe=function(e,t){this.setSubscription(e,xn(Nn({},t),{id:e})),this.pending.delete(t.topic)},n.onBatchSubscribe=function(e){var t=this;e.length&&e.forEach((function(e){t.setSubscription(e.id,Nn({},e)),t.pending.delete(e.topic)}))},n.onUnsubscribe=function(){var e=(0,u.default)((function*(e,t,r){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,r),yield this.relayer.messages.del(e)}));return function(t,r,n){return e.apply(this,arguments)}}(),n.setRelayerSubscriptions=function(){var e=(0,u.default)((function*(e){yield this.relayer.core.storage.setItem(this.storageKey,e)}));return function(t){return e.apply(this,arguments)}}(),n.getRelayerSubscriptions=function(){var e=(0,u.default)((function*(){return yield this.relayer.core.storage.getItem(this.storageKey)}));return function(){return e.apply(this,arguments)}}(),n.setSubscription=function(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))},n.addSubscription=function(e,t){this.subscriptions.set(e,Nn({},t)),this.topicMap.set(t.topic,e),this.events.emit(Qr.created,t)},n.getSubscription=function(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});var t=this.subscriptions.get(e);if(!t){var r=Le("NO_MATCHING_KEY",`${this.name}: ${e}`).message;throw new Error(r)}return t},n.deleteSubscription=function(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});var r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(Qr.deleted,xn(Nn({},r),{reason:t}))},n.persist=function(){var e=(0,u.default)((function*(){yield this.setRelayerSubscriptions(this.values),this.events.emit(Qr.sync)}));return function(){return e.apply(this,arguments)}}(),n.reset=function(){var e=(0,u.default)((function*(){if(this.cached.length)for(var e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit),t=0;t<e;t++){var r=this.cached.splice(0,this.batchSubscribeTopicsLimit);yield this.batchSubscribe(r)}this.events.emit(Qr.resubscribed)}));return function(){return e.apply(this,arguments)}}(),n.restore=function(){var e=(0,u.default)((function*(){try{var e=yield this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){var t=Le("RESTORE_WILL_OVERRIDE",this.name).message;throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}));return function(){return e.apply(this,arguments)}}(),n.batchSubscribe=function(){var e=(0,u.default)((function*(e){if(e.length){var t=yield this.rpcBatchSubscribe(e);Be(t)&&this.onBatchSubscribe(t.map((function(t,r){return xn(Nn({},e[r]),{id:t})})))}}));return function(t){return e.apply(this,arguments)}}(),n.onConnect=function(){var e=(0,u.default)((function*(){this.restartInProgress||(yield this.restart(),this.onEnable())}));return function(){return e.apply(this,arguments)}}(),n.onDisconnect=function(){this.onDisable()},n.checkPending=function(){var e=(0,u.default)((function*(){if(!this.relayer.transportExplicitlyClosed){var e=[];this.pending.forEach((function(t){e.push(t)})),yield this.batchSubscribe(e)}}));return function(){return e.apply(this,arguments)}}(),n.registerEventListeners=function(){var e=this;this.relayer.core.heartbeat.on(p.HEARTBEAT_EVENTS.pulse,(0,u.default)((function*(){yield e.checkPending()}))),this.relayer.on(Hr.connect,(0,u.default)((function*(){yield e.onConnect()}))),this.relayer.on(Hr.disconnect,(function(){e.onDisconnect()})),this.events.on(Qr.created,function(){var t=(0,u.default)((function*(t){var r=Qr.created;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,data:t}),yield e.persist()}));return function(e){return t.apply(this,arguments)}}()),this.events.on(Qr.deleted,function(){var t=(0,u.default)((function*(t){var r=Qr.deleted;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,data:t}),yield e.persist()}));return function(e){return t.apply(this,arguments)}}())},n.isInitialized=function(){if(!this.initialized){var e=Le("NOT_INITIALIZED",this.name).message;throw new Error(e)}},n.restartToComplete=function(){var e=(0,u.default)((function*(){var e=this;this.restartInProgress&&(yield new Promise((function(t){var r=setInterval((function(){e.restartInProgress||(clearInterval(r),t())}),e.pollingInterval)})))}));return function(){return e.apply(this,arguments)}}(),(0,l.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+"//"+this.name}},{key:"length",get:function(){return this.subscriptions.size}},{key:"ids",get:function(){return Array.from(this.subscriptions.keys())}},{key:"values",get:function(){return Array.from(this.subscriptions.values())}},{key:"topics",get:function(){return this.topicMap.topics}}]),r}(I),Cn=Object.defineProperty,kn=Object.getOwnPropertySymbols,Dn=Object.prototype.hasOwnProperty,Un=Object.prototype.propertyIsEnumerable,Ln=function(e,t,r){return t in e?Cn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},jn=function(e){(0,o.default)(r,e);var t=Je(r);function r(e){var r;return(r=t.call(this,e)).protocol="wc",r.version=2,r.events=new h.EventEmitter,r.name=Wr,r.transportExplicitlyClosed=!1,r.initialized=!1,r.reconnecting=!1,r.connectionStatusPollingInterval=20,r.staleConnectionErrors=["socket hang up","socket stalled"],r.request=function(){var e=(0,u.default)((function*(e){r.logger.debug("Publishing Request Payload");try{return yield r.toEstablishConnection(),yield r.provider.request(e)}catch(t){throw r.logger.debug("Failed to Publish Request"),r.logger.error(t),t}}));return function(t){return e.apply(this,arguments)}}(),r.core=e.core,r.logger=typeof e.logger<"u"&&"string"!=typeof e.logger?(0,g.generateChildLogger)(e.logger,r.name):(0,g.pino)((0,g.getDefaultLoggerOptions)({level:e.logger||$r})),r.messages=new En(r.logger,e.core),r.subscriber=new An((0,n.default)(r),r.logger),r.publisher=new _n((0,n.default)(r),r.logger),r.relayUrl=(null==e?void 0:e.relayUrl)||Kr,r.projectId=e.projectId,r.provider={},r}var i=r.prototype;return i.init=function(){var e=(0,u.default)((function*(){this.logger.trace("Initialized"),yield this.createProvider(),yield Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}));return function(){return e.apply(this,arguments)}}(),i.publish=function(){var e=(0,u.default)((function*(e,t,r){this.isInitialized(),yield this.publisher.publish(e,t,r),yield this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}));return function(t,r,n){return e.apply(this,arguments)}}(),i.subscribe=function(){var e=(0,u.default)((function*(e,t){var r=this;this.isInitialized();var n="";return yield Promise.all([new Promise((function(t){r.subscriber.once(Qr.created,(function(r){r.topic===e&&t()}))})),new Promise(function(){var i=(0,u.default)((function*(i){n=yield r.subscriber.subscribe(e,t),i()}));return function(e){return i.apply(this,arguments)}}())]),n}));return function(t,r){return e.apply(this,arguments)}}(),i.unsubscribe=function(){var e=(0,u.default)((function*(e,t){this.isInitialized(),yield this.subscriber.unsubscribe(e,t)}));return function(t,r){return e.apply(this,arguments)}}(),i.on=function(e,t){this.events.on(e,t)},i.once=function(e,t){this.events.once(e,t)},i.off=function(e,t){this.events.off(e,t)},i.removeListener=function(e,t){this.events.removeListener(e,t)},i.transportClose=function(){var e=(0,u.default)((function*(){this.transportExplicitlyClosed=!0,this.connected&&(yield this.provider.disconnect(),this.events.emit(Hr.transport_closed))}));return function(){return e.apply(this,arguments)}}(),i.transportOpen=function(){var e=(0,u.default)((function*(e){var t=this;if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=e||this.relayUrl,this.reconnecting=!0;try{yield Promise.all([new Promise((function(e){t.initialized||e(),t.subscriber.once(Qr.resubscribed,(function(){e()}))})),yield Promise.race([new Promise(function(){var e=(0,u.default)((function*(e,r){yield _e(t.provider.connect(),5e3,"socket stalled").catch((function(e){return r(e)})).then((function(){return e()})).finally((function(){return t.removeListener(Hr.transport_closed,t.rejectTransportOpen)}))}));return function(t,r){return e.apply(this,arguments)}}()),new Promise((function(e){return t.once(Hr.transport_closed,t.rejectTransportOpen)}))])])}catch(n){this.logger.error(n);var r=n;if(!this.isConnectionStalled(r.message))throw n;this.events.emit(Hr.transport_closed)}finally{this.reconnecting=!1}}}));return function(t){return e.apply(this,arguments)}}(),i.restartTransport=function(){var e=(0,u.default)((function*(e){var t=this;this.transportExplicitlyClosed||(this.relayUrl=e||this.relayUrl,this.connected&&(yield Promise.all([new Promise((function(e){t.provider.once(Jr.disconnect,(function(){e()}))})),this.transportClose()])),yield this.createProvider(),yield this.transportOpen())}));return function(t){return e.apply(this,arguments)}}(),i.isConnectionStalled=function(e){return this.staleConnectionErrors.some((function(t){return e.includes(t)}))},i.rejectTransportOpen=function(){throw new Error("closeTransport called before connection was established")},i.createProvider=function(){var e=(0,u.default)((function*(){var e=yield this.core.crypto.signJWT(this.relayUrl);this.provider=new $e.JsonRpcProvider(new We.default(me({sdkVersion:Zr,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}));return function(){return e.apply(this,arguments)}}(),i.recordMessageEvent=function(){var e=(0,u.default)((function*(e){var t=e.topic,r=e.message;yield this.messages.set(t,r)}));return function(t){return e.apply(this,arguments)}}(),i.shouldIgnoreMessageEvent=function(){var e=(0,u.default)((function*(e){var t=e.topic,r=e.message;return!(yield this.subscriber.isSubscribed(t))||this.messages.has(t,r)}));return function(t){return e.apply(this,arguments)}}(),i.onProviderPayload=function(){var e=(0,u.default)((function*(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),(0,Ke.isJsonRpcRequest)(e)){if(!e.method.endsWith(Fr))return;var t=e.params,r=t.data,n={topic:r.topic,message:r.message,publishedAt:r.publishedAt};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(function(e,t){for(var r in t||(t={}))Dn.call(t,r)&&Ln(e,r,t[r]);if(kn)for(var r of kn(t))Un.call(t,r)&&Ln(e,r,t[r]);return e}({type:"event",event:t.id},n)),this.events.emit(t.id,n),yield this.acknowledgePayload(e),yield this.onMessageEvent(n)}}));return function(t){return e.apply(this,arguments)}}(),i.onMessageEvent=function(){var e=(0,u.default)((function*(e){(yield this.shouldIgnoreMessageEvent(e))||(this.events.emit(Hr.message,e),yield this.recordMessageEvent(e))}));return function(t){return e.apply(this,arguments)}}(),i.acknowledgePayload=function(){var e=(0,u.default)((function*(e){var t=(0,Ke.formatJsonRpcResult)(e.id,!0);yield this.provider.connection.send(t)}));return function(t){return e.apply(this,arguments)}}(),i.registerProviderListeners=function(){var e=this;this.provider.on(Jr.payload,(function(t){return e.onProviderPayload(t)})),this.provider.on(Jr.connect,(function(){e.events.emit(Hr.connect)})),this.provider.on(Jr.disconnect,(function(){e.onProviderDisconnect()})),this.provider.on(Jr.error,(function(t){e.logger.error(t),e.events.emit(Hr.error,t)}))},i.registerEventListeners=function(){var e=this;this.events.on(Hr.connection_stalled,(0,u.default)((function*(){yield e.restartTransport()})))},i.onProviderDisconnect=function(){this.events.emit(Hr.disconnect),this.attemptToReconnect()},i.attemptToReconnect=function(){var e=this;this.transportExplicitlyClosed||setTimeout((0,u.default)((function*(){yield e.restartTransport()})),(0,L.toMiliseconds)(Gr))},i.isInitialized=function(){if(!this.initialized){var e=Le("NOT_INITIALIZED",this.name).message;throw new Error(e)}},i.toEstablishConnection=function(){var e=(0,u.default)((function*(){var e=this;if(!this.connected){if(this.connecting)return yield new Promise((function(t){var r=setInterval((function(){e.connected&&(clearInterval(r),t())}),e.connectionStatusPollingInterval)}));yield this.restartTransport()}}));return function(){return e.apply(this,arguments)}}(),(0,l.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"connected",get:function(){return this.provider.connection.connected}},{key:"connecting",get:function(){return this.provider.connection.connecting}}]),r}(w),Bn=Object.defineProperty,qn=Object.getOwnPropertySymbols,Vn=Object.prototype.hasOwnProperty,zn=Object.prototype.propertyIsEnumerable,$n=function(e,t,r){return t in e?Bn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Kn=function(e,t){for(var r in t||(t={}))Vn.call(t,r)&&$n(e,r,t[r]);if(qn)for(var r of qn(t))zn.call(t,r)&&$n(e,r,t[r]);return e},Wn=function(e){(0,o.default)(r,e);var t=Je(r);function r(e,r,n){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Nr,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;return(i=t.call(this,e,r,n,o)).core=e,i.logger=r,i.name=n,i.map=new Map,i.version=Xr,i.cached=[],i.initialized=!1,i.storagePrefix=Nr,i.init=(0,u.default)((function*(){i.initialized||(i.logger.trace("Initialized"),yield i.restore(),i.cached.forEach((function(e){i.getKey&&null!==e&&!qe(e)?i.map.set(i.getKey(e),e):function(e){var t;return null==(t=null==e?void 0:e.proposer)?void 0:t.publicKey}(e)?i.map.set(e.id,e):function(e){return null==e?void 0:e.topic}(e)&&i.map.set(e.topic,e)})),i.cached=[],i.initialized=!0)})),i.set=function(){var e=(0,u.default)((function*(e,t){i.isInitialized(),i.map.has(e)?yield i.update(e,t):(i.logger.debug("Setting value"),i.logger.trace({type:"method",method:"set",key:e,value:t}),i.map.set(e,t),yield i.persist())}));return function(t,r){return e.apply(this,arguments)}}(),i.get=function(e){return i.isInitialized(),i.logger.debug("Getting value"),i.logger.trace({type:"method",method:"get",key:e}),i.getData(e)},i.getAll=function(e){return i.isInitialized(),e?i.values.filter((function(t){return Object.keys(e).every((function(r){return Fe()(t[r],e[r])}))})):i.values},i.update=function(){var e=(0,u.default)((function*(e,t){i.isInitialized(),i.logger.debug("Updating value"),i.logger.trace({type:"method",method:"update",key:e,update:t});var r=Kn(Kn({},i.getData(e)),t);i.map.set(e,r),yield i.persist()}));return function(t,r){return e.apply(this,arguments)}}(),i.delete=function(){var e=(0,u.default)((function*(e,t){i.isInitialized(),i.map.has(e)&&(i.logger.debug("Deleting value"),i.logger.trace({type:"method",method:"delete",key:e,reason:t}),i.map.delete(e),yield i.persist())}));return function(t,r){return e.apply(this,arguments)}}(),i.logger=(0,g.generateChildLogger)(r,i.name),i.storagePrefix=o,i.getKey=s,i}var n=r.prototype;return n.setDataStore=function(){var e=(0,u.default)((function*(e){yield this.core.storage.setItem(this.storageKey,e)}));return function(t){return e.apply(this,arguments)}}(),n.getDataStore=function(){var e=(0,u.default)((function*(){return yield this.core.storage.getItem(this.storageKey)}));return function(){return e.apply(this,arguments)}}(),n.getData=function(e){var t=this.map.get(e);if(!t){var r=Le("NO_MATCHING_KEY",`${this.name}: ${e}`).message;throw this.logger.error(r),new Error(r)}return t},n.persist=function(){var e=(0,u.default)((function*(){yield this.setDataStore(this.values)}));return function(){return e.apply(this,arguments)}}(),n.restore=function(){var e=(0,u.default)((function*(){try{var e=yield this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){var t=Le("RESTORE_WILL_OVERRIDE",this.name).message;throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}));return function(){return e.apply(this,arguments)}}(),n.isInitialized=function(){if(!this.initialized){var e=Le("NOT_INITIALIZED",this.name).message;throw new Error(e)}},(0,l.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+"//"+this.name}},{key:"length",get:function(){return this.map.size}},{key:"keys",get:function(){return Array.from(this.map.keys())}},{key:"values",get:function(){return Array.from(this.map.values())}}]),r}(S),Hn=function(){function e(e,t){var r=this;this.core=e,this.logger=t,this.name=on,this.version=sn,this.events=new(f()),this.initialized=!1,this.storagePrefix=Nr,this.ignoredPayloadTypes=[H],this.registeredMethods=[],this.init=(0,u.default)((function*(){r.initialized||(yield r.pairings.init(),yield r.cleanup(),r.registerRelayerEvents(),r.registerExpirerEvents(),r.initialized=!0,r.logger.trace("Initialized"))})),this.register=function(e){var t=e.methods;r.isInitialized(),r.registeredMethods=(0,i.default)(new Set([].concat((0,i.default)(r.registeredMethods),(0,i.default)(t))))},this.create=(0,u.default)((function*(){r.isInitialized();var e=Z(),t=yield r.core.crypto.setSymKey(e),n=Se(L.FIVE_MINUTES),i={protocol:zr},o={topic:t,expiry:n,relay:i,active:!1},s=ke({protocol:r.core.protocol,version:r.core.version,topic:t,symKey:e,relay:i});return yield r.pairings.set(t,o),yield r.core.relayer.subscribe(t),r.core.expirer.set(t,n),{topic:t,uri:s}})),this.pair=function(){var e=(0,u.default)((function*(e){r.isInitialized(),r.isValidPair(e);var t=function(e){var t=e.indexOf(":"),r=-1!==e.indexOf("?")?e.indexOf("?"):void 0,n=e.substring(0,t),i=e.substring(t+1,r).split("@"),o=typeof r<"u"?e.substring(r):"",s=B.parse(o);return{protocol:n,topic:i[0],version:parseInt(i[1],10),symKey:s.symKey,relay:Ce(s)}}(e.uri),n=t.topic,i=t.symKey,o=t.relay;if(r.pairings.keys.includes(n))throw new Error(`Pairing already exists: ${n}`);if(r.core.crypto.hasKeys(n))throw new Error(`Keychain already exists: ${n}`);var s=Se(L.FIVE_MINUTES),a={topic:n,relay:o,expiry:s,active:!1};return yield r.pairings.set(n,a),yield r.core.crypto.setSymKey(i,n),yield r.core.relayer.subscribe(n,{relay:o}),r.core.expirer.set(n,s),e.activatePairing&&(yield r.activate({topic:n})),a}));return function(t){return e.apply(this,arguments)}}(),this.activate=function(){var e=(0,u.default)((function*(e){var t=e.topic;r.isInitialized();var n=Se(L.THIRTY_DAYS);yield r.pairings.update(t,{active:!0,expiry:n}),r.core.expirer.set(t,n)}));return function(t){return e.apply(this,arguments)}}(),this.ping=function(){var e=(0,u.default)((function*(e){r.isInitialized(),yield r.isValidPing(e);var t=e.topic;if(r.pairings.keys.includes(t)){var n=yield r.sendRequest(t,"wc_pairingPing",{}),i=function(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L.FIVE_MINUTES,i=arguments.length>1?arguments[1]:void 0,o=(0,L.toMiliseconds)(n||L.FIVE_MINUTES);return{resolve:function(t){r&&e&&(clearTimeout(r),e(t))},reject:function(e){r&&t&&(clearTimeout(r),t(e))},done:function(){return new Promise((function(n,s){r=setTimeout((function(){s(new Error(i))}),o),e=n,t=s}))}}}(),o=i.done,s=i.resolve,a=i.reject;r.events.once(Re("pairing_ping",n),(function(e){var t=e.error;t?a(t):s()})),yield o()}}));return function(t){return e.apply(this,arguments)}}(),this.updateExpiry=function(){var e=(0,u.default)((function*(e){var t=e.topic,n=e.expiry;r.isInitialized(),yield r.pairings.update(t,{expiry:n})}));return function(t){return e.apply(this,arguments)}}(),this.updateMetadata=function(){var e=(0,u.default)((function*(e){var t=e.topic,n=e.metadata;r.isInitialized(),yield r.pairings.update(t,{peerMetadata:n})}));return function(t){return e.apply(this,arguments)}}(),this.getPairings=function(){return r.isInitialized(),r.pairings.values},this.disconnect=function(){var e=(0,u.default)((function*(e){r.isInitialized(),yield r.isValidDisconnect(e);var t=e.topic;r.pairings.keys.includes(t)&&(yield r.sendRequest(t,"wc_pairingDelete",je("USER_DISCONNECTED")),yield r.deletePairing(t))}));return function(t){return e.apply(this,arguments)}}(),this.sendRequest=function(){var e=(0,u.default)((function*(e,t,n){var i=(0,Ke.formatJsonRpcRequest)(t,n),o=yield r.core.crypto.encode(e,i),s=un[t].req;return r.core.history.set(e,i),yield r.core.relayer.publish(e,o,s),i.id}));return function(t,r,n){return e.apply(this,arguments)}}(),this.sendResult=function(){var e=(0,u.default)((function*(e,t,n){var i=(0,Ke.formatJsonRpcResult)(e,n),o=yield r.core.crypto.encode(t,i),s=yield r.core.history.get(t,e),a=un[s.request.method].res;yield r.core.relayer.publish(t,o,a),yield r.core.history.resolve(i)}));return function(t,r,n){return e.apply(this,arguments)}}(),this.sendError=function(){var e=(0,u.default)((function*(e,t,n){var i=(0,Ke.formatJsonRpcError)(e,n),o=yield r.core.crypto.encode(t,i),s=yield r.core.history.get(t,e),a=un[s.request.method]?un[s.request.method].res:un.unregistered_method.res;yield r.core.relayer.publish(t,o,a),yield r.core.history.resolve(i)}));return function(t,r,n){return e.apply(this,arguments)}}(),this.deletePairing=function(){var e=(0,u.default)((function*(e,t){yield r.core.relayer.unsubscribe(e),yield Promise.all([r.pairings.delete(e,je("USER_DISCONNECTED")),r.core.crypto.deleteSymKey(e),t?Promise.resolve():r.core.expirer.del(e)])}));return function(t,r){return e.apply(this,arguments)}}(),this.cleanup=(0,u.default)((function*(){var e=r.pairings.getAll().filter((function(e){return Ie(e.expiry)}));yield Promise.all(e.map((function(e){return r.deletePairing(e.topic)})))})),this.onRelayEventRequest=function(e){var t=e.topic,n=e.payload,i=n.method;if(r.pairings.keys.includes(t))switch(i){case"wc_pairingPing":return r.onPairingPingRequest(t,n);case"wc_pairingDelete":return r.onPairingDeleteRequest(t,n);default:return r.onUnknownRpcMethodRequest(t,n)}},this.onRelayEventResponse=function(){var e=(0,u.default)((function*(e){var t=e.topic,n=e.payload,i=(yield r.core.history.get(t,n.id)).request.method;if(r.pairings.keys.includes(t)){if("wc_pairingPing"===i)return r.onPairingPingResponse(t,n);return r.onUnknownRpcMethodResponse(i)}}));return function(t){return e.apply(this,arguments)}}(),this.onPairingPingRequest=function(){var e=(0,u.default)((function*(e,t){var n=t.id;try{r.isValidPing({topic:e}),yield r.sendResult(n,e,!0),r.events.emit("pairing_ping",{id:n,topic:e})}catch(E){yield r.sendError(n,e,E),r.logger.error(E)}}));return function(t,r){return e.apply(this,arguments)}}(),this.onPairingPingResponse=function(e,t){var n=t.id;setTimeout((function(){(0,Ke.isJsonRpcResult)(t)?r.events.emit(Re("pairing_ping",n),{}):(0,Ke.isJsonRpcError)(t)&&r.events.emit(Re("pairing_ping",n),{error:t.error})}),500)},this.onPairingDeleteRequest=function(){var e=(0,u.default)((function*(e,t){var n=t.id;try{r.isValidDisconnect({topic:e}),yield r.deletePairing(e),r.events.emit("pairing_delete",{id:n,topic:e})}catch(E){yield r.sendError(n,e,E),r.logger.error(E)}}));return function(t,r){return e.apply(this,arguments)}}(),this.onUnknownRpcMethodRequest=function(){var e=(0,u.default)((function*(e,t){var n=t.id,i=t.method;try{if(r.registeredMethods.includes(i))return;var o=je("WC_METHOD_UNSUPPORTED",i);yield r.sendError(n,e,o),r.logger.error(o)}catch(o){yield r.sendError(n,e,o),r.logger.error(o)}}));return function(t,r){return e.apply(this,arguments)}}(),this.onUnknownRpcMethodResponse=function(e){r.registeredMethods.includes(e)||r.logger.error(je("WC_METHOD_UNSUPPORTED",e))},this.isValidPair=function(e){if(!ze(e)){var t=Le("MISSING_OR_INVALID",`pair() params: ${e}`).message;throw new Error(t)}if(!function(e){if(Ve(e,!1))try{return typeof new URL(e)<"u"}catch(t){return!1}return!1}(e.uri)){var r=Le("MISSING_OR_INVALID",`pair() uri: ${e.uri}`).message;throw new Error(r)}},this.isValidPing=function(){var e=(0,u.default)((function*(e){if(!ze(e)){var t=Le("MISSING_OR_INVALID",`ping() params: ${e}`).message;throw new Error(t)}var n=e.topic;yield r.isValidPairingTopic(n)}));return function(t){return e.apply(this,arguments)}}(),this.isValidDisconnect=function(){var e=(0,u.default)((function*(e){if(!ze(e)){var t=Le("MISSING_OR_INVALID",`disconnect() params: ${e}`).message;throw new Error(t)}var n=e.topic;yield r.isValidPairingTopic(n)}));return function(t){return e.apply(this,arguments)}}(),this.isValidPairingTopic=function(){var e=(0,u.default)((function*(e){if(!Ve(e,!1)){var t=Le("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`).message;throw new Error(t)}if(!r.pairings.keys.includes(e)){var n=Le("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`).message;throw new Error(n)}if(Ie(r.pairings.get(e).expiry)){yield r.deletePairing(e);var i=Le("EXPIRED",`pairing topic: ${e}`).message;throw new Error(i)}}));return function(t){return e.apply(this,arguments)}}(),this.core=e,this.logger=(0,g.generateChildLogger)(t,this.name),this.pairings=new Wn(this.core,this.logger,this.name,this.storagePrefix)}var t=e.prototype;return t.isInitialized=function(){if(!this.initialized){var e=Le("NOT_INITIALIZED",this.name).message;throw new Error(e)}},t.registerRelayerEvents=function(){var e=this;this.core.relayer.on(Hr.message,function(){var t=(0,u.default)((function*(t){var r=t.topic,n=t.message;if(!e.ignoredPayloadTypes.includes(e.core.crypto.getPayloadType(n))){var i=yield e.core.crypto.decode(r,n);(0,Ke.isJsonRpcRequest)(i)?(e.core.history.set(r,i),e.onRelayEventRequest({topic:r,payload:i})):(0,Ke.isJsonRpcResponse)(i)&&(yield e.core.history.resolve(i),e.onRelayEventResponse({topic:r,payload:i}))}}));return function(e){return t.apply(this,arguments)}}())},t.registerExpirerEvents=function(){var e=this;this.core.expirer.on(dn.expired,function(){var t=(0,u.default)((function*(t){var r=function(e){var t=e.split(":"),r=(0,P.default)(t,2),n=r[0],i=r[1],o={id:void 0,topic:void 0};if("topic"===n&&"string"==typeof i)o.topic=i;else{if("id"!==n||!Number.isInteger(Number(i)))throw new Error(`Invalid target, expected id:number or topic:string, got ${n}:${i}`);o.id=Number(i)}return o}(t.target),n=r.topic;n&&e.pairings.keys.includes(n)&&(yield e.deletePairing(n,!0),e.events.emit("pairing_expire",{topic:n}))}));return function(e){return t.apply(this,arguments)}}())},(0,l.default)(e,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}}]),e}(),Fn=function(e){(0,o.default)(r,e);var t=Je(r);function r(e,r){var n;return(n=t.call(this,e,r)).core=e,n.logger=r,n.records=new Map,n.events=new h.EventEmitter,n.name=ln,n.version=hn,n.cached=[],n.initialized=!1,n.storagePrefix=Nr,n.init=(0,u.default)((function*(){n.initialized||(n.logger.trace("Initialized"),yield n.restore(),n.cached.forEach((function(e){return n.records.set(e.id,e)})),n.cached=[],n.registerEventListeners(),n.initialized=!0)})),n.set=function(e,t,r){if(n.isInitialized(),n.logger.debug("Setting JSON-RPC request history record"),n.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:r}),!n.records.has(t.id)){var i={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:r};n.records.set(i.id,i),n.events.emit(cn.created,i)}},n.resolve=function(){var e=(0,u.default)((function*(e){if(n.isInitialized(),n.logger.debug("Updating JSON-RPC response history record"),n.logger.trace({type:"method",method:"update",response:e}),n.records.has(e.id)){var t=yield n.getRecord(e.id);typeof t.response>"u"&&(t.response=(0,Ke.isJsonRpcError)(e)?{error:e.error}:{result:e.result},n.records.set(t.id,t),n.events.emit(cn.updated,t))}}));return function(t){return e.apply(this,arguments)}}(),n.get=function(){var e=(0,u.default)((function*(e,t){return n.isInitialized(),n.logger.debug("Getting record"),n.logger.trace({type:"method",method:"get",topic:e,id:t}),yield n.getRecord(t)}));return function(t,r){return e.apply(this,arguments)}}(),n.delete=function(e,t){n.isInitialized(),n.logger.debug("Deleting record"),n.logger.trace({type:"method",method:"delete",id:t}),n.values.forEach((function(r){if(r.topic===e){if(typeof t<"u"&&r.id!==t)return;n.records.delete(r.id),n.events.emit(cn.deleted,r)}}))},n.exists=function(){var e=(0,u.default)((function*(e,t){return n.isInitialized(),!!n.records.has(t)&&(yield n.getRecord(t)).topic===e}));return function(t,r){return e.apply(this,arguments)}}(),n.on=function(e,t){n.events.on(e,t)},n.once=function(e,t){n.events.once(e,t)},n.off=function(e,t){n.events.off(e,t)},n.removeListener=function(e,t){n.events.removeListener(e,t)},n.logger=(0,g.generateChildLogger)(r,n.name),n}var n=r.prototype;return n.setJsonRpcRecords=function(){var e=(0,u.default)((function*(e){yield this.core.storage.setItem(this.storageKey,e)}));return function(t){return e.apply(this,arguments)}}(),n.getJsonRpcRecords=function(){var e=(0,u.default)((function*(){return yield this.core.storage.getItem(this.storageKey)}));return function(){return e.apply(this,arguments)}}(),n.getRecord=function(e){this.isInitialized();var t=this.records.get(e);if(!t){var r=Le("NO_MATCHING_KEY",`${this.name}: ${e}`).message;throw new Error(r)}return t},n.persist=function(){var e=(0,u.default)((function*(){yield this.setJsonRpcRecords(this.values),this.events.emit(cn.sync)}));return function(){return e.apply(this,arguments)}}(),n.restore=function(){var e=(0,u.default)((function*(){try{var e=yield this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){var t=Le("RESTORE_WILL_OVERRIDE",this.name).message;throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}));return function(){return e.apply(this,arguments)}}(),n.registerEventListeners=function(){var e=this;this.events.on(cn.created,(function(t){var r=cn.created;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,record:t}),e.persist()})),this.events.on(cn.updated,(function(t){var r=cn.updated;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,record:t}),e.persist()})),this.events.on(cn.deleted,(function(t){var r=cn.deleted;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,record:t}),e.persist()}))},n.isInitialized=function(){if(!this.initialized){var e=Le("NOT_INITIALIZED",this.name).message;throw new Error(e)}},(0,l.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+"//"+this.name}},{key:"size",get:function(){return this.records.size}},{key:"keys",get:function(){return Array.from(this.records.keys())}},{key:"values",get:function(){return Array.from(this.records.values())}},{key:"pending",get:function(){var e=[];return this.values.forEach((function(t){if(!(typeof t.response<"u")){var r={topic:t.topic,request:(0,Ke.formatJsonRpcRequest)(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)}})),e}}]),r}(b),Jn=function(e){(0,o.default)(r,e);var t=Je(r);function r(e,r){var n;return(n=t.call(this,e,r)).core=e,n.logger=r,n.expirations=new Map,n.events=new h.EventEmitter,n.name=fn,n.version=pn,n.cached=[],n.initialized=!1,n.storagePrefix=Nr,n.init=(0,u.default)((function*(){n.initialized||(n.logger.trace("Initialized"),yield n.restore(),n.cached.forEach((function(e){return n.expirations.set(e.target,e)})),n.cached=[],n.registerEventListeners(),n.initialized=!0)})),n.has=function(e){try{var t=n.formatTarget(e);return typeof n.getExpiration(t)<"u"}catch(r){return!1}},n.set=function(e,t){n.isInitialized();var r=n.formatTarget(e),i={target:r,expiry:t};n.expirations.set(r,i),n.checkExpiry(r,i),n.events.emit(dn.created,{target:r,expiration:i})},n.get=function(e){n.isInitialized();var t=n.formatTarget(e);return n.getExpiration(t)},n.del=function(e){if(n.isInitialized(),n.has(e)){var t=n.formatTarget(e),r=n.getExpiration(t);n.expirations.delete(t),n.events.emit(dn.deleted,{target:t,expiration:r})}},n.on=function(e,t){n.events.on(e,t)},n.once=function(e,t){n.events.once(e,t)},n.off=function(e,t){n.events.off(e,t)},n.removeListener=function(e,t){n.events.removeListener(e,t)},n.logger=(0,g.generateChildLogger)(r,n.name),n}var n=r.prototype;return n.formatTarget=function(e){if("string"==typeof e)return function(e){return we("topic",e)}(e);if("number"==typeof e)return function(e){return we("id",e)}(e);var t=Le("UNKNOWN_TYPE","Target type: "+typeof e).message;throw new Error(t)},n.setExpirations=function(){var e=(0,u.default)((function*(e){yield this.core.storage.setItem(this.storageKey,e)}));return function(t){return e.apply(this,arguments)}}(),n.getExpirations=function(){var e=(0,u.default)((function*(){return yield this.core.storage.getItem(this.storageKey)}));return function(){return e.apply(this,arguments)}}(),n.persist=function(){var e=(0,u.default)((function*(){yield this.setExpirations(this.values),this.events.emit(dn.sync)}));return function(){return e.apply(this,arguments)}}(),n.restore=function(){var e=(0,u.default)((function*(){try{var e=yield this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){var t=Le("RESTORE_WILL_OVERRIDE",this.name).message;throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}));return function(){return e.apply(this,arguments)}}(),n.getExpiration=function(e){var t=this.expirations.get(e);if(!t){var r=Le("NO_MATCHING_KEY",`${this.name}: ${e}`).message;throw this.logger.error(r),new Error(r)}return t},n.checkExpiry=function(e,t){var r=t.expiry;(0,L.toMiliseconds)(r)-Date.now()<=0&&this.expire(e,t)},n.expire=function(e,t){this.expirations.delete(e),this.events.emit(dn.expired,{target:e,expiration:t})},n.checkExpirations=function(){var e=this;this.core.relayer.connected&&this.expirations.forEach((function(t,r){return e.checkExpiry(r,t)}))},n.registerEventListeners=function(){var e=this;this.core.heartbeat.on(p.HEARTBEAT_EVENTS.pulse,(function(){return e.checkExpirations()})),this.events.on(dn.created,(function(t){var r=dn.created;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,data:t}),e.persist()})),this.events.on(dn.expired,(function(t){var r=dn.expired;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,data:t}),e.persist()})),this.events.on(dn.deleted,(function(t){var r=dn.deleted;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,data:t}),e.persist()}))},n.isInitialized=function(){if(!this.initialized){var e=Le("NOT_INITIALIZED",this.name).message;throw new Error(e)}},(0,l.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+"//"+this.name}},{key:"length",get:function(){return this.expirations.size}},{key:"keys",get:function(){return Array.from(this.expirations.keys())}},{key:"values",get:function(){return Array.from(this.expirations.values())}}]),r}(R),Gn=function(e){(0,o.default)(r,e);var t=Je(r);function r(e,r){var n;return(n=t.call(this,e,r)).projectId=e,n.logger=r,n.name=yn,n.initialized=!1,n.init=function(){var e=(0,u.default)((function*(e){pe()||!ge()||(n.verifyUrl=(null==e?void 0:e.verifyUrl)||vn,yield n.createIframe())}));return function(t){return e.apply(this,arguments)}}(),n.register=function(){var e=(0,u.default)((function*(e){var t;n.initialized||(yield n.init()),n.iframe&&(null==(t=n.iframe.contentWindow)||t.postMessage(e.attestationId,n.verifyUrl),n.logger.info(`postMessage sent: ${e.attestationId} ${n.verifyUrl}`))}));return function(t){return e.apply(this,arguments)}}(),n.resolve=function(){var e=(0,u.default)((function*(e){var t;if(n.isDevEnv)return"";n.logger.info(`resolving attestation: ${e.attestationId}`);var r=n.startAbortTimer(L.FIVE_SECONDS),i=yield fetch(`${n.verifyUrl}/attestation/${e.attestationId}`,{signal:n.abortController.signal});return clearTimeout(r),200===i.status?null==(t=yield i.json())?void 0:t.origin:""}));return function(t){return e.apply(this,arguments)}}(),n.createIframe=(0,u.default)((function*(){try{yield Promise.race([new Promise((function(e,t){if(document.getElementById(yn))return e();var r=document.createElement("iframe");r.setAttribute("id",yn),r.setAttribute("src",`${n.verifyUrl}/${n.projectId}`),r.style.display="none",r.addEventListener("load",(function(){n.initialized=!0,e()})),r.addEventListener("error",(function(e){t(e)})),document.body.append(r),n.iframe=r})),new Promise((function(e){setTimeout((function(){return e("iframe load timeout")}),(0,L.toMiliseconds)(L.ONE_SECOND/2))}))])}catch(e){n.logger.error(`Verify iframe failed to load: ${n.verifyUrl}`),n.logger.error(e)}})),n.logger=(0,g.generateChildLogger)(r,n.name),n.verifyUrl=vn,n.abortController=new AbortController,n.isDevEnv=de()&&{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"web-embed",slug:"web-embed",version:"0.0.1",web:{},description:"Multi-chain support for BTC/ETH/BNB/NEAR/Polygon/Solana/Avalanche/Fantom and others",sdkVersion:"49.0.0",platforms:["ios","android","web"]},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.IS_VITEST,n}return r.prototype.startAbortTimer=function(e){var t=this;return setTimeout((function(){return t.abortController.abort()}),(0,L.toMiliseconds)(e))},(0,l.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}}]),r}(O),Yn=Object.defineProperty,Zn=Object.getOwnPropertySymbols,Xn=Object.prototype.hasOwnProperty,Qn=Object.prototype.propertyIsEnumerable,ei=function(e,t,r){return t in e?Yn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},ti=function(e,t){for(var r in t||(t={}))Xn.call(t,r)&&ei(e,r,t[r]);if(Zn)for(var r of Zn(t))Qn.call(t,r)&&ei(e,r,t[r]);return e},ri=function(e){(0,o.default)(r,e);var t=Je(r);function r(e){var r;(r=t.call(this,e)).protocol=Mr,r.version=Tr,r.name=Pr,r.events=new h.EventEmitter,r.initialized=!1,r.on=function(e,t){return r.events.on(e,t)},r.once=function(e,t){return r.events.once(e,t)},r.off=function(e,t){return r.events.off(e,t)},r.removeListener=function(e,t){return r.events.removeListener(e,t)},r.projectId=null==e?void 0:e.projectId,r.relayUrl=(null==e?void 0:e.relayUrl)||Kr;var i=typeof(null==e?void 0:e.logger)<"u"&&"string"!=typeof(null==e?void 0:e.logger)?e.logger:(0,g.pino)((0,g.getDefaultLoggerOptions)({level:(null==e?void 0:e.logger)||xr.logger}));return r.logger=(0,g.generateChildLogger)(i,r.name),r.heartbeat=new p.HeartBeat,r.crypto=new bn((0,n.default)(r),r.logger,null==e?void 0:e.keychain),r.history=new Fn((0,n.default)(r),r.logger),r.expirer=new Jn((0,n.default)(r),r.logger),r.storage=null!=e&&e.storage?e.storage:new d.default(ti(ti({},Ar),null==e?void 0:e.storageOptions)),r.relayer=new jn({core:(0,n.default)(r),logger:r.logger,relayUrl:r.relayUrl,projectId:r.projectId}),r.pairing=new Hn((0,n.default)(r),r.logger),r.verify=new Gn(r.projectId||"",r.logger),r}r.init=function(){var e=(0,u.default)((function*(e){var t=new r(e);return yield t.initialize(),t}));return function(t){return e.apply(this,arguments)}}();var i=r.prototype;return i.start=function(){var e=(0,u.default)((function*(){this.initialized||(yield this.initialize())}));return function(){return e.apply(this,arguments)}}(),i.initialize=function(){var e=(0,u.default)((function*(){this.logger.trace("Initialized");try{yield this.crypto.init(),yield this.history.init(),yield this.expirer.init(),yield this.relayer.init(),yield this.heartbeat.init(),yield this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}));return function(){return e.apply(this,arguments)}}(),(0,l.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}}]),r}(m),ni=ri},2139:(e,t,r)=>{"use strict";r.r(t),r.d(t,{BASE10:()=>j,BASE16:()=>B,BASE64:()=>q,COLON:()=>ve,DEFAULT_DEPTH:()=>be,EMPTY_SPACE:()=>ye,ENV_MAP:()=>ge,ONE_THOUSAND:()=>Ee,REACT_NATIVE_PRODUCT:()=>pe,RELAYER_DEFAULT_PROTOCOL:()=>tt,SDK_TYPE:()=>_e,SLASH:()=>me,TYPE_0:()=>z,TYPE_1:()=>$,UTF8:()=>V,appendToQueryString:()=>Oe,assertType:()=>ke,buildApprovedNamespaces:()=>Tt,calcExpiry:()=>Ze,capitalize:()=>Ke,capitalizeWord:()=>$e,createDelayedPromise:()=>We,createExpiringPromise:()=>He,decodeTypeByte:()=>ee,decrypt:()=>re,deriveSymKey:()=>Y,deserialize:()=>ie,encodeTypeByte:()=>Q,encrypt:()=>te,engineEvent:()=>Qe,enumify:()=>ze,formatAccountId:()=>w,formatAccountWithChain:()=>O,formatChainId:()=>E,formatExpirerTarget:()=>Fe,formatIdTarget:()=>Ge,formatMessage:()=>L,formatMessageContext:()=>Ue,formatRelayParams:()=>ft,formatRelayRpcUrl:()=>Ae,formatTopicTarget:()=>Je,formatUA:()=>xe,formatUri:()=>dt,generateKeyPair:()=>J,generateRandomBytes32:()=>G,getAccountsChains:()=>St,getAccountsFromNamespaces:()=>P,getAddressFromAccount:()=>I,getAddressesFromAccounts:()=>M,getAppMetadata:()=>Me,getChainFromAccount:()=>R,getChainsFromAccounts:()=>T,getChainsFromNamespace:()=>A,getChainsFromNamespaces:()=>N,getChainsFromRequiredNamespaces:()=>x,getDidAddress:()=>U,getDidAddressSegments:()=>C,getDidChainId:()=>k,getEnvironment:()=>Re,getHttpUrl:()=>Ce,getInternalError:()=>kt,getJavascriptID:()=>Ne,getJavascriptOS:()=>Pe,getLastItems:()=>je,getNamespacedDidChainId:()=>D,getNamespacesChains:()=>It,getNamespacesEventsForChainId:()=>Ot,getNamespacesMethodsForChainId:()=>Rt,getRelayClientMetadata:()=>Te,getRelayProtocolApi:()=>nt,getRelayProtocolName:()=>rt,getRequiredNamespacesFromNamespaces:()=>Mt,getSdkError:()=>Dt,getUniqueValues:()=>S,hasOverlap:()=>Le,hashKey:()=>Z,hashMessage:()=>X,isBrowser:()=>Ie,isCaipNamespace:()=>Pt,isConformingNamespaces:()=>pr,isExpired:()=>Xe,isNode:()=>we,isProposalStruct:()=>Wt,isReactNative:()=>Se,isSessionCompatible:()=>Vt,isSessionStruct:()=>Ht,isTypeOneEnvelope:()=>ae,isUndefined:()=>jt,isValidAccountId:()=>$t,isValidAccounts:()=>Zt,isValidActions:()=>Qt,isValidArray:()=>Ut,isValidChainId:()=>zt,isValidChains:()=>Gt,isValidController:()=>Ft,isValidErrorReason:()=>ar,isValidEvent:()=>lr,isValidId:()=>or,isValidNamespaceAccounts:()=>Xt,isValidNamespaceActions:()=>er,isValidNamespaceChains:()=>Yt,isValidNamespaceMethodsOrEvents:()=>Jt,isValidNamespaces:()=>rr,isValidNamespacesChainId:()=>hr,isValidNamespacesEvent:()=>dr,isValidNamespacesRequest:()=>fr,isValidNumber:()=>qt,isValidObject:()=>Lt,isValidParams:()=>sr,isValidRelay:()=>nr,isValidRelays:()=>ir,isValidRequest:()=>ur,isValidRequestExpiry:()=>yr,isValidRequiredNamespaces:()=>tr,isValidResponse:()=>cr,isValidString:()=>Bt,isValidUrl:()=>Kt,mapEntries:()=>Ve,mapToObj:()=>Be,mergeArrays:()=>et,normalizeNamespaces:()=>xt,objToMap:()=>qe,parseAccountId:()=>_,parseChainId:()=>b,parseContextNames:()=>De,parseExpirerTarget:()=>Ye,parseNamespaceKey:()=>Nt,parseRelayParams:()=>lt,parseUri:()=>ht,serialize:()=>ne,validateDecoding:()=>oe,validateEncoding:()=>se});var n=r(34795),i=r(68079),o=r(96234),s=r(18779),a=r(43133),u=r(61863),c=r(74932),l=r(36381),h=r(49466),f=r(54924),d=r(42537),p=r(45415),g=r(7047),y=r(34126),v=r(60220),m=":";function b(e){var t=e.split(m),r=(0,o.default)(t,2);return{namespace:r[0],reference:r[1]}}function E(e){return[e.namespace,e.reference].join(m)}function _(e){var t=e.split(m),r=(0,o.default)(t,3);return{namespace:r[0],reference:r[1],address:r[2]}}function w(e){return[e.namespace,e.reference,e.address].join(m)}function S(e,t){var r=[];return e.forEach((function(e){var n=t(e);r.includes(n)||r.push(n)})),r}function I(e){return _(e).address}function R(e){var t=_(e);return E({namespace:t.namespace,reference:t.reference})}function O(e,t){var r=b(t);return w({namespace:r.namespace,reference:r.reference,address:e})}function M(e){return S(e,I)}function T(e){return S(e,R)}function P(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return Object.keys(e).forEach((function(n){if(!t.length||t.includes(n)){var o=e[n];r.push.apply(r,(0,i.default)(o.accounts))}})),r}function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return Object.keys(e).forEach((function(n){if(!t.length||t.includes(n)){var o=e[n];r.push.apply(r,(0,i.default)(T(o.accounts)))}})),r}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return Object.keys(e).forEach((function(n){if(!t.length||t.includes(n)){var o=e[n];r.push.apply(r,(0,i.default)(A(n,o)))}})),r}function A(e,t){return e.includes(":")?[e]:t.chains||[]}var C=function(e){return null==e?void 0:e.split(":")},k=function(e){var t=e&&C(e);if(t)return t[3]},D=function(e){var t=e&&C(e);if(t)return t[2]+":"+t[3]},U=function(e){var t=e&&C(e);if(t)return t.pop()},L=function(e,t){return[`${e.domain} wants you to sign in with your Ethereum account:`,U(t),"",e.statement,"",`URI: ${e.aud}`,`Version: ${e.version}`,`Chain ID: ${k(t)}`,`Nonce: ${e.nonce}`,`Issued At: ${e.iat}`,e.resources&&e.resources.length>0?`Resources:\n${e.resources.map((function(e){return`- ${e}`})).join("\n")}`:void 0].filter((function(e){return null!=e})).join("\n")},j="base10",B="base16",q="base64pad",V="utf8",z=0,$=1,K=0,W=1,H=12,F=32;function J(){var e=l.generateKeyPair();return{privateKey:(0,h.toString)(e.secretKey,B),publicKey:(0,h.toString)(e.publicKey,B)}}function G(){var e=(0,u.randomBytes)(F);return(0,h.toString)(e,B)}function Y(e,t){var r=l.sharedKey((0,h.fromString)(e,B),(0,h.fromString)(t,B)),n=new a.HKDF(c.SHA256,r).expand(F);return(0,h.toString)(n,B)}function Z(e){var t=(0,c.hash)((0,h.fromString)(e,B));return(0,h.toString)(t,B)}function X(e){var t=(0,c.hash)((0,h.fromString)(e,V));return(0,h.toString)(t,B)}function Q(e){return(0,h.fromString)(`${e}`,j)}function ee(e){return Number((0,h.toString)(e,j))}function te(e){var t=Q(typeof e.type<"u"?e.type:z);if(ee(t)===$&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");var r=typeof e.senderPublicKey<"u"?(0,h.fromString)(e.senderPublicKey,B):void 0,n=typeof e.iv<"u"?(0,h.fromString)(e.iv,B):(0,u.randomBytes)(H);return ne({type:t,sealed:new s.ChaCha20Poly1305((0,h.fromString)(e.symKey,B)).seal(n,(0,h.fromString)(e.message,V)),iv:n,senderPublicKey:r})}function re(e){var t=new s.ChaCha20Poly1305((0,h.fromString)(e.symKey,B)),r=ie(e.encoded),n=r.sealed,i=r.iv,o=t.open(i,n);if(null===o)throw new Error("Failed to decrypt");return(0,h.toString)(o,V)}function ne(e){if(ee(e.type)===$){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return(0,h.toString)((0,h.concat)([e.type,e.senderPublicKey,e.iv,e.sealed]),q)}return(0,h.toString)((0,h.concat)([e.type,e.iv,e.sealed]),q)}function ie(e){var t=(0,h.fromString)(e,q),r=t.slice(K,W),n=W;if(ee(r)===$){var i=n+F,o=i+H,s=t.slice(n,i),a=t.slice(i,o);return{type:r,sealed:t.slice(o),iv:a,senderPublicKey:s}}var u=n+H,c=t.slice(n,u);return{type:r,sealed:t.slice(u),iv:c}}function oe(e,t){var r=ie(e);return se({type:ee(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?(0,h.toString)(r.senderPublicKey,B):void 0,receiverPublicKey:null==t?void 0:t.receiverPublicKey})}function se(e){var t=(null==e?void 0:e.type)||z;if(t===$){if(typeof(null==e?void 0:e.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(null==e?void 0:e.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:null==e?void 0:e.senderPublicKey,receiverPublicKey:null==e?void 0:e.receiverPublicKey}}function ae(e){return e.type===$&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}var ue=Object.defineProperty,ce=Object.getOwnPropertySymbols,le=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable,fe=function(e,t,r){return t in e?ue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},de=function(e,t){for(var r in t||(t={}))le.call(t,r)&&fe(e,r,t[r]);if(ce)for(var r of ce(t))he.call(t,r)&&fe(e,r,t[r]);return e},pe="ReactNative",ge={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},ye=" ",ve=":",me="/",be=2,Ee=1e3,_e="js";function we(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Se(){return!(0,p.getDocument)()&&!!(0,p.getNavigator)()&&navigator.product===pe}function Ie(){return!we()&&!!(0,p.getNavigator)()}function Re(){return Se()?ge.reactNative:we()?ge.node:Ie()?ge.browser:ge.unknown}function Oe(e,t){var r=y.parse(e);return r=de(de({},r),t),e=y.stringify(r)}function Me(){return(0,g.getWindowMetadata)()||{name:"",description:"",url:"",icons:[""]}}function Te(e,t){var r,n=Re(),i={protocol:e,version:t,env:n};return"browser"===n&&(i.host=(null==(r=(0,p.getLocation)())?void 0:r.host)||"unknown"),i}function Pe(){var e=(0,f.detect)();if(null===e)return"unknown";var t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[t,e.name,e.version].join("-"):[t,e.version].join("-")}function Ne(){var e,t=Re();return t===ge.browser?[t,(null==(e=(0,p.getLocation)())?void 0:e.host)||"unknown"].join(":"):t}function xe(e,t,r){var n=Pe(),i=Ne();return[[e,t].join("-"),[_e,r].join("-"),n,i].join("/")}function Ae(e){var t=e.protocol,r=e.version,n=e.relayUrl,i=e.sdkVersion,o=e.auth,s=e.projectId,a=e.useOnCloseEvent,u=n.split("?"),c={auth:o,ua:xe(t,r,i),projectId:s,useOnCloseEvent:a||void 0},l=Oe(u[1]||"",c);return u[0]+"?"+l}function Ce(e){var t=(e.match(/^[^:]+(?=:\/\/)/gi)||[])[0],r=typeof t<"u"?e.split("://")[1]:e;return[t="wss"===t?"https":"http",r].join("://")}function ke(e,t,r){if(!e[t]||typeof e[t]!==r)throw new Error(`Missing or invalid "${t}" param`)}function De(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:be;return je(e.split(me),t)}function Ue(e){return De(e).join(ye)}function Le(e,t){return e.filter((function(e){return t.includes(e)})).length===e.length}function je(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:be;return e.slice(Math.max(e.length-t,0))}function Be(e){return Object.fromEntries(e.entries())}function qe(e){return new Map(Object.entries(e))}function Ve(e,t){var r={};return Object.keys(e).forEach((function(n){r[n]=t(e[n])})),r}var ze=function(e){return e};function $e(e){return e.trim().replace(/^\w/,(function(e){return e.toUpperCase()}))}function Ke(e){return e.split(ye).map((function(e){return $e(e)})).join(ye)}function We(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.FIVE_MINUTES,i=arguments.length>1?arguments[1]:void 0,o=(0,d.toMiliseconds)(n||d.FIVE_MINUTES);return{resolve:function(t){r&&e&&(clearTimeout(r),e(t))},reject:function(e){r&&t&&(clearTimeout(r),t(e))},done:function(){return new Promise((function(n,s){r=setTimeout((function(){s(new Error(i))}),o),e=n,t=s}))}}}function He(e,t,r){return new Promise(function(){var i=(0,n.default)((function*(n,i){var o=setTimeout((function(){return i(new Error(r))}),t);try{var s;n(yield e)}catch(s){i(s)}clearTimeout(o)}));return function(e,t){return i.apply(this,arguments)}}())}function Fe(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function Je(e){return Fe("topic",e)}function Ge(e){return Fe("id",e)}function Ye(e){var t=e.split(":"),r=(0,o.default)(t,2),n=r[0],i=r[1],s={id:void 0,topic:void 0};if("topic"===n&&"string"==typeof i)s.topic=i;else{if("id"!==n||!Number.isInteger(Number(i)))throw new Error(`Invalid target, expected id:number or topic:string, got ${n}:${i}`);s.id=Number(i)}return s}function Ze(e,t){return(0,d.fromMiliseconds)((t||Date.now())+(0,d.toMiliseconds)(e))}function Xe(e){return Date.now()>=(0,d.toMiliseconds)(e)}function Qe(e,t){return`${e}${t?`:${t}`:""}`}function et(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(0,i.default)(new Set([].concat((0,i.default)(e),(0,i.default)(t))))}var tt="irn";function rt(e){return(null==e?void 0:e.relay)||{protocol:tt}}function nt(e){var t=v.RELAY_JSONRPC[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}var it=Object.defineProperty,ot=Object.getOwnPropertySymbols,st=Object.prototype.hasOwnProperty,at=Object.prototype.propertyIsEnumerable,ut=function(e,t,r){return t in e?it(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},ct=function(e,t){for(var r in t||(t={}))st.call(t,r)&&ut(e,r,t[r]);if(ot)for(var r of ot(t))at.call(t,r)&&ut(e,r,t[r]);return e};function lt(e){var t={},r="relay"+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-");return Object.keys(e).forEach((function(n){if(n.startsWith(r)){var i=n.replace(r,""),o=e[n];t[i]=o}})),t}function ht(e){var t=e.indexOf(":"),r=-1!==e.indexOf("?")?e.indexOf("?"):void 0,n=e.substring(0,t),i=e.substring(t+1,r).split("@"),o=typeof r<"u"?e.substring(r):"",s=y.parse(o);return{protocol:n,topic:i[0],version:parseInt(i[1],10),symKey:s.symKey,relay:lt(s)}}function ft(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",r={};return Object.keys(e).forEach((function(n){var i="relay"+t+n;e[n]&&(r[i]=e[n])})),r}function dt(e){return`${e.protocol}:${e.topic}@${e.version}?`+y.stringify(ct({symKey:e.symKey},ft(e.relay)))}var pt=Object.defineProperty,gt=Object.defineProperties,yt=Object.getOwnPropertyDescriptors,vt=Object.getOwnPropertySymbols,mt=Object.prototype.hasOwnProperty,bt=Object.prototype.propertyIsEnumerable,Et=function(e,t,r){return t in e?pt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},_t=function(e,t){for(var r in t||(t={}))mt.call(t,r)&&Et(e,r,t[r]);if(vt)for(var r of vt(t))bt.call(t,r)&&Et(e,r,t[r]);return e},wt=function(e,t){return gt(e,yt(t))};function St(e){var t=[];return e.forEach((function(e){var r=e.split(":"),n=(0,o.default)(r,2),i=n[0],s=n[1];t.push(`${i}:${s}`)})),t}function It(e){var t=[];return Object.values(e).forEach((function(e){t.push.apply(t,(0,i.default)(St(e.accounts)))})),t}function Rt(e,t){var r=[];return Object.values(e).forEach((function(e){St(e.accounts).includes(t)&&r.push.apply(r,(0,i.default)(e.methods))})),r}function Ot(e,t){var r=[];return Object.values(e).forEach((function(e){St(e.accounts).includes(t)&&r.push.apply(r,(0,i.default)(e.events))})),r}function Mt(e,t){var r=rr(e,t);if(r)throw new Error(r.message);var n={};for(var i of Object.entries(e)){var s=(0,o.default)(i,2),a=s[0],u=s[1];n[a]={methods:u.methods,events:u.events,chains:u.accounts.map((function(e){return`${e.split(":")[0]}:${e.split(":")[1]}`}))}}return n}function Tt(e){var t=e.proposal,r=t.requiredNamespaces,n=t.optionalNamespaces,i=void 0===n?{}:n,o=e.supportedNamespaces,s=xt(r),a=xt(i),u={};Object.keys(o).forEach((function(e){var t=o[e].chains,r=o[e].methods,n=o[e].events,i=o[e].accounts;u[e]={chains:t,methods:r,events:n,accounts:i}}));var c=pr(r,u,"approve()");if(c)throw new Error(c.message);var l={};return Object.keys(s).forEach((function(e){var t=o[e].chains.filter((function(t){var r,n;return null==(n=null==(r=s[e])?void 0:r.chains)?void 0:n.includes(t)})),r=o[e].methods.filter((function(t){var r,n;return null==(n=null==(r=s[e])?void 0:r.methods)?void 0:n.includes(t)})),n=o[e].events.filter((function(t){var r,n;return null==(n=null==(r=s[e])?void 0:r.events)?void 0:n.includes(t)})),i=t.map((function(t){return o[e].accounts.filter((function(e){return e.includes(`${t}:`)}))})).flat();l[e]={chains:t,methods:r,events:n,accounts:i}})),Object.keys(a).forEach((function(e){var t,r,n,i,s,u;if(o[e]){var c=null==(r=null==(t=a[e])?void 0:t.chains)?void 0:r.filter((function(t){return o[e].chains.includes(t)})),h=o[e].methods.filter((function(t){var r,n;return null==(n=null==(r=a[e])?void 0:r.methods)?void 0:n.includes(t)})),f=o[e].events.filter((function(t){var r,n;return null==(n=null==(r=a[e])?void 0:r.events)?void 0:n.includes(t)})),d=null==c?void 0:c.map((function(t){return o[e].accounts.filter((function(e){return e.includes(t)}))})).flat();l[e]={chains:et(null==(n=l[e])?void 0:n.chains,c),methods:et(null==(i=l[e])?void 0:i.methods,h),events:et(null==(s=l[e])?void 0:s.events,f),accounts:et(null==(u=l[e])?void 0:u.accounts,d)}}})),l}function Pt(e){return e.includes(":")}function Nt(e){return Pt(e)?e.split(":")[0]:e}function xt(e){var t,r,n,i={};if(!Lt(e))return i;for(var s of Object.entries(e)){var a=(0,o.default)(s,2),u=a[0],c=a[1],l=Pt(u)?[u]:c.chains,h=c.methods||[],f=c.events||[],d=Nt(u);i[d]=wt(_t({},i[d]),{chains:et(l,null==(t=i[d])?void 0:t.chains),methods:et(h,null==(r=i[d])?void 0:r.methods),events:et(f,null==(n=i[d])?void 0:n.events)})}return i}var At={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Ct={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function kt(e,t){var r=Ct[e],n=r.message;return{message:t?`${n} ${t}`:n,code:r.code}}function Dt(e,t){var r=At[e],n=r.message;return{message:t?`${n} ${t}`:n,code:r.code}}function Ut(e,t){return!!Array.isArray(e)&&(!(typeof t<"u"&&e.length)||e.every(t))}function Lt(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function jt(e){return typeof e>"u"}function Bt(e,t){return!(!t||!jt(e))||"string"==typeof e&&Boolean(e.trim().length)}function qt(e,t){return!(!t||!jt(e))||"number"==typeof e&&!isNaN(e)}function Vt(e,t){var r=t.requiredNamespaces,n=Object.keys(e.namespaces),i=Object.keys(r),o=!0;return!!Le(i,n)&&(n.forEach((function(t){var n=e.namespaces[t],i=n.accounts,s=n.methods,a=n.events,u=St(i),c=r[t];(!Le(A(t,c),u)||!Le(c.methods,s)||!Le(c.events,a))&&(o=!1)})),o)}function zt(e){return!(!Bt(e,!1)||!e.includes(":"))&&2===e.split(":").length}function $t(e){if(Bt(e,!1)&&e.includes(":")){var t=e.split(":");if(3===t.length){var r=t[0]+":"+t[1];return!!t[2]&&zt(r)}}return!1}function Kt(e){if(Bt(e,!1))try{return typeof new URL(e)<"u"}catch(t){return!1}return!1}function Wt(e){var t;return null==(t=null==e?void 0:e.proposer)?void 0:t.publicKey}function Ht(e){return null==e?void 0:e.topic}function Ft(e,t){var r=null;return Bt(null==e?void 0:e.publicKey,!1)||(r=kt("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function Jt(e){var t=!0;return Ut(e)?e.length&&(t=e.every((function(e){return Bt(e,!1)}))):t=!1,t}function Gt(e,t,r){var n=null;return Ut(t)?t.forEach((function(t){n||(!zt(t)||!t.includes(e))&&(n=Dt("UNSUPPORTED_CHAINS",`${r}, chain ${t} should be a string and conform to "namespace:chainId" format`))})):n=Dt("UNSUPPORTED_CHAINS",`${r}, chains ${t} should be an array of strings conforming to "namespace:chainId" format`),n}function Yt(e,t){var r=null;return Object.entries(e).forEach((function(e){var n=(0,o.default)(e,2),i=n[0],s=n[1];if(!r){var a=Gt(i,A(i,s),`${t} requiredNamespace`);a&&(r=a)}})),r}function Zt(e,t){var r=null;return Ut(e)?e.forEach((function(e){r||$t(e)||(r=Dt("UNSUPPORTED_ACCOUNTS",`${t}, account ${e} should be a string and conform to "namespace:chainId:address" format`))})):r=Dt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Xt(e,t){var r=null;return Object.values(e).forEach((function(e){if(!r){var n=Zt(null==e?void 0:e.accounts,`${t} namespace`);n&&(r=n)}})),r}function Qt(e,t){var r=null;return Jt(null==e?void 0:e.methods)?Jt(null==e?void 0:e.events)||(r=Dt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=Dt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function er(e,t){var r=null;return Object.values(e).forEach((function(e){if(!r){var n=Qt(e,`${t}, namespace`);n&&(r=n)}})),r}function tr(e,t,r){var n=null;if(e&&Lt(e)){var i=er(e,t);i&&(n=i);var o=Yt(e,t);o&&(n=o)}else n=kt("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return n}function rr(e,t){var r=null;if(e&&Lt(e)){var n=er(e,t);n&&(r=n);var i=Xt(e,t);i&&(r=i)}else r=kt("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function nr(e){return Bt(e.protocol,!0)}function ir(e,t){var r=!1;return t&&!e?r=!0:e&&Ut(e)&&e.length&&e.forEach((function(e){r=nr(e)})),r}function or(e){return"number"==typeof e}function sr(e){return typeof e<"u"&&null!==typeof e}function ar(e){return!(!e||"object"!=typeof e||!e.code||!qt(e.code,!1)||!e.message||!Bt(e.message,!1))}function ur(e){return!(jt(e)||!Bt(e.method,!1))}function cr(e){return!(jt(e)||jt(e.result)&&jt(e.error)||!qt(e.id,!1)||!Bt(e.jsonrpc,!1))}function lr(e){return!(jt(e)||!Bt(e.name,!1))}function hr(e,t){return!(!zt(t)||!It(e).includes(t))}function fr(e,t,r){return!!Bt(r,!1)&&Rt(e,t).includes(r)}function dr(e,t,r){return!!Bt(r,!1)&&Ot(e,t).includes(r)}function pr(e,t,r){var n=null,i=function(e){var t={};return Object.keys(e).forEach((function(r){var n;r.includes(":")?t[r]=e[r]:null==(n=e[r].chains)||n.forEach((function(n){t[n]={methods:e[r].methods,events:e[r].events}}))})),t}(e),o=function(e){var t={};return Object.keys(e).forEach((function(r){if(r.includes(":"))t[r]=e[r];else{var n=St(e[r].accounts);null==n||n.forEach((function(n){t[n]={accounts:e[r].accounts.filter((function(e){return e.includes(`${n}:`)})),methods:e[r].methods,events:e[r].events}}))}})),t}(t),s=Object.keys(i),a=Object.keys(o),u=gr(Object.keys(e)),c=gr(Object.keys(t)),l=u.filter((function(e){return!c.includes(e)}));return l.length&&(n=kt("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.\n      Required: ${l.toString()}\n      Received: ${Object.keys(t).toString()}`)),Le(s,a)||(n=kt("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.\n      Required: ${s.toString()}\n      Approved: ${a.toString()}`)),Object.keys(t).forEach((function(e){if(e.includes(":")&&!n){var i=St(t[e].accounts);i.includes(e)||(n=kt("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${e}\n        Required: ${e}\n        Approved: ${i.toString()}`))}})),s.forEach((function(e){n||(Le(i[e].methods,o[e].methods)?Le(i[e].events,o[e].events)||(n=kt("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${e}`)):n=kt("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${e}`))})),n}function gr(e){return(0,i.default)(new Set(e.map((function(e){return e.includes(":")?e.split(":")[0]:e}))))}function yr(e,t){return qt(e,!1)&&e<=t.max&&e>=t.min}},33480:(e,t)=>{"use strict";function r(e){var t=void 0;return"undefined"!==typeof window&&"undefined"!==typeof window[e]&&(t=window[e]),t}function n(e){var t=r(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalStorage=t.getLocalStorageOrThrow=t.getCrypto=t.getCryptoOrThrow=t.getLocation=t.getLocationOrThrow=t.getNavigator=t.getNavigatorOrThrow=t.getDocument=t.getDocumentOrThrow=t.getFromWindowOrThrow=t.getFromWindow=void 0,t.getFromWindow=r,t.getFromWindowOrThrow=n,t.getDocumentOrThrow=function(){return n("document")},t.getDocument=function(){return r("document")},t.getNavigatorOrThrow=function(){return n("navigator")},t.getNavigator=function(){return r("navigator")},t.getLocationOrThrow=function(){return n("location")},t.getLocation=function(){return r("location")},t.getCryptoOrThrow=function(){return n("crypto")},t.getCrypto=function(){return r("crypto")},t.getLocalStorageOrThrow=function(){return n("localStorage")},t.getLocalStorage=function(){return r("localStorage")}},23270:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWindowMetadata=void 0;var n=r(20541);t.getWindowMetadata=function(){var e,t;try{e=n.getDocumentOrThrow(),t=n.getLocationOrThrow()}catch(o){return null}function r(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var i=e.getElementsByTagName("meta"),o=function(){var e=i[s],t=["itemprop","property","name"].map((function(t){return e.getAttribute(t)})).filter((function(e){return!!e&&r.includes(e)}));if(t.length&&t){var n=e.getAttribute("content");if(n)return{v:n}}},s=0;s<i.length;s++){var a=o();if("object"===typeof a)return a.v}return""}var i=function(){var t=r("name","og:site_name","og:title","twitter:title");return t||(t=e.title),t}();return{description:r("description","og:description","twitter:description","keywords"),url:t.origin,icons:function(){for(var r=e.getElementsByTagName("link"),n=[],i=0;i<r.length;i++){var o=r[i],s=o.getAttribute("rel");if(s&&s.toLowerCase().indexOf("icon")>-1){var a=o.getAttribute("href");if(a)if(-1===a.toLowerCase().indexOf("https:")&&-1===a.toLowerCase().indexOf("http:")&&0!==a.indexOf("//")){var u=t.protocol+"//"+t.host;if(0===a.indexOf("/"))u+=a;else{var c=t.pathname.split("/");c.pop(),u+=c.join("/")+"/"+a}n.push(u)}else if(0===a.indexOf("//")){var l=t.protocol+a;n.push(l)}else n.push(a)}}return n}(),name:i}}},20541:(e,t)=>{"use strict";function r(e){var t=void 0;return"undefined"!==typeof window&&"undefined"!==typeof window[e]&&(t=window[e]),t}function n(e){var t=r(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalStorage=t.getLocalStorageOrThrow=t.getCrypto=t.getCryptoOrThrow=t.getLocation=t.getLocationOrThrow=t.getNavigator=t.getNavigatorOrThrow=t.getDocument=t.getDocumentOrThrow=t.getFromWindowOrThrow=t.getFromWindow=void 0,t.getFromWindow=r,t.getFromWindowOrThrow=n,t.getDocumentOrThrow=function(){return n("document")},t.getDocument=function(){return r("document")},t.getNavigatorOrThrow=function(){return n("navigator")},t.getNavigator=function(){return r("navigator")},t.getLocationOrThrow=function(){return n("location")},t.getLocation=function(){return r("location")},t.getCryptoOrThrow=function(){return n("crypto")},t.getCrypto=function(){return r("crypto")},t.getLocalStorageOrThrow=function(){return n("localStorage")},t.getLocalStorage=function(){return r("localStorage")}},86193:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var n=r(34795),i=r(68079),o=r(87371),s=r(74220),a=r(17781),u="Session currently connected",c="Session currently disconnected",l="JSON RPC response format is invalid",h="User close QRCode Modal";const f=function(){function e(){this._eventEmitters=[]}var t=e.prototype;return t.subscribe=function(e){this._eventEmitters.push(e)},t.unsubscribe=function(e){this._eventEmitters=this._eventEmitters.filter((function(t){return t.event!==e}))},t.trigger=function(e){var t,r=[];(t=(0,s.isJsonRpcRequest)(e)?e.method:(0,s.isJsonRpcResponseSuccess)(e)||(0,s.isJsonRpcResponseError)(e)?`response:${e.id}`:(0,s.isInternalEvent)(e)?e.event:"")&&(r=this._eventEmitters.filter((function(e){return e.event===t}))),r&&r.length||(0,s.isReservedEvent)(t)||(0,s.isInternalEvent)(t)||(r=this._eventEmitters.filter((function(e){return"call_request"===e.event}))),r.forEach((function(t){if((0,s.isJsonRpcResponseError)(e)){var r=new Error(e.error.message);t.callback(r,null)}else t.callback(null,e)}))},(0,o.default)(e)}();const d=function(){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"walletconnect";this.storageId=e}var t=e.prototype;return t.getSession=function(){var e=null,t=(0,s.getLocal)(this.storageId);return t&&(0,s.isWalletConnectSession)(t)&&(e=t),e},t.setSession=function(e){return(0,s.setLocal)(this.storageId,e),e},t.removeSession=function(){(0,s.removeLocal)(this.storageId)},(0,o.default)(e)}();var p=r(1253);const g=function(){function e(e){if(this.protocol="wc",this.version=1,this._bridge="",this._key=null,this._clientId="",this._clientMeta=null,this._peerId="",this._peerMeta=null,this._handshakeId=0,this._handshakeTopic="",this._connected=!1,this._accounts=[],this._chainId=0,this._networkId=0,this.networkImpl=null,this._rpcUrl="",this._eventManager=new f,this._clientMeta=e.connectorOpts.clientMeta||(0,s.getClientMeta)()||null,this._cryptoLib=e.cryptoLib,this._sessionStorage=e.sessionStorage||new d(e.connectorOpts.storageId),this._qrcodeModal=e.connectorOpts.qrcodeModal,this._qrcodeModalOptions=e.connectorOpts.qrcodeModalOptions,this._signingMethods=[].concat((0,i.default)(s.signingMethods),(0,i.default)(e.connectorOpts.signingMethods||[])),!e.connectorOpts.bridge&&!e.connectorOpts.uri&&!e.connectorOpts.session)throw new Error("Missing one of the required parameters: bridge / uri / session");e.connectorOpts.bridge&&(this.bridge=(0,p.getBridgeUrl)(e.connectorOpts.bridge)),e.connectorOpts.networkImpl&&(this.networkImpl=e.connectorOpts.networkImpl),e.connectorOpts.uri&&(this.uri=e.connectorOpts.uri);var t=e.connectorOpts.session||(e.connectorOpts.autoConnectLastSessionOnMount?this._getStorageSession():void 0);t&&(this.session=t),this.handshakeId&&this._subscribeToSessionResponse(this.handshakeId,"Session request rejected"),this._transport=e.transport||new a.default({protocol:this.protocol,version:this.version,url:this.bridge,subscriptions:[this.clientId]}),this._subscribeToInternalEvents(),this._initTransport(),e.connectorOpts.uri&&this._subscribeToSessionRequest(),e.pushServerOpts&&this._registerPushServer(e.pushServerOpts)}var t=e.prototype;return t.on=function(e,t){var r={event:e,callback:t};this._eventManager.subscribe(r)},t.off=function(e){this._eventManager.unsubscribe(e)},t.createInstantRequest=function(){var e=(0,n.default)((function*(e){var t=this;this._key=yield this._generateKey();var r=this._formatRequest({method:"wc_instantRequest",params:[{peerId:this.clientId,peerMeta:this.clientMeta,request:this._formatRequest(e)}]});this.handshakeId=r.id,this.handshakeTopic=(0,s.uuid)(),this._eventManager.trigger({event:"display_uri",params:[this.uri]}),this.on("modal_closed",(function(){throw new Error(h)}));var n=function(){t.killSession()};try{var i=yield this._sendCallRequest(r);return i&&n(),i}catch(o){throw n(),o}}));return function(t){return e.apply(this,arguments)}}(),t.connect=function(){var e=(0,n.default)((function*(e){var t=this;if(!this._qrcodeModal)throw new Error("QRCode Modal not provided");return this.connected?{chainId:this.chainId,accounts:this.accounts}:(yield this.createSession(e),new Promise(function(){var e=(0,n.default)((function*(e,r){t.on("modal_closed",(function(){return r(new Error(h))})),t.on("connect",(function(t,n){if(t)return r(t);e(n.params[0])}))}));return function(t,r){return e.apply(this,arguments)}}()))}));return function(t){return e.apply(this,arguments)}}(),t.createSession=function(){var e=(0,n.default)((function*(e){if(this._connected)throw new Error(u);if(!this.pending){this._key=yield this._generateKey();var t=this._formatRequest({method:"wc_sessionRequest",params:[{peerId:this.clientId,peerMeta:this.clientMeta,chainId:e&&e.chainId?e.chainId:null}]});this.handshakeId=t.id,this.handshakeTopic=(0,s.uuid)(),this._sendSessionRequest(t,"Session update rejected",{topic:this.handshakeTopic}),this._eventManager.trigger({event:"display_uri",params:[this.uri]})}}));return function(t){return e.apply(this,arguments)}}(),t.approveSession=function(e){if(this._connected)throw new Error(u);this.chainId=e.chainId,this.accounts=e.accounts,this.networkId=e.networkId||0,this.rpcUrl=e.rpcUrl||"";var t={approved:!0,chainId:this.chainId,networkId:this.networkId,accounts:this.accounts,rpcUrl:this.rpcUrl,peerId:this.clientId,peerMeta:this.clientMeta},r={id:this.handshakeId,jsonrpc:"2.0",result:t};this._sendResponse(r),this._connected=!0,this._setStorageSession(),this._eventManager.trigger({event:"connect",params:[{peerId:this.peerId,peerMeta:this.peerMeta,chainId:this.chainId,accounts:this.accounts}]})},t.rejectSession=function(){var e=(0,n.default)((function*(e){if(this._connected)throw new Error(u);var t=e&&e.message?e.message:"Session Rejected",r=this._formatResponse({id:this.handshakeId,error:{message:t}});yield this._sendResponse(r),this._connected=!1,this._eventManager.trigger({event:"disconnect",params:[{message:t}]}),this._removeStorageSession()}));return function(t){return e.apply(this,arguments)}}(),t.updateSession=function(e){if(!this._connected)throw new Error(c);this.chainId=e.chainId,this.accounts=e.accounts,this.networkId=e.networkId||0,this.rpcUrl=e.rpcUrl||"";var t={approved:!0,chainId:this.chainId,networkId:this.networkId,accounts:this.accounts,rpcUrl:this.rpcUrl},r=this._formatRequest({method:"wc_sessionUpdate",params:[t]});this._sendSessionRequest(r,"Session update rejected"),this._eventManager.trigger({event:"session_update",params:[{chainId:this.chainId,accounts:this.accounts}]}),this._manageStorageSession()},t.killSession=function(){var e=(0,n.default)((function*(e){var t=e?e.message:"Session Disconnected",r=this._formatRequest({method:"wc_sessionUpdate",params:[{approved:!1,chainId:null,networkId:null,accounts:null}]});yield this._sendRequest(r),this._handleSessionDisconnect(t)}));return function(t){return e.apply(this,arguments)}}(),t.sendTransaction=function(){var e=(0,n.default)((function*(e){if(!this._connected)throw new Error(c);var t=(0,s.parseTransactionData)(e),r=this._formatRequest({method:"eth_sendTransaction",params:[t]});return yield this._sendCallRequest(r)}));return function(t){return e.apply(this,arguments)}}(),t.signTransaction=function(){var e=(0,n.default)((function*(e){if(!this._connected)throw new Error(c);var t=(0,s.parseTransactionData)(e),r=this._formatRequest({method:"eth_signTransaction",params:[t]});return yield this._sendCallRequest(r)}));return function(t){return e.apply(this,arguments)}}(),t.signMessage=function(){var e=(0,n.default)((function*(e){if(!this._connected)throw new Error(c);var t=this._formatRequest({method:"eth_sign",params:e});return yield this._sendCallRequest(t)}));return function(t){return e.apply(this,arguments)}}(),t.signPersonalMessage=function(){var e=(0,n.default)((function*(e){if(!this._connected)throw new Error(c);e=(0,s.parsePersonalSign)(e);var t=this._formatRequest({method:"personal_sign",params:e});return yield this._sendCallRequest(t)}));return function(t){return e.apply(this,arguments)}}(),t.signTypedData=function(){var e=(0,n.default)((function*(e){if(!this._connected)throw new Error(c);var t=this._formatRequest({method:"eth_signTypedData",params:e});return yield this._sendCallRequest(t)}));return function(t){return e.apply(this,arguments)}}(),t.updateChain=function(){var e=(0,n.default)((function*(e){if(!this._connected)throw new Error("Session currently disconnected");var t=this._formatRequest({method:"wallet_updateChain",params:[e]});return yield this._sendCallRequest(t)}));return function(t){return e.apply(this,arguments)}}(),t.unsafeSend=function(e,t){var r=this;return this._sendRequest(e,t),this._eventManager.trigger({event:"call_request_sent",params:[{request:e,options:t}]}),new Promise((function(t,n){r._subscribeToResponse(e.id,(function(e,r){if(e)n(e);else{if(!r)throw new Error("Missing JSON RPC response");t(r)}}))}))},t.sendCustomRequest=function(){var e=(0,n.default)((function*(e,t){if(!this._connected)throw new Error(c);switch(e.method){case"eth_accounts":return this.accounts;case"eth_chainId":return(0,s.convertNumberToHex)(this.chainId);case"eth_sendTransaction":case"eth_signTransaction":e.params&&(e.params[0]=(0,s.parseTransactionData)(e.params[0]));break;case"personal_sign":e.params&&(e.params=(0,s.parsePersonalSign)(e.params))}var r=this._formatRequest(e);return yield this._sendCallRequest(r,t)}));return function(t,r){return e.apply(this,arguments)}}(),t.approveRequest=function(e){if(!(0,s.isJsonRpcResponseSuccess)(e))throw new Error('JSON-RPC success response must include "result" field');var t=this._formatResponse(e);this._sendResponse(t)},t.rejectRequest=function(e){if(!(0,s.isJsonRpcResponseError)(e))throw new Error('JSON-RPC error response must include "error" field');var t=this._formatResponse(e);this._sendResponse(t)},t.transportClose=function(){this._transport.close()},t._sendRequest=function(){var e=(0,n.default)((function*(e,t){var r=this._formatRequest(e),n=yield this._encrypt(r),i="undefined"!==typeof(null===t||void 0===t?void 0:t.topic)?t.topic:this.peerId,o=JSON.stringify(n),a="undefined"!==typeof(null===t||void 0===t?void 0:t.forcePushNotification)?!t.forcePushNotification:(0,s.isSilentPayload)(r);this._transport.send(o,i,a)}));return function(t,r){return e.apply(this,arguments)}}(),t._sendResponse=function(){var e=(0,n.default)((function*(e){var t=yield this._encrypt(e),r=this.peerId,n=JSON.stringify(t);this._transport.send(n,r,!0)}));return function(t){return e.apply(this,arguments)}}(),t._sendSessionRequest=function(){var e=(0,n.default)((function*(e,t,r){this._sendRequest(e,r),this._subscribeToSessionResponse(e.id,t)}));return function(t,r,n){return e.apply(this,arguments)}}(),t._sendCallRequest=function(e,t){return this._sendRequest(e,t),this._eventManager.trigger({event:"call_request_sent",params:[{request:e,options:t}]}),this._subscribeToCallResponse(e.id)},t._formatRequest=function(e){if("undefined"===typeof e.method)throw new Error('JSON RPC request must have valid "method" value');return{id:"undefined"===typeof e.id?(0,s.payloadId)():e.id,jsonrpc:"2.0",method:e.method,params:"undefined"===typeof e.params?[]:e.params}},t._formatResponse=function(e){if("undefined"===typeof e.id)throw new Error('JSON RPC request must have valid "id" value');var t={id:e.id,jsonrpc:"2.0"};if((0,s.isJsonRpcResponseError)(e)){var r=(0,s.formatRpcError)(e.error);return Object.assign(Object.assign(Object.assign({},t),e),{error:r})}if((0,s.isJsonRpcResponseSuccess)(e))return Object.assign(Object.assign({},t),e);throw new Error(l)},t._handleSessionDisconnect=function(e){var t=e||"Session Disconnected";this._connected||(this._qrcodeModal&&this._qrcodeModal.close(),(0,s.removeLocal)(s.mobileLinkChoiceKey)),this._connected&&(this._connected=!1),this._handshakeId&&(this._handshakeId=0),this._handshakeTopic&&(this._handshakeTopic=""),this._peerId&&(this._peerId=""),this._eventManager.trigger({event:"disconnect",params:[{message:t}]}),this._removeStorageSession(),this.transportClose()},t._handleSessionResponse=function(e,t){t&&t.approved?(this._connected?(t.chainId&&(this.chainId=t.chainId),t.accounts&&(this.accounts=t.accounts),this._eventManager.trigger({event:"session_update",params:[{chainId:this.chainId,accounts:this.accounts}]})):(this._connected=!0,t.chainId&&(this.chainId=t.chainId),t.accounts&&(this.accounts=t.accounts),t.peerId&&!this.peerId&&(this.peerId=t.peerId),t.peerMeta&&!this.peerMeta&&(this.peerMeta=t.peerMeta),this._eventManager.trigger({event:"connect",params:[{peerId:this.peerId,peerMeta:this.peerMeta,chainId:this.chainId,accounts:this.accounts}]})),this._manageStorageSession()):this._handleSessionDisconnect(e)},t._handleIncomingMessages=function(){var e=(0,n.default)((function*(e){if([this.clientId,this.handshakeTopic].includes(e.topic)){var t;try{t=JSON.parse(e.payload)}catch(n){return}var r=yield this._decrypt(t);r&&this._eventManager.trigger(r)}}));return function(t){return e.apply(this,arguments)}}(),t._subscribeToSessionRequest=function(){this._transport.subscribe(this.handshakeTopic)},t._subscribeToResponse=function(e,t){this.on(`response:${e}`,t)},t._subscribeToSessionResponse=function(e,t){var r=this;this._subscribeToResponse(e,(function(e,n){e?r._handleSessionResponse(e.message):(0,s.isJsonRpcResponseSuccess)(n)?r._handleSessionResponse(t,n.result):n.error&&n.error.message?r._handleSessionResponse(n.error.message):r._handleSessionResponse(t)}))},t._subscribeToCallResponse=function(e){var t=this;return new Promise((function(r,n){t._subscribeToResponse(e,(function(e,t){e?n(e):(0,s.isJsonRpcResponseSuccess)(t)?r(t.result):t.error&&t.error.message?n(t.error):n(new Error(l))}))}))},t._subscribeToInternalEvents=function(){var e=this;this.on("display_uri",(function(){e._qrcodeModal&&e._qrcodeModal.open(e.uri,(function(){e._eventManager.trigger({event:"modal_closed",params:[]})}),e._qrcodeModalOptions)})),this.on("connect",(function(){e._qrcodeModal&&e._qrcodeModal.close()})),this.on("call_request_sent",(function(t,r){var n=r.params[0].request;if((0,s.isMobile)()&&e._signingMethods.includes(n.method)){var i=(0,s.getLocal)(s.mobileLinkChoiceKey);i&&(window.location.href=i.href)}})),this.on("wc_sessionRequest",(function(t,r){t&&e._eventManager.trigger({event:"error",params:[{code:"SESSION_REQUEST_ERROR",message:t.toString()}]}),e.handshakeId=r.id,e.peerId=r.params[0].peerId,e.peerMeta=r.params[0].peerMeta;var n=Object.assign(Object.assign({},r),{method:"session_request"});e._eventManager.trigger(n)})),this.on("wc_sessionUpdate",(function(t,r){t&&e._handleSessionResponse(t.message),e._handleSessionResponse("Session disconnected",r.params[0])}))},t._initTransport=function(){var e=this;this._transport.on("message",(function(t){return e._handleIncomingMessages(t)})),this._transport.on("open",(function(){return e._eventManager.trigger({event:"transport_open",params:[]})})),this._transport.on("close",(function(){return e._eventManager.trigger({event:"transport_close",params:[]})})),this._transport.on("error",(function(){return e._eventManager.trigger({event:"transport_error",params:["Websocket connection failed"]})})),(this._transport.closed||this._transport.closing)&&this._transport.open()},t._formatUri=function(){return`${this.protocol}:${this.handshakeTopic}@${this.version}?bridge=${encodeURIComponent(this.bridge)}&key=${this.key}`},t._parseUri=function(e){var t=(0,s.parseWalletConnectUri)(e);if(t.protocol===this.protocol){if(!t.handshakeTopic)throw Error("Invalid or missing handshakeTopic parameter value");var r=t.handshakeTopic;if(!t.bridge)throw Error("Invalid or missing bridge url parameter value");var n=decodeURIComponent(t.bridge);if(!t.key)throw Error("Invalid or missing key parameter value");return{handshakeTopic:r,bridge:n,key:t.key}}throw new Error("URI format is invalid")},t._generateKey=function(){var e=(0,n.default)((function*(){return this._cryptoLib?yield this._cryptoLib.generateKey():null}));return function(){return e.apply(this,arguments)}}(),t._encrypt=function(){var e=(0,n.default)((function*(e){var t=this._key;return this._cryptoLib&&t?yield this._cryptoLib.encrypt(e,t):null}));return function(t){return e.apply(this,arguments)}}(),t._decrypt=function(){var e=(0,n.default)((function*(e){var t=this._key;return this._cryptoLib&&t?yield this._cryptoLib.decrypt(e,t):null}));return function(t){return e.apply(this,arguments)}}(),t._getStorageSession=function(){var e=null;return this._sessionStorage&&(e=this._sessionStorage.getSession()),e},t._setStorageSession=function(){this._sessionStorage&&this._sessionStorage.setSession(this.session)},t._removeStorageSession=function(){this._sessionStorage&&this._sessionStorage.removeSession()},t._manageStorageSession=function(){this._connected?this._setStorageSession():this._removeStorageSession()},t._registerPushServer=function(e){if(!e.url||"string"!==typeof e.url)throw Error("Invalid or missing pushServerOpts.url parameter value");if(!e.type||"string"!==typeof e.type)throw Error("Invalid or missing pushServerOpts.type parameter value");if(!e.token||"string"!==typeof e.token)throw Error("Invalid or missing pushServerOpts.token parameter value");var t={bridge:this.bridge,topic:this.clientId,type:e.type,token:e.token,peerName:"",language:e.language||""};this.on("connect",function(){var r=(0,n.default)((function*(r,n){if(r)throw r;if(e.peerMeta){var i=n.params[0].peerMeta.name;t.peerName=i}try{var o=yield fetch(`${e.url}/new`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});if(!(yield o.json()).success)throw Error("Failed to register in Push Server")}catch(r){throw Error("Failed to register in Push Server")}}));return function(e,t){return r.apply(this,arguments)}}())},(0,o.default)(e,[{key:"bridge",get:function(){return this._bridge},set:function(e){e&&(this._bridge=e)}},{key:"key",get:function(){return this._key?(0,s.convertArrayBufferToHex)(this._key,!0):""},set:function(e){if(e){var t=(0,s.convertHexToArrayBuffer)(e);this._key=t}}},{key:"clientId",get:function(){var e=this._clientId;return e||(e=this._clientId=(0,s.uuid)()),this._clientId},set:function(e){e&&(this._clientId=e)}},{key:"peerId",get:function(){return this._peerId},set:function(e){e&&(this._peerId=e)}},{key:"clientMeta",get:function(){var e=this._clientMeta;return e||(e=this._clientMeta=(0,s.getClientMeta)()),e},set:function(e){}},{key:"peerMeta",get:function(){return this._peerMeta},set:function(e){this._peerMeta=e}},{key:"handshakeTopic",get:function(){return this._handshakeTopic},set:function(e){e&&(this._handshakeTopic=e)}},{key:"handshakeId",get:function(){return this._handshakeId},set:function(e){e&&(this._handshakeId=e)}},{key:"uri",get:function(){return this._formatUri()},set:function(e){if(e){var t=this._parseUri(e),r=t.handshakeTopic,n=t.bridge,i=t.key;this.handshakeTopic=r,this.bridge=n,this.key=i}}},{key:"chainId",get:function(){return this._chainId},set:function(e){this._chainId=e}},{key:"networkId",get:function(){return this._networkId},set:function(e){this._networkId=e}},{key:"accounts",get:function(){return this._accounts},set:function(e){this._accounts=e}},{key:"rpcUrl",get:function(){return this._rpcUrl},set:function(e){this._rpcUrl=e}},{key:"connected",get:function(){return this._connected},set:function(e){}},{key:"pending",get:function(){return!!this._handshakeTopic},set:function(e){}},{key:"session",get:function(){return{connected:this.connected,accounts:this.accounts,chainId:this.chainId,bridge:this.bridge,key:this.key,clientId:this.clientId,clientMeta:this.clientMeta,peerId:this.peerId,peerMeta:this.peerMeta,handshakeId:this.handshakeId,handshakeTopic:this.handshakeTopic,networkImpl:this.networkImpl}},set:function(e){e&&(this._connected=e.connected,this.accounts=e.accounts,this.chainId=e.chainId,this.bridge=e.bridge,this.key=e.key,this.clientId=e.clientId,this.clientMeta=e.clientMeta,this.peerId=e.peerId,this.peerMeta=e.peerMeta,this.handshakeId=e.handshakeId,this.handshakeTopic=e.handshakeTopic,this.networkImpl=e.networkImpl)}}]),e}()},1253:(e,t,r)=>{"use strict";r.r(t),r.d(t,{extractHostname:()=>o,extractRootDomain:()=>s,getBridgeUrl:()=>l,randomBridgeIndex:()=>a,selectRandomBridgeUrl:()=>u,shouldSelectRandomly:()=>c});var n="walletconnect.org",i="abcdefghijklmnopqrstuvwxyz0123456789".split("").map((function(e){return`https://${e}.bridge.walletconnect.org`}));function o(e){var t=e.indexOf("//")>-1?e.split("/")[2]:e.split("/")[0];return t=(t=t.split(":")[0]).split("?")[0]}function s(e){return o(e).split(".").slice(-2).join(".")}function a(){return Math.floor(Math.random()*i.length)}function u(){return i[a()]}function c(e){return s(e)===n}function l(e){return c(e)?u():e}},60220:(e,t,r)=>{"use strict";r.r(t),r.d(t,{RELAY_JSONRPC:()=>s.RELAY_JSONRPC,isPublishMethod:()=>a.isPublishMethod,isPublishParams:()=>a.isPublishParams,isPublishRequest:()=>a.isPublishRequest,isSubscribeMethod:()=>a.isSubscribeMethod,isSubscribeParams:()=>a.isSubscribeParams,isSubscribeRequest:()=>a.isSubscribeRequest,isSubscriptionMethod:()=>a.isSubscriptionMethod,isSubscriptionParams:()=>a.isSubscriptionParams,isSubscriptionRequest:()=>a.isSubscriptionRequest,isUnsubscribeMethod:()=>a.isUnsubscribeMethod,isUnsubscribeParams:()=>a.isUnsubscribeParams,isUnsubscribeRequest:()=>a.isUnsubscribeRequest,parsePublishRequest:()=>o.parsePublishRequest,parseSubscribeRequest:()=>o.parseSubscribeRequest,parseSubscriptionRequest:()=>o.parseSubscriptionRequest,parseUnsubscribeRequest:()=>o.parseUnsubscribeRequest});var n=r(77767),i={};for(const u in n)"default"!==u&&(i[u]=()=>n[u]);r.d(t,i);var o=r(2184),s=r(70666),a=r(20956)},70666:(e,t,r)=>{"use strict";r.r(t),r.d(t,{RELAY_JSONRPC:()=>n});var n={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}}},6209:(e,t,r)=>{"use strict";function n(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"string";if(!e[t]||typeof e[t]!==r)throw new Error(`Missing or invalid "${t}" param`)}function i(e,t){var r=!0;return t.forEach((function(t){t in e||(r=!1)})),r}function o(e,t){return Array.isArray(e)?e.length===t:Object.keys(e).length===t}function s(e,t){return Array.isArray(e)?e.length>=t:Object.keys(e).length>=t}function a(e,t,r){return!!(!r.length?o(e,t.length):s(e,t.length))&&i(e,t)}function u(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"_",n=e.split(r);return n[n.length-1].trim().toLowerCase()===t.trim().toLowerCase()}r.r(t),r.d(t,{assertType:()=>n,checkParams:()=>a,hasExactParamsLength:()=>o,hasRequiredParams:()=>i,hasRequiredParamsLength:()=>s,methodEndsWith:()=>u})},2184:(e,t,r)=>{"use strict";r.r(t),r.d(t,{parsePublishRequest:()=>s,parseSubscribeRequest:()=>o,parseSubscriptionRequest:()=>u,parseUnsubscribeRequest:()=>a});var n=r(6209),i=r(20956);function o(e){if(!(0,i.isSubscribeMethod)(e.method))throw new Error("JSON-RPC Request has invalid subscribe method");if(!(0,i.isSubscribeParams)(e.params))throw new Error("JSON-RPC Request has invalid subscribe params");var t=e.params;return(0,n.assertType)(t,"topic"),t}function s(e){if(!(0,i.isPublishMethod)(e.method))throw new Error("JSON-RPC Request has invalid publish method");if(!(0,i.isPublishParams)(e.params))throw new Error("JSON-RPC Request has invalid publish params");var t=e.params;return(0,n.assertType)(t,"topic"),(0,n.assertType)(t,"message"),(0,n.assertType)(t,"ttl","number"),t}function a(e){if(!(0,i.isUnsubscribeMethod)(e.method))throw new Error("JSON-RPC Request has invalid unsubscribe method");if(!(0,i.isUnsubscribeParams)(e.params))throw new Error("JSON-RPC Request has invalid unsubscribe params");var t=e.params;return(0,n.assertType)(t,"id"),t}function u(e){if(!(0,i.isSubscriptionMethod)(e.method))throw new Error("JSON-RPC Request has invalid subscription method");if(!(0,i.isSubscriptionParams)(e.params))throw new Error("JSON-RPC Request has invalid subscription params");var t=e.params;return(0,n.assertType)(t,"id"),(0,n.assertType)(t,"data"),t}},77767:()=>{},20956:(e,t,r)=>{"use strict";r.r(t),r.d(t,{isPublishMethod:()=>u,isPublishParams:()=>c,isPublishRequest:()=>a,isSubscribeMethod:()=>o,isSubscribeParams:()=>s,isSubscribeRequest:()=>i,isSubscriptionMethod:()=>p,isSubscriptionParams:()=>g,isSubscriptionRequest:()=>d,isUnsubscribeMethod:()=>h,isUnsubscribeParams:()=>f,isUnsubscribeRequest:()=>l});var n=r(6209);function i(e){return o(e.method)&&s(e.params)}function o(e){return(0,n.methodEndsWith)(e,"subscribe")}function s(e){return(0,n.checkParams)(e,["topic"],[])}function a(e){return u(e.method)&&c(e.params)}function u(e){return(0,n.methodEndsWith)(e,"publish")}function c(e){return(0,n.checkParams)(e,["message","topic","ttl"],["prompt","tag"])}function l(e){return h(e.method)&&f(e.params)}function h(e){return(0,n.methodEndsWith)(e,"unsubscribe")}function f(e){return(0,n.checkParams)(e,["id","topic"],[])}function d(e){return p(e.method)&&g(e.params)}function p(e){return(0,n.methodEndsWith)(e,"subscription")}function g(e){return(0,n.checkParams)(e,["id","data"],[])}},17406:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CORE_CONTEXT:()=>at,CORE_DEFAULT:()=>ct,CORE_PROTOCOL:()=>ot,CORE_STORAGE_OPTIONS:()=>lt,CORE_STORAGE_PREFIX:()=>ut,CORE_VERSION:()=>st,CRYPTO_CLIENT_SEED:()=>ft,CRYPTO_CONTEXT:()=>ht,CRYPTO_JWT_TTL:()=>dt,Core:()=>kr,Crypto:()=>Yt,EXPIRER_CONTEXT:()=>$t,EXPIRER_DEFAULT_TTL:()=>Ht,EXPIRER_EVENTS:()=>Kt,EXPIRER_STORAGE_VERSION:()=>Wt,Expirer:()=>Rr,HISTORY_CONTEXT:()=>Vt,HISTORY_EVENTS:()=>qt,HISTORY_STORAGE_VERSION:()=>zt,JsonRpcHistory:()=>Ir,KEYCHAIN_CONTEXT:()=>pt,KEYCHAIN_STORAGE_VERSION:()=>gt,KeyChain:()=>Gt,MESSAGES_CONTEXT:()=>yt,MESSAGES_STORAGE_VERSION:()=>vt,MessageTracker:()=>Zt,PAIRING_CONTEXT:()=>Ut,PAIRING_DEFAULT_TTL:()=>jt,PAIRING_RPC_OPTS:()=>Bt,PAIRING_STORAGE_VERSION:()=>Lt,PENDING_SUB_RESOLUTION_TIMEOUT:()=>Dt,PUBLISHER_CONTEXT:()=>bt,PUBLISHER_DEFAULT_TTL:()=>mt,Pairing:()=>Sr,RELAYER_CONTEXT:()=>St,RELAYER_DEFAULT_LOGGER:()=>_t,RELAYER_DEFAULT_PROTOCOL:()=>Et,RELAYER_DEFAULT_RELAY_URL:()=>wt,RELAYER_EVENTS:()=>It,RELAYER_PROVIDER_EVENTS:()=>Ot,RELAYER_RECONNECT_TIMEOUT:()=>Mt,RELAYER_SDK_VERSION:()=>Pt,RELAYER_STORAGE_OPTIONS:()=>Tt,RELAYER_SUBSCRIBER_SUFFIX:()=>Rt,Relayer:()=>gr,STORE_STORAGE_VERSION:()=>Nt,SUBSCRIBER_CONTEXT:()=>Ct,SUBSCRIBER_DEFAULT_TTL:()=>At,SUBSCRIBER_EVENTS:()=>xt,SUBSCRIBER_STORAGE_VERSION:()=>kt,Store:()=>wr,Subscriber:()=>cr,VERIFY_CONTEXT:()=>Ft,VERIFY_SERVER:()=>Jt,Verify:()=>Or,default:()=>Cr});var n=r(80753),i=r(68079),o=r(45754),s=r(11987),a=r(95058),u=r(34795),c=r(56666),l=r(87371),h=r(22699),f=r.n(h),d=r(68385),p=r(67660),g=r(52500),y=r(17742),v=r(42325),m=r(53179),b=r(63554),E=r(49466),_=r(42537),w=r(21061),S=r(55494),I=r(46328),R=r(33958),O=r.n(R);function M(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,a.default)(e);if(t){var i=(0,a.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){(0,c.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var N=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,u=e.charAt(0),c=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===u;)n++,t++;for(var o=(e.length-t)*c+1>>>0,s=new Uint8Array(o);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,f=o-1;(0!==l||h<i)&&-1!==f;f--,h++)l+=a*s[f]>>>0,s[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var p=new Uint8Array(n+(o-d)),g=n;d!==o;)p[g++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*l+1>>>0,c=new Uint8Array(s);i!==o;){for(var h=t[i],f=0,d=s-1;(0!==h||f<n)&&-1!==d;d--,f++)h+=256*c[d]>>>0,c[d]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=f,i++}for(var p=s-n;p!==s&&0===c[p];)p++;for(var g=u.repeat(r);p<s;++p)g+=e.charAt(c[p]);return g},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}},x=function(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},A=function(){function e(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}return e.prototype.encode=function(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")},(0,l.default)(e)}(),C=function(){function e(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}var t=e.prototype;return t.decode=function(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")},t.or=function(e){return D(this,e)},(0,l.default)(e)}(),k=function(){function e(e){this.decoders=e}var t=e.prototype;return t.or=function(e){return D(this,e)},t.decode=function(e){var t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)},(0,l.default)(e)}(),D=function(e,t){var r,n;return new k(P(P({},e.decoders||((r={})[e.prefix]=e,r)),t.decoders||((n={})[t.prefix]=t,n)))},U=function(){function e(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new A(e,t,r),this.decoder=new C(e,t,n)}var t=e.prototype;return t.encode=function(e){return this.encoder.encode(e)},t.decode=function(e){return this.decoder.decode(e)},(0,l.default)(e)}(),L=function(e){var t=e.name,r=e.prefix,n=e.encode,i=e.decode;return new U(t,r,n,i)},j=function(e){var t=e.prefix,r=e.name,n=e.alphabet,i=N(n,r),o=i.encode,s=i.decode;return L({prefix:t,name:r,encode:o,decode:function(e){return x(s(e))}})},B=function(e){var t=e.name,r=e.prefix,n=e.bitsPerChar,i=e.alphabet;return L({prefix:r,name:t,encode:function(e){return function(e,t,r){for(var n="="===t[t.length-1],i=(1<<r)-1,o="",s=0,a=0,u=0;u<e.length;++u)for(a=a<<8|e[u],s+=8;s>r;)o+=t[i&a>>(s-=r)];if(s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o}(e,i,n)},decode:function(e){return function(e,t,r,n){for(var i={},o=0;o<t.length;++o)i[t[o]]=o;for(var s=e.length;"="===e[s-1];)--s;for(var a=new Uint8Array(s*r/8|0),u=0,c=0,l=0,h=0;h<s;++h){var f=i[e[h]];if(void 0===f)throw new SyntaxError(`Non-${n} character`);c=c<<r|f,(u+=r)>=8&&(u-=8,a[l++]=255&c>>u)}if(u>=r||255&c<<8-u)throw new SyntaxError("Unexpected end of data");return a}(e,i,n,t)}})},q=L({prefix:"\0",name:"identity",encode:function(e){return function(e){return(new TextDecoder).decode(e)}(e)},decode:function(e){return function(e){return(new TextEncoder).encode(e)}(e)}}),V=Object.freeze({__proto__:null,identity:q}),z=B({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),$=Object.freeze({__proto__:null,base2:z}),K=B({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),W=Object.freeze({__proto__:null,base8:K}),H=j({prefix:"9",name:"base10",alphabet:"0123456789"}),F=Object.freeze({__proto__:null,base10:H}),J=B({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),G=B({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Y=Object.freeze({__proto__:null,base16:J,base16upper:G}),Z=B({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),X=B({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Q=B({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ee=B({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),te=B({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),re=B({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ne=B({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ie=B({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),oe=B({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),se=Object.freeze({__proto__:null,base32:Z,base32upper:X,base32pad:Q,base32padupper:ee,base32hex:te,base32hexupper:re,base32hexpad:ne,base32hexpadupper:ie,base32z:oe}),ae=j({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ue=j({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),ce=Object.freeze({__proto__:null,base36:ae,base36upper:ue}),le=j({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),he=j({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),fe=Object.freeze({__proto__:null,base58btc:le,base58flickr:he}),de=B({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),pe=B({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ge=B({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ye=B({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),ve=Object.freeze({__proto__:null,base64:de,base64pad:pe,base64url:ge,base64urlpad:ye}),me=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),be=me.reduce((function(e,t,r){return e[r]=t,e}),[]),Ee=me.reduce((function(e,t,r){return e[t.codePointAt(0)]=r,e}),[]);var _e=L({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce((function(e,t){return e+=be[t]}),"")},decode:function(e){var t=[];for(var r of e){var n=Ee[r.codePointAt(0)];if(void 0===n)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}}),we=Object.freeze({__proto__:null,base256emoji:_e}),Se=function e(t,r,n){r=r||[];for(var i=n=n||0;t>=Oe;)r[n++]=255&t|Ie,t/=128;for(;t&Re;)r[n++]=255&t|Ie,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},Ie=128,Re=-128,Oe=Math.pow(2,31);var Me=function e(t,r){var n,i=0,o=0,s=r=r||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=o<28?(n&Pe)<<o:(n&Pe)*Math.pow(2,o),o+=7}while(n>=Te);return e.bytes=s-r,i},Te=128,Pe=127;var Ne=Math.pow(2,7),xe=Math.pow(2,14),Ae=Math.pow(2,21),Ce=Math.pow(2,28),ke=Math.pow(2,35),De=Math.pow(2,42),Ue=Math.pow(2,49),Le=Math.pow(2,56),je=Math.pow(2,63),Be={encode:Se,decode:Me,encodingLength:function(e){return e<Ne?1:e<xe?2:e<Ae?3:e<Ce?4:e<ke?5:e<De?6:e<Ue?7:e<Le?8:e<je?9:10}},qe=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Be.encode(e,t,r),t},Ve=function(e){return Be.encodingLength(e)},ze=function(e,t){var r=t.byteLength,n=Ve(e),i=n+Ve(r),o=new Uint8Array(i+r);return qe(e,o,0),qe(r,o,n),o.set(t,i),new $e(e,r,t,o)},$e=(0,l.default)((function(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n})),Ke=function(e){var t=e.name,r=e.code,n=e.encode;return new We(t,r,n)},We=function(){function e(e,t,r){this.name=e,this.code=t,this.encode=r}return e.prototype.digest=function(e){var t=this;if(e instanceof Uint8Array){var r=this.encode(e);return r instanceof Uint8Array?ze(this.code,r):r.then((function(e){return ze(t.code,e)}))}throw Error("Unknown type, must be binary type")},(0,l.default)(e)}(),He=function(e){return function(){var t=(0,u.default)((function*(t){return new Uint8Array(yield crypto.subtle.digest(e,t))}));return function(e){return t.apply(this,arguments)}}()},Fe=Ke({name:"sha2-256",code:18,encode:He("SHA-256")}),Je=Ke({name:"sha2-512",code:19,encode:He("SHA-512")}),Ge=Object.freeze({__proto__:null,sha256:Fe,sha512:Je}),Ye=x,Ze={code:0,name:"identity",encode:Ye,digest:function(e){return ze(0,Ye(e))}},Xe=Object.freeze({__proto__:null,identity:Ze});new TextEncoder,new TextDecoder;var Qe=P(P(P(P(P(P(P(P(P(P({},V),$),W),F),Y),se),ce),fe),ve),we);function et(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function tt(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}P(P({},Ge),Xe);var rt=tt("utf8","u",(function(e){return"u"+new TextDecoder("utf8").decode(e)}),(function(e){return(new TextEncoder).encode(e.substring(1))})),nt=tt("ascii","a",(function(e){for(var t="a",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(function(e){for(var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?et(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),it=P({utf8:rt,"utf-8":rt,hex:Qe.base16,latin1:nt,ascii:nt,binary:nt},Qe);var ot="wc",st=2,at="core",ut=`${ot}@2:${at}:`,ct={name:at,logger:"error"},lt={database:":memory:"},ht="crypto",ft="client_ed25519_seed",dt=_.ONE_DAY,pt="keychain",gt="0.3",yt="messages",vt="0.3",mt=_.SIX_HOURS,bt="publisher",Et="irn",_t="error",wt="wss://relay.walletconnect.com",St="relayer",It={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Rt="_subscription",Ot={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Mt=_.ONE_SECOND/2,Tt={database:":memory:"},Pt="2.7.3",Nt="0.3",xt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},At=_.THIRTY_DAYS,Ct="subscription",kt="0.3",Dt=1e3*_.FIVE_SECONDS,Ut="pairing",Lt="0.3",jt=_.THIRTY_DAYS,Bt={wc_pairingDelete:{req:{ttl:_.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:_.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:_.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:_.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:_.ONE_DAY,prompt:!1,tag:0},res:{ttl:_.ONE_DAY,prompt:!1,tag:0}}},qt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Vt="history",zt="0.3",$t="expirer",Kt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Wt="0.3",Ht=_.ONE_DAY,Ft="verify-api",Jt="https://verify.walletconnect.com",Gt=function(){function e(e,t){var r=this;this.core=e,this.logger=t,this.keychain=new Map,this.name=pt,this.version=gt,this.initialized=!1,this.storagePrefix=ut,this.init=(0,u.default)((function*(){if(!r.initialized){var e=yield r.getKeyChain();typeof e<"u"&&(r.keychain=e),r.initialized=!0}})),this.has=function(e){return r.isInitialized(),r.keychain.has(e)},this.set=function(){var e=(0,u.default)((function*(e,t){r.isInitialized(),r.keychain.set(e,t),yield r.persist()}));return function(t,r){return e.apply(this,arguments)}}(),this.get=function(e){r.isInitialized();var t=r.keychain.get(e);if(typeof t>"u"){var n=(0,b.getInternalError)("NO_MATCHING_KEY",`${r.name}: ${e}`).message;throw new Error(n)}return t},this.del=function(){var e=(0,u.default)((function*(e){r.isInitialized(),r.keychain.delete(e),yield r.persist()}));return function(t){return e.apply(this,arguments)}}(),this.core=e,this.logger=(0,g.generateChildLogger)(t,this.name)}var t=e.prototype;return t.setKeyChain=function(){var e=(0,u.default)((function*(e){yield this.core.storage.setItem(this.storageKey,(0,b.mapToObj)(e))}));return function(t){return e.apply(this,arguments)}}(),t.getKeyChain=function(){var e=(0,u.default)((function*(){var e=yield this.core.storage.getItem(this.storageKey);return typeof e<"u"?(0,b.objToMap)(e):void 0}));return function(){return e.apply(this,arguments)}}(),t.persist=function(){var e=(0,u.default)((function*(){yield this.setKeyChain(this.keychain)}));return function(){return e.apply(this,arguments)}}(),t.isInitialized=function(){if(!this.initialized){var e=(0,b.getInternalError)("NOT_INITIALIZED",this.name).message;throw new Error(e)}},(0,l.default)(e,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+"//"+this.name}}]),e}(),Yt=function(){function e(e,t,r){var n=this;this.core=e,this.logger=t,this.name=ht,this.initialized=!1,this.init=(0,u.default)((function*(){n.initialized||(yield n.keychain.init(),n.initialized=!0)})),this.hasKeys=function(e){return n.isInitialized(),n.keychain.has(e)},this.getClientId=(0,u.default)((function*(){n.isInitialized();var e=yield n.getClientSeed(),t=m.generateKeyPair(e);return m.encodeIss(t.publicKey)})),this.generateKeyPair=function(){n.isInitialized();var e=(0,b.generateKeyPair)();return n.setPrivateKey(e.publicKey,e.privateKey)},this.signJWT=function(){var e=(0,u.default)((function*(e){n.isInitialized();var t=yield n.getClientSeed(),r=m.generateKeyPair(t),i=(0,b.generateRandomBytes32)(),o=dt;return yield m.signJWT(i,e,o,r)}));return function(t){return e.apply(this,arguments)}}(),this.generateSharedKey=function(e,t,r){n.isInitialized();var i=n.getPrivateKey(e),o=(0,b.deriveSymKey)(i,t);return n.setSymKey(o,r)},this.setSymKey=function(){var e=(0,u.default)((function*(e,t){n.isInitialized();var r=t||(0,b.hashKey)(e);return yield n.keychain.set(r,e),r}));return function(t,r){return e.apply(this,arguments)}}(),this.deleteKeyPair=function(){var e=(0,u.default)((function*(e){n.isInitialized(),yield n.keychain.del(e)}));return function(t){return e.apply(this,arguments)}}(),this.deleteSymKey=function(){var e=(0,u.default)((function*(e){n.isInitialized(),yield n.keychain.del(e)}));return function(t){return e.apply(this,arguments)}}(),this.encode=function(){var e=(0,u.default)((function*(e,t,r){n.isInitialized();var i=(0,b.validateEncoding)(r),o=(0,v.safeJsonStringify)(t);if((0,b.isTypeOneEnvelope)(i)){var s=i.senderPublicKey,a=i.receiverPublicKey;e=yield n.generateSharedKey(s,a)}var u=n.getSymKey(e),c=i.type,l=i.senderPublicKey;return(0,b.encrypt)({type:c,symKey:u,message:o,senderPublicKey:l})}));return function(t,r,n){return e.apply(this,arguments)}}(),this.decode=function(){var e=(0,u.default)((function*(e,t,r){n.isInitialized();var i=(0,b.validateDecoding)(t,r);if((0,b.isTypeOneEnvelope)(i)){var o=i.receiverPublicKey,s=i.senderPublicKey;e=yield n.generateSharedKey(o,s)}var a=n.getSymKey(e),u=(0,b.decrypt)({symKey:a,encoded:t});return(0,v.safeJsonParse)(u)}));return function(t,r,n){return e.apply(this,arguments)}}(),this.getPayloadType=function(e){var t=(0,b.deserialize)(e);return(0,b.decodeTypeByte)(t.type)},this.getPayloadSenderPublicKey=function(e){var t=(0,b.deserialize)(e);return t.senderPublicKey?(0,E.toString)(t.senderPublicKey,b.BASE16):void 0},this.core=e,this.logger=(0,g.generateChildLogger)(t,this.name),this.keychain=r||new Gt(this.core,this.logger)}var t=e.prototype;return t.setPrivateKey=function(){var e=(0,u.default)((function*(e,t){return yield this.keychain.set(e,t),e}));return function(t,r){return e.apply(this,arguments)}}(),t.getPrivateKey=function(e){return this.keychain.get(e)},t.getClientSeed=function(){var e=(0,u.default)((function*(){var e="";try{e=this.keychain.get(ft)}catch(t){e=(0,b.generateRandomBytes32)(),yield this.keychain.set(ft,e)}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",r=it[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):et(globalThis.Buffer.from(e,"utf-8"))}(e,"base16")}));return function(){return e.apply(this,arguments)}}(),t.getSymKey=function(e){return this.keychain.get(e)},t.isInitialized=function(){if(!this.initialized){var e=(0,b.getInternalError)("NOT_INITIALIZED",this.name).message;throw new Error(e)}},(0,l.default)(e,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}}]),e}(),Zt=function(e){(0,o.default)(r,e);var t=M(r);function r(e,r){var n;return(n=t.call(this,e,r)).logger=e,n.core=r,n.messages=new Map,n.name=yt,n.version=vt,n.initialized=!1,n.storagePrefix=ut,n.init=(0,u.default)((function*(){if(!n.initialized){n.logger.trace("Initialized");try{var e=yield n.getRelayerMessages();typeof e<"u"&&(n.messages=e),n.logger.debug(`Successfully Restored records for ${n.name}`),n.logger.trace({type:"method",method:"restore",size:n.messages.size})}catch(e){n.logger.debug(`Failed to Restore records for ${n.name}`),n.logger.error(e)}finally{n.initialized=!0}}})),n.set=function(){var e=(0,u.default)((function*(e,t){n.isInitialized();var r=(0,b.hashMessage)(t),i=n.messages.get(e);return typeof i>"u"&&(i={}),typeof i[r]<"u"||(i[r]=t,n.messages.set(e,i),yield n.persist()),r}));return function(t,r){return e.apply(this,arguments)}}(),n.get=function(e){n.isInitialized();var t=n.messages.get(e);return typeof t>"u"&&(t={}),t},n.has=function(e,t){return n.isInitialized(),typeof n.get(e)[(0,b.hashMessage)(t)]<"u"},n.del=function(){var e=(0,u.default)((function*(e){n.isInitialized(),n.messages.delete(e),yield n.persist()}));return function(t){return e.apply(this,arguments)}}(),n.logger=(0,g.generateChildLogger)(e,n.name),n.core=r,n}var n=r.prototype;return n.setRelayerMessages=function(){var e=(0,u.default)((function*(e){yield this.core.storage.setItem(this.storageKey,(0,b.mapToObj)(e))}));return function(t){return e.apply(this,arguments)}}(),n.getRelayerMessages=function(){var e=(0,u.default)((function*(){var e=yield this.core.storage.getItem(this.storageKey);return typeof e<"u"?(0,b.objToMap)(e):void 0}));return function(){return e.apply(this,arguments)}}(),n.persist=function(){var e=(0,u.default)((function*(){yield this.setRelayerMessages(this.messages)}));return function(){return e.apply(this,arguments)}}(),n.isInitialized=function(){if(!this.initialized){var e=(0,b.getInternalError)("NOT_INITIALIZED",this.name).message;throw new Error(e)}},(0,l.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+"//"+this.name}}]),r}(y.IMessageTracker),Xt=function(e){(0,o.default)(r,e);var t=M(r);function r(e,r){var n;return(n=t.call(this,e,r)).relayer=e,n.logger=r,n.events=new h.EventEmitter,n.name=bt,n.queue=new Map,n.publishTimeout=1e4,n.publish=function(){var e=(0,u.default)((function*(e,t,r){n.logger.debug("Publishing Payload"),n.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:r}});try{var i=(null==r?void 0:r.ttl)||mt,o=(0,b.getRelayProtocolName)(r),s=(null==r?void 0:r.prompt)||!1,a=(null==r?void 0:r.tag)||0,u={topic:e,message:t,opts:{ttl:i,relay:o,prompt:s,tag:a}},c=(0,b.hashMessage)(t);n.queue.set(c,u);try{yield yield(0,b.createExpiringPromise)(n.rpcPublish(e,t,i,o,s,a),n.publishTimeout),n.relayer.events.emit(It.publish,u)}catch(l){return n.logger.debug("Publishing Payload stalled"),void n.relayer.events.emit(It.connection_stalled)}n.onPublish(c,u),n.logger.debug("Successfully Published Payload"),n.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:r}})}catch(i){throw n.logger.debug("Failed to Publish Payload"),n.logger.error(i),i}}));return function(t,r,n){return e.apply(this,arguments)}}(),n.on=function(e,t){n.events.on(e,t)},n.once=function(e,t){n.events.once(e,t)},n.off=function(e,t){n.events.off(e,t)},n.removeListener=function(e,t){n.events.removeListener(e,t)},n.relayer=e,n.logger=(0,g.generateChildLogger)(r,n.name),n.registerEventListeners(),n}var n=r.prototype;return n.rpcPublish=function(e,t,r,n,i,o){var s,a,u,c,l={method:(0,b.getRelayProtocolApi)(n.protocol).publish,params:{topic:e,message:t,ttl:r,prompt:i,tag:o}};return(0,b.isUndefined)(null==(s=l.params)?void 0:s.prompt)&&(null==(a=l.params)||delete a.prompt),(0,b.isUndefined)(null==(u=l.params)?void 0:u.tag)&&(null==(c=l.params)||delete c.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:l}),this.relayer.request(l)},n.onPublish=function(e,t){this.queue.delete(e)},n.checkQueue=function(){var e=this;this.queue.forEach(function(){var t=(0,u.default)((function*(t){var r=t.topic,n=t.message,i=t.opts;yield e.publish(r,n,i)}));return function(e){return t.apply(this,arguments)}}())},n.registerEventListeners=function(){var e=this;this.relayer.core.heartbeat.on(p.HEARTBEAT_EVENTS.pulse,(function(){e.checkQueue()}))},(0,l.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}}]),r}(y.IPublisher),Qt=function(){function e(){var e=this;this.map=new Map,this.set=function(t,r){var n=e.get(t);e.exists(t,r)||e.map.set(t,[].concat((0,i.default)(n),[r]))},this.get=function(t){return e.map.get(t)||[]},this.exists=function(t,r){return e.get(t).includes(r)},this.delete=function(t,r){if(typeof r>"u")e.map.delete(t);else if(e.map.has(t)){var n=e.get(t);if(e.exists(t,r)){var i=n.filter((function(e){return e!==r}));i.length?e.map.set(t,i):e.map.delete(t)}}},this.clear=function(){e.map.clear()}}return(0,l.default)(e,[{key:"topics",get:function(){return Array.from(this.map.keys())}}]),e}(),er=Object.defineProperty,tr=Object.defineProperties,rr=Object.getOwnPropertyDescriptors,nr=Object.getOwnPropertySymbols,ir=Object.prototype.hasOwnProperty,or=Object.prototype.propertyIsEnumerable,sr=function(e,t,r){return t in e?er(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},ar=function(e,t){for(var r in t||(t={}))ir.call(t,r)&&sr(e,r,t[r]);if(nr)for(var r of nr(t))or.call(t,r)&&sr(e,r,t[r]);return e},ur=function(e,t){return tr(e,rr(t))},cr=function(e){(0,o.default)(r,e);var t=M(r);function r(e,r){var n;return(n=t.call(this,e,r)).relayer=e,n.logger=r,n.subscriptions=new Map,n.topicMap=new Qt,n.events=new h.EventEmitter,n.name=Ct,n.version=kt,n.pending=new Map,n.cached=[],n.initialized=!1,n.pendingSubscriptionWatchLabel="pending_sub_watch_label",n.pollingInterval=20,n.storagePrefix=ut,n.subscribeTimeout=1e4,n.restartInProgress=!1,n.batchSubscribeTopicsLimit=500,n.init=(0,u.default)((function*(){n.initialized||(n.logger.trace("Initialized"),yield n.restart(),n.registerEventListeners(),n.onEnable(),n.clientId=yield n.relayer.core.crypto.getClientId())})),n.subscribe=function(){var e=(0,u.default)((function*(e,t){yield n.restartToComplete(),n.isInitialized(),n.logger.debug("Subscribing Topic"),n.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{var r=(0,b.getRelayProtocolName)(t),i={topic:e,relay:r};n.pending.set(e,i);var o=yield n.rpcSubscribe(e,r);return n.onSubscribe(o,i),n.logger.debug("Successfully Subscribed Topic"),n.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}}),o}catch(r){throw n.logger.debug("Failed to Subscribe Topic"),n.logger.error(r),r}}));return function(t,r){return e.apply(this,arguments)}}(),n.unsubscribe=function(){var e=(0,u.default)((function*(e,t){yield n.restartToComplete(),n.isInitialized(),typeof(null==t?void 0:t.id)<"u"?yield n.unsubscribeById(e,t.id,t):yield n.unsubscribeByTopic(e,t)}));return function(t,r){return e.apply(this,arguments)}}(),n.isSubscribed=function(){var e=(0,u.default)((function*(e){return!!n.topics.includes(e)||(yield new Promise((function(t,r){var i=new _.Watch;i.start(n.pendingSubscriptionWatchLabel);var o=setInterval((function(){!n.pending.has(e)&&n.topics.includes(e)&&(clearInterval(o),i.stop(n.pendingSubscriptionWatchLabel),t(!0)),i.elapsed(n.pendingSubscriptionWatchLabel)>=Dt&&(clearInterval(o),i.stop(n.pendingSubscriptionWatchLabel),r(!1))}),n.pollingInterval)})))}));return function(t){return e.apply(this,arguments)}}(),n.on=function(e,t){n.events.on(e,t)},n.once=function(e,t){n.events.once(e,t)},n.off=function(e,t){n.events.off(e,t)},n.removeListener=function(e,t){n.events.removeListener(e,t)},n.restart=(0,u.default)((function*(){n.restartInProgress=!0,yield n.restore(),yield n.reset(),n.restartInProgress=!1})),n.relayer=e,n.logger=(0,g.generateChildLogger)(r,n.name),n.clientId="",n}var n=r.prototype;return n.hasSubscription=function(e,t){var r=!1;try{r=this.getSubscription(e).topic===t}catch(n){}return r},n.onEnable=function(){this.cached=[],this.initialized=!0},n.onDisable=function(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()},n.unsubscribeByTopic=function(){var e=(0,u.default)((function*(e,t){var r=this,n=this.topicMap.get(e);yield Promise.all(n.map(function(){var n=(0,u.default)((function*(n){return yield r.unsubscribeById(e,n,t)}));return function(e){return n.apply(this,arguments)}}()))}));return function(t,r){return e.apply(this,arguments)}}(),n.unsubscribeById=function(){var e=(0,u.default)((function*(e,t,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{var n=(0,b.getRelayProtocolName)(r);yield this.rpcUnsubscribe(e,t,n);var i=(0,b.getSdkError)("USER_DISCONNECTED",`${this.name}, ${e}`);yield this.onUnsubscribe(e,t,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}));return function(t,r,n){return e.apply(this,arguments)}}(),n.rpcSubscribe=function(){var e=(0,u.default)((function*(e,t){var r={method:(0,b.getRelayProtocolApi)(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{yield yield(0,b.createExpiringPromise)(this.relayer.request(r),this.subscribeTimeout)}catch(n){this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(It.connection_stalled)}return(0,b.hashMessage)(e+this.clientId)}));return function(t,r){return e.apply(this,arguments)}}(),n.rpcBatchSubscribe=function(){var e=(0,u.default)((function*(e){if(e.length){var t=e[0].relay,r={method:(0,b.getRelayProtocolApi)(t.protocol).batchSubscribe,params:{topics:e.map((function(e){return e.topic}))}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{return yield yield(0,b.createExpiringPromise)(this.relayer.request(r),this.subscribeTimeout)}catch(n){this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(It.connection_stalled)}}}));return function(t){return e.apply(this,arguments)}}(),n.rpcUnsubscribe=function(e,t,r){var n={method:(0,b.getRelayProtocolApi)(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)},n.onSubscribe=function(e,t){this.setSubscription(e,ur(ar({},t),{id:e})),this.pending.delete(t.topic)},n.onBatchSubscribe=function(e){var t=this;e.length&&e.forEach((function(e){t.setSubscription(e.id,ar({},e)),t.pending.delete(e.topic)}))},n.onUnsubscribe=function(){var e=(0,u.default)((function*(e,t,r){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,r),yield this.relayer.messages.del(e)}));return function(t,r,n){return e.apply(this,arguments)}}(),n.setRelayerSubscriptions=function(){var e=(0,u.default)((function*(e){yield this.relayer.core.storage.setItem(this.storageKey,e)}));return function(t){return e.apply(this,arguments)}}(),n.getRelayerSubscriptions=function(){var e=(0,u.default)((function*(){return yield this.relayer.core.storage.getItem(this.storageKey)}));return function(){return e.apply(this,arguments)}}(),n.setSubscription=function(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))},n.addSubscription=function(e,t){this.subscriptions.set(e,ar({},t)),this.topicMap.set(t.topic,e),this.events.emit(xt.created,t)},n.getSubscription=function(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});var t=this.subscriptions.get(e);if(!t){var r=(0,b.getInternalError)("NO_MATCHING_KEY",`${this.name}: ${e}`).message;throw new Error(r)}return t},n.deleteSubscription=function(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});var r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(xt.deleted,ur(ar({},r),{reason:t}))},n.persist=function(){var e=(0,u.default)((function*(){yield this.setRelayerSubscriptions(this.values),this.events.emit(xt.sync)}));return function(){return e.apply(this,arguments)}}(),n.reset=function(){var e=(0,u.default)((function*(){if(this.cached.length)for(var e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit),t=0;t<e;t++){var r=this.cached.splice(0,this.batchSubscribeTopicsLimit);yield this.batchSubscribe(r)}this.events.emit(xt.resubscribed)}));return function(){return e.apply(this,arguments)}}(),n.restore=function(){var e=(0,u.default)((function*(){try{var e=yield this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){var t=(0,b.getInternalError)("RESTORE_WILL_OVERRIDE",this.name).message;throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}));return function(){return e.apply(this,arguments)}}(),n.batchSubscribe=function(){var e=(0,u.default)((function*(e){if(e.length){var t=yield this.rpcBatchSubscribe(e);(0,b.isValidArray)(t)&&this.onBatchSubscribe(t.map((function(t,r){return ur(ar({},e[r]),{id:t})})))}}));return function(t){return e.apply(this,arguments)}}(),n.onConnect=function(){var e=(0,u.default)((function*(){this.restartInProgress||(yield this.restart(),this.onEnable())}));return function(){return e.apply(this,arguments)}}(),n.onDisconnect=function(){this.onDisable()},n.checkPending=function(){var e=(0,u.default)((function*(){if(!this.relayer.transportExplicitlyClosed){var e=[];this.pending.forEach((function(t){e.push(t)})),yield this.batchSubscribe(e)}}));return function(){return e.apply(this,arguments)}}(),n.registerEventListeners=function(){var e=this;this.relayer.core.heartbeat.on(p.HEARTBEAT_EVENTS.pulse,(0,u.default)((function*(){yield e.checkPending()}))),this.relayer.on(It.connect,(0,u.default)((function*(){yield e.onConnect()}))),this.relayer.on(It.disconnect,(function(){e.onDisconnect()})),this.events.on(xt.created,function(){var t=(0,u.default)((function*(t){var r=xt.created;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,data:t}),yield e.persist()}));return function(e){return t.apply(this,arguments)}}()),this.events.on(xt.deleted,function(){var t=(0,u.default)((function*(t){var r=xt.deleted;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,data:t}),yield e.persist()}));return function(e){return t.apply(this,arguments)}}())},n.isInitialized=function(){if(!this.initialized){var e=(0,b.getInternalError)("NOT_INITIALIZED",this.name).message;throw new Error(e)}},n.restartToComplete=function(){var e=(0,u.default)((function*(){var e=this;this.restartInProgress&&(yield new Promise((function(t){var r=setInterval((function(){e.restartInProgress||(clearInterval(r),t())}),e.pollingInterval)})))}));return function(){return e.apply(this,arguments)}}(),(0,l.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+"//"+this.name}},{key:"length",get:function(){return this.subscriptions.size}},{key:"ids",get:function(){return Array.from(this.subscriptions.keys())}},{key:"values",get:function(){return Array.from(this.subscriptions.values())}},{key:"topics",get:function(){return this.topicMap.topics}}]),r}(y.ISubscriber),lr=Object.defineProperty,hr=Object.getOwnPropertySymbols,fr=Object.prototype.hasOwnProperty,dr=Object.prototype.propertyIsEnumerable,pr=function(e,t,r){return t in e?lr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},gr=function(e){(0,o.default)(r,e);var t=M(r);function r(e){var r;return(r=t.call(this,e)).protocol="wc",r.version=2,r.events=new h.EventEmitter,r.name=St,r.transportExplicitlyClosed=!1,r.initialized=!1,r.reconnecting=!1,r.connectionStatusPollingInterval=20,r.staleConnectionErrors=["socket hang up","socket stalled"],r.request=function(){var e=(0,u.default)((function*(e){r.logger.debug("Publishing Request Payload");try{return yield r.toEstablishConnection(),yield r.provider.request(e)}catch(t){throw r.logger.debug("Failed to Publish Request"),r.logger.error(t),t}}));return function(t){return e.apply(this,arguments)}}(),r.core=e.core,r.logger=typeof e.logger<"u"&&"string"!=typeof e.logger?(0,g.generateChildLogger)(e.logger,r.name):(0,g.pino)((0,g.getDefaultLoggerOptions)({level:e.logger||_t})),r.messages=new Zt(r.logger,e.core),r.subscriber=new cr((0,n.default)(r),r.logger),r.publisher=new Xt((0,n.default)(r),r.logger),r.relayUrl=(null==e?void 0:e.relayUrl)||wt,r.projectId=e.projectId,r.provider={},r}var i=r.prototype;return i.init=function(){var e=(0,u.default)((function*(){this.logger.trace("Initialized"),yield this.createProvider(),yield Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}));return function(){return e.apply(this,arguments)}}(),i.publish=function(){var e=(0,u.default)((function*(e,t,r){this.isInitialized(),yield this.publisher.publish(e,t,r),yield this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}));return function(t,r,n){return e.apply(this,arguments)}}(),i.subscribe=function(){var e=(0,u.default)((function*(e,t){var r=this;this.isInitialized();var n="";return yield Promise.all([new Promise((function(t){r.subscriber.once(xt.created,(function(r){r.topic===e&&t()}))})),new Promise(function(){var i=(0,u.default)((function*(i){n=yield r.subscriber.subscribe(e,t),i()}));return function(e){return i.apply(this,arguments)}}())]),n}));return function(t,r){return e.apply(this,arguments)}}(),i.unsubscribe=function(){var e=(0,u.default)((function*(e,t){this.isInitialized(),yield this.subscriber.unsubscribe(e,t)}));return function(t,r){return e.apply(this,arguments)}}(),i.on=function(e,t){this.events.on(e,t)},i.once=function(e,t){this.events.once(e,t)},i.off=function(e,t){this.events.off(e,t)},i.removeListener=function(e,t){this.events.removeListener(e,t)},i.transportClose=function(){var e=(0,u.default)((function*(){this.transportExplicitlyClosed=!0,this.connected&&(yield this.provider.disconnect(),this.events.emit(It.transport_closed))}));return function(){return e.apply(this,arguments)}}(),i.transportOpen=function(){var e=(0,u.default)((function*(e){var t=this;if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=e||this.relayUrl,this.reconnecting=!0;try{yield Promise.all([new Promise((function(e){t.initialized||e(),t.subscriber.once(xt.resubscribed,(function(){e()}))})),yield Promise.race([new Promise(function(){var e=(0,u.default)((function*(e,r){yield(0,b.createExpiringPromise)(t.provider.connect(),5e3,"socket stalled").catch((function(e){return r(e)})).then((function(){return e()})).finally((function(){return t.removeListener(It.transport_closed,t.rejectTransportOpen)}))}));return function(t,r){return e.apply(this,arguments)}}()),new Promise((function(e){return t.once(It.transport_closed,t.rejectTransportOpen)}))])])}catch(n){this.logger.error(n);var r=n;if(!this.isConnectionStalled(r.message))throw n;this.events.emit(It.transport_closed)}finally{this.reconnecting=!1}}}));return function(t){return e.apply(this,arguments)}}(),i.restartTransport=function(){var e=(0,u.default)((function*(e){var t=this;this.transportExplicitlyClosed||(this.relayUrl=e||this.relayUrl,this.connected&&(yield Promise.all([new Promise((function(e){t.provider.once(Ot.disconnect,(function(){e()}))})),this.transportClose()])),yield this.createProvider(),yield this.transportOpen())}));return function(t){return e.apply(this,arguments)}}(),i.isConnectionStalled=function(e){return this.staleConnectionErrors.some((function(t){return e.includes(t)}))},i.rejectTransportOpen=function(){throw new Error("closeTransport called before connection was established")},i.createProvider=function(){var e=(0,u.default)((function*(){var e=yield this.core.crypto.signJWT(this.relayUrl);this.provider=new w.JsonRpcProvider(new I.default((0,b.formatRelayRpcUrl)({sdkVersion:Pt,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}));return function(){return e.apply(this,arguments)}}(),i.recordMessageEvent=function(){var e=(0,u.default)((function*(e){var t=e.topic,r=e.message;yield this.messages.set(t,r)}));return function(t){return e.apply(this,arguments)}}(),i.shouldIgnoreMessageEvent=function(){var e=(0,u.default)((function*(e){var t=e.topic,r=e.message;return!(yield this.subscriber.isSubscribed(t))||this.messages.has(t,r)}));return function(t){return e.apply(this,arguments)}}(),i.onProviderPayload=function(){var e=(0,u.default)((function*(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),(0,S.isJsonRpcRequest)(e)){if(!e.method.endsWith(Rt))return;var t=e.params,r=t.data,n={topic:r.topic,message:r.message,publishedAt:r.publishedAt};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(function(e,t){for(var r in t||(t={}))fr.call(t,r)&&pr(e,r,t[r]);if(hr)for(var r of hr(t))dr.call(t,r)&&pr(e,r,t[r]);return e}({type:"event",event:t.id},n)),this.events.emit(t.id,n),yield this.acknowledgePayload(e),yield this.onMessageEvent(n)}}));return function(t){return e.apply(this,arguments)}}(),i.onMessageEvent=function(){var e=(0,u.default)((function*(e){(yield this.shouldIgnoreMessageEvent(e))||(this.events.emit(It.message,e),yield this.recordMessageEvent(e))}));return function(t){return e.apply(this,arguments)}}(),i.acknowledgePayload=function(){var e=(0,u.default)((function*(e){var t=(0,S.formatJsonRpcResult)(e.id,!0);yield this.provider.connection.send(t)}));return function(t){return e.apply(this,arguments)}}(),i.registerProviderListeners=function(){var e=this;this.provider.on(Ot.payload,(function(t){return e.onProviderPayload(t)})),this.provider.on(Ot.connect,(function(){e.events.emit(It.connect)})),this.provider.on(Ot.disconnect,(function(){e.onProviderDisconnect()})),this.provider.on(Ot.error,(function(t){e.logger.error(t),e.events.emit(It.error,t)}))},i.registerEventListeners=function(){var e=this;this.events.on(It.connection_stalled,(0,u.default)((function*(){yield e.restartTransport()})))},i.onProviderDisconnect=function(){this.events.emit(It.disconnect),this.attemptToReconnect()},i.attemptToReconnect=function(){var e=this;this.transportExplicitlyClosed||setTimeout((0,u.default)((function*(){yield e.restartTransport()})),(0,_.toMiliseconds)(Mt))},i.isInitialized=function(){if(!this.initialized){var e=(0,b.getInternalError)("NOT_INITIALIZED",this.name).message;throw new Error(e)}},i.toEstablishConnection=function(){var e=(0,u.default)((function*(){var e=this;if(!this.connected){if(this.connecting)return yield new Promise((function(t){var r=setInterval((function(){e.connected&&(clearInterval(r),t())}),e.connectionStatusPollingInterval)}));yield this.restartTransport()}}));return function(){return e.apply(this,arguments)}}(),(0,l.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"connected",get:function(){return this.provider.connection.connected}},{key:"connecting",get:function(){return this.provider.connection.connecting}}]),r}(y.IRelayer),yr=Object.defineProperty,vr=Object.getOwnPropertySymbols,mr=Object.prototype.hasOwnProperty,br=Object.prototype.propertyIsEnumerable,Er=function(e,t,r){return t in e?yr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},_r=function(e,t){for(var r in t||(t={}))mr.call(t,r)&&Er(e,r,t[r]);if(vr)for(var r of vr(t))br.call(t,r)&&Er(e,r,t[r]);return e},wr=function(e){(0,o.default)(r,e);var t=M(r);function r(e,r,n){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ut,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;return(i=t.call(this,e,r,n,o)).core=e,i.logger=r,i.name=n,i.map=new Map,i.version=Nt,i.cached=[],i.initialized=!1,i.storagePrefix=ut,i.init=(0,u.default)((function*(){i.initialized||(i.logger.trace("Initialized"),yield i.restore(),i.cached.forEach((function(e){i.getKey&&null!==e&&!(0,b.isUndefined)(e)?i.map.set(i.getKey(e),e):(0,b.isProposalStruct)(e)?i.map.set(e.id,e):(0,b.isSessionStruct)(e)&&i.map.set(e.topic,e)})),i.cached=[],i.initialized=!0)})),i.set=function(){var e=(0,u.default)((function*(e,t){i.isInitialized(),i.map.has(e)?yield i.update(e,t):(i.logger.debug("Setting value"),i.logger.trace({type:"method",method:"set",key:e,value:t}),i.map.set(e,t),yield i.persist())}));return function(t,r){return e.apply(this,arguments)}}(),i.get=function(e){return i.isInitialized(),i.logger.debug("Getting value"),i.logger.trace({type:"method",method:"get",key:e}),i.getData(e)},i.getAll=function(e){return i.isInitialized(),e?i.values.filter((function(t){return Object.keys(e).every((function(r){return O()(t[r],e[r])}))})):i.values},i.update=function(){var e=(0,u.default)((function*(e,t){i.isInitialized(),i.logger.debug("Updating value"),i.logger.trace({type:"method",method:"update",key:e,update:t});var r=_r(_r({},i.getData(e)),t);i.map.set(e,r),yield i.persist()}));return function(t,r){return e.apply(this,arguments)}}(),i.delete=function(){var e=(0,u.default)((function*(e,t){i.isInitialized(),i.map.has(e)&&(i.logger.debug("Deleting value"),i.logger.trace({type:"method",method:"delete",key:e,reason:t}),i.map.delete(e),yield i.persist())}));return function(t,r){return e.apply(this,arguments)}}(),i.logger=(0,g.generateChildLogger)(r,i.name),i.storagePrefix=o,i.getKey=s,i}var n=r.prototype;return n.setDataStore=function(){var e=(0,u.default)((function*(e){yield this.core.storage.setItem(this.storageKey,e)}));return function(t){return e.apply(this,arguments)}}(),n.getDataStore=function(){var e=(0,u.default)((function*(){return yield this.core.storage.getItem(this.storageKey)}));return function(){return e.apply(this,arguments)}}(),n.getData=function(e){var t=this.map.get(e);if(!t){var r=(0,b.getInternalError)("NO_MATCHING_KEY",`${this.name}: ${e}`).message;throw this.logger.error(r),new Error(r)}return t},n.persist=function(){var e=(0,u.default)((function*(){yield this.setDataStore(this.values)}));return function(){return e.apply(this,arguments)}}(),n.restore=function(){var e=(0,u.default)((function*(){try{var e=yield this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){var t=(0,b.getInternalError)("RESTORE_WILL_OVERRIDE",this.name).message;throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}));return function(){return e.apply(this,arguments)}}(),n.isInitialized=function(){if(!this.initialized){var e=(0,b.getInternalError)("NOT_INITIALIZED",this.name).message;throw new Error(e)}},(0,l.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+"//"+this.name}},{key:"length",get:function(){return this.map.size}},{key:"keys",get:function(){return Array.from(this.map.keys())}},{key:"values",get:function(){return Array.from(this.map.values())}}]),r}(y.IStore),Sr=function(){function e(e,t){var r=this;this.core=e,this.logger=t,this.name=Ut,this.version=Lt,this.events=new(f()),this.initialized=!1,this.storagePrefix=ut,this.ignoredPayloadTypes=[b.TYPE_1],this.registeredMethods=[],this.init=(0,u.default)((function*(){r.initialized||(yield r.pairings.init(),yield r.cleanup(),r.registerRelayerEvents(),r.registerExpirerEvents(),r.initialized=!0,r.logger.trace("Initialized"))})),this.register=function(e){var t=e.methods;r.isInitialized(),r.registeredMethods=(0,i.default)(new Set([].concat((0,i.default)(r.registeredMethods),(0,i.default)(t))))},this.create=(0,u.default)((function*(){r.isInitialized();var e=(0,b.generateRandomBytes32)(),t=yield r.core.crypto.setSymKey(e),n=(0,b.calcExpiry)(_.FIVE_MINUTES),i={protocol:Et},o={topic:t,expiry:n,relay:i,active:!1},s=(0,b.formatUri)({protocol:r.core.protocol,version:r.core.version,topic:t,symKey:e,relay:i});return yield r.pairings.set(t,o),yield r.core.relayer.subscribe(t),r.core.expirer.set(t,n),{topic:t,uri:s}})),this.pair=function(){var e=(0,u.default)((function*(e){r.isInitialized(),r.isValidPair(e);var t=(0,b.parseUri)(e.uri),n=t.topic,i=t.symKey,o=t.relay;if(r.pairings.keys.includes(n))throw new Error(`Pairing already exists: ${n}`);if(r.core.crypto.hasKeys(n))throw new Error(`Keychain already exists: ${n}`);var s=(0,b.calcExpiry)(_.FIVE_MINUTES),a={topic:n,relay:o,expiry:s,active:!1};return yield r.pairings.set(n,a),yield r.core.crypto.setSymKey(i,n),yield r.core.relayer.subscribe(n,{relay:o}),r.core.expirer.set(n,s),e.activatePairing&&(yield r.activate({topic:n})),a}));return function(t){return e.apply(this,arguments)}}(),this.activate=function(){var e=(0,u.default)((function*(e){var t=e.topic;r.isInitialized();var n=(0,b.calcExpiry)(_.THIRTY_DAYS);yield r.pairings.update(t,{active:!0,expiry:n}),r.core.expirer.set(t,n)}));return function(t){return e.apply(this,arguments)}}(),this.ping=function(){var e=(0,u.default)((function*(e){r.isInitialized(),yield r.isValidPing(e);var t=e.topic;if(r.pairings.keys.includes(t)){var n=yield r.sendRequest(t,"wc_pairingPing",{}),i=(0,b.createDelayedPromise)(),o=i.done,s=i.resolve,a=i.reject;r.events.once((0,b.engineEvent)("pairing_ping",n),(function(e){var t=e.error;t?a(t):s()})),yield o()}}));return function(t){return e.apply(this,arguments)}}(),this.updateExpiry=function(){var e=(0,u.default)((function*(e){var t=e.topic,n=e.expiry;r.isInitialized(),yield r.pairings.update(t,{expiry:n})}));return function(t){return e.apply(this,arguments)}}(),this.updateMetadata=function(){var e=(0,u.default)((function*(e){var t=e.topic,n=e.metadata;r.isInitialized(),yield r.pairings.update(t,{peerMetadata:n})}));return function(t){return e.apply(this,arguments)}}(),this.getPairings=function(){return r.isInitialized(),r.pairings.values},this.disconnect=function(){var e=(0,u.default)((function*(e){r.isInitialized(),yield r.isValidDisconnect(e);var t=e.topic;r.pairings.keys.includes(t)&&(yield r.sendRequest(t,"wc_pairingDelete",(0,b.getSdkError)("USER_DISCONNECTED")),yield r.deletePairing(t))}));return function(t){return e.apply(this,arguments)}}(),this.sendRequest=function(){var e=(0,u.default)((function*(e,t,n){var i=(0,S.formatJsonRpcRequest)(t,n),o=yield r.core.crypto.encode(e,i),s=Bt[t].req;return r.core.history.set(e,i),yield r.core.relayer.publish(e,o,s),i.id}));return function(t,r,n){return e.apply(this,arguments)}}(),this.sendResult=function(){var e=(0,u.default)((function*(e,t,n){var i=(0,S.formatJsonRpcResult)(e,n),o=yield r.core.crypto.encode(t,i),s=yield r.core.history.get(t,e),a=Bt[s.request.method].res;yield r.core.relayer.publish(t,o,a),yield r.core.history.resolve(i)}));return function(t,r,n){return e.apply(this,arguments)}}(),this.sendError=function(){var e=(0,u.default)((function*(e,t,n){var i=(0,S.formatJsonRpcError)(e,n),o=yield r.core.crypto.encode(t,i),s=yield r.core.history.get(t,e),a=Bt[s.request.method]?Bt[s.request.method].res:Bt.unregistered_method.res;yield r.core.relayer.publish(t,o,a),yield r.core.history.resolve(i)}));return function(t,r,n){return e.apply(this,arguments)}}(),this.deletePairing=function(){var e=(0,u.default)((function*(e,t){yield r.core.relayer.unsubscribe(e),yield Promise.all([r.pairings.delete(e,(0,b.getSdkError)("USER_DISCONNECTED")),r.core.crypto.deleteSymKey(e),t?Promise.resolve():r.core.expirer.del(e)])}));return function(t,r){return e.apply(this,arguments)}}(),this.cleanup=(0,u.default)((function*(){var e=r.pairings.getAll().filter((function(e){return(0,b.isExpired)(e.expiry)}));yield Promise.all(e.map((function(e){return r.deletePairing(e.topic)})))})),this.onRelayEventRequest=function(e){var t=e.topic,n=e.payload,i=n.method;if(r.pairings.keys.includes(t))switch(i){case"wc_pairingPing":return r.onPairingPingRequest(t,n);case"wc_pairingDelete":return r.onPairingDeleteRequest(t,n);default:return r.onUnknownRpcMethodRequest(t,n)}},this.onRelayEventResponse=function(){var e=(0,u.default)((function*(e){var t=e.topic,n=e.payload,i=(yield r.core.history.get(t,n.id)).request.method;if(r.pairings.keys.includes(t)){if("wc_pairingPing"===i)return r.onPairingPingResponse(t,n);return r.onUnknownRpcMethodResponse(i)}}));return function(t){return e.apply(this,arguments)}}(),this.onPairingPingRequest=function(){var e=(0,u.default)((function*(e,t){var n=t.id;try{r.isValidPing({topic:e}),yield r.sendResult(n,e,!0),r.events.emit("pairing_ping",{id:n,topic:e})}catch(i){yield r.sendError(n,e,i),r.logger.error(i)}}));return function(t,r){return e.apply(this,arguments)}}(),this.onPairingPingResponse=function(e,t){var n=t.id;setTimeout((function(){(0,S.isJsonRpcResult)(t)?r.events.emit((0,b.engineEvent)("pairing_ping",n),{}):(0,S.isJsonRpcError)(t)&&r.events.emit((0,b.engineEvent)("pairing_ping",n),{error:t.error})}),500)},this.onPairingDeleteRequest=function(){var e=(0,u.default)((function*(e,t){var n=t.id;try{r.isValidDisconnect({topic:e}),yield r.deletePairing(e),r.events.emit("pairing_delete",{id:n,topic:e})}catch(i){yield r.sendError(n,e,i),r.logger.error(i)}}));return function(t,r){return e.apply(this,arguments)}}(),this.onUnknownRpcMethodRequest=function(){var e=(0,u.default)((function*(e,t){var n=t.id,i=t.method;try{if(r.registeredMethods.includes(i))return;var o=(0,b.getSdkError)("WC_METHOD_UNSUPPORTED",i);yield r.sendError(n,e,o),r.logger.error(o)}catch(o){yield r.sendError(n,e,o),r.logger.error(o)}}));return function(t,r){return e.apply(this,arguments)}}(),this.onUnknownRpcMethodResponse=function(e){r.registeredMethods.includes(e)||r.logger.error((0,b.getSdkError)("WC_METHOD_UNSUPPORTED",e))},this.isValidPair=function(e){if(!(0,b.isValidParams)(e)){var t=(0,b.getInternalError)("MISSING_OR_INVALID",`pair() params: ${e}`).message;throw new Error(t)}if(!(0,b.isValidUrl)(e.uri)){var r=(0,b.getInternalError)("MISSING_OR_INVALID",`pair() uri: ${e.uri}`).message;throw new Error(r)}},this.isValidPing=function(){var e=(0,u.default)((function*(e){if(!(0,b.isValidParams)(e)){var t=(0,b.getInternalError)("MISSING_OR_INVALID",`ping() params: ${e}`).message;throw new Error(t)}var n=e.topic;yield r.isValidPairingTopic(n)}));return function(t){return e.apply(this,arguments)}}(),this.isValidDisconnect=function(){var e=(0,u.default)((function*(e){if(!(0,b.isValidParams)(e)){var t=(0,b.getInternalError)("MISSING_OR_INVALID",`disconnect() params: ${e}`).message;throw new Error(t)}var n=e.topic;yield r.isValidPairingTopic(n)}));return function(t){return e.apply(this,arguments)}}(),this.isValidPairingTopic=function(){var e=(0,u.default)((function*(e){if(!(0,b.isValidString)(e,!1)){var t=(0,b.getInternalError)("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`).message;throw new Error(t)}if(!r.pairings.keys.includes(e)){var n=(0,b.getInternalError)("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`).message;throw new Error(n)}if((0,b.isExpired)(r.pairings.get(e).expiry)){yield r.deletePairing(e);var i=(0,b.getInternalError)("EXPIRED",`pairing topic: ${e}`).message;throw new Error(i)}}));return function(t){return e.apply(this,arguments)}}(),this.core=e,this.logger=(0,g.generateChildLogger)(t,this.name),this.pairings=new wr(this.core,this.logger,this.name,this.storagePrefix)}var t=e.prototype;return t.isInitialized=function(){if(!this.initialized){var e=(0,b.getInternalError)("NOT_INITIALIZED",this.name).message;throw new Error(e)}},t.registerRelayerEvents=function(){var e=this;this.core.relayer.on(It.message,function(){var t=(0,u.default)((function*(t){var r=t.topic,n=t.message;if(!e.ignoredPayloadTypes.includes(e.core.crypto.getPayloadType(n))){var i=yield e.core.crypto.decode(r,n);(0,S.isJsonRpcRequest)(i)?(e.core.history.set(r,i),e.onRelayEventRequest({topic:r,payload:i})):(0,S.isJsonRpcResponse)(i)&&(yield e.core.history.resolve(i),e.onRelayEventResponse({topic:r,payload:i}))}}));return function(e){return t.apply(this,arguments)}}())},t.registerExpirerEvents=function(){var e=this;this.core.expirer.on(Kt.expired,function(){var t=(0,u.default)((function*(t){var r=(0,b.parseExpirerTarget)(t.target).topic;r&&e.pairings.keys.includes(r)&&(yield e.deletePairing(r,!0),e.events.emit("pairing_expire",{topic:r}))}));return function(e){return t.apply(this,arguments)}}())},(0,l.default)(e,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}}]),e}(),Ir=function(e){(0,o.default)(r,e);var t=M(r);function r(e,r){var n;return(n=t.call(this,e,r)).core=e,n.logger=r,n.records=new Map,n.events=new h.EventEmitter,n.name=Vt,n.version=zt,n.cached=[],n.initialized=!1,n.storagePrefix=ut,n.init=(0,u.default)((function*(){n.initialized||(n.logger.trace("Initialized"),yield n.restore(),n.cached.forEach((function(e){return n.records.set(e.id,e)})),n.cached=[],n.registerEventListeners(),n.initialized=!0)})),n.set=function(e,t,r){if(n.isInitialized(),n.logger.debug("Setting JSON-RPC request history record"),n.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:r}),!n.records.has(t.id)){var i={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:r};n.records.set(i.id,i),n.events.emit(qt.created,i)}},n.resolve=function(){var e=(0,u.default)((function*(e){if(n.isInitialized(),n.logger.debug("Updating JSON-RPC response history record"),n.logger.trace({type:"method",method:"update",response:e}),n.records.has(e.id)){var t=yield n.getRecord(e.id);typeof t.response>"u"&&(t.response=(0,S.isJsonRpcError)(e)?{error:e.error}:{result:e.result},n.records.set(t.id,t),n.events.emit(qt.updated,t))}}));return function(t){return e.apply(this,arguments)}}(),n.get=function(){var e=(0,u.default)((function*(e,t){return n.isInitialized(),n.logger.debug("Getting record"),n.logger.trace({type:"method",method:"get",topic:e,id:t}),yield n.getRecord(t)}));return function(t,r){return e.apply(this,arguments)}}(),n.delete=function(e,t){n.isInitialized(),n.logger.debug("Deleting record"),n.logger.trace({type:"method",method:"delete",id:t}),n.values.forEach((function(r){if(r.topic===e){if(typeof t<"u"&&r.id!==t)return;n.records.delete(r.id),n.events.emit(qt.deleted,r)}}))},n.exists=function(){var e=(0,u.default)((function*(e,t){return n.isInitialized(),!!n.records.has(t)&&(yield n.getRecord(t)).topic===e}));return function(t,r){return e.apply(this,arguments)}}(),n.on=function(e,t){n.events.on(e,t)},n.once=function(e,t){n.events.once(e,t)},n.off=function(e,t){n.events.off(e,t)},n.removeListener=function(e,t){n.events.removeListener(e,t)},n.logger=(0,g.generateChildLogger)(r,n.name),n}var n=r.prototype;return n.setJsonRpcRecords=function(){var e=(0,u.default)((function*(e){yield this.core.storage.setItem(this.storageKey,e)}));return function(t){return e.apply(this,arguments)}}(),n.getJsonRpcRecords=function(){var e=(0,u.default)((function*(){return yield this.core.storage.getItem(this.storageKey)}));return function(){return e.apply(this,arguments)}}(),n.getRecord=function(e){this.isInitialized();var t=this.records.get(e);if(!t){var r=(0,b.getInternalError)("NO_MATCHING_KEY",`${this.name}: ${e}`).message;throw new Error(r)}return t},n.persist=function(){var e=(0,u.default)((function*(){yield this.setJsonRpcRecords(this.values),this.events.emit(qt.sync)}));return function(){return e.apply(this,arguments)}}(),n.restore=function(){var e=(0,u.default)((function*(){try{var e=yield this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){var t=(0,b.getInternalError)("RESTORE_WILL_OVERRIDE",this.name).message;throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}));return function(){return e.apply(this,arguments)}}(),n.registerEventListeners=function(){var e=this;this.events.on(qt.created,(function(t){var r=qt.created;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,record:t}),e.persist()})),this.events.on(qt.updated,(function(t){var r=qt.updated;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,record:t}),e.persist()})),this.events.on(qt.deleted,(function(t){var r=qt.deleted;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,record:t}),e.persist()}))},n.isInitialized=function(){if(!this.initialized){var e=(0,b.getInternalError)("NOT_INITIALIZED",this.name).message;throw new Error(e)}},(0,l.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+"//"+this.name}},{key:"size",get:function(){return this.records.size}},{key:"keys",get:function(){return Array.from(this.records.keys())}},{key:"values",get:function(){return Array.from(this.records.values())}},{key:"pending",get:function(){var e=[];return this.values.forEach((function(t){if(!(typeof t.response<"u")){var r={topic:t.topic,request:(0,S.formatJsonRpcRequest)(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)}})),e}}]),r}(y.IJsonRpcHistory),Rr=function(e){(0,o.default)(r,e);var t=M(r);function r(e,r){var n;return(n=t.call(this,e,r)).core=e,n.logger=r,n.expirations=new Map,n.events=new h.EventEmitter,n.name=$t,n.version=Wt,n.cached=[],n.initialized=!1,n.storagePrefix=ut,n.init=(0,u.default)((function*(){n.initialized||(n.logger.trace("Initialized"),yield n.restore(),n.cached.forEach((function(e){return n.expirations.set(e.target,e)})),n.cached=[],n.registerEventListeners(),n.initialized=!0)})),n.has=function(e){try{var t=n.formatTarget(e);return typeof n.getExpiration(t)<"u"}catch(r){return!1}},n.set=function(e,t){n.isInitialized();var r=n.formatTarget(e),i={target:r,expiry:t};n.expirations.set(r,i),n.checkExpiry(r,i),n.events.emit(Kt.created,{target:r,expiration:i})},n.get=function(e){n.isInitialized();var t=n.formatTarget(e);return n.getExpiration(t)},n.del=function(e){if(n.isInitialized(),n.has(e)){var t=n.formatTarget(e),r=n.getExpiration(t);n.expirations.delete(t),n.events.emit(Kt.deleted,{target:t,expiration:r})}},n.on=function(e,t){n.events.on(e,t)},n.once=function(e,t){n.events.once(e,t)},n.off=function(e,t){n.events.off(e,t)},n.removeListener=function(e,t){n.events.removeListener(e,t)},n.logger=(0,g.generateChildLogger)(r,n.name),n}var n=r.prototype;return n.formatTarget=function(e){if("string"==typeof e)return(0,b.formatTopicTarget)(e);if("number"==typeof e)return(0,b.formatIdTarget)(e);var t=(0,b.getInternalError)("UNKNOWN_TYPE","Target type: "+typeof e).message;throw new Error(t)},n.setExpirations=function(){var e=(0,u.default)((function*(e){yield this.core.storage.setItem(this.storageKey,e)}));return function(t){return e.apply(this,arguments)}}(),n.getExpirations=function(){var e=(0,u.default)((function*(){return yield this.core.storage.getItem(this.storageKey)}));return function(){return e.apply(this,arguments)}}(),n.persist=function(){var e=(0,u.default)((function*(){yield this.setExpirations(this.values),this.events.emit(Kt.sync)}));return function(){return e.apply(this,arguments)}}(),n.restore=function(){var e=(0,u.default)((function*(){try{var e=yield this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){var t=(0,b.getInternalError)("RESTORE_WILL_OVERRIDE",this.name).message;throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}));return function(){return e.apply(this,arguments)}}(),n.getExpiration=function(e){var t=this.expirations.get(e);if(!t){var r=(0,b.getInternalError)("NO_MATCHING_KEY",`${this.name}: ${e}`).message;throw this.logger.error(r),new Error(r)}return t},n.checkExpiry=function(e,t){var r=t.expiry;(0,_.toMiliseconds)(r)-Date.now()<=0&&this.expire(e,t)},n.expire=function(e,t){this.expirations.delete(e),this.events.emit(Kt.expired,{target:e,expiration:t})},n.checkExpirations=function(){var e=this;this.core.relayer.connected&&this.expirations.forEach((function(t,r){return e.checkExpiry(r,t)}))},n.registerEventListeners=function(){var e=this;this.core.heartbeat.on(p.HEARTBEAT_EVENTS.pulse,(function(){return e.checkExpirations()})),this.events.on(Kt.created,(function(t){var r=Kt.created;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,data:t}),e.persist()})),this.events.on(Kt.expired,(function(t){var r=Kt.expired;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,data:t}),e.persist()})),this.events.on(Kt.deleted,(function(t){var r=Kt.deleted;e.logger.info(`Emitting ${r}`),e.logger.debug({type:"event",event:r,data:t}),e.persist()}))},n.isInitialized=function(){if(!this.initialized){var e=(0,b.getInternalError)("NOT_INITIALIZED",this.name).message;throw new Error(e)}},(0,l.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}},{key:"storageKey",get:function(){return this.storagePrefix+this.version+"//"+this.name}},{key:"length",get:function(){return this.expirations.size}},{key:"keys",get:function(){return Array.from(this.expirations.keys())}},{key:"values",get:function(){return Array.from(this.expirations.values())}}]),r}(y.IExpirer),Or=function(e){(0,o.default)(r,e);var t=M(r);function r(e,r){var n;return(n=t.call(this,e,r)).projectId=e,n.logger=r,n.name=Ft,n.initialized=!1,n.init=function(){var e=(0,u.default)((function*(e){(0,b.isReactNative)()||!(0,b.isBrowser)()||(n.verifyUrl=(null==e?void 0:e.verifyUrl)||Jt,yield n.createIframe())}));return function(t){return e.apply(this,arguments)}}(),n.register=function(){var e=(0,u.default)((function*(e){var t;n.initialized||(yield n.init()),n.iframe&&(null==(t=n.iframe.contentWindow)||t.postMessage(e.attestationId,n.verifyUrl),n.logger.info(`postMessage sent: ${e.attestationId} ${n.verifyUrl}`))}));return function(t){return e.apply(this,arguments)}}(),n.resolve=function(){var e=(0,u.default)((function*(e){var t;if(n.isDevEnv)return"";n.logger.info(`resolving attestation: ${e.attestationId}`);var r=n.startAbortTimer(_.FIVE_SECONDS),i=yield fetch(`${n.verifyUrl}/attestation/${e.attestationId}`,{signal:n.abortController.signal});return clearTimeout(r),200===i.status?null==(t=yield i.json())?void 0:t.origin:""}));return function(t){return e.apply(this,arguments)}}(),n.createIframe=(0,u.default)((function*(){try{yield Promise.race([new Promise((function(e,t){if(document.getElementById(Ft))return e();var r=document.createElement("iframe");r.setAttribute("id",Ft),r.setAttribute("src",`${n.verifyUrl}/${n.projectId}`),r.style.display="none",r.addEventListener("load",(function(){n.initialized=!0,e()})),r.addEventListener("error",(function(e){t(e)})),document.body.append(r),n.iframe=r})),new Promise((function(e){setTimeout((function(){return e("iframe load timeout")}),(0,_.toMiliseconds)(_.ONE_SECOND/2))}))])}catch(e){n.logger.error(`Verify iframe failed to load: ${n.verifyUrl}`),n.logger.error(e)}})),n.logger=(0,g.generateChildLogger)(r,n.name),n.verifyUrl=Jt,n.abortController=new AbortController,n.isDevEnv=(0,b.isNode)()&&{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"web-embed",slug:"web-embed",version:"0.0.1",web:{},description:"Multi-chain support for BTC/ETH/BNB/NEAR/Polygon/Solana/Avalanche/Fantom and others",sdkVersion:"49.0.0",platforms:["ios","android","web"]},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.IS_VITEST,n}return r.prototype.startAbortTimer=function(e){var t=this;return setTimeout((function(){return t.abortController.abort()}),(0,_.toMiliseconds)(e))},(0,l.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}}]),r}(y.IVerify),Mr=Object.defineProperty,Tr=Object.getOwnPropertySymbols,Pr=Object.prototype.hasOwnProperty,Nr=Object.prototype.propertyIsEnumerable,xr=function(e,t,r){return t in e?Mr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Ar=function(e,t){for(var r in t||(t={}))Pr.call(t,r)&&xr(e,r,t[r]);if(Tr)for(var r of Tr(t))Nr.call(t,r)&&xr(e,r,t[r]);return e},Cr=function(e){(0,o.default)(r,e);var t=M(r);function r(e){var r;(r=t.call(this,e)).protocol=ot,r.version=st,r.name=at,r.events=new h.EventEmitter,r.initialized=!1,r.on=function(e,t){return r.events.on(e,t)},r.once=function(e,t){return r.events.once(e,t)},r.off=function(e,t){return r.events.off(e,t)},r.removeListener=function(e,t){return r.events.removeListener(e,t)},r.projectId=null==e?void 0:e.projectId,r.relayUrl=(null==e?void 0:e.relayUrl)||wt;var i=typeof(null==e?void 0:e.logger)<"u"&&"string"!=typeof(null==e?void 0:e.logger)?e.logger:(0,g.pino)((0,g.getDefaultLoggerOptions)({level:(null==e?void 0:e.logger)||ct.logger}));return r.logger=(0,g.generateChildLogger)(i,r.name),r.heartbeat=new p.HeartBeat,r.crypto=new Yt((0,n.default)(r),r.logger,null==e?void 0:e.keychain),r.history=new Ir((0,n.default)(r),r.logger),r.expirer=new Rr((0,n.default)(r),r.logger),r.storage=null!=e&&e.storage?e.storage:new d.default(Ar(Ar({},lt),null==e?void 0:e.storageOptions)),r.relayer=new gr({core:(0,n.default)(r),logger:r.logger,relayUrl:r.relayUrl,projectId:r.projectId}),r.pairing=new Sr((0,n.default)(r),r.logger),r.verify=new Or(r.projectId||"",r.logger),r}r.init=function(){var e=(0,u.default)((function*(e){var t=new r(e);return yield t.initialize(),t}));return function(t){return e.apply(this,arguments)}}();var i=r.prototype;return i.start=function(){var e=(0,u.default)((function*(){this.initialized||(yield this.initialize())}));return function(){return e.apply(this,arguments)}}(),i.initialize=function(){var e=(0,u.default)((function*(){this.logger.trace("Initialized");try{yield this.crypto.init(),yield this.history.init(),yield this.expirer.init(),yield this.relayer.init(),yield this.heartbeat.init(),yield this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}));return function(){return e.apply(this,arguments)}}(),(0,l.default)(r,[{key:"context",get:function(){return(0,g.getLoggerContext)(this.logger)}}]),r}(y.ICore),kr=Cr},17742:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ICore:()=>h,ICrypto:()=>f,IEngine:()=>M,IEngineEvents:()=>O,IExpirer:()=>_,IJsonRpcHistory:()=>d,IKeyChain:()=>E,IMessageTracker:()=>p,IPairing:()=>w,IPublisher:()=>g,IRelayer:()=>y,ISignClient:()=>R,ISignClientEvents:()=>I,IStore:()=>v,ISubscriber:()=>b,ISubscriberTopicMap:()=>m,IVerify:()=>S});var n=r(87371),i=r(45754),o=r(11987),s=r(95058),a=r(5774),u=r(22699),c=r.n(u);function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,o.default)(this,r)}}var h=function(e){(0,i.default)(r,e);var t=l(r);function r(e){var r;return(r=t.call(this)).opts=e,r.protocol="wc",r.version=2,r}return(0,n.default)(r)}(a.IEvents),f=(0,n.default)((function(e,t,r){this.core=e,this.logger=t})),d=function(e){(0,i.default)(r,e);var t=l(r);function r(e,r){var n;return(n=t.call(this)).core=e,n.logger=r,n.records=new Map,n}return(0,n.default)(r)}(a.IEvents),p=(0,n.default)((function(e,t){this.logger=e,this.core=t})),g=function(e){(0,i.default)(r,e);var t=l(r);function r(e,r){var n;return(n=t.call(this)).relayer=e,n.logger=r,n}return(0,n.default)(r)}(a.IEvents),y=function(e){(0,i.default)(r,e);var t=l(r);function r(e){return t.call(this)}return(0,n.default)(r)}(a.IEvents),v=(0,n.default)((function(e,t,r,n){this.core=e,this.logger=t,this.name=r})),m=(0,n.default)((function(){this.map=new Map})),b=function(e){(0,i.default)(r,e);var t=l(r);function r(e,r){var n;return(n=t.call(this)).relayer=e,n.logger=r,n}return(0,n.default)(r)}(a.IEvents),E=(0,n.default)((function(e,t){this.core=e,this.logger=t})),_=function(e){(0,i.default)(r,e);var t=l(r);function r(e,r){var n;return(n=t.call(this)).core=e,n.logger=r,n}return(0,n.default)(r)}(a.IEvents),w=(0,n.default)((function(e,t){this.logger=e,this.core=t})),S=(0,n.default)((function(e,t){this.projectId=e,this.logger=t})),I=function(e){(0,i.default)(r,e);var t=l(r);function r(){return t.call(this)}return(0,n.default)(r)}(c()),R=(0,n.default)((function(e){this.opts=e,this.protocol="wc",this.version=2})),O=function(e){(0,i.default)(r,e);var t=l(r);function r(){return t.call(this)}return(0,n.default)(r)}(u.EventEmitter),M=(0,n.default)((function(e){this.client=e}))},63554:(e,t,r)=>{"use strict";r.r(t),r.d(t,{BASE10:()=>j,BASE16:()=>B,BASE64:()=>q,COLON:()=>ve,DEFAULT_DEPTH:()=>be,EMPTY_SPACE:()=>ye,ENV_MAP:()=>ge,ONE_THOUSAND:()=>Ee,REACT_NATIVE_PRODUCT:()=>pe,RELAYER_DEFAULT_PROTOCOL:()=>tt,SDK_TYPE:()=>_e,SLASH:()=>me,TYPE_0:()=>z,TYPE_1:()=>$,UTF8:()=>V,appendToQueryString:()=>Oe,assertType:()=>ke,buildApprovedNamespaces:()=>Tt,calcExpiry:()=>Ze,capitalize:()=>Ke,capitalizeWord:()=>$e,createDelayedPromise:()=>We,createExpiringPromise:()=>He,decodeTypeByte:()=>ee,decrypt:()=>re,deriveSymKey:()=>Y,deserialize:()=>ie,encodeTypeByte:()=>Q,encrypt:()=>te,engineEvent:()=>Qe,enumify:()=>ze,formatAccountId:()=>w,formatAccountWithChain:()=>O,formatChainId:()=>E,formatExpirerTarget:()=>Fe,formatIdTarget:()=>Ge,formatMessage:()=>L,formatMessageContext:()=>Ue,formatRelayParams:()=>ft,formatRelayRpcUrl:()=>Ae,formatTopicTarget:()=>Je,formatUA:()=>xe,formatUri:()=>dt,generateKeyPair:()=>J,generateRandomBytes32:()=>G,getAccountsChains:()=>St,getAccountsFromNamespaces:()=>P,getAddressFromAccount:()=>I,getAddressesFromAccounts:()=>M,getAppMetadata:()=>Me,getChainFromAccount:()=>R,getChainsFromAccounts:()=>T,getChainsFromNamespace:()=>A,getChainsFromNamespaces:()=>N,getChainsFromRequiredNamespaces:()=>x,getDidAddress:()=>U,getDidAddressSegments:()=>C,getDidChainId:()=>k,getEnvironment:()=>Re,getHttpUrl:()=>Ce,getInternalError:()=>kt,getJavascriptID:()=>Ne,getJavascriptOS:()=>Pe,getLastItems:()=>je,getNamespacedDidChainId:()=>D,getNamespacesChains:()=>It,getNamespacesEventsForChainId:()=>Ot,getNamespacesMethodsForChainId:()=>Rt,getRelayClientMetadata:()=>Te,getRelayProtocolApi:()=>nt,getRelayProtocolName:()=>rt,getRequiredNamespacesFromNamespaces:()=>Mt,getSdkError:()=>Dt,getUniqueValues:()=>S,hasOverlap:()=>Le,hashKey:()=>Z,hashMessage:()=>X,isBrowser:()=>Ie,isCaipNamespace:()=>Pt,isConformingNamespaces:()=>pr,isExpired:()=>Xe,isNode:()=>we,isProposalStruct:()=>Wt,isReactNative:()=>Se,isSessionCompatible:()=>Vt,isSessionStruct:()=>Ht,isTypeOneEnvelope:()=>ae,isUndefined:()=>jt,isValidAccountId:()=>$t,isValidAccounts:()=>Zt,isValidActions:()=>Qt,isValidArray:()=>Ut,isValidChainId:()=>zt,isValidChains:()=>Gt,isValidController:()=>Ft,isValidErrorReason:()=>ar,isValidEvent:()=>lr,isValidId:()=>or,isValidNamespaceAccounts:()=>Xt,isValidNamespaceActions:()=>er,isValidNamespaceChains:()=>Yt,isValidNamespaceMethodsOrEvents:()=>Jt,isValidNamespaces:()=>rr,isValidNamespacesChainId:()=>hr,isValidNamespacesEvent:()=>dr,isValidNamespacesRequest:()=>fr,isValidNumber:()=>qt,isValidObject:()=>Lt,isValidParams:()=>sr,isValidRelay:()=>nr,isValidRelays:()=>ir,isValidRequest:()=>ur,isValidRequestExpiry:()=>yr,isValidRequiredNamespaces:()=>tr,isValidResponse:()=>cr,isValidString:()=>Bt,isValidUrl:()=>Kt,mapEntries:()=>Ve,mapToObj:()=>Be,mergeArrays:()=>et,normalizeNamespaces:()=>xt,objToMap:()=>qe,parseAccountId:()=>_,parseChainId:()=>b,parseContextNames:()=>De,parseExpirerTarget:()=>Ye,parseNamespaceKey:()=>Nt,parseRelayParams:()=>lt,parseUri:()=>ht,serialize:()=>ne,validateDecoding:()=>oe,validateEncoding:()=>se});var n=r(34795),i=r(68079),o=r(96234),s=r(18779),a=r(43133),u=r(61863),c=r(74932),l=r(36381),h=r(49466),f=r(54924),d=r(42537),p=r(45415),g=r(7047),y=r(34126),v=r(60220),m=":";function b(e){var t=e.split(m),r=(0,o.default)(t,2);return{namespace:r[0],reference:r[1]}}function E(e){return[e.namespace,e.reference].join(m)}function _(e){var t=e.split(m),r=(0,o.default)(t,3);return{namespace:r[0],reference:r[1],address:r[2]}}function w(e){return[e.namespace,e.reference,e.address].join(m)}function S(e,t){var r=[];return e.forEach((function(e){var n=t(e);r.includes(n)||r.push(n)})),r}function I(e){return _(e).address}function R(e){var t=_(e);return E({namespace:t.namespace,reference:t.reference})}function O(e,t){var r=b(t);return w({namespace:r.namespace,reference:r.reference,address:e})}function M(e){return S(e,I)}function T(e){return S(e,R)}function P(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return Object.keys(e).forEach((function(n){if(!t.length||t.includes(n)){var o=e[n];r.push.apply(r,(0,i.default)(o.accounts))}})),r}function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return Object.keys(e).forEach((function(n){if(!t.length||t.includes(n)){var o=e[n];r.push.apply(r,(0,i.default)(T(o.accounts)))}})),r}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return Object.keys(e).forEach((function(n){if(!t.length||t.includes(n)){var o=e[n];r.push.apply(r,(0,i.default)(A(n,o)))}})),r}function A(e,t){return e.includes(":")?[e]:t.chains||[]}var C=function(e){return null==e?void 0:e.split(":")},k=function(e){var t=e&&C(e);if(t)return t[3]},D=function(e){var t=e&&C(e);if(t)return t[2]+":"+t[3]},U=function(e){var t=e&&C(e);if(t)return t.pop()},L=function(e,t){return[`${e.domain} wants you to sign in with your Ethereum account:`,U(t),"",e.statement,"",`URI: ${e.aud}`,`Version: ${e.version}`,`Chain ID: ${k(t)}`,`Nonce: ${e.nonce}`,`Issued At: ${e.iat}`,e.resources&&e.resources.length>0?`Resources:\n${e.resources.map((function(e){return`- ${e}`})).join("\n")}`:void 0].filter((function(e){return null!=e})).join("\n")},j="base10",B="base16",q="base64pad",V="utf8",z=0,$=1,K=0,W=1,H=12,F=32;function J(){var e=l.generateKeyPair();return{privateKey:(0,h.toString)(e.secretKey,B),publicKey:(0,h.toString)(e.publicKey,B)}}function G(){var e=(0,u.randomBytes)(F);return(0,h.toString)(e,B)}function Y(e,t){var r=l.sharedKey((0,h.fromString)(e,B),(0,h.fromString)(t,B)),n=new a.HKDF(c.SHA256,r).expand(F);return(0,h.toString)(n,B)}function Z(e){var t=(0,c.hash)((0,h.fromString)(e,B));return(0,h.toString)(t,B)}function X(e){var t=(0,c.hash)((0,h.fromString)(e,V));return(0,h.toString)(t,B)}function Q(e){return(0,h.fromString)(`${e}`,j)}function ee(e){return Number((0,h.toString)(e,j))}function te(e){var t=Q(typeof e.type<"u"?e.type:z);if(ee(t)===$&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");var r=typeof e.senderPublicKey<"u"?(0,h.fromString)(e.senderPublicKey,B):void 0,n=typeof e.iv<"u"?(0,h.fromString)(e.iv,B):(0,u.randomBytes)(H);return ne({type:t,sealed:new s.ChaCha20Poly1305((0,h.fromString)(e.symKey,B)).seal(n,(0,h.fromString)(e.message,V)),iv:n,senderPublicKey:r})}function re(e){var t=new s.ChaCha20Poly1305((0,h.fromString)(e.symKey,B)),r=ie(e.encoded),n=r.sealed,i=r.iv,o=t.open(i,n);if(null===o)throw new Error("Failed to decrypt");return(0,h.toString)(o,V)}function ne(e){if(ee(e.type)===$){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return(0,h.toString)((0,h.concat)([e.type,e.senderPublicKey,e.iv,e.sealed]),q)}return(0,h.toString)((0,h.concat)([e.type,e.iv,e.sealed]),q)}function ie(e){var t=(0,h.fromString)(e,q),r=t.slice(K,W),n=W;if(ee(r)===$){var i=n+F,o=i+H,s=t.slice(n,i),a=t.slice(i,o);return{type:r,sealed:t.slice(o),iv:a,senderPublicKey:s}}var u=n+H,c=t.slice(n,u);return{type:r,sealed:t.slice(u),iv:c}}function oe(e,t){var r=ie(e);return se({type:ee(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?(0,h.toString)(r.senderPublicKey,B):void 0,receiverPublicKey:null==t?void 0:t.receiverPublicKey})}function se(e){var t=(null==e?void 0:e.type)||z;if(t===$){if(typeof(null==e?void 0:e.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(null==e?void 0:e.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:null==e?void 0:e.senderPublicKey,receiverPublicKey:null==e?void 0:e.receiverPublicKey}}function ae(e){return e.type===$&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}var ue=Object.defineProperty,ce=Object.getOwnPropertySymbols,le=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable,fe=function(e,t,r){return t in e?ue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},de=function(e,t){for(var r in t||(t={}))le.call(t,r)&&fe(e,r,t[r]);if(ce)for(var r of ce(t))he.call(t,r)&&fe(e,r,t[r]);return e},pe="ReactNative",ge={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},ye=" ",ve=":",me="/",be=2,Ee=1e3,_e="js";function we(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Se(){return!(0,p.getDocument)()&&!!(0,p.getNavigator)()&&navigator.product===pe}function Ie(){return!we()&&!!(0,p.getNavigator)()}function Re(){return Se()?ge.reactNative:we()?ge.node:Ie()?ge.browser:ge.unknown}function Oe(e,t){var r=y.parse(e);return r=de(de({},r),t),e=y.stringify(r)}function Me(){return(0,g.getWindowMetadata)()||{name:"",description:"",url:"",icons:[""]}}function Te(e,t){var r,n=Re(),i={protocol:e,version:t,env:n};return"browser"===n&&(i.host=(null==(r=(0,p.getLocation)())?void 0:r.host)||"unknown"),i}function Pe(){var e=(0,f.detect)();if(null===e)return"unknown";var t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[t,e.name,e.version].join("-"):[t,e.version].join("-")}function Ne(){var e,t=Re();return t===ge.browser?[t,(null==(e=(0,p.getLocation)())?void 0:e.host)||"unknown"].join(":"):t}function xe(e,t,r){var n=Pe(),i=Ne();return[[e,t].join("-"),[_e,r].join("-"),n,i].join("/")}function Ae(e){var t=e.protocol,r=e.version,n=e.relayUrl,i=e.sdkVersion,o=e.auth,s=e.projectId,a=e.useOnCloseEvent,u=n.split("?"),c={auth:o,ua:xe(t,r,i),projectId:s,useOnCloseEvent:a||void 0},l=Oe(u[1]||"",c);return u[0]+"?"+l}function Ce(e){var t=(e.match(/^[^:]+(?=:\/\/)/gi)||[])[0],r=typeof t<"u"?e.split("://")[1]:e;return[t="wss"===t?"https":"http",r].join("://")}function ke(e,t,r){if(!e[t]||typeof e[t]!==r)throw new Error(`Missing or invalid "${t}" param`)}function De(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:be;return je(e.split(me),t)}function Ue(e){return De(e).join(ye)}function Le(e,t){return e.filter((function(e){return t.includes(e)})).length===e.length}function je(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:be;return e.slice(Math.max(e.length-t,0))}function Be(e){return Object.fromEntries(e.entries())}function qe(e){return new Map(Object.entries(e))}function Ve(e,t){var r={};return Object.keys(e).forEach((function(n){r[n]=t(e[n])})),r}var ze=function(e){return e};function $e(e){return e.trim().replace(/^\w/,(function(e){return e.toUpperCase()}))}function Ke(e){return e.split(ye).map((function(e){return $e(e)})).join(ye)}function We(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.FIVE_MINUTES,i=arguments.length>1?arguments[1]:void 0,o=(0,d.toMiliseconds)(n||d.FIVE_MINUTES);return{resolve:function(t){r&&e&&(clearTimeout(r),e(t))},reject:function(e){r&&t&&(clearTimeout(r),t(e))},done:function(){return new Promise((function(n,s){r=setTimeout((function(){s(new Error(i))}),o),e=n,t=s}))}}}function He(e,t,r){return new Promise(function(){var i=(0,n.default)((function*(n,i){var o=setTimeout((function(){return i(new Error(r))}),t);try{var s;n(yield e)}catch(s){i(s)}clearTimeout(o)}));return function(e,t){return i.apply(this,arguments)}}())}function Fe(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function Je(e){return Fe("topic",e)}function Ge(e){return Fe("id",e)}function Ye(e){var t=e.split(":"),r=(0,o.default)(t,2),n=r[0],i=r[1],s={id:void 0,topic:void 0};if("topic"===n&&"string"==typeof i)s.topic=i;else{if("id"!==n||!Number.isInteger(Number(i)))throw new Error(`Invalid target, expected id:number or topic:string, got ${n}:${i}`);s.id=Number(i)}return s}function Ze(e,t){return(0,d.fromMiliseconds)((t||Date.now())+(0,d.toMiliseconds)(e))}function Xe(e){return Date.now()>=(0,d.toMiliseconds)(e)}function Qe(e,t){return`${e}${t?`:${t}`:""}`}function et(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(0,i.default)(new Set([].concat((0,i.default)(e),(0,i.default)(t))))}var tt="irn";function rt(e){return(null==e?void 0:e.relay)||{protocol:tt}}function nt(e){var t=v.RELAY_JSONRPC[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}var it=Object.defineProperty,ot=Object.getOwnPropertySymbols,st=Object.prototype.hasOwnProperty,at=Object.prototype.propertyIsEnumerable,ut=function(e,t,r){return t in e?it(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},ct=function(e,t){for(var r in t||(t={}))st.call(t,r)&&ut(e,r,t[r]);if(ot)for(var r of ot(t))at.call(t,r)&&ut(e,r,t[r]);return e};function lt(e){var t={},r="relay"+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-");return Object.keys(e).forEach((function(n){if(n.startsWith(r)){var i=n.replace(r,""),o=e[n];t[i]=o}})),t}function ht(e){var t=e.indexOf(":"),r=-1!==e.indexOf("?")?e.indexOf("?"):void 0,n=e.substring(0,t),i=e.substring(t+1,r).split("@"),o=typeof r<"u"?e.substring(r):"",s=y.parse(o);return{protocol:n,topic:i[0],version:parseInt(i[1],10),symKey:s.symKey,relay:lt(s)}}function ft(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",r={};return Object.keys(e).forEach((function(n){var i="relay"+t+n;e[n]&&(r[i]=e[n])})),r}function dt(e){return`${e.protocol}:${e.topic}@${e.version}?`+y.stringify(ct({symKey:e.symKey},ft(e.relay)))}var pt=Object.defineProperty,gt=Object.defineProperties,yt=Object.getOwnPropertyDescriptors,vt=Object.getOwnPropertySymbols,mt=Object.prototype.hasOwnProperty,bt=Object.prototype.propertyIsEnumerable,Et=function(e,t,r){return t in e?pt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},_t=function(e,t){for(var r in t||(t={}))mt.call(t,r)&&Et(e,r,t[r]);if(vt)for(var r of vt(t))bt.call(t,r)&&Et(e,r,t[r]);return e},wt=function(e,t){return gt(e,yt(t))};function St(e){var t=[];return e.forEach((function(e){var r=e.split(":"),n=(0,o.default)(r,2),i=n[0],s=n[1];t.push(`${i}:${s}`)})),t}function It(e){var t=[];return Object.values(e).forEach((function(e){t.push.apply(t,(0,i.default)(St(e.accounts)))})),t}function Rt(e,t){var r=[];return Object.values(e).forEach((function(e){St(e.accounts).includes(t)&&r.push.apply(r,(0,i.default)(e.methods))})),r}function Ot(e,t){var r=[];return Object.values(e).forEach((function(e){St(e.accounts).includes(t)&&r.push.apply(r,(0,i.default)(e.events))})),r}function Mt(e,t){var r=rr(e,t);if(r)throw new Error(r.message);var n={};for(var i of Object.entries(e)){var s=(0,o.default)(i,2),a=s[0],u=s[1];n[a]={methods:u.methods,events:u.events,chains:u.accounts.map((function(e){return`${e.split(":")[0]}:${e.split(":")[1]}`}))}}return n}function Tt(e){var t=e.proposal,r=t.requiredNamespaces,n=t.optionalNamespaces,i=void 0===n?{}:n,o=e.supportedNamespaces,s=xt(r),a=xt(i),u={};Object.keys(o).forEach((function(e){var t=o[e].chains,r=o[e].methods,n=o[e].events,i=o[e].accounts;u[e]={chains:t,methods:r,events:n,accounts:i}}));var c=pr(r,u,"approve()");if(c)throw new Error(c.message);var l={};return Object.keys(s).forEach((function(e){var t=o[e].chains.filter((function(t){var r,n;return null==(n=null==(r=s[e])?void 0:r.chains)?void 0:n.includes(t)})),r=o[e].methods.filter((function(t){var r,n;return null==(n=null==(r=s[e])?void 0:r.methods)?void 0:n.includes(t)})),n=o[e].events.filter((function(t){var r,n;return null==(n=null==(r=s[e])?void 0:r.events)?void 0:n.includes(t)})),i=t.map((function(t){return o[e].accounts.filter((function(e){return e.includes(`${t}:`)}))})).flat();l[e]={chains:t,methods:r,events:n,accounts:i}})),Object.keys(a).forEach((function(e){var t,r,n,i,s,u;if(o[e]){var c=null==(r=null==(t=a[e])?void 0:t.chains)?void 0:r.filter((function(t){return o[e].chains.includes(t)})),h=o[e].methods.filter((function(t){var r,n;return null==(n=null==(r=a[e])?void 0:r.methods)?void 0:n.includes(t)})),f=o[e].events.filter((function(t){var r,n;return null==(n=null==(r=a[e])?void 0:r.events)?void 0:n.includes(t)})),d=null==c?void 0:c.map((function(t){return o[e].accounts.filter((function(e){return e.includes(t)}))})).flat();l[e]={chains:et(null==(n=l[e])?void 0:n.chains,c),methods:et(null==(i=l[e])?void 0:i.methods,h),events:et(null==(s=l[e])?void 0:s.events,f),accounts:et(null==(u=l[e])?void 0:u.accounts,d)}}})),l}function Pt(e){return e.includes(":")}function Nt(e){return Pt(e)?e.split(":")[0]:e}function xt(e){var t,r,n,i={};if(!Lt(e))return i;for(var s of Object.entries(e)){var a=(0,o.default)(s,2),u=a[0],c=a[1],l=Pt(u)?[u]:c.chains,h=c.methods||[],f=c.events||[],d=Nt(u);i[d]=wt(_t({},i[d]),{chains:et(l,null==(t=i[d])?void 0:t.chains),methods:et(h,null==(r=i[d])?void 0:r.methods),events:et(f,null==(n=i[d])?void 0:n.events)})}return i}var At={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Ct={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function kt(e,t){var r=Ct[e],n=r.message;return{message:t?`${n} ${t}`:n,code:r.code}}function Dt(e,t){var r=At[e],n=r.message;return{message:t?`${n} ${t}`:n,code:r.code}}function Ut(e,t){return!!Array.isArray(e)&&(!(typeof t<"u"&&e.length)||e.every(t))}function Lt(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function jt(e){return typeof e>"u"}function Bt(e,t){return!(!t||!jt(e))||"string"==typeof e&&Boolean(e.trim().length)}function qt(e,t){return!(!t||!jt(e))||"number"==typeof e&&!isNaN(e)}function Vt(e,t){var r=t.requiredNamespaces,n=Object.keys(e.namespaces),i=Object.keys(r),o=!0;return!!Le(i,n)&&(n.forEach((function(t){var n=e.namespaces[t],i=n.accounts,s=n.methods,a=n.events,u=St(i),c=r[t];(!Le(A(t,c),u)||!Le(c.methods,s)||!Le(c.events,a))&&(o=!1)})),o)}function zt(e){return!(!Bt(e,!1)||!e.includes(":"))&&2===e.split(":").length}function $t(e){if(Bt(e,!1)&&e.includes(":")){var t=e.split(":");if(3===t.length){var r=t[0]+":"+t[1];return!!t[2]&&zt(r)}}return!1}function Kt(e){if(Bt(e,!1))try{return typeof new URL(e)<"u"}catch(t){return!1}return!1}function Wt(e){var t;return null==(t=null==e?void 0:e.proposer)?void 0:t.publicKey}function Ht(e){return null==e?void 0:e.topic}function Ft(e,t){var r=null;return Bt(null==e?void 0:e.publicKey,!1)||(r=kt("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function Jt(e){var t=!0;return Ut(e)?e.length&&(t=e.every((function(e){return Bt(e,!1)}))):t=!1,t}function Gt(e,t,r){var n=null;return Ut(t)?t.forEach((function(t){n||(!zt(t)||!t.includes(e))&&(n=Dt("UNSUPPORTED_CHAINS",`${r}, chain ${t} should be a string and conform to "namespace:chainId" format`))})):n=Dt("UNSUPPORTED_CHAINS",`${r}, chains ${t} should be an array of strings conforming to "namespace:chainId" format`),n}function Yt(e,t){var r=null;return Object.entries(e).forEach((function(e){var n=(0,o.default)(e,2),i=n[0],s=n[1];if(!r){var a=Gt(i,A(i,s),`${t} requiredNamespace`);a&&(r=a)}})),r}function Zt(e,t){var r=null;return Ut(e)?e.forEach((function(e){r||$t(e)||(r=Dt("UNSUPPORTED_ACCOUNTS",`${t}, account ${e} should be a string and conform to "namespace:chainId:address" format`))})):r=Dt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Xt(e,t){var r=null;return Object.values(e).forEach((function(e){if(!r){var n=Zt(null==e?void 0:e.accounts,`${t} namespace`);n&&(r=n)}})),r}function Qt(e,t){var r=null;return Jt(null==e?void 0:e.methods)?Jt(null==e?void 0:e.events)||(r=Dt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=Dt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function er(e,t){var r=null;return Object.values(e).forEach((function(e){if(!r){var n=Qt(e,`${t}, namespace`);n&&(r=n)}})),r}function tr(e,t,r){var n=null;if(e&&Lt(e)){var i=er(e,t);i&&(n=i);var o=Yt(e,t);o&&(n=o)}else n=kt("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return n}function rr(e,t){var r=null;if(e&&Lt(e)){var n=er(e,t);n&&(r=n);var i=Xt(e,t);i&&(r=i)}else r=kt("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function nr(e){return Bt(e.protocol,!0)}function ir(e,t){var r=!1;return t&&!e?r=!0:e&&Ut(e)&&e.length&&e.forEach((function(e){r=nr(e)})),r}function or(e){return"number"==typeof e}function sr(e){return typeof e<"u"&&null!==typeof e}function ar(e){return!(!e||"object"!=typeof e||!e.code||!qt(e.code,!1)||!e.message||!Bt(e.message,!1))}function ur(e){return!(jt(e)||!Bt(e.method,!1))}function cr(e){return!(jt(e)||jt(e.result)&&jt(e.error)||!qt(e.id,!1)||!Bt(e.jsonrpc,!1))}function lr(e){return!(jt(e)||!Bt(e.name,!1))}function hr(e,t){return!(!zt(t)||!It(e).includes(t))}function fr(e,t,r){return!!Bt(r,!1)&&Rt(e,t).includes(r)}function dr(e,t,r){return!!Bt(r,!1)&&Ot(e,t).includes(r)}function pr(e,t,r){var n=null,i=function(e){var t={};return Object.keys(e).forEach((function(r){var n;r.includes(":")?t[r]=e[r]:null==(n=e[r].chains)||n.forEach((function(n){t[n]={methods:e[r].methods,events:e[r].events}}))})),t}(e),o=function(e){var t={};return Object.keys(e).forEach((function(r){if(r.includes(":"))t[r]=e[r];else{var n=St(e[r].accounts);null==n||n.forEach((function(n){t[n]={accounts:e[r].accounts.filter((function(e){return e.includes(`${n}:`)})),methods:e[r].methods,events:e[r].events}}))}})),t}(t),s=Object.keys(i),a=Object.keys(o),u=gr(Object.keys(e)),c=gr(Object.keys(t)),l=u.filter((function(e){return!c.includes(e)}));return l.length&&(n=kt("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.\n      Required: ${l.toString()}\n      Received: ${Object.keys(t).toString()}`)),Le(s,a)||(n=kt("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.\n      Required: ${s.toString()}\n      Approved: ${a.toString()}`)),Object.keys(t).forEach((function(e){if(e.includes(":")&&!n){var i=St(t[e].accounts);i.includes(e)||(n=kt("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${e}\n        Required: ${e}\n        Approved: ${i.toString()}`))}})),s.forEach((function(e){n||(Le(i[e].methods,o[e].methods)?Le(i[e].events,o[e].events)||(n=kt("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${e}`)):n=kt("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${e}`))})),n}function gr(e){return(0,i.default)(new Set(e.map((function(e){return e.includes(":")?e.split(":")[0]:e}))))}function yr(e,t){return qt(e,!1)&&e<=t.max&&e>=t.min}},69262:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5163);n.__exportStar(r(32668),t),n.__exportStar(r(23928),t)},32668:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_THOUSAND=t.ONE_HUNDRED=void 0,t.ONE_HUNDRED=100,t.ONE_THOUSAND=1e3},23928:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=5*t.ONE_MINUTE,t.TEN_MINUTES=10*t.ONE_MINUTE,t.THIRTY_MINUTES=30*t.ONE_MINUTE,t.SIXTY_MINUTES=60*t.ONE_MINUTE,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=3*t.ONE_HOUR,t.SIX_HOURS=6*t.ONE_HOUR,t.TWELVE_HOURS=12*t.ONE_HOUR,t.TWENTY_FOUR_HOURS=24*t.ONE_HOUR,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=3*t.ONE_DAY,t.FIVE_DAYS=5*t.ONE_DAY,t.SEVEN_DAYS=7*t.ONE_DAY,t.THIRTY_DAYS=30*t.ONE_DAY,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=2*t.ONE_WEEK,t.THREE_WEEKS=3*t.ONE_WEEK,t.FOUR_WEEKS=4*t.ONE_WEEK,t.ONE_YEAR=365*t.ONE_DAY},42537:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5163);n.__exportStar(r(55241),t),n.__exportStar(r(93612),t),n.__exportStar(r(84052),t),n.__exportStar(r(69262),t)},84052:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(5163).__exportStar(r(84755),t)},84755:(e,t,r)=>{"use strict";var n=r(98870);Object.defineProperty(t,"__esModule",{value:!0}),t.IWatch=void 0;var i=n((function(){}));t.IWatch=i},40740:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromMiliseconds=t.toMiliseconds=void 0;var n=r(69262);t.toMiliseconds=function(e){return e*n.ONE_THOUSAND},t.fromMiliseconds=function(e){return Math.floor(e/n.ONE_THOUSAND)}},25518:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delay=void 0,t.delay=function(e){return new Promise((function(t){setTimeout((function(){t(!0)}),e)}))}},55241:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5163);n.__exportStar(r(25518),t),n.__exportStar(r(40740),t)},93612:(e,t,r)=>{"use strict";var n=r(98870);Object.defineProperty(t,"__esModule",{value:!0}),t.Watch=void 0;var i=function(){function e(){this.timestamps=new Map}var t=e.prototype;return t.start=function(e){if(this.timestamps.has(e))throw new Error(`Watch already started for label: ${e}`);this.timestamps.set(e,{started:Date.now()})},t.stop=function(e){var t=this.get(e);if("undefined"!==typeof t.elapsed)throw new Error(`Watch already stopped for label: ${e}`);var r=Date.now()-t.started;this.timestamps.set(e,{started:t.started,elapsed:r})},t.get=function(e){var t=this.timestamps.get(e);if("undefined"===typeof t)throw new Error(`No timestamp found for label: ${e}`);return t},t.elapsed=function(e){var t=this.get(e),r=t.elapsed||Date.now()-t.started;return r},n(e)}();t.Watch=i,t.default=i},74220:(e,t,r)=>{"use strict";r.r(t),r.d(t,{addHexPrefix:()=>Ne,appendToQueryString:()=>ut,concatArrayBuffers:()=>le,concatBuffers:()=>ge,convertArrayBufferToBuffer:()=>se,convertArrayBufferToHex:()=>ue,convertArrayBufferToNumber:()=>ce,convertArrayBufferToUtf8:()=>ae,convertBufferToArrayBuffer:()=>he,convertBufferToHex:()=>de,convertBufferToNumber:()=>pe,convertBufferToUtf8:()=>fe,convertHexToArrayBuffer:()=>_e,convertHexToBuffer:()=>Ee,convertHexToNumber:()=>Se,convertHexToUtf8:()=>we,convertNumberToArrayBuffer:()=>Re,convertNumberToBuffer:()=>Ie,convertNumberToHex:()=>Me,convertNumberToUtf8:()=>Oe,convertUtf8ToArrayBuffer:()=>ye,convertUtf8ToBuffer:()=>ve,convertUtf8ToHex:()=>me,convertUtf8ToNumber:()=>be,detectEnv:()=>m,detectOS:()=>b,formatIOSMobile:()=>K,formatMobileRegistry:()=>X,formatMobileRegistryEntry:()=>Z,formatQueryString:()=>lt,formatRpcError:()=>ot,getClientMeta:()=>L,getCrypto:()=>k,getCryptoOrThrow:()=>C,getDappRegistryUrl:()=>Y,getDocument:()=>T,getDocumentOrThrow:()=>M,getEncoding:()=>Ke,getFromWindow:()=>R,getFromWindowOrThrow:()=>O,getInfuraRpcUrl:()=>Ue,getLocal:()=>V,getLocalStorage:()=>U,getLocalStorageOrThrow:()=>D,getLocation:()=>A,getLocationOrThrow:()=>x,getMobileLinkRegistry:()=>F,getMobileRegistryEntry:()=>H,getNavigator:()=>N,getNavigatorOrThrow:()=>P,getQueryString:()=>at,getRpcUrl:()=>Le,getType:()=>$e,getWalletRegistryUrl:()=>G,infuraNetworks:()=>re,isAndroid:()=>E,isArrayBuffer:()=>ze,isBrowser:()=>I,isBuffer:()=>qe,isEmptyArray:()=>Be,isEmptyString:()=>je,isHexString:()=>We,isIOS:()=>_,isInternalEvent:()=>Ye,isJsonRpcRequest:()=>Fe,isJsonRpcResponseError:()=>Ge,isJsonRpcResponseSuccess:()=>Je,isJsonRpcSubscription:()=>He,isMobile:()=>w,isNode:()=>S,isReservedEvent:()=>Ze,isSilentPayload:()=>Xe,isTypedArray:()=>Ve,isValidAddress:()=>et,isWalletConnectSession:()=>ht,logDeprecationWarning:()=>De,mobileLinkChoiceKey:()=>$,parsePersonalSign:()=>tt,parseQueryString:()=>ct,parseTransactionData:()=>rt,parseWalletConnectUri:()=>ft,payloadId:()=>Ce,promisify:()=>it,removeHexLeadingZeros:()=>Ae,removeHexPrefix:()=>xe,removeLocal:()=>z,reservedEvents:()=>Q,safeJsonParse:()=>j,safeJsonStringify:()=>B,sanitizeHex:()=>Pe,saveMobileLinkInfo:()=>W,setLocal:()=>q,signingMethods:()=>ee,stateMethods:()=>te,toChecksumAddress:()=>Qe,uuid:()=>ke});var n=r(23270),i=r(33480),o=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n},s=function(e,t,r){this.name=e,this.version=t,this.os=r,this.type="browser"},a=function(e){this.version=e,this.type="node",this.name="node",this.os=process.platform},u=function(e,t,r,n){this.name=e,this.version=t,this.os=r,this.bot=n,this.type="bot-device"},c=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},l=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},h=/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,f=3,d=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],p=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function g(e){return e?v(e):"undefined"===typeof document&&"undefined"!==typeof navigator&&"ReactNative"===navigator.product?new l:"undefined"!==typeof navigator?v(navigator.userAgent):function(){var e="undefined"!==typeof process&&process.version;return e?new a(process.version.slice(1)):null}()}function y(e){return""!==e&&d.reduce((function(t,r){var n=r[0],i=r[1];if(t)return t;var o=i.exec(e);return!!o&&[n,o]}),!1)}function v(e){var t=y(e);if(!t)return null;var r=t[0],n=t[1];if("searchbot"===r)return new c;var i=n[1]&&n[1].split(/[._]/).slice(0,3);i?i.length<f&&(i=o(i,function(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}(f-i.length))):i=[];var a=i.join("."),l=function(e){for(var t=0,r=p.length;t<r;t++){var n=p[t],i=n[0];if(n[1].exec(e))return i}return null}(e),d=h.exec(e);return d&&d[1]?new u(r,a,l,d[1]):new s(r,a,l)}function m(e){return g(e)}function b(){const e=m();return e&&e.os?e.os:void 0}function E(){const e=b();return!!e&&e.toLowerCase().includes("android")}function _(){const e=b();return!!e&&(e.toLowerCase().includes("ios")||e.toLowerCase().includes("mac")&&navigator.maxTouchPoints>1)}function w(){return!!b()&&(E()||_())}function S(){const e=m();return!(!e||!e.name)&&"node"===e.name.toLowerCase()}function I(){return!S()&&!!N()}const R=i.getFromWindow,O=i.getFromWindowOrThrow,M=i.getDocumentOrThrow,T=i.getDocument,P=i.getNavigatorOrThrow,N=i.getNavigator,x=i.getLocationOrThrow,A=i.getLocation,C=i.getCryptoOrThrow,k=i.getCrypto,D=i.getLocalStorageOrThrow,U=i.getLocalStorage;function L(){return n.getWindowMetadata()}const j=function(e){if("string"!==typeof e)throw new Error("Cannot safe json parse value of type "+typeof e);try{return JSON.parse(e)}catch(t){return e}},B=function(e){return"string"===typeof e?e:JSON.stringify(e)};function q(e,t){const r=B(t),n=U();n&&n.setItem(e,r)}function V(e){let t=null,r=null;const n=U();return n&&(r=n.getItem(e)),t=r?j(r):r,t}function z(e){const t=U();t&&t.removeItem(e)}const $="WALLETCONNECT_DEEPLINK_CHOICE";function K(e,t){const r=encodeURIComponent(e);return t.universalLink?`${t.universalLink}/wc?uri=${r}`:t.deepLink?`${t.deepLink}${t.deepLink.endsWith(":")?"//":"/"}wc?uri=${r}`:""}function W(e){const t=e.href.split("?")[0];q($,Object.assign(Object.assign({},e),{href:t}))}function H(e,t){return e.filter((e=>e.name.toLowerCase().includes(t.toLowerCase())))[0]}function F(e,t){let r=e;return t&&(r=t.map((t=>H(e,t))).filter(Boolean)),r}const J="https://registry.walletconnect.com";function G(){return J+"/api/v2/wallets"}function Y(){return J+"/api/v2/dapps"}function Z(e,t="mobile"){var r;return{name:e.name||"",shortName:e.metadata.shortName||"",color:e.metadata.colors.primary||"",logo:null!==(r=e.image_url.sm)&&void 0!==r?r:"",universalLink:e[t].universal||"",deepLink:e[t].native||""}}function X(e,t="mobile"){return Object.values(e).filter((e=>!!e[t].universal||!!e[t].native)).map((e=>Z(e,t)))}var Q=["session_request","session_update","exchange_key","connect","disconnect","display_uri","modal_closed","transport_open","transport_close","transport_error"],ee=["eth_sendTransaction","eth_signTransaction","eth_sign","eth_signTypedData","eth_signTypedData_v1","eth_signTypedData_v2","eth_signTypedData_v3","eth_signTypedData_v4","personal_sign","wallet_addEthereumChain","wallet_switchEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],te=["eth_accounts","eth_chainId","net_version"],re={1:"mainnet",3:"ropsten",4:"rinkeby",5:"goerli",42:"kovan"},ne=r(86621),ie=r.n(ne),oe=r(71232);function se(e){return oe.arrayToBuffer(new Uint8Array(e))}function ae(e){return oe.arrayToUtf8(new Uint8Array(e))}function ue(e,t){return oe.arrayToHex(new Uint8Array(e),!t)}function ce(e){return oe.arrayToNumber(new Uint8Array(e))}function le(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return oe.hexToArray(t.map((function(e){return oe.arrayToHex(new Uint8Array(e))})).join("")).buffer}function he(e){return oe.bufferToArray(e).buffer}function fe(e){return oe.bufferToUtf8(e)}function de(e,t){return oe.bufferToHex(e,!t)}function pe(e){return oe.bufferToNumber(e)}function ge(){return oe.concatBuffers.apply(oe,arguments)}function ye(e){return oe.utf8ToArray(e).buffer}function ve(e){return oe.utf8ToBuffer(e)}function me(e,t){return oe.utf8ToHex(e,!t)}function be(e){return new(ie())(e,10).toNumber()}function Ee(e){return oe.hexToBuffer(e)}function _e(e){return oe.hexToArray(e).buffer}function we(e){return oe.hexToUtf8(e)}function Se(e){return new(ie())(oe.removeHexPrefix(e),"hex").toNumber()}function Ie(e){return oe.numberToBuffer(e)}function Re(e){return oe.numberToArray(e).buffer}function Oe(e){return new(ie())(e).toString()}function Me(e,t){var r=oe.removeHexPrefix(oe.sanitizeHex(new(ie())(e).toString(16)));return t?r:oe.addHexPrefix(r)}var Te=r(83669);function Pe(e){return oe.sanitizeHex(e)}function Ne(e){return oe.addHexPrefix(e)}function xe(e){return oe.removeHexPrefix(e)}function Ae(e){return oe.removeHexLeadingZeros(oe.addHexPrefix(e))}var Ce=r(55494).payloadId;function ke(){return function(e,t){for(t=e="";e++<36;t+=51*e&52?(15^e?8^Math.random()*(20^e?16:4):4).toString(16):"-");return t}()}function De(){console.warn("DEPRECATION WARNING: This WalletConnect client library will be deprecated in favor of @walletconnect/client. Please check docs.walletconnect.org to learn more about this migration!")}function Ue(e,t){var r,n=re[e];return n&&(r=`https://${n}.infura.io/v3/${t}`),r}function Le(e,t){var r,n=Ue(e,t.infuraId);return t.custom&&t.custom[e]?r=t.custom[e]:n&&(r=n),r}function je(e){return""===e||"string"===typeof e&&""===e.trim()}function Be(e){return!(e&&e.length)}function qe(e){return oe.isBuffer(e)}function Ve(e){return oe.isTypedArray(e)}function ze(e){return oe.isArrayBuffer(e)}function $e(e){return oe.getType(e)}function Ke(e){return oe.getEncoding(e)}function We(e,t){return oe.isHexString(e,t)}function He(e){return"object"===typeof e.params}function Fe(e){return"undefined"!==typeof e.method}function Je(e){return"undefined"!==typeof e.result}function Ge(e){return"undefined"!==typeof e.error}function Ye(e){return"undefined"!==typeof e.event}function Ze(e){return Q.includes(e)||e.startsWith("wc_")}function Xe(e){return!!e.method.startsWith("wc_")||!ee.includes(e.method)}function Qe(e){e=(0,oe.removeHexPrefix)(e.toLowerCase());for(var t=(0,oe.removeHexPrefix)((0,Te.keccak_256)(ve(e))),r="",n=0;n<e.length;n++)parseInt(t[n],16)>7?r+=e[n].toUpperCase():r+=e[n];return(0,oe.addHexPrefix)(r)}var et=function(e){return!!e&&("0x"===e.toLowerCase().substring(0,2)&&(!!/^(0x)?[0-9a-f]{40}$/i.test(e)&&(!(!/^(0x)?[0-9a-f]{40}$/.test(e)&&!/^(0x)?[0-9A-F]{40}$/.test(e))||e===Qe(e))))};function tt(e){return Be(e)||We(e[0])||(e[0]=me(e[0])),e}function rt(e){if("undefined"!==typeof e.type&&"0"!==e.type)return e;if("undefined"===typeof e.from||!et(e.from))throw new Error("Transaction object must include a valid 'from' value.");function t(e){var t=e;return("number"===typeof e||"string"===typeof e&&!je(e))&&(We(e)?"string"===typeof e&&(t=Pe(e)):t=Me(e)),"string"===typeof t&&(t=Ae(t)),t}var r={from:Pe(e.from),to:"undefined"===typeof e.to?void 0:Pe(e.to),gasPrice:"undefined"===typeof e.gasPrice?"":t(e.gasPrice),gas:"undefined"===typeof e.gas?"undefined"===typeof e.gasLimit?"":t(e.gasLimit):t(e.gas),value:"undefined"===typeof e.value?"":t(e.value),nonce:"undefined"===typeof e.nonce?"":t(e.nonce),data:"undefined"===typeof e.data?"":Pe(e.data)||"0x"},n=["gasPrice","gas","value","nonce"];return Object.keys(r).forEach((function(e){("undefined"===typeof r[e]||"string"===typeof r[e]&&!r[e].trim().length)&&n.includes(e)&&delete r[e]})),r}var nt=r(34795);function it(e,t){var r=function(){var r=(0,nt.default)((function*(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return new Promise((function(r,i){e.apply(t,[].concat(n,[function(e,t){null!==e&&"undefined"!==typeof e||i(e),r(t)}]))}))}));return function(){return r.apply(this,arguments)}}();return r}function ot(e){var t=e.message||"Failed or Rejected Request",r=-32e3;if(e&&!e.code)switch(t){case"Parse error":r=-32700;break;case"Invalid request":r=-32600;break;case"Method not found":r=-32601;break;case"Invalid params":r=-32602;break;case"Internal error":r=-32603;break;default:r=-32e3}var n={code:r,message:t};return e.data&&(n.data=e.data),n}var st=r(34126);function at(e){var t=-1!==e.indexOf("?")?e.indexOf("?"):void 0;return"undefined"!==typeof t?e.substr(t):""}function ut(e,t){var r=ct(e);return e=lt(r=Object.assign(Object.assign({},r),t))}function ct(e){return st.parse(e)}function lt(e){return st.stringify(e)}function ht(e){return"undefined"!==typeof e.bridge}function ft(e){var t=e.indexOf(":"),r=-1!==e.indexOf("?")?e.indexOf("?"):void 0,n=e.substring(0,t);var i=function(e){var t=e.split("@");return{handshakeTopic:t[0],version:parseInt(t[1],10)}}(e.substring(t+1,r));var o=function(e){var t=ct(e);return{key:t.key||"",bridge:t.bridge||""}}("undefined"!==typeof r?e.substr(r):"");return Object.assign(Object.assign({protocol:n},i),o)}},86621:function(e,t,r){!function(e,t){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function o(e,t,r){if(o.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}var s;"object"===typeof e?e.exports=o:t.BN=o,o.BN=o,o.wordSize=26;try{s="undefined"!==typeof window&&"undefined"!==typeof window.Buffer?window.Buffer:r(50314).Buffer}catch(R){}function a(e,t){var r=e.charCodeAt(t);return r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:r-48&15}function u(e,t,r){var n=a(e,r);return r-1>=t&&(n|=a(e,r-1)<<4),n}function c(e,t,r,n){for(var i=0,o=Math.min(e.length,r),s=t;s<o;s++){var a=e.charCodeAt(s)-48;i*=n,i+=a>=49?a-49+10:a>=17?a-17+10:a}return i}o.isBN=function(e){return e instanceof o||null!==e&&"object"===typeof e&&e.constructor.wordSize===o.wordSize&&Array.isArray(e.words)},o.max=function(e,t){return e.cmp(t)>0?e:t},o.min=function(e,t){return e.cmp(t)<0?e:t},o.prototype._init=function(e,t,r){if("number"===typeof e)return this._initNumber(e,t,r);if("object"===typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,r):(this._parseBase(e,t,i),"le"===r&&this._initArray(this.toArray(),t,r)))},o.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},o.prototype._initArray=function(e,t,r){if(n("number"===typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var o,s,a=0;if("be"===r)for(i=e.length-1,o=0;i>=0;i-=3)s=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);else if("le"===r)for(i=0,o=0;i<e.length;i+=3)s=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);return this.strip()},o.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,o=0,s=0;if("be"===r)for(n=e.length-1;n>=t;n-=2)i=u(e,t,n)<<o,this.words[s]|=67108863&i,o>=18?(o-=18,s+=1,this.words[s]|=i>>>26):o+=8;else for(n=(e.length-t)%2===0?t+1:t;n<e.length;n+=2)i=u(e,t,n)<<o,this.words[s]|=67108863&i,o>=18?(o-=18,s+=1,this.words[s]|=i>>>26):o+=8;this.strip()},o.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var n=0,i=1;i<=67108863;i*=t)n++;n--,i=i/t|0;for(var o=e.length-r,s=o%n,a=Math.min(o,o-s)+r,u=0,l=r;l<a;l+=n)u=c(e,l,l+n,t),this.imuln(i),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u);if(0!==s){var h=1;for(u=c(e,l,e.length,t),l=0;l<s;l++)h*=t;this.imuln(h),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u)}this.strip()},o.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},o.prototype.clone=function(){var e=new o(null);return this.copy(e),e},o.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},o.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},o.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},o.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],h=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],f=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function d(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0;r.length=n,n=n-1|0;var i=0|e.words[0],o=0|t.words[0],s=i*o,a=67108863&s,u=s/67108864|0;r.words[0]=a;for(var c=1;c<n;c++){for(var l=u>>>26,h=67108863&u,f=Math.min(c,t.length-1),d=Math.max(0,c-e.length+1);d<=f;d++){var p=c-d|0;l+=(s=(i=0|e.words[p])*(o=0|t.words[d])+h)/67108864|0,h=67108863&s}r.words[c]=0|h,u=0|l}return 0!==u?r.words[c]=0|u:r.length--,r.strip()}o.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var i=0,o=0,s=0;s<this.length;s++){var a=this.words[s],u=(16777215&(a<<i|o)).toString(16);r=0!==(o=a>>>24-i&16777215)||s!==this.length-1?l[6-u.length]+u+r:u+r,(i+=2)>=26&&(i-=26,s--)}for(0!==o&&(r=o.toString(16)+r);r.length%t!==0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var c=h[e],d=f[e];r="";var p=this.clone();for(p.negative=0;!p.isZero();){var g=p.modn(d).toString(e);r=(p=p.idivn(d)).isZero()?g+r:l[c-g.length]+g+r}for(this.isZero()&&(r="0"+r);r.length%t!==0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},o.prototype.toJSON=function(){return this.toString(16)},o.prototype.toBuffer=function(e,t){return n("undefined"!==typeof s),this.toArrayLike(s,e,t)},o.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},o.prototype.toArrayLike=function(e,t,r){var i=this.byteLength(),o=r||Math.max(1,i);n(i<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0"),this.strip();var s,a,u="le"===t,c=new e(o),l=this.clone();if(u){for(a=0;!l.isZero();a++)s=l.andln(255),l.iushrn(8),c[a]=s;for(;a<o;a++)c[a]=0}else{for(a=0;a<o-i;a++)c[a]=0;for(a=0;!l.isZero();a++)s=l.andln(255),l.iushrn(8),c[o-a-1]=s}return c},Math.clz32?o.prototype._countBits=function(e){return 32-Math.clz32(e)}:o.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},o.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return 0===(8191&t)&&(r+=13,t>>>=13),0===(127&t)&&(r+=7,t>>>=7),0===(15&t)&&(r+=4,t>>>=4),0===(3&t)&&(r+=2,t>>>=2),0===(1&t)&&r++,r},o.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},o.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return 0!==this.negative},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},o.prototype.ior=function(e){return n(0===(this.negative|e.negative)),this.iuor(e)},o.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},o.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},o.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this.strip()},o.prototype.iand=function(e){return n(0===(this.negative|e.negative)),this.iuand(e)},o.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},o.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},o.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var n=0;n<r.length;n++)this.words[n]=t.words[n]^r.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this.strip()},o.prototype.ixor=function(e){return n(0===(this.negative|e.negative)),this.iuxor(e)},o.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},o.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},o.prototype.inotn=function(e){n("number"===typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this.strip()},o.prototype.notn=function(e){return this.clone().inotn(e)},o.prototype.setn=function(e,t){n("number"===typeof e&&e>=0);var r=e/26|0,i=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<i:this.words[r]&~(1<<i),this.strip()},o.prototype.iadd=function(e){var t,r,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,n=e):(r=e,n=this);for(var i=0,o=0;o<n.length;o++)t=(0|r.words[o])+(0|n.words[o])+i,this.words[o]=67108863&t,i=t>>>26;for(;0!==i&&o<r.length;o++)t=(0|r.words[o])+i,this.words[o]=67108863&t,i=t>>>26;if(this.length=r.length,0!==i)this.words[this.length]=i,this.length++;else if(r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this},o.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},o.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,n,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(r=this,n=e):(r=e,n=this);for(var o=0,s=0;s<n.length;s++)o=(t=(0|r.words[s])-(0|n.words[s])+o)>>26,this.words[s]=67108863&t;for(;0!==o&&s<r.length;s++)o=(t=(0|r.words[s])+o)>>26,this.words[s]=67108863&t;if(0===o&&s<r.length&&r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this.length=Math.max(this.length,s),r!==this&&(this.negative=1),this.strip()},o.prototype.sub=function(e){return this.clone().isub(e)};var p=function(e,t,r){var n,i,o,s=e.words,a=t.words,u=r.words,c=0,l=0|s[0],h=8191&l,f=l>>>13,d=0|s[1],p=8191&d,g=d>>>13,y=0|s[2],v=8191&y,m=y>>>13,b=0|s[3],E=8191&b,_=b>>>13,w=0|s[4],S=8191&w,I=w>>>13,R=0|s[5],O=8191&R,M=R>>>13,T=0|s[6],P=8191&T,N=T>>>13,x=0|s[7],A=8191&x,C=x>>>13,k=0|s[8],D=8191&k,U=k>>>13,L=0|s[9],j=8191&L,B=L>>>13,q=0|a[0],V=8191&q,z=q>>>13,$=0|a[1],K=8191&$,W=$>>>13,H=0|a[2],F=8191&H,J=H>>>13,G=0|a[3],Y=8191&G,Z=G>>>13,X=0|a[4],Q=8191&X,ee=X>>>13,te=0|a[5],re=8191&te,ne=te>>>13,ie=0|a[6],oe=8191&ie,se=ie>>>13,ae=0|a[7],ue=8191&ae,ce=ae>>>13,le=0|a[8],he=8191&le,fe=le>>>13,de=0|a[9],pe=8191&de,ge=de>>>13;r.negative=e.negative^t.negative,r.length=19;var ye=(c+(n=Math.imul(h,V))|0)+((8191&(i=(i=Math.imul(h,z))+Math.imul(f,V)|0))<<13)|0;c=((o=Math.imul(f,z))+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(p,V),i=(i=Math.imul(p,z))+Math.imul(g,V)|0,o=Math.imul(g,z);var ve=(c+(n=n+Math.imul(h,K)|0)|0)+((8191&(i=(i=i+Math.imul(h,W)|0)+Math.imul(f,K)|0))<<13)|0;c=((o=o+Math.imul(f,W)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(v,V),i=(i=Math.imul(v,z))+Math.imul(m,V)|0,o=Math.imul(m,z),n=n+Math.imul(p,K)|0,i=(i=i+Math.imul(p,W)|0)+Math.imul(g,K)|0,o=o+Math.imul(g,W)|0;var me=(c+(n=n+Math.imul(h,F)|0)|0)+((8191&(i=(i=i+Math.imul(h,J)|0)+Math.imul(f,F)|0))<<13)|0;c=((o=o+Math.imul(f,J)|0)+(i>>>13)|0)+(me>>>26)|0,me&=67108863,n=Math.imul(E,V),i=(i=Math.imul(E,z))+Math.imul(_,V)|0,o=Math.imul(_,z),n=n+Math.imul(v,K)|0,i=(i=i+Math.imul(v,W)|0)+Math.imul(m,K)|0,o=o+Math.imul(m,W)|0,n=n+Math.imul(p,F)|0,i=(i=i+Math.imul(p,J)|0)+Math.imul(g,F)|0,o=o+Math.imul(g,J)|0;var be=(c+(n=n+Math.imul(h,Y)|0)|0)+((8191&(i=(i=i+Math.imul(h,Z)|0)+Math.imul(f,Y)|0))<<13)|0;c=((o=o+Math.imul(f,Z)|0)+(i>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(S,V),i=(i=Math.imul(S,z))+Math.imul(I,V)|0,o=Math.imul(I,z),n=n+Math.imul(E,K)|0,i=(i=i+Math.imul(E,W)|0)+Math.imul(_,K)|0,o=o+Math.imul(_,W)|0,n=n+Math.imul(v,F)|0,i=(i=i+Math.imul(v,J)|0)+Math.imul(m,F)|0,o=o+Math.imul(m,J)|0,n=n+Math.imul(p,Y)|0,i=(i=i+Math.imul(p,Z)|0)+Math.imul(g,Y)|0,o=o+Math.imul(g,Z)|0;var Ee=(c+(n=n+Math.imul(h,Q)|0)|0)+((8191&(i=(i=i+Math.imul(h,ee)|0)+Math.imul(f,Q)|0))<<13)|0;c=((o=o+Math.imul(f,ee)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(O,V),i=(i=Math.imul(O,z))+Math.imul(M,V)|0,o=Math.imul(M,z),n=n+Math.imul(S,K)|0,i=(i=i+Math.imul(S,W)|0)+Math.imul(I,K)|0,o=o+Math.imul(I,W)|0,n=n+Math.imul(E,F)|0,i=(i=i+Math.imul(E,J)|0)+Math.imul(_,F)|0,o=o+Math.imul(_,J)|0,n=n+Math.imul(v,Y)|0,i=(i=i+Math.imul(v,Z)|0)+Math.imul(m,Y)|0,o=o+Math.imul(m,Z)|0,n=n+Math.imul(p,Q)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(g,Q)|0,o=o+Math.imul(g,ee)|0;var _e=(c+(n=n+Math.imul(h,re)|0)|0)+((8191&(i=(i=i+Math.imul(h,ne)|0)+Math.imul(f,re)|0))<<13)|0;c=((o=o+Math.imul(f,ne)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(P,V),i=(i=Math.imul(P,z))+Math.imul(N,V)|0,o=Math.imul(N,z),n=n+Math.imul(O,K)|0,i=(i=i+Math.imul(O,W)|0)+Math.imul(M,K)|0,o=o+Math.imul(M,W)|0,n=n+Math.imul(S,F)|0,i=(i=i+Math.imul(S,J)|0)+Math.imul(I,F)|0,o=o+Math.imul(I,J)|0,n=n+Math.imul(E,Y)|0,i=(i=i+Math.imul(E,Z)|0)+Math.imul(_,Y)|0,o=o+Math.imul(_,Z)|0,n=n+Math.imul(v,Q)|0,i=(i=i+Math.imul(v,ee)|0)+Math.imul(m,Q)|0,o=o+Math.imul(m,ee)|0,n=n+Math.imul(p,re)|0,i=(i=i+Math.imul(p,ne)|0)+Math.imul(g,re)|0,o=o+Math.imul(g,ne)|0;var we=(c+(n=n+Math.imul(h,oe)|0)|0)+((8191&(i=(i=i+Math.imul(h,se)|0)+Math.imul(f,oe)|0))<<13)|0;c=((o=o+Math.imul(f,se)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(A,V),i=(i=Math.imul(A,z))+Math.imul(C,V)|0,o=Math.imul(C,z),n=n+Math.imul(P,K)|0,i=(i=i+Math.imul(P,W)|0)+Math.imul(N,K)|0,o=o+Math.imul(N,W)|0,n=n+Math.imul(O,F)|0,i=(i=i+Math.imul(O,J)|0)+Math.imul(M,F)|0,o=o+Math.imul(M,J)|0,n=n+Math.imul(S,Y)|0,i=(i=i+Math.imul(S,Z)|0)+Math.imul(I,Y)|0,o=o+Math.imul(I,Z)|0,n=n+Math.imul(E,Q)|0,i=(i=i+Math.imul(E,ee)|0)+Math.imul(_,Q)|0,o=o+Math.imul(_,ee)|0,n=n+Math.imul(v,re)|0,i=(i=i+Math.imul(v,ne)|0)+Math.imul(m,re)|0,o=o+Math.imul(m,ne)|0,n=n+Math.imul(p,oe)|0,i=(i=i+Math.imul(p,se)|0)+Math.imul(g,oe)|0,o=o+Math.imul(g,se)|0;var Se=(c+(n=n+Math.imul(h,ue)|0)|0)+((8191&(i=(i=i+Math.imul(h,ce)|0)+Math.imul(f,ue)|0))<<13)|0;c=((o=o+Math.imul(f,ce)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(D,V),i=(i=Math.imul(D,z))+Math.imul(U,V)|0,o=Math.imul(U,z),n=n+Math.imul(A,K)|0,i=(i=i+Math.imul(A,W)|0)+Math.imul(C,K)|0,o=o+Math.imul(C,W)|0,n=n+Math.imul(P,F)|0,i=(i=i+Math.imul(P,J)|0)+Math.imul(N,F)|0,o=o+Math.imul(N,J)|0,n=n+Math.imul(O,Y)|0,i=(i=i+Math.imul(O,Z)|0)+Math.imul(M,Y)|0,o=o+Math.imul(M,Z)|0,n=n+Math.imul(S,Q)|0,i=(i=i+Math.imul(S,ee)|0)+Math.imul(I,Q)|0,o=o+Math.imul(I,ee)|0,n=n+Math.imul(E,re)|0,i=(i=i+Math.imul(E,ne)|0)+Math.imul(_,re)|0,o=o+Math.imul(_,ne)|0,n=n+Math.imul(v,oe)|0,i=(i=i+Math.imul(v,se)|0)+Math.imul(m,oe)|0,o=o+Math.imul(m,se)|0,n=n+Math.imul(p,ue)|0,i=(i=i+Math.imul(p,ce)|0)+Math.imul(g,ue)|0,o=o+Math.imul(g,ce)|0;var Ie=(c+(n=n+Math.imul(h,he)|0)|0)+((8191&(i=(i=i+Math.imul(h,fe)|0)+Math.imul(f,he)|0))<<13)|0;c=((o=o+Math.imul(f,fe)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(j,V),i=(i=Math.imul(j,z))+Math.imul(B,V)|0,o=Math.imul(B,z),n=n+Math.imul(D,K)|0,i=(i=i+Math.imul(D,W)|0)+Math.imul(U,K)|0,o=o+Math.imul(U,W)|0,n=n+Math.imul(A,F)|0,i=(i=i+Math.imul(A,J)|0)+Math.imul(C,F)|0,o=o+Math.imul(C,J)|0,n=n+Math.imul(P,Y)|0,i=(i=i+Math.imul(P,Z)|0)+Math.imul(N,Y)|0,o=o+Math.imul(N,Z)|0,n=n+Math.imul(O,Q)|0,i=(i=i+Math.imul(O,ee)|0)+Math.imul(M,Q)|0,o=o+Math.imul(M,ee)|0,n=n+Math.imul(S,re)|0,i=(i=i+Math.imul(S,ne)|0)+Math.imul(I,re)|0,o=o+Math.imul(I,ne)|0,n=n+Math.imul(E,oe)|0,i=(i=i+Math.imul(E,se)|0)+Math.imul(_,oe)|0,o=o+Math.imul(_,se)|0,n=n+Math.imul(v,ue)|0,i=(i=i+Math.imul(v,ce)|0)+Math.imul(m,ue)|0,o=o+Math.imul(m,ce)|0,n=n+Math.imul(p,he)|0,i=(i=i+Math.imul(p,fe)|0)+Math.imul(g,he)|0,o=o+Math.imul(g,fe)|0;var Re=(c+(n=n+Math.imul(h,pe)|0)|0)+((8191&(i=(i=i+Math.imul(h,ge)|0)+Math.imul(f,pe)|0))<<13)|0;c=((o=o+Math.imul(f,ge)|0)+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863,n=Math.imul(j,K),i=(i=Math.imul(j,W))+Math.imul(B,K)|0,o=Math.imul(B,W),n=n+Math.imul(D,F)|0,i=(i=i+Math.imul(D,J)|0)+Math.imul(U,F)|0,o=o+Math.imul(U,J)|0,n=n+Math.imul(A,Y)|0,i=(i=i+Math.imul(A,Z)|0)+Math.imul(C,Y)|0,o=o+Math.imul(C,Z)|0,n=n+Math.imul(P,Q)|0,i=(i=i+Math.imul(P,ee)|0)+Math.imul(N,Q)|0,o=o+Math.imul(N,ee)|0,n=n+Math.imul(O,re)|0,i=(i=i+Math.imul(O,ne)|0)+Math.imul(M,re)|0,o=o+Math.imul(M,ne)|0,n=n+Math.imul(S,oe)|0,i=(i=i+Math.imul(S,se)|0)+Math.imul(I,oe)|0,o=o+Math.imul(I,se)|0,n=n+Math.imul(E,ue)|0,i=(i=i+Math.imul(E,ce)|0)+Math.imul(_,ue)|0,o=o+Math.imul(_,ce)|0,n=n+Math.imul(v,he)|0,i=(i=i+Math.imul(v,fe)|0)+Math.imul(m,he)|0,o=o+Math.imul(m,fe)|0;var Oe=(c+(n=n+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,ge)|0)+Math.imul(g,pe)|0))<<13)|0;c=((o=o+Math.imul(g,ge)|0)+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,n=Math.imul(j,F),i=(i=Math.imul(j,J))+Math.imul(B,F)|0,o=Math.imul(B,J),n=n+Math.imul(D,Y)|0,i=(i=i+Math.imul(D,Z)|0)+Math.imul(U,Y)|0,o=o+Math.imul(U,Z)|0,n=n+Math.imul(A,Q)|0,i=(i=i+Math.imul(A,ee)|0)+Math.imul(C,Q)|0,o=o+Math.imul(C,ee)|0,n=n+Math.imul(P,re)|0,i=(i=i+Math.imul(P,ne)|0)+Math.imul(N,re)|0,o=o+Math.imul(N,ne)|0,n=n+Math.imul(O,oe)|0,i=(i=i+Math.imul(O,se)|0)+Math.imul(M,oe)|0,o=o+Math.imul(M,se)|0,n=n+Math.imul(S,ue)|0,i=(i=i+Math.imul(S,ce)|0)+Math.imul(I,ue)|0,o=o+Math.imul(I,ce)|0,n=n+Math.imul(E,he)|0,i=(i=i+Math.imul(E,fe)|0)+Math.imul(_,he)|0,o=o+Math.imul(_,fe)|0;var Me=(c+(n=n+Math.imul(v,pe)|0)|0)+((8191&(i=(i=i+Math.imul(v,ge)|0)+Math.imul(m,pe)|0))<<13)|0;c=((o=o+Math.imul(m,ge)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(j,Y),i=(i=Math.imul(j,Z))+Math.imul(B,Y)|0,o=Math.imul(B,Z),n=n+Math.imul(D,Q)|0,i=(i=i+Math.imul(D,ee)|0)+Math.imul(U,Q)|0,o=o+Math.imul(U,ee)|0,n=n+Math.imul(A,re)|0,i=(i=i+Math.imul(A,ne)|0)+Math.imul(C,re)|0,o=o+Math.imul(C,ne)|0,n=n+Math.imul(P,oe)|0,i=(i=i+Math.imul(P,se)|0)+Math.imul(N,oe)|0,o=o+Math.imul(N,se)|0,n=n+Math.imul(O,ue)|0,i=(i=i+Math.imul(O,ce)|0)+Math.imul(M,ue)|0,o=o+Math.imul(M,ce)|0,n=n+Math.imul(S,he)|0,i=(i=i+Math.imul(S,fe)|0)+Math.imul(I,he)|0,o=o+Math.imul(I,fe)|0;var Te=(c+(n=n+Math.imul(E,pe)|0)|0)+((8191&(i=(i=i+Math.imul(E,ge)|0)+Math.imul(_,pe)|0))<<13)|0;c=((o=o+Math.imul(_,ge)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(j,Q),i=(i=Math.imul(j,ee))+Math.imul(B,Q)|0,o=Math.imul(B,ee),n=n+Math.imul(D,re)|0,i=(i=i+Math.imul(D,ne)|0)+Math.imul(U,re)|0,o=o+Math.imul(U,ne)|0,n=n+Math.imul(A,oe)|0,i=(i=i+Math.imul(A,se)|0)+Math.imul(C,oe)|0,o=o+Math.imul(C,se)|0,n=n+Math.imul(P,ue)|0,i=(i=i+Math.imul(P,ce)|0)+Math.imul(N,ue)|0,o=o+Math.imul(N,ce)|0,n=n+Math.imul(O,he)|0,i=(i=i+Math.imul(O,fe)|0)+Math.imul(M,he)|0,o=o+Math.imul(M,fe)|0;var Pe=(c+(n=n+Math.imul(S,pe)|0)|0)+((8191&(i=(i=i+Math.imul(S,ge)|0)+Math.imul(I,pe)|0))<<13)|0;c=((o=o+Math.imul(I,ge)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,n=Math.imul(j,re),i=(i=Math.imul(j,ne))+Math.imul(B,re)|0,o=Math.imul(B,ne),n=n+Math.imul(D,oe)|0,i=(i=i+Math.imul(D,se)|0)+Math.imul(U,oe)|0,o=o+Math.imul(U,se)|0,n=n+Math.imul(A,ue)|0,i=(i=i+Math.imul(A,ce)|0)+Math.imul(C,ue)|0,o=o+Math.imul(C,ce)|0,n=n+Math.imul(P,he)|0,i=(i=i+Math.imul(P,fe)|0)+Math.imul(N,he)|0,o=o+Math.imul(N,fe)|0;var Ne=(c+(n=n+Math.imul(O,pe)|0)|0)+((8191&(i=(i=i+Math.imul(O,ge)|0)+Math.imul(M,pe)|0))<<13)|0;c=((o=o+Math.imul(M,ge)|0)+(i>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,n=Math.imul(j,oe),i=(i=Math.imul(j,se))+Math.imul(B,oe)|0,o=Math.imul(B,se),n=n+Math.imul(D,ue)|0,i=(i=i+Math.imul(D,ce)|0)+Math.imul(U,ue)|0,o=o+Math.imul(U,ce)|0,n=n+Math.imul(A,he)|0,i=(i=i+Math.imul(A,fe)|0)+Math.imul(C,he)|0,o=o+Math.imul(C,fe)|0;var xe=(c+(n=n+Math.imul(P,pe)|0)|0)+((8191&(i=(i=i+Math.imul(P,ge)|0)+Math.imul(N,pe)|0))<<13)|0;c=((o=o+Math.imul(N,ge)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,n=Math.imul(j,ue),i=(i=Math.imul(j,ce))+Math.imul(B,ue)|0,o=Math.imul(B,ce),n=n+Math.imul(D,he)|0,i=(i=i+Math.imul(D,fe)|0)+Math.imul(U,he)|0,o=o+Math.imul(U,fe)|0;var Ae=(c+(n=n+Math.imul(A,pe)|0)|0)+((8191&(i=(i=i+Math.imul(A,ge)|0)+Math.imul(C,pe)|0))<<13)|0;c=((o=o+Math.imul(C,ge)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(j,he),i=(i=Math.imul(j,fe))+Math.imul(B,he)|0,o=Math.imul(B,fe);var Ce=(c+(n=n+Math.imul(D,pe)|0)|0)+((8191&(i=(i=i+Math.imul(D,ge)|0)+Math.imul(U,pe)|0))<<13)|0;c=((o=o+Math.imul(U,ge)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863;var ke=(c+(n=Math.imul(j,pe))|0)+((8191&(i=(i=Math.imul(j,ge))+Math.imul(B,pe)|0))<<13)|0;return c=((o=Math.imul(B,ge))+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,u[0]=ye,u[1]=ve,u[2]=me,u[3]=be,u[4]=Ee,u[5]=_e,u[6]=we,u[7]=Se,u[8]=Ie,u[9]=Re,u[10]=Oe,u[11]=Me,u[12]=Te,u[13]=Pe,u[14]=Ne,u[15]=xe,u[16]=Ae,u[17]=Ce,u[18]=ke,0!==c&&(u[19]=c,r.length++),r};function g(e,t,r){return(new y).mulp(e,t,r)}function y(e,t){this.x=e,this.y=t}Math.imul||(p=d),o.prototype.mulTo=function(e,t){var r,n=this.length+e.length;return r=10===this.length&&10===e.length?p(this,e,t):n<63?d(this,e,t):n<1024?function(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var n=0,i=0,o=0;o<r.length-1;o++){var s=i;i=0;for(var a=67108863&n,u=Math.min(o,t.length-1),c=Math.max(0,o-e.length+1);c<=u;c++){var l=o-c,h=(0|e.words[l])*(0|t.words[c]),f=67108863&h;a=67108863&(f=f+a|0),i+=(s=(s=s+(h/67108864|0)|0)+(f>>>26)|0)>>>26,s&=67108863}r.words[o]=a,n=s,s=i}return 0!==n?r.words[o]=n:r.length--,r.strip()}(this,e,t):g(this,e,t),r},y.prototype.makeRBT=function(e){for(var t=new Array(e),r=o.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,r,e);return t},y.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var n=0,i=0;i<t;i++)n|=(1&e)<<t-i-1,e>>=1;return n},y.prototype.permute=function(e,t,r,n,i,o){for(var s=0;s<o;s++)n[s]=t[e[s]],i[s]=r[e[s]]},y.prototype.transform=function(e,t,r,n,i,o){this.permute(o,e,t,r,n,i);for(var s=1;s<i;s<<=1)for(var a=s<<1,u=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),l=0;l<i;l+=a)for(var h=u,f=c,d=0;d<s;d++){var p=r[l+d],g=n[l+d],y=r[l+d+s],v=n[l+d+s],m=h*y-f*v;v=h*v+f*y,y=m,r[l+d]=p+y,n[l+d]=g+v,r[l+d+s]=p-y,n[l+d+s]=g-v,d!==a&&(m=u*h-c*f,f=u*f+c*h,h=m)}},y.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),n=1&r,i=0;for(r=r/2|0;r;r>>>=1)i++;return 1<<i+1+n},y.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var n=0;n<r/2;n++){var i=e[n];e[n]=e[r-n-1],e[r-n-1]=i,i=t[n],t[n]=-t[r-n-1],t[r-n-1]=-i}},y.prototype.normalize13b=function(e,t){for(var r=0,n=0;n<t/2;n++){var i=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+r;e[n]=67108863&i,r=i<67108864?0:i/67108864|0}return e},y.prototype.convert13b=function(e,t,r,i){for(var o=0,s=0;s<t;s++)o+=0|e[s],r[2*s]=8191&o,o>>>=13,r[2*s+1]=8191&o,o>>>=13;for(s=2*t;s<i;++s)r[s]=0;n(0===o),n(0===(-8192&o))},y.prototype.stub=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=0;return t},y.prototype.mulp=function(e,t,r){var n=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(n),o=this.stub(n),s=new Array(n),a=new Array(n),u=new Array(n),c=new Array(n),l=new Array(n),h=new Array(n),f=r.words;f.length=n,this.convert13b(e.words,e.length,s,n),this.convert13b(t.words,t.length,c,n),this.transform(s,o,a,u,n,i),this.transform(c,o,l,h,n,i);for(var d=0;d<n;d++){var p=a[d]*l[d]-u[d]*h[d];u[d]=a[d]*h[d]+u[d]*l[d],a[d]=p}return this.conjugate(a,u,n),this.transform(a,u,f,o,n,i),this.conjugate(f,o,n),this.normalize13b(f,n),r.negative=e.negative^t.negative,r.length=e.length+t.length,r.strip()},o.prototype.mul=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},o.prototype.mulf=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),g(this,e,t)},o.prototype.imul=function(e){return this.clone().mulTo(e,this)},o.prototype.imuln=function(e){n("number"===typeof e),n(e<67108864);for(var t=0,r=0;r<this.length;r++){var i=(0|this.words[r])*e,o=(67108863&i)+(67108863&t);t>>=26,t+=i/67108864|0,t+=o>>>26,this.words[r]=67108863&o}return 0!==t&&(this.words[r]=t,this.length++),this},o.prototype.muln=function(e){return this.clone().imuln(e)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),r=0;r<t.length;r++){var n=r/26|0,i=r%26;t[r]=(e.words[n]&1<<i)>>>i}return t}(e);if(0===t.length)return new o(1);for(var r=this,n=0;n<t.length&&0===t[n];n++,r=r.sqr());if(++n<t.length)for(var i=r.sqr();n<t.length;n++,i=i.sqr())0!==t[n]&&(r=r.mul(i));return r},o.prototype.iushln=function(e){n("number"===typeof e&&e>=0);var t,r=e%26,i=(e-r)/26,o=67108863>>>26-r<<26-r;if(0!==r){var s=0;for(t=0;t<this.length;t++){var a=this.words[t]&o,u=(0|this.words[t])-a<<r;this.words[t]=u|s,s=a>>>26-r}s&&(this.words[t]=s,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this.strip()},o.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},o.prototype.iushrn=function(e,t,r){var i;n("number"===typeof e&&e>=0),i=t?(t-t%26)/26:0;var o=e%26,s=Math.min((e-o)/26,this.length),a=67108863^67108863>>>o<<o,u=r;if(i-=s,i=Math.max(0,i),u){for(var c=0;c<s;c++)u.words[c]=this.words[c];u.length=s}if(0===s);else if(this.length>s)for(this.length-=s,c=0;c<this.length;c++)this.words[c]=this.words[c+s];else this.words[0]=0,this.length=1;var l=0;for(c=this.length-1;c>=0&&(0!==l||c>=i);c--){var h=0|this.words[c];this.words[c]=l<<26-o|h>>>o,l=h&a}return u&&0!==l&&(u.words[u.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},o.prototype.ishrn=function(e,t,r){return n(0===this.negative),this.iushrn(e,t,r)},o.prototype.shln=function(e){return this.clone().ishln(e)},o.prototype.ushln=function(e){return this.clone().iushln(e)},o.prototype.shrn=function(e){return this.clone().ishrn(e)},o.prototype.ushrn=function(e){return this.clone().iushrn(e)},o.prototype.testn=function(e){n("number"===typeof e&&e>=0);var t=e%26,r=(e-t)/26,i=1<<t;return!(this.length<=r)&&!!(this.words[r]&i)},o.prototype.imaskn=function(e){n("number"===typeof e&&e>=0);var t=e%26,r=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==t&&r++,this.length=Math.min(r,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this.strip()},o.prototype.maskn=function(e){return this.clone().imaskn(e)},o.prototype.iaddn=function(e){return n("number"===typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},o.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},o.prototype.isubn=function(e){if(n("number"===typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},o.prototype.addn=function(e){return this.clone().iaddn(e)},o.prototype.subn=function(e){return this.clone().isubn(e)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(e,t,r){var i,o,s=e.length+r;this._expand(s);var a=0;for(i=0;i<e.length;i++){o=(0|this.words[i+r])+a;var u=(0|e.words[i])*t;a=((o-=67108863&u)>>26)-(u/67108864|0),this.words[i+r]=67108863&o}for(;i<this.length-r;i++)a=(o=(0|this.words[i+r])+a)>>26,this.words[i+r]=67108863&o;if(0===a)return this.strip();for(n(-1===a),a=0,i=0;i<this.length;i++)a=(o=-(0|this.words[i])+a)>>26,this.words[i]=67108863&o;return this.negative=1,this.strip()},o.prototype._wordDiv=function(e,t){var r=(this.length,e.length),n=this.clone(),i=e,s=0|i.words[i.length-1];0!==(r=26-this._countBits(s))&&(i=i.ushln(r),n.iushln(r),s=0|i.words[i.length-1]);var a,u=n.length-i.length;if("mod"!==t){(a=new o(null)).length=u+1,a.words=new Array(a.length);for(var c=0;c<a.length;c++)a.words[c]=0}var l=n.clone()._ishlnsubmul(i,1,u);0===l.negative&&(n=l,a&&(a.words[u]=1));for(var h=u-1;h>=0;h--){var f=67108864*(0|n.words[i.length+h])+(0|n.words[i.length+h-1]);for(f=Math.min(f/s|0,67108863),n._ishlnsubmul(i,f,h);0!==n.negative;)f--,n.negative=0,n._ishlnsubmul(i,1,h),n.isZero()||(n.negative^=1);a&&(a.words[h]=f)}return a&&a.strip(),n.strip(),"div"!==t&&0!==r&&n.iushrn(r),{div:a||null,mod:n}},o.prototype.divmod=function(e,t,r){return n(!e.isZero()),this.isZero()?{div:new o(0),mod:new o(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(i=a.div.neg()),"div"!==t&&(s=a.mod.neg(),r&&0!==s.negative&&s.iadd(e)),{div:i,mod:s}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(i=a.div.neg()),{div:i,mod:a.mod}):0!==(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(s=a.mod.neg(),r&&0!==s.negative&&s.isub(e)),{div:a.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new o(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new o(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new o(this.modn(e.words[0]))}:this._wordDiv(e,t);var i,s,a},o.prototype.div=function(e){return this.divmod(e,"div",!1).div},o.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},o.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},o.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),i=e.andln(1),o=r.cmp(n);return o<0||1===i&&0===o?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},o.prototype.modn=function(e){n(e<=67108863);for(var t=(1<<26)%e,r=0,i=this.length-1;i>=0;i--)r=(t*r+(0|this.words[i]))%e;return r},o.prototype.idivn=function(e){n(e<=67108863);for(var t=0,r=this.length-1;r>=0;r--){var i=(0|this.words[r])+67108864*t;this.words[r]=i/e|0,t=i%e}return this.strip()},o.prototype.divn=function(e){return this.clone().idivn(e)},o.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new o(1),s=new o(0),a=new o(0),u=new o(1),c=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++c;for(var l=r.clone(),h=t.clone();!t.isZero();){for(var f=0,d=1;0===(t.words[0]&d)&&f<26;++f,d<<=1);if(f>0)for(t.iushrn(f);f-- >0;)(i.isOdd()||s.isOdd())&&(i.iadd(l),s.isub(h)),i.iushrn(1),s.iushrn(1);for(var p=0,g=1;0===(r.words[0]&g)&&p<26;++p,g<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(a.isOdd()||u.isOdd())&&(a.iadd(l),u.isub(h)),a.iushrn(1),u.iushrn(1);t.cmp(r)>=0?(t.isub(r),i.isub(a),s.isub(u)):(r.isub(t),a.isub(i),u.isub(s))}return{a:a,b:u,gcd:r.iushln(c)}},o.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i,s=new o(1),a=new o(0),u=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var c=0,l=1;0===(t.words[0]&l)&&c<26;++c,l<<=1);if(c>0)for(t.iushrn(c);c-- >0;)s.isOdd()&&s.iadd(u),s.iushrn(1);for(var h=0,f=1;0===(r.words[0]&f)&&h<26;++h,f<<=1);if(h>0)for(r.iushrn(h);h-- >0;)a.isOdd()&&a.iadd(u),a.iushrn(1);t.cmp(r)>=0?(t.isub(r),s.isub(a)):(r.isub(t),a.isub(s))}return(i=0===t.cmpn(1)?s:a).cmpn(0)<0&&i.iadd(e),i},o.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var n=0;t.isEven()&&r.isEven();n++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var i=t.cmp(r);if(i<0){var o=t;t=r,r=o}else if(0===i||0===r.cmpn(1))break;t.isub(r)}return r.iushln(n)},o.prototype.invm=function(e){return this.egcd(e).a.umod(e)},o.prototype.isEven=function(){return 0===(1&this.words[0])},o.prototype.isOdd=function(){return 1===(1&this.words[0])},o.prototype.andln=function(e){return this.words[0]&e},o.prototype.bincn=function(e){n("number"===typeof e);var t=e%26,r=(e-t)/26,i=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var o=i,s=r;0!==o&&s<this.length;s++){var a=0|this.words[s];o=(a+=o)>>>26,a&=67108863,this.words[s]=a}return 0!==o&&(this.words[s]=o,this.length++),this},o.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},o.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this.strip(),this.length>1)t=1;else{r&&(e=-e),n(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},o.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},o.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],i=0|e.words[r];if(n!==i){n<i?t=-1:n>i&&(t=1);break}}return t},o.prototype.gtn=function(e){return 1===this.cmpn(e)},o.prototype.gt=function(e){return 1===this.cmp(e)},o.prototype.gten=function(e){return this.cmpn(e)>=0},o.prototype.gte=function(e){return this.cmp(e)>=0},o.prototype.ltn=function(e){return-1===this.cmpn(e)},o.prototype.lt=function(e){return-1===this.cmp(e)},o.prototype.lten=function(e){return this.cmpn(e)<=0},o.prototype.lte=function(e){return this.cmp(e)<=0},o.prototype.eqn=function(e){return 0===this.cmpn(e)},o.prototype.eq=function(e){return 0===this.cmp(e)},o.red=function(e){return new S(e)},o.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},o.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(e){return this.red=e,this},o.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},o.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},o.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},o.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},o.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},o.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},o.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},o.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},o.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var v={k256:null,p224:null,p192:null,p25519:null};function m(e,t){this.name=e,this.p=new o(t,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function b(){m.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function E(){m.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function _(){m.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function w(){m.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(e){if("string"===typeof e){var t=o._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function I(e){S.call(this,e),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}m.prototype._tmp=function(){var e=new o(null);return e.words=new Array(Math.ceil(this.n/13)),e},m.prototype.ireduce=function(e){var t,r=e;do{this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},m.prototype.split=function(e,t){e.iushrn(this.n,0,t)},m.prototype.imulK=function(e){return e.imul(this.k)},i(b,m),b.prototype.split=function(e,t){for(var r=4194303,n=Math.min(e.length,9),i=0;i<n;i++)t.words[i]=e.words[i];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=o&r,i=10;i<e.length;i++){var s=0|e.words[i];e.words[i-10]=(s&r)<<4|o>>>22,o=s}o>>>=22,e.words[i-10]=o,0===o&&e.length>10?e.length-=10:e.length-=9},b.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var n=0|e.words[r];t+=977*n,e.words[r]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(E,m),i(_,m),i(w,m),w.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var n=19*(0|e.words[r])+t,i=67108863&n;n>>>=26,e.words[r]=i,t=n}return 0!==t&&(e.words[e.length++]=t),e},o._prime=function(e){if(v[e])return v[e];var t;if("k256"===e)t=new b;else if("p224"===e)t=new E;else if("p192"===e)t=new _;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new w}return v[e]=t,t},S.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},S.prototype._verify2=function(e,t){n(0===(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},S.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},S.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},S.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},S.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},S.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},S.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return r.cmpn(0)<0&&r.iadd(this.m),r},S.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},S.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},S.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},S.prototype.isqr=function(e){return this.imul(e,e.clone())},S.prototype.sqr=function(e){return this.mul(e,e)},S.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2===1),3===t){var r=this.m.add(new o(1)).iushrn(2);return this.pow(e,r)}for(var i=this.m.subn(1),s=0;!i.isZero()&&0===i.andln(1);)s++,i.iushrn(1);n(!i.isZero());var a=new o(1).toRed(this),u=a.redNeg(),c=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new o(2*l*l).toRed(this);0!==this.pow(l,c).cmp(u);)l.redIAdd(u);for(var h=this.pow(l,i),f=this.pow(e,i.addn(1).iushrn(1)),d=this.pow(e,i),p=s;0!==d.cmp(a);){for(var g=d,y=0;0!==g.cmp(a);y++)g=g.redSqr();n(y<p);var v=this.pow(h,new o(1).iushln(p-y-1));f=f.redMul(v),h=v.redSqr(),d=d.redMul(h),p=y}return f},S.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},S.prototype.pow=function(e,t){if(t.isZero())return new o(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=new Array(16);r[0]=new o(1).toRed(this),r[1]=e;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],e);var i=r[0],s=0,a=0,u=t.bitLength()%26;for(0===u&&(u=26),n=t.length-1;n>=0;n--){for(var c=t.words[n],l=u-1;l>=0;l--){var h=c>>l&1;i!==r[0]&&(i=this.sqr(i)),0!==h||0!==s?(s<<=1,s|=h,(4===++a||0===n&&0===l)&&(i=this.mul(i,r[s]),a=0,s=0)):a=0}u=26}return i},S.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},S.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},o.mont=function(e){return new I(e)},i(I,S),I.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},I.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},I.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},I.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new o(0)._forceRed(this);var r=e.mul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},I.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e=r.nmd(e),this)},45415:(e,t)=>{"use strict";function r(e){var t=void 0;return"undefined"!==typeof window&&"undefined"!==typeof window[e]&&(t=window[e]),t}function n(e){var t=r(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalStorage=t.getLocalStorageOrThrow=t.getCrypto=t.getCryptoOrThrow=t.getLocation=t.getLocationOrThrow=t.getNavigator=t.getNavigatorOrThrow=t.getDocument=t.getDocumentOrThrow=t.getFromWindowOrThrow=t.getFromWindow=void 0,t.getFromWindow=r,t.getFromWindowOrThrow=n,t.getDocumentOrThrow=function(){return n("document")},t.getDocument=function(){return r("document")},t.getNavigatorOrThrow=function(){return n("navigator")},t.getNavigator=function(){return r("navigator")},t.getLocationOrThrow=function(){return n("location")},t.getLocation=function(){return r("location")},t.getCryptoOrThrow=function(){return n("crypto")},t.getCrypto=function(){return r("crypto")},t.getLocalStorageOrThrow=function(){return n("localStorage")},t.getLocalStorage=function(){return r("localStorage")}},7047:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWindowMetadata=void 0;var n=r(45415);t.getWindowMetadata=function(){var e,t;try{e=n.getDocumentOrThrow(),t=n.getLocationOrThrow()}catch(o){return null}function r(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var i=e.getElementsByTagName("meta"),o=function(){var e=i[s],t=["itemprop","property","name"].map((function(t){return e.getAttribute(t)})).filter((function(e){return!!e&&r.includes(e)}));if(t.length&&t){var n=e.getAttribute("content");if(n)return{v:n}}},s=0;s<i.length;s++){var a=o();if("object"===typeof a)return a.v}return""}var i=function(){var t=r("name","og:site_name","og:title","twitter:title");return t||(t=e.title),t}();return{description:r("description","og:description","twitter:description","keywords"),url:t.origin,icons:function(){for(var r=e.getElementsByTagName("link"),n=[],i=0;i<r.length;i++){var o=r[i],s=o.getAttribute("rel");if(s&&s.toLowerCase().indexOf("icon")>-1){var a=o.getAttribute("href");if(a)if(-1===a.toLowerCase().indexOf("https:")&&-1===a.toLowerCase().indexOf("http:")&&0!==a.indexOf("//")){var u=t.protocol+"//"+t.host;if(0===a.indexOf("/"))u+=a;else{var c=t.pathname.split("/");c.pop(),u+=c.join("/")+"/"+a}n.push(u)}else if(0===a.indexOf("//")){var l=t.protocol+a;n.push(l)}else n.push(a)}}return n}(),name:i}}},5803:(e,t,r)=>{function n(e){try{if(!r.g.localStorage)return!1}catch(n){return!1}var t=r.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}},10082:e=>{e.exports=function(e){return e&&"object"===typeof e&&"function"===typeof e.copy&&"function"===typeof e.fill&&"function"===typeof e.readUInt8}},54895:(e,t,r)=>{"use strict";var n=r(52635),i=r(43138),o=r(32094),s=r(50198);function a(e){return e.call.bind(e)}var u="undefined"!==typeof BigInt,c="undefined"!==typeof Symbol,l=a(Object.prototype.toString),h=a(Number.prototype.valueOf),f=a(String.prototype.valueOf),d=a(Boolean.prototype.valueOf);if(u)var p=a(BigInt.prototype.valueOf);if(c)var g=a(Symbol.prototype.valueOf);function y(e,t){if("object"!==typeof e)return!1;try{return t(e),!0}catch(r){return!1}}function v(e){return"[object Map]"===l(e)}function m(e){return"[object Set]"===l(e)}function b(e){return"[object WeakMap]"===l(e)}function E(e){return"[object WeakSet]"===l(e)}function _(e){return"[object ArrayBuffer]"===l(e)}function w(e){return"undefined"!==typeof ArrayBuffer&&(_.working?_(e):e instanceof ArrayBuffer)}function S(e){return"[object DataView]"===l(e)}function I(e){return"undefined"!==typeof DataView&&(S.working?S(e):e instanceof DataView)}t.isArgumentsObject=n,t.isGeneratorFunction=i,t.isTypedArray=s,t.isPromise=function(e){return"undefined"!==typeof Promise&&e instanceof Promise||null!==e&&"object"===typeof e&&"function"===typeof e.then&&"function"===typeof e.catch},t.isArrayBufferView=function(e){return"undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):s(e)||I(e)},t.isUint8Array=function(e){return"Uint8Array"===o(e)},t.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===o(e)},t.isUint16Array=function(e){return"Uint16Array"===o(e)},t.isUint32Array=function(e){return"Uint32Array"===o(e)},t.isInt8Array=function(e){return"Int8Array"===o(e)},t.isInt16Array=function(e){return"Int16Array"===o(e)},t.isInt32Array=function(e){return"Int32Array"===o(e)},t.isFloat32Array=function(e){return"Float32Array"===o(e)},t.isFloat64Array=function(e){return"Float64Array"===o(e)},t.isBigInt64Array=function(e){return"BigInt64Array"===o(e)},t.isBigUint64Array=function(e){return"BigUint64Array"===o(e)},v.working="undefined"!==typeof Map&&v(new Map),t.isMap=function(e){return"undefined"!==typeof Map&&(v.working?v(e):e instanceof Map)},m.working="undefined"!==typeof Set&&m(new Set),t.isSet=function(e){return"undefined"!==typeof Set&&(m.working?m(e):e instanceof Set)},b.working="undefined"!==typeof WeakMap&&b(new WeakMap),t.isWeakMap=function(e){return"undefined"!==typeof WeakMap&&(b.working?b(e):e instanceof WeakMap)},E.working="undefined"!==typeof WeakSet&&E(new WeakSet),t.isWeakSet=function(e){return E(e)},_.working="undefined"!==typeof ArrayBuffer&&_(new ArrayBuffer),t.isArrayBuffer=w,S.working="undefined"!==typeof ArrayBuffer&&"undefined"!==typeof DataView&&S(new DataView(new ArrayBuffer(1),0,1)),t.isDataView=I;var R="undefined"!==typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function O(e){return"[object SharedArrayBuffer]"===l(e)}function M(e){return"undefined"!==typeof R&&("undefined"===typeof O.working&&(O.working=O(new R)),O.working?O(e):e instanceof R)}function T(e){return y(e,h)}function P(e){return y(e,f)}function N(e){return y(e,d)}function x(e){return u&&y(e,p)}function A(e){return c&&y(e,g)}t.isSharedArrayBuffer=M,t.isAsyncFunction=function(e){return"[object AsyncFunction]"===l(e)},t.isMapIterator=function(e){return"[object Map Iterator]"===l(e)},t.isSetIterator=function(e){return"[object Set Iterator]"===l(e)},t.isGeneratorObject=function(e){return"[object Generator]"===l(e)},t.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===l(e)},t.isNumberObject=T,t.isStringObject=P,t.isBooleanObject=N,t.isBigIntObject=x,t.isSymbolObject=A,t.isBoxedPrimitive=function(e){return T(e)||P(e)||N(e)||x(e)||A(e)},t.isAnyArrayBuffer=function(e){return"undefined"!==typeof Uint8Array&&(w(e)||M(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(e){Object.defineProperty(t,e,{enumerable:!1,value:function(){throw new Error(e+" is not supported in userland")}})}))},43335:(e,t,r)=>{var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},i=/%[sdj%]/g;t.format=function(e){if(!m(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(u(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,o=n.length,s=String(e).replace(i,(function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return e}})),a=n[r];r<o;a=n[++r])y(a)||!_(a)?s+=" "+a:s+=" "+u(a);return s},t.deprecate=function(e,r){if("undefined"!==typeof process&&!0===process.noDeprecation)return e;if("undefined"===typeof process)return function(){return t.deprecate(e,r).apply(this,arguments)};var n=!1;return function(){if(!n){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),n=!0}return e.apply(this,arguments)}};var o={},s=/^$/;if({NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"web-embed",slug:"web-embed",version:"0.0.1",web:{},description:"Multi-chain support for BTC/ETH/BNB/NEAR/Polygon/Solana/Avalanche/Fantom and others",sdkVersion:"49.0.0",platforms:["ios","android","web"]},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.NODE_DEBUG){var a={NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"web-embed",slug:"web-embed",version:"0.0.1",web:{},description:"Multi-chain support for BTC/ETH/BNB/NEAR/Polygon/Solana/Avalanche/Fantom and others",sdkVersion:"49.0.0",platforms:["ios","android","web"]},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.NODE_DEBUG;a=a.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),s=new RegExp("^"+a+"$","i")}function u(e,r){var n={seen:[],stylize:l};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),g(r)?n.showHidden=r:r&&t._extend(n,r),b(n.showHidden)&&(n.showHidden=!1),b(n.depth)&&(n.depth=2),b(n.colors)&&(n.colors=!1),b(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=c),h(n,e,n.depth)}function c(e,t){var r=u.styles[t];return r?"\x1b["+u.colors[r][0]+"m"+e+"\x1b["+u.colors[r][1]+"m":e}function l(e,t){return e}function h(e,r,n){if(e.customInspect&&r&&I(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,e);return m(i)||(i=h(e,i,n)),i}var o=function(e,t){if(b(t))return e.stylize("undefined","undefined");if(m(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(v(t))return e.stylize(""+t,"number");if(g(t))return e.stylize(""+t,"boolean");if(y(t))return e.stylize("null","null")}(e,r);if(o)return o;var s=Object.keys(r),a=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(r)),S(r)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(r);if(0===s.length){if(I(r)){var u=r.name?": "+r.name:"";return e.stylize("[Function"+u+"]","special")}if(E(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(w(r))return e.stylize(Date.prototype.toString.call(r),"date");if(S(r))return f(r)}var c,l="",_=!1,R=["{","}"];(p(r)&&(_=!0,R=["[","]"]),I(r))&&(l=" [Function"+(r.name?": "+r.name:"")+"]");return E(r)&&(l=" "+RegExp.prototype.toString.call(r)),w(r)&&(l=" "+Date.prototype.toUTCString.call(r)),S(r)&&(l=" "+f(r)),0!==s.length||_&&0!=r.length?n<0?E(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),c=_?function(e,t,r,n,i){for(var o=[],s=0,a=t.length;s<a;++s)T(t,String(s))?o.push(d(e,t,r,n,String(s),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(d(e,t,r,n,i,!0))})),o}(e,r,n,a,s):s.map((function(t){return d(e,r,n,a,t,_)})),e.seen.pop(),function(e,t,r){var n=e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(n>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(c,l,R)):R[0]+l+R[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,r,n,i,o){var s,a,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?a=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(a=e.stylize("[Setter]","special")),T(n,i)||(s="["+i+"]"),a||(e.seen.indexOf(u.value)<0?(a=y(r)?h(e,u.value,null):h(e,u.value,r-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(e){return"  "+e})).join("\n").slice(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),b(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.slice(1,-1),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function p(e){return Array.isArray(e)}function g(e){return"boolean"===typeof e}function y(e){return null===e}function v(e){return"number"===typeof e}function m(e){return"string"===typeof e}function b(e){return void 0===e}function E(e){return _(e)&&"[object RegExp]"===R(e)}function _(e){return"object"===typeof e&&null!==e}function w(e){return _(e)&&"[object Date]"===R(e)}function S(e){return _(e)&&("[object Error]"===R(e)||e instanceof Error)}function I(e){return"function"===typeof e}function R(e){return Object.prototype.toString.call(e)}function O(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(e=e.toUpperCase(),!o[e])if(s.test(e)){var r=process.pid;o[e]=function(){var n=t.format.apply(t,arguments);console.error("%s %d: %s",e,r,n)}}else o[e]=function(){};return o[e]},t.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.types=r(54895),t.isArray=p,t.isBoolean=g,t.isNull=y,t.isNullOrUndefined=function(e){return null==e},t.isNumber=v,t.isString=m,t.isSymbol=function(e){return"symbol"===typeof e},t.isUndefined=b,t.isRegExp=E,t.types.isRegExp=E,t.isObject=_,t.isDate=w,t.types.isDate=w,t.isError=S,t.types.isNativeError=S,t.isFunction=I,t.isPrimitive=function(e){return null===e||"boolean"===typeof e||"number"===typeof e||"string"===typeof e||"symbol"===typeof e||"undefined"===typeof e},t.isBuffer=r(10082);var M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",function(){var e=new Date,t=[O(e.getHours()),O(e.getMinutes()),O(e.getSeconds())].join(":");return[e.getDate(),M[e.getMonth()],t].join(" ")}(),t.format.apply(t,arguments))},t.inherits=r(91285),t._extend=function(e,t){if(!t||!_(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var P="undefined"!==typeof Symbol?Symbol("util.promisify.custom"):void 0;function N(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!==typeof e)throw new TypeError('The "original" argument must be of type Function');if(P&&e[P]){var t;if("function"!==typeof(t=e[P]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,P,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,i)}catch(s){r(s)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),P&&Object.defineProperty(t,P,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=P,t.callbackify=function(e){if("function"!==typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);var n=t.pop();if("function"!==typeof n)throw new TypeError("The last argument must be of type Function");var i=this,o=function(){return n.apply(i,arguments)};e.apply(this,t).then((function(e){process.nextTick(o.bind(null,null,e))}),(function(e){process.nextTick(N.bind(null,e,o))}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,n(e)),t}},29987:(e,t,r)=>{"use strict";var n;r.r(t),r.d(t,{NIL:()=>A,parse:()=>y,stringify:()=>l,v1:()=>g,v3:()=>O,v4:()=>M,v5:()=>x,validate:()=>a,version:()=>C});var i=new Uint8Array(16);function o(){if(!n&&!(n="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(i)}const s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const a=function(e){return"string"===typeof e&&s.test(e)};for(var u=[],c=0;c<256;++c)u.push((c+256).toString(16).substr(1));const l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]).toLowerCase();if(!a(r))throw TypeError("Stringified UUID is invalid");return r};var h,f,d=0,p=0;const g=function(e,t,r){var n=t&&r||0,i=t||new Array(16),s=(e=e||{}).node||h,a=void 0!==e.clockseq?e.clockseq:f;if(null==s||null==a){var u=e.random||(e.rng||o)();null==s&&(s=h=[1|u[0],u[1],u[2],u[3],u[4],u[5]]),null==a&&(a=f=16383&(u[6]<<8|u[7]))}var c=void 0!==e.msecs?e.msecs:Date.now(),g=void 0!==e.nsecs?e.nsecs:p+1,y=c-d+(g-p)/1e4;if(y<0&&void 0===e.clockseq&&(a=a+1&16383),(y<0||c>d)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");d=c,p=g,f=a;var v=(1e4*(268435455&(c+=122192928e5))+g)%4294967296;i[n++]=v>>>24&255,i[n++]=v>>>16&255,i[n++]=v>>>8&255,i[n++]=255&v;var m=c/4294967296*1e4&268435455;i[n++]=m>>>8&255,i[n++]=255&m,i[n++]=m>>>24&15|16,i[n++]=m>>>16&255,i[n++]=a>>>8|128,i[n++]=255&a;for(var b=0;b<6;++b)i[n+b]=s[b];return t||l(i)};const y=function(e){if(!a(e))throw TypeError("Invalid UUID");var t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};function v(e,t,r){function n(e,n,i,o){if("string"===typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"===typeof n&&(n=y(n)),16!==n.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+e.length);if(s.set(n),s.set(e,n.length),(s=r(s))[6]=15&s[6]|t,s[8]=63&s[8]|128,i){o=o||0;for(var a=0;a<16;++a)i[o+a]=s[a];return i}return l(s)}try{n.name=e}catch(i){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}function m(e){return 14+(e+64>>>9<<4)+1}function b(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function E(e,t,r,n,i,o){return b((s=b(b(t,e),b(n,o)))<<(a=i)|s>>>32-a,r);var s,a}function _(e,t,r,n,i,o,s){return E(t&r|~t&n,e,t,i,o,s)}function w(e,t,r,n,i,o,s){return E(t&n|r&~n,e,t,i,o,s)}function S(e,t,r,n,i,o,s){return E(t^r^n,e,t,i,o,s)}function I(e,t,r,n,i,o,s){return E(r^(t|~n),e,t,i,o,s)}const R=function(e){if("string"===typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){for(var t=[],r=32*e.length,n="0123456789abcdef",i=0;i<r;i+=8){var o=e[i>>5]>>>i%32&255,s=parseInt(n.charAt(o>>>4&15)+n.charAt(15&o),16);t.push(s)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[m(t)-1]=t;for(var r=1732584193,n=-271733879,i=-1732584194,o=271733878,s=0;s<e.length;s+=16){var a=r,u=n,c=i,l=o;r=_(r,n,i,o,e[s],7,-680876936),o=_(o,r,n,i,e[s+1],12,-389564586),i=_(i,o,r,n,e[s+2],17,606105819),n=_(n,i,o,r,e[s+3],22,-1044525330),r=_(r,n,i,o,e[s+4],7,-176418897),o=_(o,r,n,i,e[s+5],12,1200080426),i=_(i,o,r,n,e[s+6],17,-1473231341),n=_(n,i,o,r,e[s+7],22,-45705983),r=_(r,n,i,o,e[s+8],7,1770035416),o=_(o,r,n,i,e[s+9],12,-1958414417),i=_(i,o,r,n,e[s+10],17,-42063),n=_(n,i,o,r,e[s+11],22,-1990404162),r=_(r,n,i,o,e[s+12],7,1804603682),o=_(o,r,n,i,e[s+13],12,-40341101),i=_(i,o,r,n,e[s+14],17,-1502002290),r=w(r,n=_(n,i,o,r,e[s+15],22,1236535329),i,o,e[s+1],5,-165796510),o=w(o,r,n,i,e[s+6],9,-1069501632),i=w(i,o,r,n,e[s+11],14,643717713),n=w(n,i,o,r,e[s],20,-373897302),r=w(r,n,i,o,e[s+5],5,-701558691),o=w(o,r,n,i,e[s+10],9,38016083),i=w(i,o,r,n,e[s+15],14,-660478335),n=w(n,i,o,r,e[s+4],20,-405537848),r=w(r,n,i,o,e[s+9],5,568446438),o=w(o,r,n,i,e[s+14],9,-1019803690),i=w(i,o,r,n,e[s+3],14,-187363961),n=w(n,i,o,r,e[s+8],20,1163531501),r=w(r,n,i,o,e[s+13],5,-1444681467),o=w(o,r,n,i,e[s+2],9,-51403784),i=w(i,o,r,n,e[s+7],14,1735328473),r=S(r,n=w(n,i,o,r,e[s+12],20,-1926607734),i,o,e[s+5],4,-378558),o=S(o,r,n,i,e[s+8],11,-2022574463),i=S(i,o,r,n,e[s+11],16,1839030562),n=S(n,i,o,r,e[s+14],23,-35309556),r=S(r,n,i,o,e[s+1],4,-1530992060),o=S(o,r,n,i,e[s+4],11,1272893353),i=S(i,o,r,n,e[s+7],16,-155497632),n=S(n,i,o,r,e[s+10],23,-1094730640),r=S(r,n,i,o,e[s+13],4,681279174),o=S(o,r,n,i,e[s],11,-358537222),i=S(i,o,r,n,e[s+3],16,-722521979),n=S(n,i,o,r,e[s+6],23,76029189),r=S(r,n,i,o,e[s+9],4,-640364487),o=S(o,r,n,i,e[s+12],11,-421815835),i=S(i,o,r,n,e[s+15],16,530742520),r=I(r,n=S(n,i,o,r,e[s+2],23,-995338651),i,o,e[s],6,-198630844),o=I(o,r,n,i,e[s+7],10,1126891415),i=I(i,o,r,n,e[s+14],15,-1416354905),n=I(n,i,o,r,e[s+5],21,-57434055),r=I(r,n,i,o,e[s+12],6,1700485571),o=I(o,r,n,i,e[s+3],10,-1894986606),i=I(i,o,r,n,e[s+10],15,-1051523),n=I(n,i,o,r,e[s+1],21,-2054922799),r=I(r,n,i,o,e[s+8],6,1873313359),o=I(o,r,n,i,e[s+15],10,-30611744),i=I(i,o,r,n,e[s+6],15,-1560198380),n=I(n,i,o,r,e[s+13],21,1309151649),r=I(r,n,i,o,e[s+4],6,-145523070),o=I(o,r,n,i,e[s+11],10,-1120210379),i=I(i,o,r,n,e[s+2],15,718787259),n=I(n,i,o,r,e[s+9],21,-343485551),r=b(r,a),n=b(n,u),i=b(i,c),o=b(o,l)}return[r,n,i,o]}(function(e){if(0===e.length)return[];for(var t=8*e.length,r=new Uint32Array(m(t)),n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))};const O=v("v3",48,R);const M=function(e,t,r){var n=(e=e||{}).random||(e.rng||o)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=n[i];return t}return l(n)};function T(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:case 3:return t^r^n;case 2:return t&r^t&n^r&n}}function P(e,t){return e<<t|e>>>32-t}const N=function(e){var t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"===typeof e){var n=unescape(encodeURIComponent(e));e=[];for(var i=0;i<n.length;++i)e.push(n.charCodeAt(i))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var o=e.length/4+2,s=Math.ceil(o/16),a=new Array(s),u=0;u<s;++u){for(var c=new Uint32Array(16),l=0;l<16;++l)c[l]=e[64*u+4*l]<<24|e[64*u+4*l+1]<<16|e[64*u+4*l+2]<<8|e[64*u+4*l+3];a[u]=c}a[s-1][14]=8*(e.length-1)/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=8*(e.length-1)&4294967295;for(var h=0;h<s;++h){for(var f=new Uint32Array(80),d=0;d<16;++d)f[d]=a[h][d];for(var p=16;p<80;++p)f[p]=P(f[p-3]^f[p-8]^f[p-14]^f[p-16],1);for(var g=r[0],y=r[1],v=r[2],m=r[3],b=r[4],E=0;E<80;++E){var _=Math.floor(E/20),w=P(g,5)+T(_,y,v,m)+b+t[_]+f[E]>>>0;b=m,m=v,v=P(y,30)>>>0,y=g,g=w}r[0]=r[0]+g>>>0,r[1]=r[1]+y>>>0,r[2]=r[2]+v>>>0,r[3]=r[3]+m>>>0,r[4]=r[4]+b>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]};const x=v("v5",80,N),A="00000000-0000-0000-0000-000000000000";const C=function(e){if(!a(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},84620:e=>{e.exports=function e(n,i){var o,s=0,a=0,u=i=i||0,c=n.length;do{if(u>=c)throw e.bytes=0,new RangeError("Could not decode varint");o=n[u++],s+=a<28?(o&r)<<a:(o&r)*Math.pow(2,a),a+=7}while(o>=t);return e.bytes=u-i,s};var t=128,r=127},82136:e=>{e.exports=function e(i,o,s){o=o||[];var a=s=s||0;for(;i>=n;)o[s++]=255&i|t,i/=128;for(;i&r;)o[s++]=255&i|t,i>>>=7;return o[s]=0|i,e.bytes=s-a+1,o};var t=128,r=-128,n=Math.pow(2,31)},28260:(e,t,r)=>{e.exports={encode:r(82136),decode:r(84620),encodingLength:r(82027)}},82027:e=>{var t=Math.pow(2,7),r=Math.pow(2,14),n=Math.pow(2,21),i=Math.pow(2,28),o=Math.pow(2,35),s=Math.pow(2,42),a=Math.pow(2,49),u=Math.pow(2,56),c=Math.pow(2,63);e.exports=function(e){return e<t?1:e<r?2:e<n?3:e<i?4:e<o?5:e<s?6:e<a?7:e<u?8:e<c?9:10}},8595:(e,t,r)=>{"use strict";var n=r(77834).Buffer,i=9007199254740991;function o(e){if(e<0||e>i||e%1!==0)throw new RangeError("value out of range")}function s(e){return o(e),e<253?1:e<=65535?3:e<=4294967295?5:9}e.exports={encode:function e(t,r,i){if(o(t),r||(r=n.allocUnsafe(s(t))),!n.isBuffer(r))throw new TypeError("buffer must be a Buffer instance");return i||(i=0),t<253?(r.writeUInt8(t,i),e.bytes=1):t<=65535?(r.writeUInt8(253,i),r.writeUInt16LE(t,i+1),e.bytes=3):t<=4294967295?(r.writeUInt8(254,i),r.writeUInt32LE(t,i+1),e.bytes=5):(r.writeUInt8(255,i),r.writeUInt32LE(t>>>0,i+1),r.writeUInt32LE(t/4294967296|0,i+5),e.bytes=9),r},decode:function e(t,r){if(!n.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");r||(r=0);var i=t.readUInt8(r);if(i<253)return e.bytes=1,i;if(253===i)return e.bytes=3,t.readUInt16LE(r+1);if(254===i)return e.bytes=5,t.readUInt32LE(r+1);e.bytes=9;var s=t.readUInt32LE(r+1),a=4294967296*t.readUInt32LE(r+5)+s;return o(a),a},encodingLength:s}},89201:(e,t,r)=>{var n=r(65097),i=r(49797),o=r(72993),s=r(95003),a=r(45376),u=function(e,t){var r=[];return t.forEach((function(t){if("object"===typeof t.components){if("tuple"!==t.type.substring(0,5))throw new Error("components found but type is not tuple; report on GitHub");var n="",i=t.type.indexOf("[");i>=0&&(n=t.type.substring(i));var o=u(e,t.components);Array.isArray(o)&&e?r.push("tuple("+o.join(",")+")"+n):e?r.push("("+o+")"):r.push("("+o.join(",")+")"+n)}else r.push(t.type)})),r},c=function(e){if(!i.isHexStrict(e))throw new Error("The parameter must be a valid HEX string.");var t="",r=0,n=e.length;for("0x"===e.substring(0,2)&&(r=2);r<n;r+=2){var o=parseInt(e.substr(r,2),16);t+=String.fromCharCode(o)}return t},l=function(e){if(!e)return"0x00";for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r).toString(16);t+=n.length<2?"0"+n:n}return"0x"+t},h=function(e){if(e=e?e.toLowerCase():"ether",!n.unitMap[e])throw new Error('This unit "'+e+"\" doesn't exist, please use the one of the following units"+JSON.stringify(n.unitMap,null,2));return e};e.exports={_fireError:function(e,t,r,n,i){return!e||"object"!==typeof e||e instanceof Error||!e.data||((e.data&&"object"===typeof e.data||Array.isArray(e.data))&&(e.data=JSON.stringify(e.data,null,2)),e=e.message+"\n"+e.data),"string"===typeof e&&(e=new Error(e)),"function"===typeof n&&n(e,i),"function"===typeof r&&((t&&"function"===typeof t.listeners&&t.listeners("error").length||"function"===typeof n)&&t.catch((function(){})),setTimeout((function(){r(e)}),1)),t&&"function"===typeof t.emit&&setTimeout((function(){t.emit("error",e,i),t.removeAllListeners()}),1),t},_jsonInterfaceMethodToString:function(e){return e&&"object"===typeof e&&e.name&&-1!==e.name.indexOf("(")?e.name:e.name+"("+u(!1,e.inputs).join(",")+")"},_flattenTypes:u,randomHex:function(e){return"0x"+s(e).toString("hex")},BN:i.BN,isBN:i.isBN,isBigNumber:i.isBigNumber,isHex:i.isHex,isHexStrict:i.isHexStrict,sha3:i.sha3,sha3Raw:i.sha3Raw,keccak256:i.sha3,soliditySha3:o.soliditySha3,soliditySha3Raw:o.soliditySha3Raw,encodePacked:o.encodePacked,isAddress:i.isAddress,checkAddressChecksum:i.checkAddressChecksum,toChecksumAddress:function(e){if("undefined"===typeof e)return"";if(!/^(0x)?[0-9a-f]{40}$/i.test(e))throw new Error('Given address "'+e+'" is not a valid Ethereum address.');e=e.toLowerCase().replace(/^0x/i,"");for(var t=i.sha3(e).replace(/^0x/i,""),r="0x",n=0;n<e.length;n++)parseInt(t[n],16)>7?r+=e[n].toUpperCase():r+=e[n];return r},toHex:i.toHex,toBN:i.toBN,bytesToHex:i.bytesToHex,hexToBytes:i.hexToBytes,hexToNumberString:i.hexToNumberString,hexToNumber:i.hexToNumber,toDecimal:i.hexToNumber,numberToHex:i.numberToHex,fromDecimal:i.numberToHex,hexToUtf8:i.hexToUtf8,hexToString:i.hexToUtf8,toUtf8:i.hexToUtf8,stripHexPrefix:i.stripHexPrefix,utf8ToHex:i.utf8ToHex,stringToHex:i.utf8ToHex,fromUtf8:i.utf8ToHex,hexToAscii:c,toAscii:c,asciiToHex:l,fromAscii:l,unitMap:n.unitMap,toWei:function(e,t){if(t=h(t),!i.isBN(e)&&"string"!==typeof e)throw new Error("Please pass numbers as strings or BN objects to avoid precision errors.");return i.isBN(e)?n.toWei(e,t):n.toWei(e,t).toString(10)},fromWei:function(e,t){if(t=h(t),!i.isBN(e)&&"string"!==typeof e)throw new Error("Please pass numbers as strings or BN objects to avoid precision errors.");return i.isBN(e)?n.fromWei(e,t):n.fromWei(e,t).toString(10)},padLeft:i.leftPad,leftPad:i.leftPad,padRight:i.rightPad,rightPad:i.rightPad,toTwosComplement:i.toTwosComplement,isBloom:i.isBloom,isUserEthereumAddressInBloom:i.isUserEthereumAddressInBloom,isContractAddressInBloom:i.isContractAddressInBloom,isTopic:i.isTopic,isTopicInBloom:i.isTopicInBloom,isInBloom:i.isInBloom,compareBlockNumbers:function(e,t){if(e==t)return 0;if("genesis"!=e&&"earliest"!=e&&0!=e||"genesis"!=t&&"earliest"!=t&&0!=t){if("genesis"==e||"earliest"==e)return-1;if("genesis"==t||"earliest"==t)return 1;if("latest"==e)return"pending"==t?-1:1;if("latest"===t)return"pending"==e?1:-1;if("pending"==e)return 1;if("pending"==t)return-1;{let r=new a(e),n=new a(t);return r.lt(n)?-1:r.eq(n)?0:1}}return 0},toNumber:i.toNumber}},72993:(e,t,r)=>{var n=r(45376),i=r(49797),o=function(e){var t=typeof e;if("string"===t)return i.isHexStrict(e)?new n(e.replace(/0x/i,""),16):new n(e,10);if("number"===t)return new n(e);if(i.isBigNumber(e))return new n(e.toString(10));if(i.isBN(e))return e;throw new Error(e+" is not a number")},s=function(e,t,r){var s,a,u;if("bytes"===(e=(u=e).startsWith("int[")?"int256"+u.slice(3):"int"===u?"int256":u.startsWith("uint[")?"uint256"+u.slice(4):"uint"===u?"uint256":u.startsWith("fixed[")?"fixed128x128"+u.slice(5):"fixed"===u?"fixed128x128":u.startsWith("ufixed[")?"ufixed128x128"+u.slice(6):"ufixed"===u?"ufixed128x128":u)){if(t.replace(/^0x/i,"").length%2!==0)throw new Error("Invalid bytes characters "+t.length);return t}if("string"===e)return i.utf8ToHex(t);if("bool"===e)return t?"01":"00";if(e.startsWith("address")){if(s=r?64:40,!i.isAddress(t))throw new Error(t+" is not a valid address, or the checksum is invalid.");return i.leftPad(t.toLowerCase(),s)}if(s=function(e){var t=/^\D+(\d+).*$/.exec(e);return t?parseInt(t[1],10):null}(e),e.startsWith("bytes")){if(!s)throw new Error("bytes[] not yet supported in solidity");if(r&&(s=32),s<1||s>32||s<t.replace(/^0x/i,"").length/2)throw new Error("Invalid bytes"+s+" for "+t);return i.rightPad(t,2*s)}if(e.startsWith("uint")){if(s%8||s<8||s>256)throw new Error("Invalid uint"+s+" size");if((a=o(t)).bitLength()>s)throw new Error("Supplied uint exceeds width: "+s+" vs "+a.bitLength());if(a.lt(new n(0)))throw new Error("Supplied uint "+a.toString()+" is negative");return s?i.leftPad(a.toString("hex"),s/8*2):a}if(e.startsWith("int")){if(s%8||s<8||s>256)throw new Error("Invalid int"+s+" size");if((a=o(t)).bitLength()>s)throw new Error("Supplied int exceeds width: "+s+" vs "+a.bitLength());return a.lt(new n(0))?a.toTwos(s).toString("hex"):s?i.leftPad(a.toString("hex"),s/8*2):a}throw new Error("Unsupported or invalid type: "+e)},a=function(e){if(Array.isArray(e))throw new Error("Autodetection of array types is not supported.");var t,r,o="";if(e&&"object"===typeof e&&(e.hasOwnProperty("v")||e.hasOwnProperty("t")||e.hasOwnProperty("value")||e.hasOwnProperty("type"))?(t=e.hasOwnProperty("t")?e.t:e.type,o=e.hasOwnProperty("v")?e.v:e.value):(t=i.toHex(e,!0),o=i.toHex(e),t.startsWith("int")||t.startsWith("uint")||(t="bytes")),!t.startsWith("int")&&!t.startsWith("uint")||"string"!==typeof o||/^(-)?0x/i.test(o)||(o=new n(o)),Array.isArray(o)){if(r=function(e){var t=/^\D+\d*\[(\d+)\]$/.exec(e);return t?parseInt(t[1],10):null}(t),r&&o.length!==r)throw new Error(t+" is not matching the given array "+JSON.stringify(o));r=o.length}return Array.isArray(o)?o.map((function(e){return s(t,e,r).toString("hex").replace("0x","")})).join(""):s(t,o,r).toString("hex").replace("0x","")};e.exports={soliditySha3:function(){var e=Array.prototype.slice.call(arguments).map(a);return i.sha3("0x"+e.join(""))},soliditySha3Raw:function(){return i.sha3Raw("0x"+Array.prototype.slice.call(arguments).map(a).join(""))},encodePacked:function(){return"0x"+Array.prototype.slice.call(arguments).map(a).join("").toLowerCase()}}},49797:(e,t,r)=>{var n=r(48834).Buffer,i=r(45376),o=r(13367),s=r(35050),a=r(47144),u=r(7245),c=function(e){return i.isBN(e)},l=function(e){return e&&e.constructor&&"BigNumber"===e.constructor.name},h=function(e){try{return o.apply(null,arguments)}catch(t){throw new Error(t+' Given value: "'+e+'"')}},f=function(e){return!!/^(0x)?[0-9a-f]{40}$/i.test(e)&&(!(!/^(0x|0X)?[0-9a-f]{40}$/.test(e)&&!/^(0x|0X)?[0-9A-F]{40}$/.test(e))||d(e))},d=function(e){e=e.replace(/^0x/i,"");for(var t=_(e.toLowerCase()).replace(/^0x/i,""),r=0;r<40;r++)if(parseInt(t[r],16)>7&&e[r].toUpperCase()!==e[r]||parseInt(t[r],16)<=7&&e[r].toLowerCase()!==e[r])return!1;return!0},p=function(e){var t="";e=(e=(e=(e=(e=s.encode(e)).replace(/^(?:\u0000)*/,"")).split("").reverse().join("")).replace(/^(?:\u0000)*/,"")).split("").reverse().join("");for(var r=0;r<e.length;r++){var n=e.charCodeAt(r).toString(16);t+=n.length<2?"0"+n:n}return"0x"+t},g=function(e){if(!e)return e;if("string"===typeof e&&!m(e))throw new Error('Given value "'+e+'" is not a valid hex string.');return h(e).toNumber()},y=function(e){if(null===e||void 0===e)return e;if(!isFinite(e)&&!m(e))throw new Error('Given input "'+e+'" is not a number.');var t=h(e),r=t.toString(16);return t.lt(new i(0))?"-0x"+r.substr(1):"0x"+r},v=function(e,t){if(f(e))return t?"address":"0x"+e.toLowerCase().replace(/^0x/i,"");if("boolean"===typeof e)return t?"bool":e?"0x01":"0x00";if(n.isBuffer(e))return"0x"+e.toString("hex");if("object"===typeof e&&e&&!l(e)&&!c(e))return t?"string":p(JSON.stringify(e));if("string"===typeof e){if(0===e.indexOf("-0x")||0===e.indexOf("-0X"))return t?"int256":y(e);if(0===e.indexOf("0x")||0===e.indexOf("0X"))return t?"bytes":e;if(!isFinite(e))return t?"string":p(e)}return t?e<0?"int256":"uint256":y(e)},m=function(e){return("string"===typeof e||"number"===typeof e)&&/^(-)?0x[0-9a-f]*$/i.test(e)},b=function(e){return("string"===typeof e||"number"===typeof e)&&/^(-0x|0x)?[0-9a-f]*$/i.test(e)},E="0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",_=function(e){c(e)&&(e=e.toString()),m(e)&&/^0x/i.test(e.toString())?e=a.toBuffer(e):"string"===typeof e&&(e=n.from(e,"utf-8"));var t=a.bufferToHex(a.keccak256(e));return t===E?null:t};_._Hash=a.keccak256;e.exports={BN:i,isBN:c,isBigNumber:l,toBN:h,isAddress:f,isBloom:function(e){return u.isBloom(e)},isUserEthereumAddressInBloom:function(e,t){return u.isUserEthereumAddressInBloom(e,t)},isContractAddressInBloom:function(e,t){return u.isContractAddressInBloom(e,t)},isTopic:function(e){return u.isTopic(e)},isTopicInBloom:function(e,t){return u.isTopicInBloom(e,t)},isInBloom:function(e,t){return u.isInBloom(e,t)},checkAddressChecksum:d,utf8ToHex:p,hexToUtf8:function(e){if(!m(e))throw new Error('The parameter "'+e+'" must be a valid HEX string.');for(var t="",r=0,n=(e=(e=(e=(e=(e=e.replace(/^0x/i,"")).replace(/^(?:00)*/,"")).split("").reverse().join("")).replace(/^(?:00)*/,"")).split("").reverse().join("")).length,i=0;i<n;i+=2)r=parseInt(e.substr(i,2),16),t+=String.fromCharCode(r);return s.decode(t)},hexToNumber:g,hexToNumberString:function(e){if(!e)return e;if("string"===typeof e&&!m(e))throw new Error('Given value "'+e+'" is not a valid hex string.');return h(e).toString(10)},numberToHex:y,toHex:v,hexToBytes:function(e){if(e=e.toString(16),!m(e))throw new Error('Given value "'+e+'" is not a valid hex string.');e=e.replace(/^0x/i,"");for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},bytesToHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push((e[r]>>>4).toString(16)),t.push((15&e[r]).toString(16));return"0x"+t.join("")},isHex:b,isHexStrict:m,stripHexPrefix:function(e){return 0!==e&&b(e)?e.replace(/^(-)?0x/i,"$1"):e},leftPad:function(e,t,r){var n=/^0x/i.test(e)||"number"===typeof e,i=t-(e=e.toString(16).replace(/^0x/i,"")).length+1>=0?t-e.length+1:0;return(n?"0x":"")+new Array(i).join(r||"0")+e},rightPad:function(e,t,r){var n=/^0x/i.test(e)||"number"===typeof e,i=t-(e=e.toString(16).replace(/^0x/i,"")).length+1>=0?t-e.length+1:0;return(n?"0x":"")+e+new Array(i).join(r||"0")},toTwosComplement:function(e){return"0x"+h(e).toTwos(256).toString(16,64)},sha3:_,sha3Raw:function(e){return null===(e=_(e))?E:e},toNumber:function(e){return"number"===typeof e?e:g(v(e))}}},45376:function(e,t,r){!function(e,t){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function o(e,t,r){if(o.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}var s;"object"===typeof e?e.exports=o:t.BN=o,o.BN=o,o.wordSize=26;try{s="undefined"!==typeof window&&"undefined"!==typeof window.Buffer?window.Buffer:r(42780).Buffer}catch(R){}function a(e,t){var r=e.charCodeAt(t);return r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:r-48&15}function u(e,t,r){var n=a(e,r);return r-1>=t&&(n|=a(e,r-1)<<4),n}function c(e,t,r,n){for(var i=0,o=Math.min(e.length,r),s=t;s<o;s++){var a=e.charCodeAt(s)-48;i*=n,i+=a>=49?a-49+10:a>=17?a-17+10:a}return i}o.isBN=function(e){return e instanceof o||null!==e&&"object"===typeof e&&e.constructor.wordSize===o.wordSize&&Array.isArray(e.words)},o.max=function(e,t){return e.cmp(t)>0?e:t},o.min=function(e,t){return e.cmp(t)<0?e:t},o.prototype._init=function(e,t,r){if("number"===typeof e)return this._initNumber(e,t,r);if("object"===typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,r):(this._parseBase(e,t,i),"le"===r&&this._initArray(this.toArray(),t,r)))},o.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},o.prototype._initArray=function(e,t,r){if(n("number"===typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var o,s,a=0;if("be"===r)for(i=e.length-1,o=0;i>=0;i-=3)s=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);else if("le"===r)for(i=0,o=0;i<e.length;i+=3)s=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);return this.strip()},o.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,o=0,s=0;if("be"===r)for(n=e.length-1;n>=t;n-=2)i=u(e,t,n)<<o,this.words[s]|=67108863&i,o>=18?(o-=18,s+=1,this.words[s]|=i>>>26):o+=8;else for(n=(e.length-t)%2===0?t+1:t;n<e.length;n+=2)i=u(e,t,n)<<o,this.words[s]|=67108863&i,o>=18?(o-=18,s+=1,this.words[s]|=i>>>26):o+=8;this.strip()},o.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var n=0,i=1;i<=67108863;i*=t)n++;n--,i=i/t|0;for(var o=e.length-r,s=o%n,a=Math.min(o,o-s)+r,u=0,l=r;l<a;l+=n)u=c(e,l,l+n,t),this.imuln(i),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u);if(0!==s){var h=1;for(u=c(e,l,e.length,t),l=0;l<s;l++)h*=t;this.imuln(h),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u)}this.strip()},o.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},o.prototype.clone=function(){var e=new o(null);return this.copy(e),e},o.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},o.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},o.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},o.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],h=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],f=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function d(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0;r.length=n,n=n-1|0;var i=0|e.words[0],o=0|t.words[0],s=i*o,a=67108863&s,u=s/67108864|0;r.words[0]=a;for(var c=1;c<n;c++){for(var l=u>>>26,h=67108863&u,f=Math.min(c,t.length-1),d=Math.max(0,c-e.length+1);d<=f;d++){var p=c-d|0;l+=(s=(i=0|e.words[p])*(o=0|t.words[d])+h)/67108864|0,h=67108863&s}r.words[c]=0|h,u=0|l}return 0!==u?r.words[c]=0|u:r.length--,r.strip()}o.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var i=0,o=0,s=0;s<this.length;s++){var a=this.words[s],u=(16777215&(a<<i|o)).toString(16);r=0!==(o=a>>>24-i&16777215)||s!==this.length-1?l[6-u.length]+u+r:u+r,(i+=2)>=26&&(i-=26,s--)}for(0!==o&&(r=o.toString(16)+r);r.length%t!==0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var c=h[e],d=f[e];r="";var p=this.clone();for(p.negative=0;!p.isZero();){var g=p.modn(d).toString(e);r=(p=p.idivn(d)).isZero()?g+r:l[c-g.length]+g+r}for(this.isZero()&&(r="0"+r);r.length%t!==0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},o.prototype.toJSON=function(){return this.toString(16)},o.prototype.toBuffer=function(e,t){return n("undefined"!==typeof s),this.toArrayLike(s,e,t)},o.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},o.prototype.toArrayLike=function(e,t,r){var i=this.byteLength(),o=r||Math.max(1,i);n(i<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0"),this.strip();var s,a,u="le"===t,c=new e(o),l=this.clone();if(u){for(a=0;!l.isZero();a++)s=l.andln(255),l.iushrn(8),c[a]=s;for(;a<o;a++)c[a]=0}else{for(a=0;a<o-i;a++)c[a]=0;for(a=0;!l.isZero();a++)s=l.andln(255),l.iushrn(8),c[o-a-1]=s}return c},Math.clz32?o.prototype._countBits=function(e){return 32-Math.clz32(e)}:o.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},o.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return 0===(8191&t)&&(r+=13,t>>>=13),0===(127&t)&&(r+=7,t>>>=7),0===(15&t)&&(r+=4,t>>>=4),0===(3&t)&&(r+=2,t>>>=2),0===(1&t)&&r++,r},o.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},o.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return 0!==this.negative},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},o.prototype.ior=function(e){return n(0===(this.negative|e.negative)),this.iuor(e)},o.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},o.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},o.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this.strip()},o.prototype.iand=function(e){return n(0===(this.negative|e.negative)),this.iuand(e)},o.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},o.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},o.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var n=0;n<r.length;n++)this.words[n]=t.words[n]^r.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this.strip()},o.prototype.ixor=function(e){return n(0===(this.negative|e.negative)),this.iuxor(e)},o.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},o.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},o.prototype.inotn=function(e){n("number"===typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this.strip()},o.prototype.notn=function(e){return this.clone().inotn(e)},o.prototype.setn=function(e,t){n("number"===typeof e&&e>=0);var r=e/26|0,i=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<i:this.words[r]&~(1<<i),this.strip()},o.prototype.iadd=function(e){var t,r,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,n=e):(r=e,n=this);for(var i=0,o=0;o<n.length;o++)t=(0|r.words[o])+(0|n.words[o])+i,this.words[o]=67108863&t,i=t>>>26;for(;0!==i&&o<r.length;o++)t=(0|r.words[o])+i,this.words[o]=67108863&t,i=t>>>26;if(this.length=r.length,0!==i)this.words[this.length]=i,this.length++;else if(r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this},o.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},o.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,n,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(r=this,n=e):(r=e,n=this);for(var o=0,s=0;s<n.length;s++)o=(t=(0|r.words[s])-(0|n.words[s])+o)>>26,this.words[s]=67108863&t;for(;0!==o&&s<r.length;s++)o=(t=(0|r.words[s])+o)>>26,this.words[s]=67108863&t;if(0===o&&s<r.length&&r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this.length=Math.max(this.length,s),r!==this&&(this.negative=1),this.strip()},o.prototype.sub=function(e){return this.clone().isub(e)};var p=function(e,t,r){var n,i,o,s=e.words,a=t.words,u=r.words,c=0,l=0|s[0],h=8191&l,f=l>>>13,d=0|s[1],p=8191&d,g=d>>>13,y=0|s[2],v=8191&y,m=y>>>13,b=0|s[3],E=8191&b,_=b>>>13,w=0|s[4],S=8191&w,I=w>>>13,R=0|s[5],O=8191&R,M=R>>>13,T=0|s[6],P=8191&T,N=T>>>13,x=0|s[7],A=8191&x,C=x>>>13,k=0|s[8],D=8191&k,U=k>>>13,L=0|s[9],j=8191&L,B=L>>>13,q=0|a[0],V=8191&q,z=q>>>13,$=0|a[1],K=8191&$,W=$>>>13,H=0|a[2],F=8191&H,J=H>>>13,G=0|a[3],Y=8191&G,Z=G>>>13,X=0|a[4],Q=8191&X,ee=X>>>13,te=0|a[5],re=8191&te,ne=te>>>13,ie=0|a[6],oe=8191&ie,se=ie>>>13,ae=0|a[7],ue=8191&ae,ce=ae>>>13,le=0|a[8],he=8191&le,fe=le>>>13,de=0|a[9],pe=8191&de,ge=de>>>13;r.negative=e.negative^t.negative,r.length=19;var ye=(c+(n=Math.imul(h,V))|0)+((8191&(i=(i=Math.imul(h,z))+Math.imul(f,V)|0))<<13)|0;c=((o=Math.imul(f,z))+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(p,V),i=(i=Math.imul(p,z))+Math.imul(g,V)|0,o=Math.imul(g,z);var ve=(c+(n=n+Math.imul(h,K)|0)|0)+((8191&(i=(i=i+Math.imul(h,W)|0)+Math.imul(f,K)|0))<<13)|0;c=((o=o+Math.imul(f,W)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(v,V),i=(i=Math.imul(v,z))+Math.imul(m,V)|0,o=Math.imul(m,z),n=n+Math.imul(p,K)|0,i=(i=i+Math.imul(p,W)|0)+Math.imul(g,K)|0,o=o+Math.imul(g,W)|0;var me=(c+(n=n+Math.imul(h,F)|0)|0)+((8191&(i=(i=i+Math.imul(h,J)|0)+Math.imul(f,F)|0))<<13)|0;c=((o=o+Math.imul(f,J)|0)+(i>>>13)|0)+(me>>>26)|0,me&=67108863,n=Math.imul(E,V),i=(i=Math.imul(E,z))+Math.imul(_,V)|0,o=Math.imul(_,z),n=n+Math.imul(v,K)|0,i=(i=i+Math.imul(v,W)|0)+Math.imul(m,K)|0,o=o+Math.imul(m,W)|0,n=n+Math.imul(p,F)|0,i=(i=i+Math.imul(p,J)|0)+Math.imul(g,F)|0,o=o+Math.imul(g,J)|0;var be=(c+(n=n+Math.imul(h,Y)|0)|0)+((8191&(i=(i=i+Math.imul(h,Z)|0)+Math.imul(f,Y)|0))<<13)|0;c=((o=o+Math.imul(f,Z)|0)+(i>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(S,V),i=(i=Math.imul(S,z))+Math.imul(I,V)|0,o=Math.imul(I,z),n=n+Math.imul(E,K)|0,i=(i=i+Math.imul(E,W)|0)+Math.imul(_,K)|0,o=o+Math.imul(_,W)|0,n=n+Math.imul(v,F)|0,i=(i=i+Math.imul(v,J)|0)+Math.imul(m,F)|0,o=o+Math.imul(m,J)|0,n=n+Math.imul(p,Y)|0,i=(i=i+Math.imul(p,Z)|0)+Math.imul(g,Y)|0,o=o+Math.imul(g,Z)|0;var Ee=(c+(n=n+Math.imul(h,Q)|0)|0)+((8191&(i=(i=i+Math.imul(h,ee)|0)+Math.imul(f,Q)|0))<<13)|0;c=((o=o+Math.imul(f,ee)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(O,V),i=(i=Math.imul(O,z))+Math.imul(M,V)|0,o=Math.imul(M,z),n=n+Math.imul(S,K)|0,i=(i=i+Math.imul(S,W)|0)+Math.imul(I,K)|0,o=o+Math.imul(I,W)|0,n=n+Math.imul(E,F)|0,i=(i=i+Math.imul(E,J)|0)+Math.imul(_,F)|0,o=o+Math.imul(_,J)|0,n=n+Math.imul(v,Y)|0,i=(i=i+Math.imul(v,Z)|0)+Math.imul(m,Y)|0,o=o+Math.imul(m,Z)|0,n=n+Math.imul(p,Q)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(g,Q)|0,o=o+Math.imul(g,ee)|0;var _e=(c+(n=n+Math.imul(h,re)|0)|0)+((8191&(i=(i=i+Math.imul(h,ne)|0)+Math.imul(f,re)|0))<<13)|0;c=((o=o+Math.imul(f,ne)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(P,V),i=(i=Math.imul(P,z))+Math.imul(N,V)|0,o=Math.imul(N,z),n=n+Math.imul(O,K)|0,i=(i=i+Math.imul(O,W)|0)+Math.imul(M,K)|0,o=o+Math.imul(M,W)|0,n=n+Math.imul(S,F)|0,i=(i=i+Math.imul(S,J)|0)+Math.imul(I,F)|0,o=o+Math.imul(I,J)|0,n=n+Math.imul(E,Y)|0,i=(i=i+Math.imul(E,Z)|0)+Math.imul(_,Y)|0,o=o+Math.imul(_,Z)|0,n=n+Math.imul(v,Q)|0,i=(i=i+Math.imul(v,ee)|0)+Math.imul(m,Q)|0,o=o+Math.imul(m,ee)|0,n=n+Math.imul(p,re)|0,i=(i=i+Math.imul(p,ne)|0)+Math.imul(g,re)|0,o=o+Math.imul(g,ne)|0;var we=(c+(n=n+Math.imul(h,oe)|0)|0)+((8191&(i=(i=i+Math.imul(h,se)|0)+Math.imul(f,oe)|0))<<13)|0;c=((o=o+Math.imul(f,se)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(A,V),i=(i=Math.imul(A,z))+Math.imul(C,V)|0,o=Math.imul(C,z),n=n+Math.imul(P,K)|0,i=(i=i+Math.imul(P,W)|0)+Math.imul(N,K)|0,o=o+Math.imul(N,W)|0,n=n+Math.imul(O,F)|0,i=(i=i+Math.imul(O,J)|0)+Math.imul(M,F)|0,o=o+Math.imul(M,J)|0,n=n+Math.imul(S,Y)|0,i=(i=i+Math.imul(S,Z)|0)+Math.imul(I,Y)|0,o=o+Math.imul(I,Z)|0,n=n+Math.imul(E,Q)|0,i=(i=i+Math.imul(E,ee)|0)+Math.imul(_,Q)|0,o=o+Math.imul(_,ee)|0,n=n+Math.imul(v,re)|0,i=(i=i+Math.imul(v,ne)|0)+Math.imul(m,re)|0,o=o+Math.imul(m,ne)|0,n=n+Math.imul(p,oe)|0,i=(i=i+Math.imul(p,se)|0)+Math.imul(g,oe)|0,o=o+Math.imul(g,se)|0;var Se=(c+(n=n+Math.imul(h,ue)|0)|0)+((8191&(i=(i=i+Math.imul(h,ce)|0)+Math.imul(f,ue)|0))<<13)|0;c=((o=o+Math.imul(f,ce)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(D,V),i=(i=Math.imul(D,z))+Math.imul(U,V)|0,o=Math.imul(U,z),n=n+Math.imul(A,K)|0,i=(i=i+Math.imul(A,W)|0)+Math.imul(C,K)|0,o=o+Math.imul(C,W)|0,n=n+Math.imul(P,F)|0,i=(i=i+Math.imul(P,J)|0)+Math.imul(N,F)|0,o=o+Math.imul(N,J)|0,n=n+Math.imul(O,Y)|0,i=(i=i+Math.imul(O,Z)|0)+Math.imul(M,Y)|0,o=o+Math.imul(M,Z)|0,n=n+Math.imul(S,Q)|0,i=(i=i+Math.imul(S,ee)|0)+Math.imul(I,Q)|0,o=o+Math.imul(I,ee)|0,n=n+Math.imul(E,re)|0,i=(i=i+Math.imul(E,ne)|0)+Math.imul(_,re)|0,o=o+Math.imul(_,ne)|0,n=n+Math.imul(v,oe)|0,i=(i=i+Math.imul(v,se)|0)+Math.imul(m,oe)|0,o=o+Math.imul(m,se)|0,n=n+Math.imul(p,ue)|0,i=(i=i+Math.imul(p,ce)|0)+Math.imul(g,ue)|0,o=o+Math.imul(g,ce)|0;var Ie=(c+(n=n+Math.imul(h,he)|0)|0)+((8191&(i=(i=i+Math.imul(h,fe)|0)+Math.imul(f,he)|0))<<13)|0;c=((o=o+Math.imul(f,fe)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(j,V),i=(i=Math.imul(j,z))+Math.imul(B,V)|0,o=Math.imul(B,z),n=n+Math.imul(D,K)|0,i=(i=i+Math.imul(D,W)|0)+Math.imul(U,K)|0,o=o+Math.imul(U,W)|0,n=n+Math.imul(A,F)|0,i=(i=i+Math.imul(A,J)|0)+Math.imul(C,F)|0,o=o+Math.imul(C,J)|0,n=n+Math.imul(P,Y)|0,i=(i=i+Math.imul(P,Z)|0)+Math.imul(N,Y)|0,o=o+Math.imul(N,Z)|0,n=n+Math.imul(O,Q)|0,i=(i=i+Math.imul(O,ee)|0)+Math.imul(M,Q)|0,o=o+Math.imul(M,ee)|0,n=n+Math.imul(S,re)|0,i=(i=i+Math.imul(S,ne)|0)+Math.imul(I,re)|0,o=o+Math.imul(I,ne)|0,n=n+Math.imul(E,oe)|0,i=(i=i+Math.imul(E,se)|0)+Math.imul(_,oe)|0,o=o+Math.imul(_,se)|0,n=n+Math.imul(v,ue)|0,i=(i=i+Math.imul(v,ce)|0)+Math.imul(m,ue)|0,o=o+Math.imul(m,ce)|0,n=n+Math.imul(p,he)|0,i=(i=i+Math.imul(p,fe)|0)+Math.imul(g,he)|0,o=o+Math.imul(g,fe)|0;var Re=(c+(n=n+Math.imul(h,pe)|0)|0)+((8191&(i=(i=i+Math.imul(h,ge)|0)+Math.imul(f,pe)|0))<<13)|0;c=((o=o+Math.imul(f,ge)|0)+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863,n=Math.imul(j,K),i=(i=Math.imul(j,W))+Math.imul(B,K)|0,o=Math.imul(B,W),n=n+Math.imul(D,F)|0,i=(i=i+Math.imul(D,J)|0)+Math.imul(U,F)|0,o=o+Math.imul(U,J)|0,n=n+Math.imul(A,Y)|0,i=(i=i+Math.imul(A,Z)|0)+Math.imul(C,Y)|0,o=o+Math.imul(C,Z)|0,n=n+Math.imul(P,Q)|0,i=(i=i+Math.imul(P,ee)|0)+Math.imul(N,Q)|0,o=o+Math.imul(N,ee)|0,n=n+Math.imul(O,re)|0,i=(i=i+Math.imul(O,ne)|0)+Math.imul(M,re)|0,o=o+Math.imul(M,ne)|0,n=n+Math.imul(S,oe)|0,i=(i=i+Math.imul(S,se)|0)+Math.imul(I,oe)|0,o=o+Math.imul(I,se)|0,n=n+Math.imul(E,ue)|0,i=(i=i+Math.imul(E,ce)|0)+Math.imul(_,ue)|0,o=o+Math.imul(_,ce)|0,n=n+Math.imul(v,he)|0,i=(i=i+Math.imul(v,fe)|0)+Math.imul(m,he)|0,o=o+Math.imul(m,fe)|0;var Oe=(c+(n=n+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,ge)|0)+Math.imul(g,pe)|0))<<13)|0;c=((o=o+Math.imul(g,ge)|0)+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,n=Math.imul(j,F),i=(i=Math.imul(j,J))+Math.imul(B,F)|0,o=Math.imul(B,J),n=n+Math.imul(D,Y)|0,i=(i=i+Math.imul(D,Z)|0)+Math.imul(U,Y)|0,o=o+Math.imul(U,Z)|0,n=n+Math.imul(A,Q)|0,i=(i=i+Math.imul(A,ee)|0)+Math.imul(C,Q)|0,o=o+Math.imul(C,ee)|0,n=n+Math.imul(P,re)|0,i=(i=i+Math.imul(P,ne)|0)+Math.imul(N,re)|0,o=o+Math.imul(N,ne)|0,n=n+Math.imul(O,oe)|0,i=(i=i+Math.imul(O,se)|0)+Math.imul(M,oe)|0,o=o+Math.imul(M,se)|0,n=n+Math.imul(S,ue)|0,i=(i=i+Math.imul(S,ce)|0)+Math.imul(I,ue)|0,o=o+Math.imul(I,ce)|0,n=n+Math.imul(E,he)|0,i=(i=i+Math.imul(E,fe)|0)+Math.imul(_,he)|0,o=o+Math.imul(_,fe)|0;var Me=(c+(n=n+Math.imul(v,pe)|0)|0)+((8191&(i=(i=i+Math.imul(v,ge)|0)+Math.imul(m,pe)|0))<<13)|0;c=((o=o+Math.imul(m,ge)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(j,Y),i=(i=Math.imul(j,Z))+Math.imul(B,Y)|0,o=Math.imul(B,Z),n=n+Math.imul(D,Q)|0,i=(i=i+Math.imul(D,ee)|0)+Math.imul(U,Q)|0,o=o+Math.imul(U,ee)|0,n=n+Math.imul(A,re)|0,i=(i=i+Math.imul(A,ne)|0)+Math.imul(C,re)|0,o=o+Math.imul(C,ne)|0,n=n+Math.imul(P,oe)|0,i=(i=i+Math.imul(P,se)|0)+Math.imul(N,oe)|0,o=o+Math.imul(N,se)|0,n=n+Math.imul(O,ue)|0,i=(i=i+Math.imul(O,ce)|0)+Math.imul(M,ue)|0,o=o+Math.imul(M,ce)|0,n=n+Math.imul(S,he)|0,i=(i=i+Math.imul(S,fe)|0)+Math.imul(I,he)|0,o=o+Math.imul(I,fe)|0;var Te=(c+(n=n+Math.imul(E,pe)|0)|0)+((8191&(i=(i=i+Math.imul(E,ge)|0)+Math.imul(_,pe)|0))<<13)|0;c=((o=o+Math.imul(_,ge)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(j,Q),i=(i=Math.imul(j,ee))+Math.imul(B,Q)|0,o=Math.imul(B,ee),n=n+Math.imul(D,re)|0,i=(i=i+Math.imul(D,ne)|0)+Math.imul(U,re)|0,o=o+Math.imul(U,ne)|0,n=n+Math.imul(A,oe)|0,i=(i=i+Math.imul(A,se)|0)+Math.imul(C,oe)|0,o=o+Math.imul(C,se)|0,n=n+Math.imul(P,ue)|0,i=(i=i+Math.imul(P,ce)|0)+Math.imul(N,ue)|0,o=o+Math.imul(N,ce)|0,n=n+Math.imul(O,he)|0,i=(i=i+Math.imul(O,fe)|0)+Math.imul(M,he)|0,o=o+Math.imul(M,fe)|0;var Pe=(c+(n=n+Math.imul(S,pe)|0)|0)+((8191&(i=(i=i+Math.imul(S,ge)|0)+Math.imul(I,pe)|0))<<13)|0;c=((o=o+Math.imul(I,ge)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,n=Math.imul(j,re),i=(i=Math.imul(j,ne))+Math.imul(B,re)|0,o=Math.imul(B,ne),n=n+Math.imul(D,oe)|0,i=(i=i+Math.imul(D,se)|0)+Math.imul(U,oe)|0,o=o+Math.imul(U,se)|0,n=n+Math.imul(A,ue)|0,i=(i=i+Math.imul(A,ce)|0)+Math.imul(C,ue)|0,o=o+Math.imul(C,ce)|0,n=n+Math.imul(P,he)|0,i=(i=i+Math.imul(P,fe)|0)+Math.imul(N,he)|0,o=o+Math.imul(N,fe)|0;var Ne=(c+(n=n+Math.imul(O,pe)|0)|0)+((8191&(i=(i=i+Math.imul(O,ge)|0)+Math.imul(M,pe)|0))<<13)|0;c=((o=o+Math.imul(M,ge)|0)+(i>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,n=Math.imul(j,oe),i=(i=Math.imul(j,se))+Math.imul(B,oe)|0,o=Math.imul(B,se),n=n+Math.imul(D,ue)|0,i=(i=i+Math.imul(D,ce)|0)+Math.imul(U,ue)|0,o=o+Math.imul(U,ce)|0,n=n+Math.imul(A,he)|0,i=(i=i+Math.imul(A,fe)|0)+Math.imul(C,he)|0,o=o+Math.imul(C,fe)|0;var xe=(c+(n=n+Math.imul(P,pe)|0)|0)+((8191&(i=(i=i+Math.imul(P,ge)|0)+Math.imul(N,pe)|0))<<13)|0;c=((o=o+Math.imul(N,ge)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,n=Math.imul(j,ue),i=(i=Math.imul(j,ce))+Math.imul(B,ue)|0,o=Math.imul(B,ce),n=n+Math.imul(D,he)|0,i=(i=i+Math.imul(D,fe)|0)+Math.imul(U,he)|0,o=o+Math.imul(U,fe)|0;var Ae=(c+(n=n+Math.imul(A,pe)|0)|0)+((8191&(i=(i=i+Math.imul(A,ge)|0)+Math.imul(C,pe)|0))<<13)|0;c=((o=o+Math.imul(C,ge)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(j,he),i=(i=Math.imul(j,fe))+Math.imul(B,he)|0,o=Math.imul(B,fe);var Ce=(c+(n=n+Math.imul(D,pe)|0)|0)+((8191&(i=(i=i+Math.imul(D,ge)|0)+Math.imul(U,pe)|0))<<13)|0;c=((o=o+Math.imul(U,ge)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863;var ke=(c+(n=Math.imul(j,pe))|0)+((8191&(i=(i=Math.imul(j,ge))+Math.imul(B,pe)|0))<<13)|0;return c=((o=Math.imul(B,ge))+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,u[0]=ye,u[1]=ve,u[2]=me,u[3]=be,u[4]=Ee,u[5]=_e,u[6]=we,u[7]=Se,u[8]=Ie,u[9]=Re,u[10]=Oe,u[11]=Me,u[12]=Te,u[13]=Pe,u[14]=Ne,u[15]=xe,u[16]=Ae,u[17]=Ce,u[18]=ke,0!==c&&(u[19]=c,r.length++),r};function g(e,t,r){return(new y).mulp(e,t,r)}function y(e,t){this.x=e,this.y=t}Math.imul||(p=d),o.prototype.mulTo=function(e,t){var r,n=this.length+e.length;return r=10===this.length&&10===e.length?p(this,e,t):n<63?d(this,e,t):n<1024?function(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var n=0,i=0,o=0;o<r.length-1;o++){var s=i;i=0;for(var a=67108863&n,u=Math.min(o,t.length-1),c=Math.max(0,o-e.length+1);c<=u;c++){var l=o-c,h=(0|e.words[l])*(0|t.words[c]),f=67108863&h;a=67108863&(f=f+a|0),i+=(s=(s=s+(h/67108864|0)|0)+(f>>>26)|0)>>>26,s&=67108863}r.words[o]=a,n=s,s=i}return 0!==n?r.words[o]=n:r.length--,r.strip()}(this,e,t):g(this,e,t),r},y.prototype.makeRBT=function(e){for(var t=new Array(e),r=o.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,r,e);return t},y.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var n=0,i=0;i<t;i++)n|=(1&e)<<t-i-1,e>>=1;return n},y.prototype.permute=function(e,t,r,n,i,o){for(var s=0;s<o;s++)n[s]=t[e[s]],i[s]=r[e[s]]},y.prototype.transform=function(e,t,r,n,i,o){this.permute(o,e,t,r,n,i);for(var s=1;s<i;s<<=1)for(var a=s<<1,u=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),l=0;l<i;l+=a)for(var h=u,f=c,d=0;d<s;d++){var p=r[l+d],g=n[l+d],y=r[l+d+s],v=n[l+d+s],m=h*y-f*v;v=h*v+f*y,y=m,r[l+d]=p+y,n[l+d]=g+v,r[l+d+s]=p-y,n[l+d+s]=g-v,d!==a&&(m=u*h-c*f,f=u*f+c*h,h=m)}},y.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),n=1&r,i=0;for(r=r/2|0;r;r>>>=1)i++;return 1<<i+1+n},y.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var n=0;n<r/2;n++){var i=e[n];e[n]=e[r-n-1],e[r-n-1]=i,i=t[n],t[n]=-t[r-n-1],t[r-n-1]=-i}},y.prototype.normalize13b=function(e,t){for(var r=0,n=0;n<t/2;n++){var i=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+r;e[n]=67108863&i,r=i<67108864?0:i/67108864|0}return e},y.prototype.convert13b=function(e,t,r,i){for(var o=0,s=0;s<t;s++)o+=0|e[s],r[2*s]=8191&o,o>>>=13,r[2*s+1]=8191&o,o>>>=13;for(s=2*t;s<i;++s)r[s]=0;n(0===o),n(0===(-8192&o))},y.prototype.stub=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=0;return t},y.prototype.mulp=function(e,t,r){var n=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(n),o=this.stub(n),s=new Array(n),a=new Array(n),u=new Array(n),c=new Array(n),l=new Array(n),h=new Array(n),f=r.words;f.length=n,this.convert13b(e.words,e.length,s,n),this.convert13b(t.words,t.length,c,n),this.transform(s,o,a,u,n,i),this.transform(c,o,l,h,n,i);for(var d=0;d<n;d++){var p=a[d]*l[d]-u[d]*h[d];u[d]=a[d]*h[d]+u[d]*l[d],a[d]=p}return this.conjugate(a,u,n),this.transform(a,u,f,o,n,i),this.conjugate(f,o,n),this.normalize13b(f,n),r.negative=e.negative^t.negative,r.length=e.length+t.length,r.strip()},o.prototype.mul=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},o.prototype.mulf=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),g(this,e,t)},o.prototype.imul=function(e){return this.clone().mulTo(e,this)},o.prototype.imuln=function(e){n("number"===typeof e),n(e<67108864);for(var t=0,r=0;r<this.length;r++){var i=(0|this.words[r])*e,o=(67108863&i)+(67108863&t);t>>=26,t+=i/67108864|0,t+=o>>>26,this.words[r]=67108863&o}return 0!==t&&(this.words[r]=t,this.length++),this},o.prototype.muln=function(e){return this.clone().imuln(e)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),r=0;r<t.length;r++){var n=r/26|0,i=r%26;t[r]=(e.words[n]&1<<i)>>>i}return t}(e);if(0===t.length)return new o(1);for(var r=this,n=0;n<t.length&&0===t[n];n++,r=r.sqr());if(++n<t.length)for(var i=r.sqr();n<t.length;n++,i=i.sqr())0!==t[n]&&(r=r.mul(i));return r},o.prototype.iushln=function(e){n("number"===typeof e&&e>=0);var t,r=e%26,i=(e-r)/26,o=67108863>>>26-r<<26-r;if(0!==r){var s=0;for(t=0;t<this.length;t++){var a=this.words[t]&o,u=(0|this.words[t])-a<<r;this.words[t]=u|s,s=a>>>26-r}s&&(this.words[t]=s,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this.strip()},o.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},o.prototype.iushrn=function(e,t,r){var i;n("number"===typeof e&&e>=0),i=t?(t-t%26)/26:0;var o=e%26,s=Math.min((e-o)/26,this.length),a=67108863^67108863>>>o<<o,u=r;if(i-=s,i=Math.max(0,i),u){for(var c=0;c<s;c++)u.words[c]=this.words[c];u.length=s}if(0===s);else if(this.length>s)for(this.length-=s,c=0;c<this.length;c++)this.words[c]=this.words[c+s];else this.words[0]=0,this.length=1;var l=0;for(c=this.length-1;c>=0&&(0!==l||c>=i);c--){var h=0|this.words[c];this.words[c]=l<<26-o|h>>>o,l=h&a}return u&&0!==l&&(u.words[u.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},o.prototype.ishrn=function(e,t,r){return n(0===this.negative),this.iushrn(e,t,r)},o.prototype.shln=function(e){return this.clone().ishln(e)},o.prototype.ushln=function(e){return this.clone().iushln(e)},o.prototype.shrn=function(e){return this.clone().ishrn(e)},o.prototype.ushrn=function(e){return this.clone().iushrn(e)},o.prototype.testn=function(e){n("number"===typeof e&&e>=0);var t=e%26,r=(e-t)/26,i=1<<t;return!(this.length<=r)&&!!(this.words[r]&i)},o.prototype.imaskn=function(e){n("number"===typeof e&&e>=0);var t=e%26,r=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==t&&r++,this.length=Math.min(r,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this.strip()},o.prototype.maskn=function(e){return this.clone().imaskn(e)},o.prototype.iaddn=function(e){return n("number"===typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},o.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},o.prototype.isubn=function(e){if(n("number"===typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},o.prototype.addn=function(e){return this.clone().iaddn(e)},o.prototype.subn=function(e){return this.clone().isubn(e)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(e,t,r){var i,o,s=e.length+r;this._expand(s);var a=0;for(i=0;i<e.length;i++){o=(0|this.words[i+r])+a;var u=(0|e.words[i])*t;a=((o-=67108863&u)>>26)-(u/67108864|0),this.words[i+r]=67108863&o}for(;i<this.length-r;i++)a=(o=(0|this.words[i+r])+a)>>26,this.words[i+r]=67108863&o;if(0===a)return this.strip();for(n(-1===a),a=0,i=0;i<this.length;i++)a=(o=-(0|this.words[i])+a)>>26,this.words[i]=67108863&o;return this.negative=1,this.strip()},o.prototype._wordDiv=function(e,t){var r=(this.length,e.length),n=this.clone(),i=e,s=0|i.words[i.length-1];0!==(r=26-this._countBits(s))&&(i=i.ushln(r),n.iushln(r),s=0|i.words[i.length-1]);var a,u=n.length-i.length;if("mod"!==t){(a=new o(null)).length=u+1,a.words=new Array(a.length);for(var c=0;c<a.length;c++)a.words[c]=0}var l=n.clone()._ishlnsubmul(i,1,u);0===l.negative&&(n=l,a&&(a.words[u]=1));for(var h=u-1;h>=0;h--){var f=67108864*(0|n.words[i.length+h])+(0|n.words[i.length+h-1]);for(f=Math.min(f/s|0,67108863),n._ishlnsubmul(i,f,h);0!==n.negative;)f--,n.negative=0,n._ishlnsubmul(i,1,h),n.isZero()||(n.negative^=1);a&&(a.words[h]=f)}return a&&a.strip(),n.strip(),"div"!==t&&0!==r&&n.iushrn(r),{div:a||null,mod:n}},o.prototype.divmod=function(e,t,r){return n(!e.isZero()),this.isZero()?{div:new o(0),mod:new o(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(i=a.div.neg()),"div"!==t&&(s=a.mod.neg(),r&&0!==s.negative&&s.iadd(e)),{div:i,mod:s}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(i=a.div.neg()),{div:i,mod:a.mod}):0!==(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(s=a.mod.neg(),r&&0!==s.negative&&s.isub(e)),{div:a.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new o(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new o(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new o(this.modn(e.words[0]))}:this._wordDiv(e,t);var i,s,a},o.prototype.div=function(e){return this.divmod(e,"div",!1).div},o.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},o.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},o.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),i=e.andln(1),o=r.cmp(n);return o<0||1===i&&0===o?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},o.prototype.modn=function(e){n(e<=67108863);for(var t=(1<<26)%e,r=0,i=this.length-1;i>=0;i--)r=(t*r+(0|this.words[i]))%e;return r},o.prototype.idivn=function(e){n(e<=67108863);for(var t=0,r=this.length-1;r>=0;r--){var i=(0|this.words[r])+67108864*t;this.words[r]=i/e|0,t=i%e}return this.strip()},o.prototype.divn=function(e){return this.clone().idivn(e)},o.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new o(1),s=new o(0),a=new o(0),u=new o(1),c=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++c;for(var l=r.clone(),h=t.clone();!t.isZero();){for(var f=0,d=1;0===(t.words[0]&d)&&f<26;++f,d<<=1);if(f>0)for(t.iushrn(f);f-- >0;)(i.isOdd()||s.isOdd())&&(i.iadd(l),s.isub(h)),i.iushrn(1),s.iushrn(1);for(var p=0,g=1;0===(r.words[0]&g)&&p<26;++p,g<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(a.isOdd()||u.isOdd())&&(a.iadd(l),u.isub(h)),a.iushrn(1),u.iushrn(1);t.cmp(r)>=0?(t.isub(r),i.isub(a),s.isub(u)):(r.isub(t),a.isub(i),u.isub(s))}return{a:a,b:u,gcd:r.iushln(c)}},o.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i,s=new o(1),a=new o(0),u=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var c=0,l=1;0===(t.words[0]&l)&&c<26;++c,l<<=1);if(c>0)for(t.iushrn(c);c-- >0;)s.isOdd()&&s.iadd(u),s.iushrn(1);for(var h=0,f=1;0===(r.words[0]&f)&&h<26;++h,f<<=1);if(h>0)for(r.iushrn(h);h-- >0;)a.isOdd()&&a.iadd(u),a.iushrn(1);t.cmp(r)>=0?(t.isub(r),s.isub(a)):(r.isub(t),a.isub(s))}return(i=0===t.cmpn(1)?s:a).cmpn(0)<0&&i.iadd(e),i},o.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var n=0;t.isEven()&&r.isEven();n++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var i=t.cmp(r);if(i<0){var o=t;t=r,r=o}else if(0===i||0===r.cmpn(1))break;t.isub(r)}return r.iushln(n)},o.prototype.invm=function(e){return this.egcd(e).a.umod(e)},o.prototype.isEven=function(){return 0===(1&this.words[0])},o.prototype.isOdd=function(){return 1===(1&this.words[0])},o.prototype.andln=function(e){return this.words[0]&e},o.prototype.bincn=function(e){n("number"===typeof e);var t=e%26,r=(e-t)/26,i=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var o=i,s=r;0!==o&&s<this.length;s++){var a=0|this.words[s];o=(a+=o)>>>26,a&=67108863,this.words[s]=a}return 0!==o&&(this.words[s]=o,this.length++),this},o.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},o.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this.strip(),this.length>1)t=1;else{r&&(e=-e),n(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},o.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},o.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],i=0|e.words[r];if(n!==i){n<i?t=-1:n>i&&(t=1);break}}return t},o.prototype.gtn=function(e){return 1===this.cmpn(e)},o.prototype.gt=function(e){return 1===this.cmp(e)},o.prototype.gten=function(e){return this.cmpn(e)>=0},o.prototype.gte=function(e){return this.cmp(e)>=0},o.prototype.ltn=function(e){return-1===this.cmpn(e)},o.prototype.lt=function(e){return-1===this.cmp(e)},o.prototype.lten=function(e){return this.cmpn(e)<=0},o.prototype.lte=function(e){return this.cmp(e)<=0},o.prototype.eqn=function(e){return 0===this.cmpn(e)},o.prototype.eq=function(e){return 0===this.cmp(e)},o.red=function(e){return new S(e)},o.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},o.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(e){return this.red=e,this},o.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},o.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},o.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},o.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},o.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},o.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},o.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},o.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},o.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var v={k256:null,p224:null,p192:null,p25519:null};function m(e,t){this.name=e,this.p=new o(t,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function b(){m.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function E(){m.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function _(){m.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function w(){m.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(e){if("string"===typeof e){var t=o._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function I(e){S.call(this,e),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}m.prototype._tmp=function(){var e=new o(null);return e.words=new Array(Math.ceil(this.n/13)),e},m.prototype.ireduce=function(e){var t,r=e;do{this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},m.prototype.split=function(e,t){e.iushrn(this.n,0,t)},m.prototype.imulK=function(e){return e.imul(this.k)},i(b,m),b.prototype.split=function(e,t){for(var r=4194303,n=Math.min(e.length,9),i=0;i<n;i++)t.words[i]=e.words[i];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=o&r,i=10;i<e.length;i++){var s=0|e.words[i];e.words[i-10]=(s&r)<<4|o>>>22,o=s}o>>>=22,e.words[i-10]=o,0===o&&e.length>10?e.length-=10:e.length-=9},b.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var n=0|e.words[r];t+=977*n,e.words[r]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(E,m),i(_,m),i(w,m),w.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var n=19*(0|e.words[r])+t,i=67108863&n;n>>>=26,e.words[r]=i,t=n}return 0!==t&&(e.words[e.length++]=t),e},o._prime=function(e){if(v[e])return v[e];var t;if("k256"===e)t=new b;else if("p224"===e)t=new E;else if("p192"===e)t=new _;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new w}return v[e]=t,t},S.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},S.prototype._verify2=function(e,t){n(0===(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},S.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},S.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},S.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},S.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},S.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},S.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return r.cmpn(0)<0&&r.iadd(this.m),r},S.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},S.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},S.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},S.prototype.isqr=function(e){return this.imul(e,e.clone())},S.prototype.sqr=function(e){return this.mul(e,e)},S.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2===1),3===t){var r=this.m.add(new o(1)).iushrn(2);return this.pow(e,r)}for(var i=this.m.subn(1),s=0;!i.isZero()&&0===i.andln(1);)s++,i.iushrn(1);n(!i.isZero());var a=new o(1).toRed(this),u=a.redNeg(),c=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new o(2*l*l).toRed(this);0!==this.pow(l,c).cmp(u);)l.redIAdd(u);for(var h=this.pow(l,i),f=this.pow(e,i.addn(1).iushrn(1)),d=this.pow(e,i),p=s;0!==d.cmp(a);){for(var g=d,y=0;0!==g.cmp(a);y++)g=g.redSqr();n(y<p);var v=this.pow(h,new o(1).iushln(p-y-1));f=f.redMul(v),h=v.redSqr(),d=d.redMul(h),p=y}return f},S.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},S.prototype.pow=function(e,t){if(t.isZero())return new o(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=new Array(16);r[0]=new o(1).toRed(this),r[1]=e;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],e);var i=r[0],s=0,a=0,u=t.bitLength()%26;for(0===u&&(u=26),n=t.length-1;n>=0;n--){for(var c=t.words[n],l=u-1;l>=0;l--){var h=c>>l&1;i!==r[0]&&(i=this.sqr(i)),0!==h||0!==s?(s<<=1,s|=h,(4===++a||0===n&&0===l)&&(i=this.mul(i,r[s]),a=0,s=0)):a=0}u=26}return i},S.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},S.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},o.mont=function(e){return new I(e)},i(I,S),I.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},I.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},I.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},I.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new o(0)._forceRed(this);var r=e.mul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},I.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e=r.nmd(e),this)},32094:(e,t,r)=>{"use strict";var n=r(83243),i=r(62191),o=r(62680),s=r(50326),a=o("Object.prototype.toString"),u=r(67226)(),c="undefined"===typeof globalThis?r.g:globalThis,l=i(),h=o("String.prototype.slice"),f={},d=Object.getPrototypeOf;u&&s&&d&&n(l,(function(e){if("function"===typeof c[e]){var t=new c[e];if(Symbol.toStringTag in t){var r=d(t),n=s(r,Symbol.toStringTag);if(!n){var i=d(r);n=s(i,Symbol.toStringTag)}f[e]=n.get}}}));var p=r(50198);e.exports=function(e){return!!p(e)&&(u&&Symbol.toStringTag in e?function(e){var t=!1;return n(f,(function(r,n){if(!t)try{var i=r.call(e);i===n&&(t=i)}catch(o){}})),t}(e):h(a(e),8,-1))}},21384:(e,t,r)=>{var n=r(48834).Buffer,i=r(44075);function o(e,t){if(void 0!==t&&e[0]!==t)throw new Error("Invalid network version");if(33===e.length)return{version:e[0],privateKey:e.slice(1,33),compressed:!1};if(34!==e.length)throw new Error("Invalid WIF length");if(1!==e[33])throw new Error("Invalid compression flag");return{version:e[0],privateKey:e.slice(1,33),compressed:!0}}function s(e,t,r){var i=new n(r?34:33);return i.writeUInt8(e,0),t.copy(i,1),r&&(i[33]=1),i}e.exports={decode:function(e,t){return o(i.decode(e),t)},decodeRaw:o,encode:function(e,t,r){return"number"===typeof e?i.encode(s(e,t,r)):i.encode(s(e.version,e.privateKey,e.compressed))},encodeRaw:s}},18071:(e,t,r)=>{"use strict";const n=r(84545);n.createWebSocketStream=r(58254),n.Server=r(37133),n.Receiver=r(35126),n.Sender=r(2282),n.WebSocket=n,n.WebSocketServer=n.Server,e.exports=n},10795:(e,t,r)=>{"use strict";var n=r(48834).Buffer;const{EMPTY_BUFFER:i}=r(46197),o=n[Symbol.species];function s(e,t,r,n,i){for(let o=0;o<i;o++)r[n+o]=e[o]^t[3&o]}function a(e,t){for(let r=0;r<e.length;r++)e[r]^=t[3&r]}if(e.exports={concat:function(e,t){if(0===e.length)return i;if(1===e.length)return e[0];const r=n.allocUnsafe(t);let s=0;for(let n=0;n<e.length;n++){const t=e[n];r.set(t,s),s+=t.length}return s<t?new o(r.buffer,r.byteOffset,s):r},mask:s,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:function e(t){if(e.readOnly=!0,n.isBuffer(t))return t;let r;return t instanceof ArrayBuffer?r=new o(t):ArrayBuffer.isView(t)?r=new o(t.buffer,t.byteOffset,t.byteLength):(r=n.from(t),e.readOnly=!1),r},unmask:a},!{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"web-embed",slug:"web-embed",version:"0.0.1",web:{},description:"Multi-chain support for BTC/ETH/BNB/NEAR/Polygon/Solana/Avalanche/Fantom and others",sdkVersion:"49.0.0",platforms:["ios","android","web"]},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.WS_NO_BUFFER_UTIL)try{const t=r(14015);e.exports.mask=function(e,r,n,i,o){o<48?s(e,r,n,i,o):t.mask(e,r,n,i,o)},e.exports.unmask=function(e,r){e.length<32?a(e,r):t.unmask(e,r)}}catch(u){}},46197:(e,t,r)=>{"use strict";var n=r(48834).Buffer;e.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:n.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},17365:(e,t,r)=>{"use strict";const{kForOnEventAttribute:n,kListener:i}=r(46197),o=Symbol("kCode"),s=Symbol("kData"),a=Symbol("kError"),u=Symbol("kMessage"),c=Symbol("kReason"),l=Symbol("kTarget"),h=Symbol("kType"),f=Symbol("kWasClean");class d{constructor(e){this[l]=null,this[h]=e}get target(){return this[l]}get type(){return this[h]}}Object.defineProperty(d.prototype,"target",{enumerable:!0}),Object.defineProperty(d.prototype,"type",{enumerable:!0});class p extends d{constructor(e,t={}){super(e),this[o]=void 0===t.code?0:t.code,this[c]=void 0===t.reason?"":t.reason,this[f]=void 0!==t.wasClean&&t.wasClean}get code(){return this[o]}get reason(){return this[c]}get wasClean(){return this[f]}}Object.defineProperty(p.prototype,"code",{enumerable:!0}),Object.defineProperty(p.prototype,"reason",{enumerable:!0}),Object.defineProperty(p.prototype,"wasClean",{enumerable:!0});class g extends d{constructor(e,t={}){super(e),this[a]=void 0===t.error?null:t.error,this[u]=void 0===t.message?"":t.message}get error(){return this[a]}get message(){return this[u]}}Object.defineProperty(g.prototype,"error",{enumerable:!0}),Object.defineProperty(g.prototype,"message",{enumerable:!0});class y extends d{constructor(e,t={}){super(e),this[s]=void 0===t.data?null:t.data}get data(){return this[s]}}Object.defineProperty(y.prototype,"data",{enumerable:!0});const v={addEventListener(e,t,r={}){for(const s of this.listeners(e))if(!r[n]&&s[i]===t&&!s[n])return;let o;if("message"===e)o=function(e,r){const n=new y("message",{data:r?e:e.toString()});n[l]=this,m(t,this,n)};else if("close"===e)o=function(e,r){const n=new p("close",{code:e,reason:r.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});n[l]=this,m(t,this,n)};else if("error"===e)o=function(e){const r=new g("error",{error:e,message:e.message});r[l]=this,m(t,this,r)};else{if("open"!==e)return;o=function(){const e=new d("open");e[l]=this,m(t,this,e)}}o[n]=!!r[n],o[i]=t,r.once?this.once(e,o):this.on(e,o)},removeEventListener(e,t){for(const r of this.listeners(e))if(r[i]===t&&!r[n]){this.removeListener(e,r);break}}};function m(e,t,r){"object"===typeof e&&e.handleEvent?e.handleEvent.call(e,r):e.call(t,r)}e.exports={CloseEvent:p,ErrorEvent:g,Event:d,EventTarget:v,MessageEvent:y}},32769:(e,t,r)=>{"use strict";const{tokenChars:n}=r(63767);function i(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}e.exports={format:function(e){return Object.keys(e).map((t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map((e=>[t].concat(Object.keys(e).map((t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map((e=>!0===e?t:`${t}=${e}`)).join("; ")}))).join("; "))).join(", ")})).join(", ")},parse:function(e){const t=Object.create(null);let r,o,s=Object.create(null),a=!1,u=!1,c=!1,l=-1,h=-1,f=-1,d=0;for(;d<e.length;d++)if(h=e.charCodeAt(d),void 0===r)if(-1===f&&1===n[h])-1===l&&(l=d);else if(0===d||32!==h&&9!==h){if(59!==h&&44!==h)throw new SyntaxError(`Unexpected character at index ${d}`);{if(-1===l)throw new SyntaxError(`Unexpected character at index ${d}`);-1===f&&(f=d);const n=e.slice(l,f);44===h?(i(t,n,s),s=Object.create(null)):r=n,l=f=-1}}else-1===f&&-1!==l&&(f=d);else if(void 0===o)if(-1===f&&1===n[h])-1===l&&(l=d);else if(32===h||9===h)-1===f&&-1!==l&&(f=d);else if(59===h||44===h){if(-1===l)throw new SyntaxError(`Unexpected character at index ${d}`);-1===f&&(f=d),i(s,e.slice(l,f),!0),44===h&&(i(t,r,s),s=Object.create(null),r=void 0),l=f=-1}else{if(61!==h||-1===l||-1!==f)throw new SyntaxError(`Unexpected character at index ${d}`);o=e.slice(l,d),l=f=-1}else if(u){if(1!==n[h])throw new SyntaxError(`Unexpected character at index ${d}`);-1===l?l=d:a||(a=!0),u=!1}else if(c)if(1===n[h])-1===l&&(l=d);else if(34===h&&-1!==l)c=!1,f=d;else{if(92!==h)throw new SyntaxError(`Unexpected character at index ${d}`);u=!0}else if(34===h&&61===e.charCodeAt(d-1))c=!0;else if(-1===f&&1===n[h])-1===l&&(l=d);else if(-1===l||32!==h&&9!==h){if(59!==h&&44!==h)throw new SyntaxError(`Unexpected character at index ${d}`);{if(-1===l)throw new SyntaxError(`Unexpected character at index ${d}`);-1===f&&(f=d);let n=e.slice(l,f);a&&(n=n.replace(/\\/g,""),a=!1),i(s,o,n),44===h&&(i(t,r,s),s=Object.create(null),r=void 0),o=void 0,l=f=-1}}else-1===f&&(f=d);if(-1===l||c||32===h||9===h)throw new SyntaxError("Unexpected end of input");-1===f&&(f=d);const p=e.slice(l,f);return void 0===r?i(t,p,s):(void 0===o?i(s,p,!0):i(s,o,a?p.replace(/\\/g,""):p),i(t,r,s)),t}}},45802:e=>{"use strict";const t=Symbol("kDone"),r=Symbol("kRun");e.exports=class{constructor(e){this[t]=()=>{this.pending--,this[r]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[r]()}[r](){if(this.pending!==this.concurrency&&this.jobs.length){const e=this.jobs.shift();this.pending++,e(this[t])}}}},26984:(e,t,r)=>{"use strict";var n=r(48834).Buffer;const i=r(79344),o=r(10795),s=r(45802),{kStatusCode:a}=r(46197),u=n[Symbol.species],c=n.from([0,0,255,255]),l=Symbol("permessage-deflate"),h=Symbol("total-length"),f=Symbol("callback"),d=Symbol("buffers"),p=Symbol("error");let g;function y(e){this[d].push(e),this[h]+=e.length}function v(e){this[h]+=e.length,this[l]._maxPayload<1||this[h]<=this[l]._maxPayload?this[d].push(e):(this[p]=new RangeError("Max payload size exceeded"),this[p].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[p][a]=1009,this.removeListener("data",v),this.reset())}function m(e){this[l]._inflate=null,e[a]=1007,this[f](e)}e.exports=class{constructor(e,t,r){if(this._maxPayload=0|r,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!g){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;g=new s(e)}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const e=this._deflate[f];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){const t=this._options,r=e.find((e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"===typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"===typeof t.clientMaxWindowBits&&!e.client_max_window_bits)));if(!r)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(r.server_no_context_takeover=!0),t.clientNoContextTakeover&&(r.client_no_context_takeover=!0),"number"===typeof t.serverMaxWindowBits&&(r.server_max_window_bits=t.serverMaxWindowBits),"number"===typeof t.clientMaxWindowBits?r.client_max_window_bits=t.clientMaxWindowBits:!0!==r.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete r.client_max_window_bits,r}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"===typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"===typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach((e=>{Object.keys(e).forEach((t=>{let r=e[t];if(r.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(r=r[0],"client_max_window_bits"===t){if(!0!==r){const e=+r;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${r}`)}else if("server_max_window_bits"===t){const e=+r;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==r)throw new TypeError(`Invalid value for parameter "${t}": ${r}`)}e[t]=r}))})),e}decompress(e,t,r){g.add((n=>{this._decompress(e,t,((e,t)=>{n(),r(e,t)}))}))}compress(e,t,r){g.add((n=>{this._compress(e,t,((e,t)=>{n(),r(e,t)}))}))}_decompress(e,t,r){const n=this._isServer?"client":"server";if(!this._inflate){const e=`${n}_max_window_bits`,t="number"!==typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=i.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[l]=this,this._inflate[h]=0,this._inflate[d]=[],this._inflate.on("error",m),this._inflate.on("data",v)}this._inflate[f]=r,this._inflate.write(e),t&&this._inflate.write(c),this._inflate.flush((()=>{const e=this._inflate[p];if(e)return this._inflate.close(),this._inflate=null,void r(e);const i=o.concat(this._inflate[d],this._inflate[h]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[h]=0,this._inflate[d]=[],t&&this.params[`${n}_no_context_takeover`]&&this._inflate.reset()),r(null,i)}))}_compress(e,t,r){const n=this._isServer?"server":"client";if(!this._deflate){const e=`${n}_max_window_bits`,t="number"!==typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=i.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[h]=0,this._deflate[d]=[],this._deflate.on("data",y)}this._deflate[f]=r,this._deflate.write(e),this._deflate.flush(i.Z_SYNC_FLUSH,(()=>{if(!this._deflate)return;let e=o.concat(this._deflate[d],this._deflate[h]);t&&(e=new u(e.buffer,e.byteOffset,e.length-4)),this._deflate[f]=null,this._deflate[h]=0,this._deflate[d]=[],t&&this.params[`${n}_no_context_takeover`]&&this._deflate.reset(),r(null,e)}))}}},35126:(e,t,r)=>{"use strict";var n=r(48834).Buffer;const{Writable:i}=r(54851),o=r(26984),{BINARY_TYPES:s,EMPTY_BUFFER:a,kStatusCode:u,kWebSocket:c}=r(46197),{concat:l,toArrayBuffer:h,unmask:f}=r(10795),{isValidStatusCode:d,isValidUTF8:p}=r(63767),g=n[Symbol.species];function y(e,t,r,n,i){const o=new e(r?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(o,y),o.code=i,o[u]=n,o}e.exports=class extends i{constructor(e={}){super(),this._binaryType=e.binaryType||s[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[c]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=0,this._loop=!1}_write(e,t,r){if(8===this._opcode&&0==this._state)return r();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(r)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=new g(t.buffer,t.byteOffset+e,t.length-e),new g(t.buffer,t.byteOffset,e)}const t=n.allocUnsafe(e);do{const r=this._buffers[0],n=t.length-e;e>=r.length?t.set(this._buffers.shift(),n):(t.set(new Uint8Array(r.buffer,r.byteOffset,e),n),this._buffers[0]=new g(r.buffer,r.byteOffset+e,r.length-e)),e-=r.length}while(e>0);return t}startLoop(e){let t;this._loop=!0;do{switch(this._state){case 0:t=this.getInfo();break;case 1:t=this.getPayloadLength16();break;case 2:t=this.getPayloadLength64();break;case 3:this.getMask();break;case 4:t=this.getData(e);break;default:return void(this._loop=!1)}}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2)return void(this._loop=!1);const e=this.consume(2);if(0!==(48&e[0]))return this._loop=!1,y(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");const t=64===(64&e[0]);if(t&&!this._extensions[o.extensionName])return this._loop=!1,y(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=128===(128&e[0]),this._opcode=15&e[0],this._payloadLength=127&e[1],0===this._opcode){if(t)return this._loop=!1,y(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,y(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return this._loop=!1,y(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=t}else{if(!(this._opcode>7&&this._opcode<11))return this._loop=!1,y(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin)return this._loop=!1,y(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(t)return this._loop=!1,y(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return this._loop=!1,y(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128===(128&e[1]),this._isServer){if(!this._masked)return this._loop=!1,y(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,y(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(126===this._payloadLength)this._state=1;else{if(127!==this._payloadLength)return this.haveLength();this._state=2}}getPayloadLength16(){if(!(this._bufferedBytes<2))return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength();this._loop=!1}getPayloadLength64(){if(this._bufferedBytes<8)return void(this._loop=!1);const e=this.consume(8),t=e.readUInt32BE(0);return t>Math.pow(2,21)-1?(this._loop=!1,y(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,y(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=a;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&0!==(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])&&f(t,this._mask)}return this._opcode>7?this.controlMessage(t):this._compressed?(this._state=5,void this.decompress(t,e)):(t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage())}decompress(e,t){this._extensions[o.extensionName].decompress(e,this._fin,((e,r)=>{if(e)return t(e);if(r.length){if(this._messageLength+=r.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return t(y(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(r)}const n=this.dataMessage();if(n)return t(n);this.startLoop(t)}))}dataMessage(){if(this._fin){const e=this._messageLength,t=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let r;r="nodebuffer"===this._binaryType?l(t,e):"arraybuffer"===this._binaryType?h(l(t,e)):t,this.emit("message",r,!0)}else{const r=l(t,e);if(!this._skipUTF8Validation&&!p(r))return this._loop=!1,y(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",r,!1)}}this._state=0}controlMessage(e){if(8===this._opcode)if(this._loop=!1,0===e.length)this.emit("conclude",1005,a),this.end();else{const t=e.readUInt16BE(0);if(!d(t))return y(RangeError,`invalid status code ${t}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");const r=new g(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!p(r))return y(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",t,r),this.end()}else 9===this._opcode?this.emit("ping",e):this.emit("pong",e);this._state=0}}},2282:(e,t,r)=>{"use strict";var n=r(48834).Buffer;r(49892),r(75776);const{randomFillSync:i}=r(97959),o=r(26984),{EMPTY_BUFFER:s}=r(46197),{isValidStatusCode:a}=r(63767),{mask:u,toBuffer:c}=r(10795),l=Symbol("kByteLength"),h=n.alloc(4);class f{constructor(e,t,r){this._extensions=t||{},r&&(this._generateMask=r,this._maskBuffer=n.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){let r,o,s=!1,a=2,c=!1;t.mask&&(r=t.maskBuffer||h,t.generateMask?t.generateMask(r):i(r,0,4),c=0===(r[0]|r[1]|r[2]|r[3]),a=6),"string"===typeof e?o=t.mask&&!c||void 0===t[l]?(e=n.from(e)).length:t[l]:(o=e.length,s=t.mask&&t.readOnly&&!c);let f=o;o>=65536?(a+=8,f=127):o>125&&(a+=2,f=126);const d=n.allocUnsafe(s?o+a:a);return d[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(d[0]|=64),d[1]=f,126===f?d.writeUInt16BE(o,2):127===f&&(d[2]=d[3]=0,d.writeUIntBE(o,4,6)),t.mask?(d[1]|=128,d[a-4]=r[0],d[a-3]=r[1],d[a-2]=r[2],d[a-1]=r[3],c?[d,e]:s?(u(e,r,d,a,o),[d]):(u(e,r,e,0,o),[d,e])):[d,e]}close(e,t,r,i){let o;if(void 0===e)o=s;else{if("number"!==typeof e||!a(e))throw new TypeError("First argument must be a valid error code number");if(void 0!==t&&t.length){const r=n.byteLength(t);if(r>123)throw new RangeError("The message must not be greater than 123 bytes");o=n.allocUnsafe(2+r),o.writeUInt16BE(e,0),"string"===typeof t?o.write(t,2):o.set(t,2)}else o=n.allocUnsafe(2),o.writeUInt16BE(e,0)}const u={[l]:o.length,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,o,!1,u,i]):this.sendFrame(f.frame(o,u),i)}ping(e,t,r){let i,o;if("string"===typeof e?(i=n.byteLength(e),o=!1):(i=(e=c(e)).length,o=c.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");const s={[l]:i,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:o,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,s,r]):this.sendFrame(f.frame(e,s),r)}pong(e,t,r){let i,o;if("string"===typeof e?(i=n.byteLength(e),o=!1):(i=(e=c(e)).length,o=c.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");const s={[l]:i,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:o,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,s,r]):this.sendFrame(f.frame(e,s),r)}send(e,t,r){const i=this._extensions[o.extensionName];let s,a,u=t.binary?2:1,h=t.compress;if("string"===typeof e?(s=n.byteLength(e),a=!1):(s=(e=c(e)).length,a=c.readOnly),this._firstFragment?(this._firstFragment=!1,h&&i&&i.params[i._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(h=s>=i._threshold),this._compress=h):(h=!1,u=0),t.fin&&(this._firstFragment=!0),i){const n={[l]:s,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:u,readOnly:a,rsv1:h};this._deflating?this.enqueue([this.dispatch,e,this._compress,n,r]):this.dispatch(e,this._compress,n,r)}else this.sendFrame(f.frame(e,{[l]:s,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:u,readOnly:a,rsv1:!1}),r)}dispatch(e,t,r,n){if(!t)return void this.sendFrame(f.frame(e,r),n);const i=this._extensions[o.extensionName];this._bufferedBytes+=r[l],this._deflating=!0,i.compress(e,r.fin,((e,t)=>{if(this._socket.destroyed){const e=new Error("The socket was closed while data was being compressed");"function"===typeof n&&n(e);for(let t=0;t<this._queue.length;t++){const r=this._queue[t],n=r[r.length-1];"function"===typeof n&&n(e)}}else this._bufferedBytes-=r[l],this._deflating=!1,r.readOnly=!1,this.sendFrame(f.frame(t,r),n),this.dequeue()}))}dequeue(){for(;!this._deflating&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[3][l],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][l],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}e.exports=f},58254:(e,t,r)=>{"use strict";const{Duplex:n}=r(54851);function i(e){e.emit("close")}function o(){!this.destroyed&&this._writableState.finished&&this.destroy()}function s(e){this.removeListener("error",s),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}e.exports=function(e,t){let r=!0;const a=new n({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",(function(t,r){const n=!r&&a._readableState.objectMode?t.toString():t;a.push(n)||e.pause()})),e.once("error",(function(e){a.destroyed||(r=!1,a.destroy(e))})),e.once("close",(function(){a.destroyed||a.push(null)})),a._destroy=function(t,n){if(e.readyState===e.CLOSED)return n(t),void process.nextTick(i,a);let o=!1;e.once("error",(function(e){o=!0,n(e)})),e.once("close",(function(){o||n(t),process.nextTick(i,a)})),r&&e.terminate()},a._final=function(t){e.readyState!==e.CONNECTING?null!==e._socket&&(e._socket._writableState.finished?(t(),a._readableState.endEmitted&&a.destroy()):(e._socket.once("finish",(function(){t()})),e.close())):e.once("open",(function(){a._final(t)}))},a._read=function(){e.isPaused&&e.resume()},a._write=function(t,r,n){e.readyState!==e.CONNECTING?e.send(t,n):e.once("open",(function(){a._write(t,r,n)}))},a.on("end",o),a.on("error",s),a}},30873:(e,t,r)=>{"use strict";const{tokenChars:n}=r(63767);e.exports={parse:function(e){const t=new Set;let r=-1,i=-1,o=0;for(;o<e.length;o++){const s=e.charCodeAt(o);if(-1===i&&1===n[s])-1===r&&(r=o);else if(0===o||32!==s&&9!==s){if(44!==s)throw new SyntaxError(`Unexpected character at index ${o}`);{if(-1===r)throw new SyntaxError(`Unexpected character at index ${o}`);-1===i&&(i=o);const n=e.slice(r,i);if(t.has(n))throw new SyntaxError(`The "${n}" subprotocol is duplicated`);t.add(n),r=i=-1}}else-1===i&&-1!==r&&(i=o)}if(-1===r||-1!==i)throw new SyntaxError("Unexpected end of input");const s=e.slice(r,o);if(t.has(s))throw new SyntaxError(`The "${s}" subprotocol is duplicated`);return t.add(s),t}}},63767:(e,t,r)=>{"use strict";const{isUtf8:n}=r(48834);function i(e){const t=e.length;let r=0;for(;r<t;)if(0===(128&e[r]))r++;else if(192===(224&e[r])){if(r+1===t||128!==(192&e[r+1])||192===(254&e[r]))return!1;r+=2}else if(224===(240&e[r])){if(r+2>=t||128!==(192&e[r+1])||128!==(192&e[r+2])||224===e[r]&&128===(224&e[r+1])||237===e[r]&&160===(224&e[r+1]))return!1;r+=3}else{if(240!==(248&e[r]))return!1;if(r+3>=t||128!==(192&e[r+1])||128!==(192&e[r+2])||128!==(192&e[r+3])||240===e[r]&&128===(240&e[r+1])||244===e[r]&&e[r+1]>143||e[r]>244)return!1;r+=4}return!0}if(e.exports={isValidStatusCode:function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:i,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},n)e.exports.isValidUTF8=function(e){return e.length<24?i(e):n(e)};else if(!{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"web-embed",slug:"web-embed",version:"0.0.1",web:{},description:"Multi-chain support for BTC/ETH/BNB/NEAR/Polygon/Solana/Avalanche/Fantom and others",sdkVersion:"49.0.0",platforms:["ios","android","web"]},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.WS_NO_UTF_8_VALIDATE)try{const t=r(41807);e.exports.isValidUTF8=function(e){return e.length<32?i(e):t(e)}}catch(o){}},37133:(e,t,r)=>{"use strict";var n=r(48834).Buffer;const i=r(22699),o=r(56323),{createHash:s}=(r(53008),r(49892),r(75776),r(97959)),a=r(32769),u=r(26984),c=r(30873),l=r(84545),{GUID:h,kWebSocket:f}=r(46197),d=/^[+/0-9A-Za-z]{22}==$/;function p(e){e._state=2,e.emit("close")}function g(){this.destroy()}function y(e,t,r,i){r=r||o.STATUS_CODES[t],i={Connection:"close","Content-Type":"text/html","Content-Length":n.byteLength(r),...i},e.once("finish",e.destroy),e.end(`HTTP/1.1 ${t} ${o.STATUS_CODES[t]}\r\n`+Object.keys(i).map((e=>`${e}: ${i[e]}`)).join("\r\n")+"\r\n\r\n"+r)}function v(e,t,r,n,i){if(e.listenerCount("wsClientError")){const n=new Error(i);Error.captureStackTrace(n,v),e.emit("wsClientError",n,r,t)}else y(r,n,i)}e.exports=class extends i{constructor(e,t){if(super(),null==(e={maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:l,...e}).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(this._server=o.createServer(((e,t)=>{const r=o.STATUS_CODES[426];t.writeHead(426,{"Content-Length":r.length,"Content-Type":"text/plain"}),t.end(r)})),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){const e=this.emit.bind(this,"connection");this._removeListeners=function(e,t){for(const r of Object.keys(t))e.on(r,t[r]);return function(){for(const r of Object.keys(t))e.removeListener(r,t[r])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,r,n)=>{this.handleUpgrade(t,r,n,e)}})}!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=0}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(2===this._state)return e&&this.once("close",(()=>{e(new Error("The server is not running"))})),void process.nextTick(p,this);if(e&&this.once("close",e),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(p,this);else{const e=this._server;this._removeListeners(),this._removeListeners=this._server=null,e.close((()=>{p(this)}))}}shouldHandle(e){if(this.options.path){const t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,r,n){t.on("error",g);const i=e.headers["sec-websocket-key"],o=+e.headers["sec-websocket-version"];if("GET"!==e.method){return void v(this,e,t,405,"Invalid HTTP method")}if("websocket"!==e.headers.upgrade.toLowerCase()){return void v(this,e,t,400,"Invalid Upgrade header")}if(!i||!d.test(i)){return void v(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header")}if(8!==o&&13!==o){return void v(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header")}if(!this.shouldHandle(e))return void y(t,400);const s=e.headers["sec-websocket-protocol"];let l=new Set;if(void 0!==s)try{l=c.parse(s)}catch(p){return void v(this,e,t,400,"Invalid Sec-WebSocket-Protocol header")}const h=e.headers["sec-websocket-extensions"],f={};if(this.options.perMessageDeflate&&void 0!==h){const r=new u(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const e=a.parse(h);e[u.extensionName]&&(r.accept(e[u.extensionName]),f[u.extensionName]=r)}catch(p){return void v(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header")}}if(this.options.verifyClient){const s={origin:e.headers[""+(8===o?"sec-websocket-origin":"origin")],secure:!(!e.socket.authorized&&!e.socket.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(s,((o,s,a,u)=>{if(!o)return y(t,s||401,a,u);this.completeUpgrade(f,i,l,e,t,r,n)}));if(!this.options.verifyClient(s))return y(t,401)}this.completeUpgrade(f,i,l,e,t,r,n)}completeUpgrade(e,t,r,n,i,o,c){if(!i.readable||!i.writable)return i.destroy();if(i[f])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return y(i,503);const l=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${s("sha1").update(t+h).digest("base64")}`],d=new this.options.WebSocket(null);if(r.size){const e=this.options.handleProtocols?this.options.handleProtocols(r,n):r.values().next().value;e&&(l.push(`Sec-WebSocket-Protocol: ${e}`),d._protocol=e)}if(e[u.extensionName]){const t=e[u.extensionName].params,r=a.format({[u.extensionName]:[t]});l.push(`Sec-WebSocket-Extensions: ${r}`),d._extensions=e}this.emit("headers",l,n),i.write(l.concat("\r\n").join("\r\n")),i.removeListener("error",g),d.setSocket(i,o,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(d),d.on("close",(()=>{this.clients.delete(d),this._shouldEmitClose&&!this.clients.size&&process.nextTick(p,this)}))),c(d,n)}}},84545:(e,t,r)=>{"use strict";var n=r(48834).Buffer;const i=r(22699),o=r(53008),s=r(56323),a=r(49892),u=r(75776),{randomBytes:c,createHash:l}=r(97959),{Readable:h}=r(54851),{URL:f}=r(883),d=r(26984),p=r(35126),g=r(2282),{BINARY_TYPES:y,EMPTY_BUFFER:v,GUID:m,kForOnEventAttribute:b,kListener:E,kStatusCode:_,kWebSocket:w,NOOP:S}=r(46197),{EventTarget:{addEventListener:I,removeEventListener:R}}=r(17365),{format:O,parse:M}=r(32769),{toBuffer:T}=r(10795),P=Symbol("kAborted"),N=[8,13],x=["CONNECTING","OPEN","CLOSING","CLOSED"],A=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class C extends i{constructor(e,t,r){super(),this._binaryType=y[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=v,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=C.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"===typeof t&&null!==t?(r=t,t=[]):t=[t]),k(this,e,t,r)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(e){y.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,r){const n=new p({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:r.maxPayload,skipUTF8Validation:r.skipUTF8Validation});this._sender=new g(e,this._extensions,r.generateMask),this._receiver=n,this._socket=e,n[w]=this,e[w]=this,n.on("conclude",q),n.on("drain",V),n.on("error",z),n.on("message",K),n.on("ping",W),n.on("pong",H),e.setTimeout(0),e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",J),e.on("data",G),e.on("end",Y),e.on("error",Z),this._readyState=C.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this._readyState=C.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[d.extensionName]&&this._extensions[d.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=C.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==C.CLOSED)if(this.readyState!==C.CONNECTING)this.readyState!==C.CLOSING?(this._readyState=C.CLOSING,this._sender.close(e,t,!this._isServer,(e=>{e||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())})),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)):this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();else{const e="WebSocket was closed before the connection was established";j(this,this._req,e)}}pause(){this.readyState!==C.CONNECTING&&this.readyState!==C.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,r){if(this.readyState===C.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"===typeof e?(r=e,e=t=void 0):"function"===typeof t&&(r=t,t=void 0),"number"===typeof e&&(e=e.toString()),this.readyState===C.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||v,t,r)):B(this,e,r)}pong(e,t,r){if(this.readyState===C.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"===typeof e?(r=e,e=t=void 0):"function"===typeof t&&(r=t,t=void 0),"number"===typeof e&&(e=e.toString()),this.readyState===C.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||v,t,r)):B(this,e,r)}resume(){this.readyState!==C.CONNECTING&&this.readyState!==C.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,r){if(this.readyState===C.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"===typeof t&&(r=t,t={}),"number"===typeof e&&(e=e.toString()),this.readyState!==C.OPEN)return void B(this,e,r);const n={binary:"string"!==typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[d.extensionName]||(n.compress=!1),this._sender.send(e||v,n,r)}terminate(){if(this.readyState!==C.CLOSED)if(this.readyState!==C.CONNECTING)this._socket&&(this._readyState=C.CLOSING,this._socket.destroy());else{const e="WebSocket was closed before the connection was established";j(this,this._req,e)}}}function k(e,t,r,i){const a={protocolVersion:N[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...i,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(!N.includes(a.protocolVersion))throw new RangeError(`Unsupported protocol version: ${a.protocolVersion} (supported versions: ${N.join(", ")})`);let u;if(t instanceof f)u=t,e._url=t.href;else{try{u=new f(t)}catch(S){throw new SyntaxError(`Invalid URL: ${t}`)}e._url=t}const h="wss:"===u.protocol,p="ws+unix:"===u.protocol;let g;if("ws:"===u.protocol||h||p?p&&!u.pathname?g="The URL's pathname is empty":u.hash&&(g="The URL contains a fragment identifier"):g='The URL\'s protocol must be one of "ws:", "wss:", or "ws+unix:"',g){const t=new SyntaxError(g);if(0===e._redirects)throw t;return void D(e,t)}const y=h?443:80,v=c(16).toString("base64"),b=h?o.request:s.request,E=new Set;let _,w;if(a.createConnection=h?L:U,a.defaultPort=a.defaultPort||y,a.port=u.port||y,a.host=u.hostname.startsWith("[")?u.hostname.slice(1,-1):u.hostname,a.headers={...a.headers,"Sec-WebSocket-Version":a.protocolVersion,"Sec-WebSocket-Key":v,Connection:"Upgrade",Upgrade:"websocket"},a.path=u.pathname+u.search,a.timeout=a.handshakeTimeout,a.perMessageDeflate&&(_=new d(!0!==a.perMessageDeflate?a.perMessageDeflate:{},!1,a.maxPayload),a.headers["Sec-WebSocket-Extensions"]=O({[d.extensionName]:_.offer()})),r.length){for(const e of r){if("string"!==typeof e||!A.test(e)||E.has(e))throw new SyntaxError("An invalid or duplicated subprotocol was specified");E.add(e)}a.headers["Sec-WebSocket-Protocol"]=r.join(",")}if(a.origin&&(a.protocolVersion<13?a.headers["Sec-WebSocket-Origin"]=a.origin:a.headers.Origin=a.origin),(u.username||u.password)&&(a.auth=`${u.username}:${u.password}`),p){const e=a.path.split(":");a.socketPath=e[0],a.path=e[1]}if(a.followRedirects){if(0===e._redirects){e._originalIpc=p,e._originalSecure=h,e._originalHostOrSocketPath=p?a.socketPath:u.host;const t=i&&i.headers;if(i={...i,headers:{}},t)for(const[e,r]of Object.entries(t))i.headers[e.toLowerCase()]=r}else if(0===e.listenerCount("redirect")){const t=p?!!e._originalIpc&&a.socketPath===e._originalHostOrSocketPath:!e._originalIpc&&u.host===e._originalHostOrSocketPath;(!t||e._originalSecure&&!h)&&(delete a.headers.authorization,delete a.headers.cookie,t||delete a.headers.host,a.auth=void 0)}a.auth&&!i.headers.authorization&&(i.headers.authorization="Basic "+n.from(a.auth).toString("base64")),w=e._req=b(a),e._redirects&&e.emit("redirect",e.url,w)}else w=e._req=b(a);a.timeout&&w.on("timeout",(()=>{j(e,w,"Opening handshake has timed out")})),w.on("error",(t=>{null===w||w[P]||(w=e._req=null,D(e,t))})),w.on("response",(n=>{const o=n.headers.location,s=n.statusCode;if(o&&a.followRedirects&&s>=300&&s<400){if(++e._redirects>a.maxRedirects)return void j(e,w,"Maximum redirects exceeded");let n;w.abort();try{n=new f(o,t)}catch(S){const r=new SyntaxError(`Invalid URL: ${o}`);return void D(e,r)}k(e,n,r,i)}else e.emit("unexpected-response",w,n)||j(e,w,`Unexpected server response: ${n.statusCode}`)})),w.on("upgrade",((t,r,n)=>{if(e.emit("upgrade",t),e.readyState!==C.CONNECTING)return;if(w=e._req=null,"websocket"!==t.headers.upgrade.toLowerCase())return void j(e,r,"Invalid Upgrade header");const i=l("sha1").update(v+m).digest("base64");if(t.headers["sec-websocket-accept"]!==i)return void j(e,r,"Invalid Sec-WebSocket-Accept header");const o=t.headers["sec-websocket-protocol"];let s;if(void 0!==o?E.size?E.has(o)||(s="Server sent an invalid subprotocol"):s="Server sent a subprotocol but none was requested":E.size&&(s="Server sent no subprotocol"),s)return void j(e,r,s);o&&(e._protocol=o);const u=t.headers["sec-websocket-extensions"];if(void 0!==u){if(!_){return void j(e,r,"Server sent a Sec-WebSocket-Extensions header but no extension was requested")}let t;try{t=M(u)}catch(c){return void j(e,r,"Invalid Sec-WebSocket-Extensions header")}const n=Object.keys(t);if(1!==n.length||n[0]!==d.extensionName){return void j(e,r,"Server indicated an extension that was not requested")}try{_.accept(t[d.extensionName])}catch(c){return void j(e,r,"Invalid Sec-WebSocket-Extensions header")}e._extensions[d.extensionName]=_}e.setSocket(r,n,{generateMask:a.generateMask,maxPayload:a.maxPayload,skipUTF8Validation:a.skipUTF8Validation})})),w.end()}function D(e,t){e._readyState=C.CLOSING,e.emit("error",t),e.emitClose()}function U(e){return e.path=e.socketPath,a.connect(e)}function L(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=a.isIP(e.host)?"":e.host),u.connect(e)}function j(e,t,r){e._readyState=C.CLOSING;const n=new Error(r);Error.captureStackTrace(n,j),t.setHeader?(t[P]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(D,e,n)):(t.destroy(n),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function B(e,t,r){if(t){const r=T(t).length;e._socket?e._sender._bufferedBytes+=r:e._bufferedAmount+=r}if(r){const t=new Error(`WebSocket is not open: readyState ${e.readyState} (${x[e.readyState]})`);process.nextTick(r,t)}}function q(e,t){const r=this[w];r._closeFrameReceived=!0,r._closeMessage=t,r._closeCode=e,void 0!==r._socket[w]&&(r._socket.removeListener("data",G),process.nextTick(F,r._socket),1005===e?r.close():r.close(e,t))}function V(){const e=this[w];e.isPaused||e._socket.resume()}function z(e){const t=this[w];void 0!==t._socket[w]&&(t._socket.removeListener("data",G),process.nextTick(F,t._socket),t.close(e[_])),t.emit("error",e)}function $(){this[w].emitClose()}function K(e,t){this[w].emit("message",e,t)}function W(e){const t=this[w];t.pong(e,!t._isServer,S),t.emit("ping",e)}function H(e){this[w].emit("pong",e)}function F(e){e.resume()}function J(){const e=this[w];let t;this.removeListener("close",J),this.removeListener("data",G),this.removeListener("end",Y),e._readyState=C.CLOSING,this._readableState.endEmitted||e._closeFrameReceived||e._receiver._writableState.errorEmitted||null===(t=e._socket.read())||e._receiver.write(t),e._receiver.end(),this[w]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",$),e._receiver.on("finish",$))}function G(e){this[w]._receiver.write(e)||this.pause()}function Y(){const e=this[w];e._readyState=C.CLOSING,e._receiver.end(),this.end()}function Z(){const e=this[w];this.removeListener("error",Z),this.on("error",S),e&&(e._readyState=C.CLOSING,this.destroy())}Object.defineProperty(C,"CONNECTING",{enumerable:!0,value:x.indexOf("CONNECTING")}),Object.defineProperty(C.prototype,"CONNECTING",{enumerable:!0,value:x.indexOf("CONNECTING")}),Object.defineProperty(C,"OPEN",{enumerable:!0,value:x.indexOf("OPEN")}),Object.defineProperty(C.prototype,"OPEN",{enumerable:!0,value:x.indexOf("OPEN")}),Object.defineProperty(C,"CLOSING",{enumerable:!0,value:x.indexOf("CLOSING")}),Object.defineProperty(C.prototype,"CLOSING",{enumerable:!0,value:x.indexOf("CLOSING")}),Object.defineProperty(C,"CLOSED",{enumerable:!0,value:x.indexOf("CLOSED")}),Object.defineProperty(C.prototype,"CLOSED",{enumerable:!0,value:x.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach((e=>{Object.defineProperty(C.prototype,e,{enumerable:!0})})),["open","error","close","message"].forEach((e=>{Object.defineProperty(C.prototype,`on${e}`,{enumerable:!0,get(){for(const t of this.listeners(e))if(t[b])return t[E];return null},set(t){for(const r of this.listeners(e))if(r[b]){this.removeListener(e,r);break}"function"===typeof t&&this.addEventListener(e,t,{[b]:!0})}})})),C.prototype.addEventListener=I,C.prototype.removeEventListener=R,e.exports=C},38268:e=>{"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},8006:(e,t,r)=>{"use strict";function n(e){var t=this;if(t instanceof n||(t=new n),t.tail=null,t.head=null,t.length=0,e&&"function"===typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var r=0,i=arguments.length;r<i;r++)t.push(arguments[r]);return t}function i(e,t,r){var n=t===e.head?new a(r,null,t,e):new a(r,t,t.next,e);return null===n.next&&(e.tail=n),null===n.prev&&(e.head=n),e.length++,n}function o(e,t){e.tail=new a(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function s(e,t){e.head=new a(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function a(e,t,r,n){if(!(this instanceof a))return new a(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}e.exports=n,n.Node=a,n.create=n,n.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},n.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},n.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},n.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},n.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)s(this,arguments[e]);return this.length},n.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},n.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},n.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},n.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},n.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},n.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},n.prototype.map=function(e,t){t=t||this;for(var r=new n,i=this.head;null!==i;)r.push(e.call(t,i.value,this)),i=i.next;return r},n.prototype.mapReverse=function(e,t){t=t||this;for(var r=new n,i=this.tail;null!==i;)r.push(e.call(t,i.value,this)),i=i.prev;return r},n.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var i=0;null!==n;i++)r=e(r,n.value,i),n=n.next;return r},n.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var i=this.length-1;null!==n;i--)r=e(r,n.value,i),n=n.prev;return r},n.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},n.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},n.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,o=this.head;null!==o&&i<e;i++)o=o.next;for(;null!==o&&i<t;i++,o=o.next)r.push(o.value);return r},n.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,o=this.tail;null!==o&&i>t;i--)o=o.prev;for(;null!==o&&i>e;i--,o=o.prev)r.push(o.value);return r},n.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,o=this.head;null!==o&&n<e;n++)o=o.next;var s=[];for(n=0;o&&n<t;n++)s.push(o.value),o=this.removeNode(o);null===o&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev);for(n=0;n<r.length;n++)o=i(this,o,r[n]);return s},n.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};try{r(38268)(n)}catch(u){}},85292:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CppObject=void 0;t.CppObject=class{constructor(e,t){this.ptr=e,this.inst=t}checkAlive(){if(!this.ptr)throw Error("Call after destroyed")}getPointer(){return this.checkAlive(),this.ptr}}},55066:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Image=void 0;const n=r(85292),i=r(14782),o=r(51632);class s extends n.CppObject{static async createFromGrayBuffer(e,t,r,n=0){const i=await(0,o.getInstance)(),s=i.HEAPU8,a=new Uint8Array(r),u=e*t;if(u!==a.byteLength)throw Error("dataBuf does not match width and height");const c=i._malloc(u);s.set(a,c);return new this(i._Image_create(e,t,808466521,c,u,n),i)}static async createFromRGBABuffer(e,t,r,n=0){const i=await(0,o.getInstance)(),s=i.HEAPU8,a=new Uint8Array(r),u=e*t;if(4*u!==a.byteLength)throw Error("dataBuf does not match width and height");const c=i._malloc(u);for(let o=0;o<u;++o){const e=a[4*o],t=a[4*o+1],r=a[4*o+2];s[c+o]=19595*e+38469*t+7472*r>>16}return new this(i._Image_create(e,t,808466521,c,u,n),i)}destroy(){this.checkAlive(),this.inst._Image_destory(this.ptr),this.ptr=0}getSymbols(){this.checkAlive();const e=this.inst._Image_get_symbols(this.ptr);return i.Symbol.createSymbolsFromPtr(e,this.inst.HEAPU8.buffer)}}t.Image=s},93138:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImageScanner=void 0;const n=r(85292),i=r(51632),o=r(14782);class s extends n.CppObject{static async create(){const e=await(0,i.getInstance)();return new this(e._ImageScanner_create(),e)}destroy(){this.checkAlive(),this.inst._ImageScanner_destory(this.ptr),this.ptr=0}setConfig(e,t,r){return this.checkAlive(),this.inst._ImageScanner_set_config(this.ptr,e,t,r)}enableCache(e=!0){this.checkAlive(),this.inst._ImageScanner_enable_cache(this.ptr,e)}recycleImage(e){this.checkAlive(),this.inst._ImageScanner_recycle_image(this.ptr,e.getPointer())}getResults(){this.checkAlive();const e=this.inst._ImageScanner_get_results(this.ptr);return o.Symbol.createSymbolsFromPtr(e,this.inst.HEAPU8.buffer)}scan(e){return this.checkAlive(),this.inst._ImageScanner_scan(this.ptr,e.getPointer())}}t.ImageScanner=s},14782:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Symbol=void 0;const n=r(48306);class i{constructor(e,t){this.ptr=e,this.ptr32=e>>2,this.buf=t,this.HEAP8=new Int8Array(t),this.HEAPU32=new Uint32Array(t),this.HEAP32=new Int32Array(t)}}class o extends i{get type(){return this.HEAPU32[this.ptr32]}get data(){const e=this.HEAPU32[this.ptr32+4],t=this.HEAPU32[this.ptr32+5];return Int8Array.from(this.HEAP8.subarray(t,t+e))}get points(){const e=this.HEAPU32[this.ptr32+7],t=this.HEAPU32[this.ptr32+8]>>2,r=[];for(let n=0;n<e;++n){const e=this.HEAP32[t+2*n],i=this.HEAP32[t+2*n+1];r.push({x:e,y:i})}return r}get next(){const e=this.HEAPU32[this.ptr32+11];return e?new o(e,this.buf):null}get time(){return this.HEAPU32[this.ptr32+13]}get cacheCount(){return this.HEAP32[this.ptr32+14]}get quality(){return this.HEAP32[this.ptr32+15]}}class s extends i{get head(){const e=this.HEAPU32[this.ptr32+2];return e?new o(e,this.buf):null}}class a{constructor(e){this.type=e.type,this.typeName=n.ZBarSymbolType[this.type],this.data=e.data,this.points=e.points,this.time=e.time,this.cacheCount=e.cacheCount,this.quality=e.quality}static createSymbolsFromPtr(e,t){if(0==e)return[];let r=new s(e,t).head;const n=[];for(;null!==r;)n.push(new a(r)),r=r.next;return n}decode(e){return new TextDecoder(e).decode(this.data)}}t.Symbol=a},48306:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZBarConfigType=t.ZBarSymbolType=void 0,function(e){e[e.ZBAR_NONE=0]="ZBAR_NONE",e[e.ZBAR_PARTIAL=1]="ZBAR_PARTIAL",e[e.ZBAR_EAN8=8]="ZBAR_EAN8",e[e.ZBAR_UPCE=9]="ZBAR_UPCE",e[e.ZBAR_ISBN10=10]="ZBAR_ISBN10",e[e.ZBAR_UPCA=12]="ZBAR_UPCA",e[e.ZBAR_EAN13=13]="ZBAR_EAN13",e[e.ZBAR_ISBN13=14]="ZBAR_ISBN13",e[e.ZBAR_I25=25]="ZBAR_I25",e[e.ZBAR_CODE39=39]="ZBAR_CODE39",e[e.ZBAR_PDF417=57]="ZBAR_PDF417",e[e.ZBAR_QRCODE=64]="ZBAR_QRCODE",e[e.ZBAR_CODE128=128]="ZBAR_CODE128",e[e.ZBAR_SYMBOL=255]="ZBAR_SYMBOL",e[e.ZBAR_ADDON2=512]="ZBAR_ADDON2",e[e.ZBAR_ADDON5=1280]="ZBAR_ADDON5",e[e.ZBAR_ADDON=1792]="ZBAR_ADDON"}(t.ZBarSymbolType||(t.ZBarSymbolType={})),function(e){e[e.ZBAR_CFG_ENABLE=0]="ZBAR_CFG_ENABLE",e[e.ZBAR_CFG_ADD_CHECK=1]="ZBAR_CFG_ADD_CHECK",e[e.ZBAR_CFG_EMIT_CHECK=2]="ZBAR_CFG_EMIT_CHECK",e[e.ZBAR_CFG_ASCII=3]="ZBAR_CFG_ASCII",e[e.ZBAR_CFG_NUM=4]="ZBAR_CFG_NUM",e[e.ZBAR_CFG_MIN_LEN=32]="ZBAR_CFG_MIN_LEN",e[e.ZBAR_CFG_MAX_LEN=33]="ZBAR_CFG_MAX_LEN",e[e.ZBAR_CFG_UNCERTAINTY=64]="ZBAR_CFG_UNCERTAINTY",e[e.ZBAR_CFG_POSITION=128]="ZBAR_CFG_POSITION",e[e.ZBAR_CFG_X_DENSITY=256]="ZBAR_CFG_X_DENSITY",e[e.ZBAR_CFG_Y_DENSITY=257]="ZBAR_CFG_Y_DENSITY"}(t.ZBarConfigType||(t.ZBarConfigType={}))},25631:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(55066),t),i(r(93138),t),i(r(9794),t),i(r(14782),t)},51632:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInstance=void 0;const n=r(51280);let i=null,o=(async()=>{if(i=await(0,n.loadWasmInstance)({}),!i)throw Error("WASM was not loaded");return i})();t.getInstance=async()=>await o},51280:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.loadWasmInstance=void 0;const i=n(r(41692)),o=n(r(93485)),s=(e,t)=>("zbar.wasm"!=e&&console.error("Unexpected file:",e),i.default);t.loadWasmInstance=async e=>{e.locateFile=s;const t=()=>{};return e.print=t,e.printErr=t,await(0,o.default)(e)}},9794:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scanImageData=t.scanRGBABuffer=t.scanGrayBuffer=t.getDefaultScanner=void 0;const n=r(55066),i=r(93138).ImageScanner.create();t.getDefaultScanner=async()=>await i;const o=async(e,t)=>{void 0===t&&(t=await i);const r=t.scan(e);if(r<0)throw Error("Scan Failed");return 0===r?[]:e.getSymbols()};t.scanGrayBuffer=async(e,t,r,i)=>{const s=await n.Image.createFromGrayBuffer(t,r,e),a=await o(s,i);return s.destroy(),a};t.scanRGBABuffer=async(e,t,r,i)=>{const s=await n.Image.createFromRGBABuffer(t,r,e),a=await o(s,i);return s.destroy(),a};t.scanImageData=async(e,r)=>await(0,t.scanRGBABuffer)(e.data.buffer,e.width,e.height,r)},93485:(e,t,r)=>{var n=function(){var e="undefined"!==typeof document&&document.currentScript?document.currentScript.src:void 0;return e=e||"/index.js",function(t){var n,i,o="undefined"!==typeof(t=t||{})?t:{};o.ready=new Promise((function(e,t){n=e,i=t}));var s,a={};for(s in o)o.hasOwnProperty(s)&&(a[s]=o[s]);var u,c,l,h,f,d=[],p="object"===typeof window,g="function"===typeof importScripts,y="object"===typeof process&&"object"===typeof process.versions&&"string"===typeof process.versions.node,v="";y?(v=g?r(58869).dirname(v)+"/":"//",u=function(e,t){return h||(h=r(98770)),f||(f=r(58869)),e=f.normalize(e),h.readFileSync(e,t?null:"utf8")},l=function(e){var t,r=u(e,!0);return r.buffer||(r=new Uint8Array(r)),r.buffer||j("Assertion failed: "+t),r},c=function(e,t,n){h||(h=r(98770)),f||(f=r(58869)),e=f.normalize(e),h.readFile(e,(function(e,r){e?n(e):t(r.buffer)}))},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),d=process.argv.slice(2),process.on("uncaughtException",(function(e){if(!(e instanceof Q))throw e})),process.on("unhandledRejection",(function(e){throw e})),function(e,t){if(w||k>0)throw process.exitCode=e,t;var r;(r=t)instanceof Q||E("exiting due to exception: "+r),process.exit(e)},o.inspect=function(){return"[Emscripten Module object]"}):(p||g)&&(g?v=self.location.href:"undefined"!==typeof document&&document.currentScript&&(v=document.currentScript.src),e&&(v=e),v=0!==v.indexOf("blob:")?v.substr(0,v.replace(/[?#].*/,"").lastIndexOf("/")+1):"",u=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},g&&(l=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),c=function(e,t,r){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)});var m,b=o.print||console.log.bind(console),E=o.printErr||console.warn.bind(console);for(s in a)a.hasOwnProperty(s)&&(o[s]=a[s]);a=null,o.arguments&&(d=o.arguments),o.thisProgram&&o.thisProgram,o.quit&&o.quit,o.wasmBinary&&(m=o.wasmBinary);var _,w=o.noExitRuntime||!0;"object"!==typeof WebAssembly&&j("no native wasm support detected");var S=!1;var I,R,O,M="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function T(e,t,r){for(var n=t+r,i=t;e[i]&&!(i>=n);)++i;if(i-t>16&&e.subarray&&M)return M.decode(e.subarray(t,i));for(var o="";t<i;){var s=e[t++];if(128&s){var a=63&e[t++];if(192!=(224&s)){var u=63&e[t++];if((s=224==(240&s)?(15&s)<<12|a<<6|u:(7&s)<<18|a<<12|u<<6|63&e[t++])<65536)o+=String.fromCharCode(s);else{var c=s-65536;o+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else o+=String.fromCharCode((31&s)<<6|a)}else o+=String.fromCharCode(s)}return o}function P(e){I=e,o.HEAP8=new Int8Array(e),o.HEAP16=new Int16Array(e),o.HEAP32=O=new Int32Array(e),o.HEAPU8=R=new Uint8Array(e),o.HEAPU16=new Uint16Array(e),o.HEAPU32=new Uint32Array(e),o.HEAPF32=new Float32Array(e),o.HEAPF64=new Float64Array(e)}o.INITIAL_MEMORY;var N,x=[],A=[],C=[],k=0;var D=0,U=null,L=null;function j(e){o.onAbort&&o.onAbort(e),E(e="Aborted("+e+")"),S=!0,1,e+=". Build with -s ASSERTIONS=1 for more info.";var t=new WebAssembly.RuntimeError(e);throw i(t),t}o.preloadedImages={},o.preloadedAudios={};var B,q,V,z="data:application/octet-stream;base64,";function $(e){return e.startsWith(z)}function K(e){return e.startsWith("file://")}function W(e){try{if(e==B&&m)return new Uint8Array(m);if(l)return l(e);throw"both async and sync fetching of the wasm failed"}catch(E){j(E)}}function H(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var r=t.func;"number"===typeof r?void 0===t.arg?F(r)():F(r)(t.arg):r(void 0===t.arg?null:t.arg)}else t(o)}}function F(e){return N.get(e)}$(B="zbar.wasm")||(q=B,B=o.locateFile?o.locateFile(q,v):v+q),V=y?function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:function(){return performance.now()};function J(e){try{return _.grow(e-I.byteLength+65535>>>16),P(_.buffer),1}catch(t){}}var G={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var r=G.buffers[e];0===t||10===t?((1===e?b:E)(T(r,0)),r.length=0):r.push(t)},varargs:void 0,get:function(){return G.varargs+=4,O[G.varargs-4>>2]},getStr:function(e){var t=function(e,t){return e?T(R,e,t):""}(e);return t},get64:function(e,t){return e}};var Y,Z={f:function(e,t){var r,n;if(0===e)r=Date.now();else{if(1!==e&&4!==e)return n=28,O[X()>>2]=n,-1;r=V()}return O[t>>2]=r/1e3|0,O[t+4>>2]=r%1e3*1e3*1e3|0,0},c:function(e,t,r){R.copyWithin(e,t,t+r)},d:function(e){var t,r,n=R.length,i=2147483648;if((e>>>=0)>i)return!1;for(var o=1;o<=4;o*=2){var s=n*(1+.2/o);if(s=Math.min(s,e+100663296),J(Math.min(i,((t=Math.max(e,s))%(r=65536)>0&&(t+=r-t%r),t))))return!0}return!1},e:function(e){return 0},b:function(e,t,r,n,i){},a:function(e,t,r,n){for(var i=0,o=0;o<r;o++){var s=O[t>>2],a=O[t+4>>2];t+=8;for(var u=0;u<a;u++)G.printChar(e,R[s+u]);i+=a}return O[n>>2]=i,0}},X=(function(){var e={a:Z};function t(e,t){var r,n=e.exports;o.asm=n,P((_=o.asm.g).buffer),N=o.asm.s,r=o.asm.h,A.unshift(r),function(e){if(D--,o.monitorRunDependencies&&o.monitorRunDependencies(D),0==D&&(null!==U&&(clearInterval(U),U=null),L)){var t=L;L=null,t()}}()}function r(e){t(e.instance)}function n(t){return function(){if(!m&&(p||g)){if("function"===typeof fetch&&!K(B))return fetch(B,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+B+"'";return e.arrayBuffer()})).catch((function(){return W(B)}));if(c)return new Promise((function(e,t){c(B,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return W(B)}))}().then((function(t){return WebAssembly.instantiate(t,e)})).then((function(e){return e})).then(t,(function(e){E("failed to asynchronously prepare wasm: "+e),j(e)}))}if(D++,o.monitorRunDependencies&&o.monitorRunDependencies(D),o.instantiateWasm)try{return o.instantiateWasm(e,t)}catch(s){return E("Module.instantiateWasm callback failed with error: "+s),!1}(m||"function"!==typeof WebAssembly.instantiateStreaming||$(B)||K(B)||"function"!==typeof fetch?n(r):fetch(B,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(r,(function(e){return E("wasm streaming compile failed: "+e),E("falling back to ArrayBuffer instantiation"),n(r)}))}))).catch(i)}(),o.___wasm_call_ctors=function(){return(o.___wasm_call_ctors=o.asm.h).apply(null,arguments)},o._ImageScanner_create=function(){return(o._ImageScanner_create=o.asm.i).apply(null,arguments)},o._ImageScanner_destory=function(){return(o._ImageScanner_destory=o.asm.j).apply(null,arguments)},o._ImageScanner_set_config=function(){return(o._ImageScanner_set_config=o.asm.k).apply(null,arguments)},o._ImageScanner_enable_cache=function(){return(o._ImageScanner_enable_cache=o.asm.l).apply(null,arguments)},o._ImageScanner_recycle_image=function(){return(o._ImageScanner_recycle_image=o.asm.m).apply(null,arguments)},o._ImageScanner_get_results=function(){return(o._ImageScanner_get_results=o.asm.n).apply(null,arguments)},o._ImageScanner_scan=function(){return(o._ImageScanner_scan=o.asm.o).apply(null,arguments)},o._Image_create=function(){return(o._Image_create=o.asm.p).apply(null,arguments)},o._Image_destory=function(){return(o._Image_destory=o.asm.q).apply(null,arguments)},o._Image_get_symbols=function(){return(o._Image_get_symbols=o.asm.r).apply(null,arguments)},o.___errno_location=function(){return(X=o.___errno_location=o.asm.t).apply(null,arguments)});o._free=function(){return(o._free=o.asm.u).apply(null,arguments)},o._malloc=function(){return(o._malloc=o.asm.v).apply(null,arguments)};function Q(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function ee(e){function t(){Y||(Y=!0,o.calledRun=!0,S||(!0,H(A),n(o),o.onRuntimeInitialized&&o.onRuntimeInitialized(),function(){if(o.postRun)for("function"==typeof o.postRun&&(o.postRun=[o.postRun]);o.postRun.length;)e=o.postRun.shift(),C.unshift(e);var e;H(C)}()))}e=e||d,D>0||(!function(){if(o.preRun)for("function"==typeof o.preRun&&(o.preRun=[o.preRun]);o.preRun.length;)e=o.preRun.shift(),x.unshift(e);var e;H(x)}(),D>0||(o.setStatus?(o.setStatus("Running..."),setTimeout((function(){setTimeout((function(){o.setStatus("")}),1),t()}),1)):t()))}if(L=function e(){Y||ee(),Y||(L=e)},o.run=ee,o.preInit)for("function"==typeof o.preInit&&(o.preInit=[o.preInit]);o.preInit.length>0;)o.preInit.pop()();return ee(),t.ready}}();e.exports=n},41692:(e,t,r)=>{"use strict";e.exports=r.p+"static/media/zbar.wasm.235eff51d7a9ded7a612.bin"}}]);