"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[7277],{86141:(e,t,r)=>{r.r(t),r.d(t,{VaultBase:()=>S,VaultBaseChainOnly:()=>C});var n=r(72579),o=r.n(n),i=r(56666),a=r(1842),u=r.n(a),c=r(34795),s=r(87371),d=r(45754),l=r(11987),f=r(95058),p=r(6391),h=r.n(p),y=r(36393),v=r(13549),w=r(42547),g=r(13208),m=r(92431),x=r(40915),I=r(78489),T=r(69618),b=r(98514),E=r(14540),O=r(48834).Buffer;function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function A(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,f.default)(e);if(t){var o=(0,f.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}if(g.default.isExtensionUi)throw new Error("engine/VaultBase is not allowed imported from ui");var C=function(e){(0,d.default)(r,e);var t=A(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.initProvider=function(){var e=(0,c.default)((function*(){var e=(yield this.getNetwork()).impl;u()(T.IMPL_MAPPINGS[e])||(this.engineProvider=yield this.engine.providerManager.getProvider(this.networkId))}));return function(){return e.apply(this,arguments)}}(),n.proxyJsonRPCCall=function(){var e=(0,c.default)((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.createClientFromURL=function(e){throw new x.NotImplemented},n.getEthersProvider=function(){var e=(0,c.default)((function*(){throw new x.NotImplemented}));return function(){return e.apply(this,arguments)}}(),n.getClientEndpointStatus=function(){var e=(0,c.default)((function*(e){var t=this.createClientFromURL(e),r=performance.now(),n=(yield t.getInfo()).bestBlockNumber;return{responseTime:Math.floor(performance.now()-r),latestBlock:n}}));return function(t){return e.apply(this,arguments)}}(),n.checkRpcBatchSupport=function(){var e=(0,c.default)((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.getDisplayAddress=function(){var e=(0,c.default)((function*(e){return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),n.validateAddress=function(){var e=(0,c.default)((function*(e){var t=yield this.engineProvider.verifyAddress(e),r=t.normalizedAddress;if(!t.isValid||!r)throw new x.InvalidAddress;return Promise.resolve(r)}));return function(t){return e.apply(this,arguments)}}(),n.validateImportedCredential=function(e){return Promise.resolve(this.settings.importedAccountEnabled&&/^(0x)?[0-9a-zA-Z]{64}$/.test(e))},n.validateWatchingCredential=function(){var e=(0,c.default)((function*(e){return Promise.resolve(this.settings.watchingAccountEnabled&&(yield this.engineProvider.verifyAddress(e)).isValid)}));return function(t){return e.apply(this,arguments)}}(),n.validateTokenAddress=function(){var e=(0,c.default)((function*(e){var t=yield this.engineProvider.verifyTokenAddress(e),r=t.normalizedAddress;if(!t.isValid||"undefined"===typeof r)throw new x.InvalidTokenAddress;return Promise.resolve(r)}));return function(t){return e.apply(this,arguments)}}(),n.validateCanCreateNextAccount=function(){var e=(0,c.default)((function*(e,t){return Promise.resolve(!0)}));return function(t,r){return e.apply(this,arguments)}}(),n.checkAccountExistence=function(){var e=(0,c.default)((function*(e,t){return Promise.resolve(!0)}));return function(t,r){return e.apply(this,arguments)}}(),n.getBalances=function(){var e=(0,c.default)((function*(e,t,r){return(yield this.engine.providerManager.getClient(this.networkId)).getBalances(e.map((function(e){var t=e.address,r=e.tokenAddress;return{address:t,coin:k({},"string"===typeof r?{tokenAddress:r}:{})}})))}));return function(t,r,n){return e.apply(this,arguments)}}(),n.getFrozenBalance=function(){var e=(0,c.default)((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.password,e.useRecycleBalance,e.ignoreInscriptions,e.useCustomAddressesBalance;return 0}));return function(){return e.apply(this,arguments)}}(),n.fetchBalanceDetails=function(){var e=(0,c.default)((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.password,e.useRecycleBalance,e.ignoreInscriptions,e.useCustomAddressesBalance;return Promise.resolve(void 0)}));return function(){return e.apply(this,arguments)}}(),n.getTransactionStatuses=function(e){return this.engine.providerManager.getTransactionStatuses(this.networkId,e)},n.getTransactionFeeInNative=function(e){return Promise.resolve("")},n.isContractAddress=function(){var e=(0,c.default)((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),n.getAccountNameInfoMap=function(){var e=(0,c.default)((function*(){var e=yield this.getNetwork();return(0,I.getAccountNameInfoByImpl)(e.impl)}));return function(){return e.apply(this,arguments)}}(),n.canAutoCreateNextAccount=function(){var e=(0,c.default)((function*(e){return Promise.resolve(!1)}));return function(t){return e.apply(this,arguments)}}(),n.filterAccounts=function(){var e=(0,c.default)((function*(e){var t=e.accounts;e.networkId;return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),n.shouldChangeAccountWhenNetworkChanged=function(){var e=(0,c.default)((function*(e){e.previousNetwork,e.newNetwork,e.activeAccountId;return Promise.resolve({shouldReloadAccountList:!1,shouldChangeActiveAccount:!1})}));return function(t){return e.apply(this,arguments)}}(),n.getAccountNameInfosByImportedOrWatchingCredential=function(){var e=(0,c.default)((function*(e){return Promise.resolve([])}));return function(t){return e.apply(this,arguments)}}(),n.checkIsUnlimitedAllowance=function(){var e=(0,c.default)((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.checkIsApprovedForAll=function(){var e=(0,c.default)((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.checkIsBatchTransfer=function(){var e=(0,c.default)((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.getFeePricePerUnit=function(){var e=(0,c.default)((function*(){throw new x.NotImplemented}));return function(){return e.apply(this,arguments)}}(),n.fetchRpcChainId=function(){var e=(0,c.default)((function*(e){return null}));return function(t){return e.apply(this,arguments)}}(),n.getTxWaitingSeconds=function(){var e=(0,c.default)((function*(){return[]}));return function(){return e.apply(this,arguments)}}(),n.getUserNFTAssets=function(){var e=(0,c.default)((function*(e){e.serviceData;return Promise.resolve(void 0)}));return function(t){return e.apply(this,arguments)}}(),n.getTransactionDetail=function(){var e=(0,c.default)((function*(e){return Promise.resolve(void 0)}));return function(t){return e.apply(this,arguments)}}(),(0,s.default)(r)}(E.VaultContext),S=function(e){(0,d.default)(r,e);var t=A(r);function r(){for(var e,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).uuid=y.default.v4().toString(),e}var n=r.prototype;return n.init=function(){var e=(0,c.default)((function*(e){yield this.initProvider(),yield this.initKeyring(e)}));return function(t){return e.apply(this,arguments)}}(),n.initKeyring=function(){var e=(0,c.default)((function*(e){this.keyring=yield e.keyringCreator(this)}));return function(t){return e.apply(this,arguments)}}(),n.signTransaction=function(){var e=(0,c.default)((function*(e,t){return this.keyring.signTransaction(e,t)}));return function(t,r){return e.apply(this,arguments)}}(),n.signAndSendTransaction=function(){var e=(0,c.default)((function*(e,t,r){var n=yield this.signTransaction(e,t);return r?k(k({},n),{},{encodedTx:e.encodedTx}):this.broadcastTransaction(k(k({},n),{},{encodedTx:e.encodedTx}))}));return function(t,r,n){return e.apply(this,arguments)}}(),n.broadcastTransaction=function(){var e=(0,c.default)((function*(e,t){w.default.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var r=yield this.engine.providerManager.broadcastTransaction(this.networkId,e.rawTx,t);return w.default.engine.info("broadcastTransaction END:",{txid:r,rawTx:e.rawTx}),k(k({},e),{},{txid:r,encodedTx:e.encodedTx})}));return function(t,r){return e.apply(this,arguments)}}(),n.buildEncodedTxFromBatchTransfer=function(){var e=(0,c.default)((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.buildEncodedTxsFromSetApproveForAll=function(){var e=(0,c.default)((function*(e,t){throw new x.NotImplemented}));return function(t,r){return e.apply(this,arguments)}}(),n.activateAccount=function(){var e=(0,c.default)((function*(){throw new x.NotImplemented}));return function(){return e.apply(this,arguments)}}(),n.activateToken=function(){var e=(0,c.default)((function*(e,t){throw new x.NotImplemented}));return function(t,r){return e.apply(this,arguments)}}(),n.getTokenAllowance=function(){var e=(0,c.default)((function*(e,t){throw new x.NotImplemented}));return function(t,r){return e.apply(this,arguments)}}(),n.batchTokensAllowance=function(){var e=(0,c.default)((function*(e,t){throw new x.NotImplemented}));return function(t,r){return e.apply(this,arguments)}}(),n.getOutputAccount=function(){var e=(0,c.default)((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address,template:e.template,pubKey:o()(e,"pub","")}}));return function(){return e.apply(this,arguments)}}(),n.getAccountBalance=function(){var e=(0,c.default)((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,o=(yield this.getDbAccount()).address;return this.getBalances((t?[{address:o}]:[]).concat(e.map((function(e){return{address:o,tokenAddress:e}}))),r,n)}));return function(t){return e.apply(this,arguments)}}(),n.updatePendingTxs=function(){var e=(0,c.default)((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.getAccountNonce=function(){var e=(0,c.default)((function*(){return Promise.resolve(null)}));return function(){return e.apply(this,arguments)}}(),n.fixActionDirection=function(){var e=(0,c.default)((function*(e){var t,r,n,o,i=e.action,a=e.accountAddress;(i.direction=b.IDecodedTxDirection.OTHER,i.type===b.IDecodedTxActionType.NATIVE_TRANSFER)&&(i.direction=yield this.buildTxActionDirection({from:(null==(t=i.nativeTransfer)?void 0:t.from)||"",to:(null==(r=i.nativeTransfer)?void 0:r.to)||"",address:a}));i.type===b.IDecodedTxActionType.TOKEN_TRANSFER&&(i.direction=yield this.buildTxActionDirection({from:(null==(n=i.tokenTransfer)?void 0:n.from)||"",to:(null==(o=i.tokenTransfer)?void 0:o.to)||"",address:a}));return i}));return function(t){return e.apply(this,arguments)}}(),n.fixDecodedTx=function(){var e=(0,c.default)((function*(e){var t,r;e.createdAt=null!=(t=e.createdAt)?t:Date.now();var n=null==(r=e.encodedTx)?void 0:r.nonce;e.nonce=u()(n)?e.nonce:new(h())(n).toNumber();for(var o=e.owner,i=0;i<e.actions.length;i+=1){var a=e.actions[i];yield this.fixActionDirection({action:a,accountAddress:o})}if(e.outputActions)for(var c=0;c<e.outputActions.length;c+=1){var s=e.outputActions[c];yield this.fixActionDirection({action:s,accountAddress:o})}return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),n.fixHistoryTx=function(){var e=(0,c.default)((function*(e){return e.decodedTx=yield this.fixDecodedTx(e.decodedTx),Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),n.buildHistoryTx=function(){var e=(0,c.default)((function*(e){var t=e.historyTxToMerge,r=(e.encodedTx,e.decodedTx),n=e.signedTx,o=e.isSigner,i=e.isLocalCreated,a=(null==n?void 0:n.txid)||(null==r?void 0:r.txid)||"";if(!a)throw new Error("buildHistoryTx txid not found");var u=yield this.getAccountAddress();r.txid=a||r.txid,r.owner=u,o&&(r.signer=u),null!=n&&n.txKey&&(r.extraInfo?r.extraInfo.txKey=n.txKey:r.extraInfo={txKey:n.txKey});var c=k(k({id:`${this.networkId}_${a}_${this.accountId}`,isLocalCreated:Boolean(i)},t),{},{decodedTx:r});return c=yield this.fixHistoryTx(c),Promise.resolve(c)}));return function(t){return e.apply(this,arguments)}}(),n.checkIsScamHistoryTx=function(){var e=(0,c.default)((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),n.fetchOnChainHistory=function(){var e=(0,c.default)((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.fixAddressCase=function(e){return Promise.resolve(e)},n.buildTxActionDirection=function(){var e=(0,c.default)((function*(e){var t=e.from,r=e.to,n=e.address;return t=yield this.fixAddressCase(t||""),r=yield this.fixAddressCase(r),n=yield this.fixAddressCase(n),t===r&&t===n?b.IDecodedTxDirection.SELF:t&&t===n?b.IDecodedTxDirection.OUT:r&&r===n?b.IDecodedTxDirection.IN:b.IDecodedTxDirection.OTHER}));return function(t){return e.apply(this,arguments)}}(),n.getNextNonce=function(){var e=(0,c.default)((function*(e,t){var r,n=null==(r=(yield this.engine.providerManager.getAddresses(e,[t.address]))[0])?void 0:r.nonce;if(u()(n))throw new x.OneKeyError("Get on-chain nonce failed.");yield this.engine.getHistory(e,t.id,void 0,!1);var o=yield m.default.history.getMaxPendingNonce({accountId:this.accountId,networkId:e}),i=yield m.default.history.getPendingNonceList({accountId:this.accountId,networkId:e}),a=Math.max(u()(o)?0:o+1,n);if(Number.isNaN(a)&&(a=n),a>n)for(var c=n;c<a;c+=1)if(!i.includes(c)){a=c;break}if(a<n&&(a=n),a-n>=v.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH)throw new x.PendingQueueTooLong(v.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH);return a}));return function(t,r){return e.apply(this,arguments)}}(),n.validateSendAmount=function(e,t,r){return Promise.resolve(!0)},n.notifyChainChanged=function(e,t){},n.getFetchBalanceAddress=function(e){return Promise.resolve(e.address)},n.getPrivateKeyByCredential=function(e){return Promise.resolve(O.from(e.startsWith("0x")?e.slice(2):e,"hex"))},n.getMinDepositAmount=function(){var e=(0,c.default)((function*(){return"0"}));return function(){return e.apply(this,arguments)}}(),n.specialCheckEncodedTx=function(){var e=(0,c.default)((function*(e){return{success:!0}}));return function(t){return e.apply(this,arguments)}}(),n.getAllUsedAddress=function(){var e=(0,c.default)((function*(){return Promise.resolve([])}));return function(){return e.apply(this,arguments)}}(),n.attachFeeInfoToDAppEncodedTx=function(){var e=(0,c.default)((function*(e){return Promise.resolve(e.encodedTx)}));return function(t){return e.apply(this,arguments)}}(),(0,s.default)(r)}(C)},7277:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Oe});var n=r(56666),o=r(96234),i=r(34795),a=r(87371),u=r(45754),c=r(11987),s=r(95058),d=r(99330),l=r(87472),f=r(39337),p=r(6391),h=r.n(p),y=r(23556),v=r.n(y),w=r(40915),g=r(40727),m=r(98514),x=r(92853),I=r(86141),T=r(76553),b=r(42547),E=r(14231),O=r(84658),P=r(97293),k=r(78489),A=r(98145),C=r(17391),S=r(68652),B=r(53546),D=r(13549),N=r(27281);function H(e){return"mainnet"===e?N.predefined.LINA:N.predefined.AGGRON4}var R=r(68079),F=r(56997),K=r(12397),M=r(30655);function j(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return j=function(e){this.s=e,this.n=e.next},j.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new j(e)}var U=24;function L(e){return _.apply(this,arguments)}function _(){return(_=(0,i.default)((function*(e){var t,r=e.indexer,n=e.address,o=e.onAllowCollect,i=void 0===o?function(){return!0}:o,a=(0,l.parseAddress)(n),u=r.collector({lock:a,type:"empty"}),c=[],s=!1,d=!1;try{for(var f,p=function(e){var t,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(t=e[r]))return t.call(e);if(n&&null!=(t=e[n]))return new j(t.call(e));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}(u.collect());s=!(f=yield p.next()).done;s=!1){var h=f.value;(yield null==i?void 0:i(h))&&c.push(h)}}catch(y){d=!0,t=y}finally{try{s&&null!=p.return&&(yield p.return())}finally{if(d)throw t}}return c}))).apply(this,arguments)}function V(){return(V=(0,i.default)((function*(e){return L({indexer:e.indexer,address:e.address,type:e.type})}))).apply(this,arguments)}function G(e){return W.apply(this,arguments)}function W(){return(W=(0,i.default)((function*(e){var t=e.indexer,r=e.address,n=e.type,o=e.client,i=yield o.getTipBlockNumber();return L({indexer:t,address:r,type:n,onAllowCollect:function(e){var t;return new(h())(i,16).minus(new(h())(null!=(t=e.blockNumber)?t:"0x0",16)).isGreaterThan(U)}})}))).apply(this,arguments)}function $(){return($=(0,i.default)((function*(e){var t=e.indexer,r=e.address,n=e.client,o=e.type,i=yield n.getTipBlockNumber();return L({indexer:t,address:r,type:o,onAllowCollect:function(e){var t;return new(h())(i,16).minus(new(h())(null!=(t=e.blockNumber)?t:"0x0",16)).isLessThan(U)}})}))).apply(this,arguments)}function z(){return z=(0,i.default)((function*(e){var t=e.indexer,r=e.address,n=e.client,o=e.type,i=yield function(e){return $.apply(this,arguments)}({indexer:t,address:r,client:n,type:o});return i.reduce((function(e,t){return e.plus(new(h())(t.cellOutput.capacity,16))}),new(h())(0))})),z.apply(this,arguments)}function q(){return q=(0,i.default)((function*(e){var t=e.indexer,r=e.address,n=yield function(e){return V.apply(this,arguments)}({indexer:t,address:r});return n.reduce((function(e,t){return e.plus(new(h())(t.cellOutput.capacity,16))}),new(h())(0))})),q.apply(this,arguments)}var X=61e8;function Y(e){var t=e.confirmCells,r=e.from,n=e.network,o=e.transferInfo,i=e.config,a=e.specifiedFeeRate,u=o.to,c=o.amount,s=new(h())(c).shiftedBy(n.decimals).toFixed(),d=new(h())(1e5);if(null!=a&&a.limit&&null!=a&&a.price){var l=new(h())(a.price).shiftedBy(n.decimals);d=new(h())(a.limit).multipliedBy(l)}var f,p,y=t.reduce((function(e,t){return e.plus(new(h())(t.cellOutput.capacity,16))}),new(h())(0)),v=new(h())(s).isGreaterThanOrEqualTo(y);v?(f=y,p=new(h())(s)):p=(f=new(h())(s).plus(d)).plus(X);var g=function(e,t){var r=new(h())(0),n=[];for(var o of e)if(r=r.plus(new(h())(o.cellOutput.capacity,16)),n.push(o),r.isGreaterThanOrEqualTo(t))break;return{collected:n,collectedSum:r}}(t,p),m=g.collected,x=g.collectedSum,I=x.minus(f);if(!v&&I.minus(X).isLessThan(0))throw new w.ChangeLessThanMinInputCapacityError("61");if(x.isLessThan(s))throw new w.InsufficientBalance(`Insufficient balance - need: ${s} CKB, available: ${x.toFixed()} CKB`);var T=i.SCRIPTS.SECP256K1_BLAKE160;if(!T)throw new Error("Not implemented transafe");var b=v?x.minus(d).toFixed():s,E={transferInfo:o,hasMaxSend:v,cellDeps:[{outPoint:{txHash:T.TX_HASH,index:T.INDEX},depType:T.DEP_TYPE}],inputs:m,outputs:[{address:u,value:b}],feeInfo:{limit:null==a?void 0:a.limit,price:null==a?void 0:a.price}};return I.isGreaterThan(0)&&(E.change={address:r,value:I.toFixed()}),E}function Q(e){var t=e.encodedTxNervos,r=e.config,n=(0,l.TransactionSkeleton)({});return n=(n=(n=n.update("inputs",(function(e){return e.push.apply(e,(0,R.default)(t.inputs))}))).update("outputs",(function(e){var n=(t.change?[].concat((0,R.default)(t.outputs),[t.change]):t.outputs).map((function(e){var t=e.address,n=e.value,o=e.data,i=(0,l.parseAddress)(t,{config:r});return{cellOutput:{capacity:F.BI.from(n).toHexString(),lock:i},data:null!=o?o:"0x"}}));return e.push.apply(e,(0,R.default)(n))}))).update("cellDeps",(function(e){return e.push.apply(e,(0,R.default)(t.cellDeps))}))}function Z(e){var t=e.sendAccount,r=e.txSkeleton,n=e.config,o=r,i=o.get("inputs").findIndex((function(e){return K.bytes.equal(E.blockchain.Script.pack(e.cellOutput.lock),E.blockchain.Script.pack((0,l.parseAddress)(t,{config:n})))}));if(-1!==i){for(;i>=o.get("witnesses").size;)o=o.update("witnesses",(function(e){return e.push("0x")}));var a=o.get("witnesses").get(i),u={lock:"0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"};if("0x"!==a){var c=E.blockchain.WitnessArgs.unpack(K.bytes.bytify(a)),s=c.lock;if(s&&u.lock&&!K.bytes.equal(s,u.lock))throw new Error("Lock field in first witness is set aside for signature!");var d=c.inputType;d&&(u.inputType=d);var f=c.outputType;f&&(u.outputType=f)}a=K.bytes.hexify(E.blockchain.WitnessArgs.pack(u)),o=o.update("witnesses",(function(e){return e.set(i,a)}))}return o}function J(e){var t,r=M.common.prepareSigningEntries(e),n=r.get("signingEntries");if(0===(null==n?void 0:n.size))throw new Error("No signingEntries");return{txSkeleton:r,message:null==(t=n.get(0))?void 0:t.message}}function ee(e){var t=function(e){return(0,l.createTransactionFromSkeleton)(e)}(J(e).txSkeleton);return E.blockchain.Transaction.pack(t).byteLength+4}function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ne(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.default)(e);if(t){var o=(0,s.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}var oe=function(e){(0,u.default)(r,e);var t=ne(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.prepareAccounts=function(){var e=(0,i.default)((function*(e){var t,r=e.indexes,n=e.names,o=e.template,i=(0,P.slicePathTemplate)(o).pathPrefix,a=r.map((function(e){return`${i}/${e}`})),u=yield this.getHardwareSDKInstance(),c=yield this.getHardwareInfo(),s=c.connectId,d=c.deviceId,l=yield this.getWalletPassphraseState(),f=H(yield this.getNetworkChainId()),p=(0,k.getAccountNameInfoByImpl)(D.IMPL_NERVOS).default.prefix;try{t=yield u.nervosGetAddress(s,d,re({bundle:a.map((function(e){return{path:e,showOnOneKey:false,network:f.PREFIX}}))},l))}catch(I){throw b.default.common.error(I),new w.OneKeyHardwareError(I)}if(!t.success)throw b.default.common.error(t.payload),(0,B.convertDeviceError)(t.payload);var h=[],y=0;for(var v of t.payload){var g=v.address,m=v.path,x=(n||[])[y]||`${p} #${r[y]+1}`;h.push({id:`${this.walletId}--${m}`,name:x,type:A.AccountType.SIMPLE,path:m,coinType:D.COINTYPE_NERVOS,pub:"",address:g}),y+=1}return h}));return function(t){return e.apply(this,arguments)}}(),n.getAddress=function(){var e=(0,i.default)((function*(e){var t,r,n=yield this.getHardwareSDKInstance(),o=yield this.getHardwareInfo(),i=o.connectId,a=o.deviceId,u=yield this.getWalletPassphraseState(),c=H(yield this.getNetworkChainId()),s=yield n.nervosGetAddress(i,a,re({path:e.path,showOnOneKey:e.showOnOneKey,network:c.PREFIX},u));if(s.success&&null!=(t=s.payload)&&t.address)return null==(r=s.payload)?void 0:r.address;throw(0,B.convertDeviceError)(s.payload)}));return function(t){return e.apply(this,arguments)}}(),n.batchGetAddress=function(){var e=(0,i.default)((function*(e){var t=yield this.getHardwareSDKInstance(),r=yield this.getHardwareInfo(),n=r.connectId,o=r.deviceId,i=yield this.getWalletPassphraseState(),a=H(yield this.getNetworkChainId()),u=yield t.nervosGetAddress(n,o,re(re({},i),{},{bundle:e.map((function(e){return{path:e.path,showOnOneKey:!!e.showOnOneKey,network:a.PREFIX}}))}));if(!u.success)throw(0,B.convertDeviceError)(u.payload);return u.payload.map((function(e){return{path:e.path,address:e.address}}))}));return function(t){return e.apply(this,arguments)}}(),n.signTransaction=function(){var e=(0,i.default)((function*(e){b.default.common.info("signTransaction",e);var t=yield this.getDbAccount(),r=yield this.getNetworkChainId(),n=H(r),o=Q({encodedTxNervos:e.payload.encodedTx,config:n}),i=J(o=Z({sendAccount:t.address,txSkeleton:o,config:H(r)})).txSkeleton,a=o.witnesses.get(0);if(!a)throw new w.OneKeyInternalError("Transaction serialization failure");var u=(0,l.createTransactionFromSkeleton)(o),c=E.blockchain.RawTransaction.pack(u),s=yield this.getHardwareInfo(),d=s.connectId,f=s.deviceId,p=yield this.getWalletPassphraseState(),h=yield this.getHardwareSDKInstance(),y=yield h.nervosSignTransaction(d,f,re({path:t.path,network:n.PREFIX,rawTx:(0,O.bytesToHex)(c),witnessHex:a},p));if(y.success){var v=y.payload.signature,g=(0,l.sealTransaction)(i,[(0,S.addHexPrefix)(v)]);return{txid:"",rawTx:(0,O.bytesToHex)(E.blockchain.Transaction.pack(g))}}throw(0,B.convertDeviceError)(y.payload)}));return function(t){return e.apply(this,arguments)}}(),(0,a.default)(r)}(C.KeyringHardwareBase),ie=r(67053),ae=r(5851),ue=r(10887);function ce(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).config,r=void 0===t?void 0:t;return(0,l.generateAddress)(e,{config:r})}function se(e,t){var r=t.config,n=function(e){return(new E.utils.CKBHasher).update(e).digestHex().slice(0,42)}(e),o=r.SCRIPTS.SECP256K1_BLAKE160;if(!o)throw new Error("SECP256K1_BLAKE160 not found in config");return ce({codeHash:o.CODE_HASH,hashType:o.HASH_TYPE,args:n},{config:r})}var de=r(48834).Buffer;function le(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.default)(e);if(t){var o=(0,s.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}var fe=function(e){(0,u.default)(r,e);var t=le(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.getSigners=function(){var e=(0,i.default)((function*(e,t){var r,n=yield this.getDbAccount();if(1!==t.length)throw new w.OneKeyInternalError("Nervos signers number should be 1.");if(t[0]!==n.address)throw new w.OneKeyInternalError("Wrong address required for signing.");var o=(yield this.getPrivateKeys(e))[n.path];if("undefined"===typeof o)throw new w.OneKeyInternalError("Unable to get signer.");return(r={})[n.address]=new ie.Signer(o,e,"secp256k1"),r}));return function(t,r){return e.apply(this,arguments)}}(),n.prepareAccounts=function(){var e=(0,i.default)((function*(e){var t=e.password,r=e.indexes,n=e.names,o=e.template,i=(yield this.engine.dbApi.getCredential(this.walletId,t)).seed,a=(0,P.slicePathTemplate)(o).pathPrefix,u=(0,ae.batchGetPublicKeys)("secp256k1",i,t,a,r.map((function(e){return`${e.toString()}`})));if(u.length!==r.length)throw new w.OneKeyInternalError("Unable to get publick key.");var c=H(yield this.getNetworkChainId()),s=(0,k.getAccountNameInfoByImpl)(D.IMPL_NERVOS).default.prefix,d=[],l=0;for(var f of u){var p=f.path,h=f.extendedKey.key,y=(0,O.bytesToHex)(h),v=se((0,S.addHexPrefix)(y),{config:c}),g=(n||[])[l]||`${s} #${r[l]+1}`;d.push({id:`${this.walletId}--${p}`,name:g,type:A.AccountType.SIMPLE,path:p,coinType:D.COINTYPE_NERVOS,pub:y,address:v}),l+=1}return d}));return function(t){return e.apply(this,arguments)}}(),n.signTransaction=function(){var e=(0,i.default)((function*(e,t){b.default.common.info("signTransaction result",e);var r=(yield this.getDbAccount()).address,n=(yield this.getSigners(t.password||"",[r]))[r],i=yield this.getNetworkChainId(),a=Q({encodedTxNervos:e.payload.encodedTx,config:H(i)}),u=J(a=Z({sendAccount:r,txSkeleton:a,config:H(i)})),c=u.txSkeleton,s=u.message;if(!s)throw new w.OneKeyInternalError("Unable to serialize transaction message.");var d=yield n.sign(de.from((0,S.stripHexPrefix)(s),"hex")),f=(0,o.default)(d,2),p=f[0],h=f[1].toString(16).padStart(2,"0"),y=(0,S.addHexPrefix)((0,O.bytesToHex)(p)+h),v=(0,l.sealTransaction)(c,[y]),g=E.blockchain.Transaction.pack(v);return{txid:"",rawTx:(0,O.bytesToHex)(g)}}));return function(t,r){return e.apply(this,arguments)}}(),(0,a.default)(r)}(ue.KeyringHdBase);function pe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.default)(e);if(t){var o=(0,s.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}var he=function(e){(0,u.default)(r,e);var t=pe(r);function r(){return t.apply(this,arguments)}return(0,a.default)(r)}(r(55942).KeyringImportedBase);function ye(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.default)(e);if(t){var o=(0,s.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}var ve=function(e){(0,u.default)(r,e);var t=ye(r);function r(){return t.apply(this,arguments)}return(0,a.default)(r)}(r(1625).KeyringWatchingBase),we=r(59607);function ge(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return ge=function(e){this.s=e,this.n=e.next},ge.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new ge(e)}function me(){return(me=(0,i.default)((function*(e){var t,r=e.transactionCollector,n=e.limit,o=void 0===n?10:n,i=r.collect(),a=0,u=[],c=!1,s=!1;try{for(var d,l=function(e){var t,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(t=e[r]))return t.call(e);if(n&&null!=(t=e[n]))return new ge(t.call(e));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}(i);c=!(d=yield l.next()).done;c=!1){var f=d.value;if(u.push(f),(a+=1)>=o)break}}catch(p){s=!0,t=p}finally{try{c&&null!=l.return&&(yield l.return())}finally{if(s)throw t}}return u.filter((function(e,t,r){return r.findIndex((function(t){return t.transaction.hash===e.transaction.hash}))===t}))}))).apply(this,arguments)}function xe(){return xe=(0,i.default)((function*(e){var t=e.client,r=e.transferHistoryArray,n=function(){var e=(0,i.default)((function*(e){var r=yield t.getTransaction(e.txHash),n=parseInt(e.index,16);return{cellOutput:r.transaction.outputs[n],data:r.transaction.outputsData[n],outPoint:e}}));return function(t){return e.apply(this,arguments)}}(),o=[];for(var a of r)if(a.txStatus.blockHash){var u=yield(0,l.createTransactionSkeleton)(a.transaction,n),c=yield t.getHeader(a.txStatus.blockHash,"0x1");o.push({txSkeleton:u,txWithStatus:a,txBlockHeader:c})}return o})),xe.apply(this,arguments)}function Ie(e,t,r,n){return null==e?void 0:e.map((function(e){return{address:ce(e.cellOutput.lock,{config:n}),balance:new(h())(e.cellOutput.capacity,16).shiftedBy(-r.decimals).toFixed(),balanceValue:new(h())(e.cellOutput.capacity,16).toString(),symbol:r.symbol,isMine:ce(e.cellOutput.lock,{config:n})===t}}))}function Te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ee(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.default)(e);if(t){var o=(0,s.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}var Oe=function(e){(0,u.default)(r,e);var t=Ee(r);function r(){for(var e,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).keyringMap={hd:fe,hw:oe,imported:he,watching:ve,external:ve},e.settings=we.default,e.getClientCache=v()(function(){var t=(0,i.default)((function*(t){return e.getNervosClient(t)}));return function(e){return t.apply(this,arguments)}}(),{promise:!0,max:1,maxAge:(0,T.getTimeDurationMs)({minute:5})}),e.getIndexer=v()((0,i.default)((function*(){var t,r=yield e.getRpcUrl(),n=yield e.getChainImplInfo(),o=n.indexer.find((function(e){return e.rpcUrl===r})),i=(null==o?void 0:o.indexerUrl)||(null==(t=n.indexer[0])?void 0:t.indexerUrl)||r;return new d.Indexer(i,r)})),{promise:!0,max:1,maxAge:(0,T.getTimeDurationMs)({minute:5})}),e.getTransactionCollector=v()(function(){var t=(0,i.default)((function*(t){var r=yield e.getRpcUrl(),n=yield e.getIndexer(),o=(0,l.parseAddress)(t);return new d.TransactionCollector(n,{lock:o,withData:!0,order:"desc"},r)}));return function(e){return t.apply(this,arguments)}}(),{promise:!0,max:3,maxAge:(0,T.getTimeDurationMs)({minute:5})}),e}var n=r.prototype;return n.getClient=function(){var e=(0,i.default)((function*(){var e=yield this.getRpcUrl();return this.getClientCache(e)}));return function(){return e.apply(this,arguments)}}(),n.getNervosClient=function(e){return new f.RPC(e,{fetch:function(e){function t(t,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=(0,i.default)((function*(e,t){return fetch(e,t)}));return function(t,r){return e.apply(this,arguments)}}())})},n.getChainImplInfo=function(){var e=(0,i.default)((function*(){return(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).implOptions}));return function(){return e.apply(this,arguments)}}(),n.getClientEndpointStatus=function(){var e=(0,i.default)((function*(e){var t=yield this.getClientCache(e),r=performance.now(),n=yield t.getTipBlockNumber(),o=parseInt(n);return{responseTime:Math.floor(performance.now()-r),latestBlock:o}}));return function(t){return e.apply(this,arguments)}}(),n.getFrozenBalance=function(){var e=(0,i.default)((function*(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).password;var e=yield this.getIndexer(),t=yield this.getClient(),r=yield this.getDbAccount(),n=yield function(e){return z.apply(this,arguments)}({indexer:e,address:r.address,client:t}),o=yield this.engine.getNetwork(this.networkId);return n.shiftedBy(-o.decimals).toNumber()}));return function(){return e.apply(this,arguments)}}(),n.getBalances=function(){var e=(0,i.default)((function*(e){var t,r=yield this.getIndexer(),n=(t=function(e){return e.address},e.reduce((function(e,r){var n=t(r);return e[n]||(e[n]=[]),e[n].push(r),e}),{})),a=new Map;return yield Promise.all(Object.entries(n).map(function(){var e=(0,i.default)((function*(e){var t=(0,o.default)(e,2),n=t[0];t[1];try{try{a.set(n,yield function(e){return q.apply(this,arguments)}({indexer:r,address:n}))}catch(i){}}catch(u){}}));return function(t){return e.apply(this,arguments)}}())),e.map((function(e){var t,r=e.address;return null!=(t=a.get(r))?t:new(h())(0)}))}));return function(t){return e.apply(this,arguments)}}(),n.buildEncodedTxFromTransfer=function(){var e=(0,i.default)((function*(e,t){if(!e.to)throw new Error("Invalid transferInfo.to params");if(e.token)throw new w.OneKeyInternalError("Nervos does not support token transfer");var r=yield this.getIndexer(),n=yield this.getClient(),o=H(yield this.getNetworkChainId()),i=(yield this.getDbAccount()).address,a=yield this.getNetwork();return Y({confirmCells:yield G({indexer:r,address:i,client:n}),from:i,network:a,transferInfo:e,config:o,specifiedFeeRate:t})}));return function(t,r){return e.apply(this,arguments)}}(),n.buildUnsignedTxFromEncodedTx=function(){var e=(0,i.default)((function*(e){var t=e.inputs,r=e.outputs,n=e.change,o=H(yield this.getNetworkChainId()),i=[];for(var a of t){var u,c,s,d,l=new(h())(a.cellOutput.capacity,16);i.push({address:ce(a.cellOutput.lock,{config:o}),value:l,utxo:{txid:null!=(u=null==(c=a.outPoint)?void 0:c.txHash)?u:"",vout:new(h())(null!=(s=null==(d=a.outPoint)?void 0:d.index)?s:"0x00",16).toNumber(),value:l}})}var f=r.map((function(e){var t=e.address,r=e.value,n=e.data;return{address:t,value:new(h())(r),payload:{data:n}}}));n&&f.push({address:n.address,value:new(h())(n.value),payload:{data:n.data}});var p={inputs:i,outputs:f,payload:{},encodedTx:e};return Promise.resolve(p)}));return function(t){return e.apply(this,arguments)}}(),n.decodedTxToLegacy=function(e){return Promise.resolve({})},n.decodeTx=function(){var e=(0,i.default)((function*(e,t){var r,n,o=e.inputs,i=e.outputs,a=e.feeInfo,u=H(yield this.getNetworkChainId()),c=yield this.engine.getNetwork(this.networkId),s=yield this.getDbAccount(),d={tokenInfo:yield this.engine.getNativeTokenInfo(this.networkId),utxoFrom:o.map((function(e){var t,r;return{address:ce(e.cellOutput.lock,{config:u}),balance:new(h())(e.cellOutput.capacity,16).shiftedBy(-c.decimals).toFixed(),balanceValue:null!=(t=null==(r=new(h())(e.cellOutput.capacity,16))?void 0:r.toString())?t:"0",symbol:c.symbol,isMine:!0}})),utxoTo:i.map((function(e){return{address:e.address,balance:new(h())(e.value).shiftedBy(-c.decimals).toFixed(),balanceValue:e.value.toString(),symbol:c.symbol,isMine:!1}})),from:s.address,to:i[0].address,amount:new(h())(i[0].value).shiftedBy(-c.decimals).toFixed(),amountValue:i[0].value,extraInfo:null};return{txid:"",owner:s.address,signer:s.address,nonce:0,actions:[{type:m.IDecodedTxActionType.NATIVE_TRANSFER,direction:i[0].address===s.address?m.IDecodedTxDirection.OUT:m.IDecodedTxDirection.SELF,nativeTransfer:d}],status:m.IDecodedTxStatus.Pending,networkId:this.networkId,accountId:this.accountId,extraInfo:null,totalFeeInNative:new(h())(null!=(r=null==a?void 0:a.limit)?r:"0").multipliedBy(null!=(n=null==a?void 0:a.price)?n:"0.00000001").toFixed()}}));return function(t,r){return e.apply(this,arguments)}}(),n.fetchFeeInfo=function(){var e=(0,i.default)((function*(e){var t=yield this.engine.getNetwork(this.networkId),r=H(yield this.getNetworkChainId()),n=yield this.getClient(),o=Q({encodedTxNervos:e,config:r}),i=ee(o=Z({sendAccount:(yield this.getDbAccount()).address,txSkeleton:o,config:r})),a=(yield n.getFeeRateStatistics()).median,u=(0,x.convertFeeValueToGwei)({value:new(h())(a,16).dividedBy(1024).toFixed(0),network:t});return{nativeSymbol:t.symbol,nativeDecimals:t.decimals,feeSymbol:t.feeSymbol,feeDecimals:t.feeDecimals,limit:new(h())(i).multipliedBy(1.1).toFixed(0),prices:[u],defaultPresetIndex:"0"}}));return function(t){return e.apply(this,arguments)}}(),n.attachFeeInfoToEncodedTx=function(){var e=(0,i.default)((function*(e){var t=e.feeInfoValue,r=t.price,n=t.limit;if("undefined"===typeof r||"string"!==typeof r)throw new w.OneKeyInternalError("Invalid gas price.");if("string"!==typeof n)throw new w.OneKeyInternalError("Invalid fee limit");return"string"===typeof r&&"string"===typeof n?this.buildEncodedTxFromTransfer(e.encodedTx.transferInfo,{price:r,limit:n}):Promise.resolve(be(be({},e.encodedTx),{},{feeInfo:{price:r,limit:n}}))}));return function(t){return e.apply(this,arguments)}}(),n.updateEncodedTx=function(){var e=(0,i.default)((function*(e,t,r){var n=e.outputs;if(r.type===m.IEncodedTxUpdateType.transfer&&n.length>0){var o,i,a,u=yield this.getNetwork(),c=new(h())(null!=(o=null==(i=t.feeInfo)?void 0:i.limit)?o:"512").multipliedBy("1.1"),s=new(h())(null!=(a=t.totalBalance)?a:t.amount).shiftedBy(u.decimals).toFixed(0);return Promise.resolve(be(be({},e),{},{hasMaxSend:!0,outputs:[{address:n[0].address,value:s}],mass:parseInt(c.toFixed(0))}))}return Promise.resolve(e)}));return function(t,r,n){return e.apply(this,arguments)}}(),n.broadcastTransaction=function(){var e=(0,i.default)((function*(e){var t=yield this.getClient();b.default.engine.info("nervos broadcastTransaction start:",{rawTx:e.rawTx});try{var r=function(e){var t=E.blockchain.Transaction.unpack((0,S.addHexPrefix)(e));return{version:F.BI.from(t.version).toHexString(),cellDeps:t.cellDeps.map((function(e){return{depType:e.depType,outPoint:{txHash:e.outPoint.txHash,index:F.BI.from(e.outPoint.index).toHexString()}}})),headerDeps:t.headerDeps,inputs:t.inputs.map((function(e){return{previousOutput:{txHash:e.previousOutput.txHash,index:F.BI.from(e.previousOutput.index).toHexString()},since:F.BI.from(e.since).toHexString()}})),outputs:t.outputs.map((function(e){return{capacity:F.BI.from(e.capacity).toHexString(),lock:e.lock,type:e.type}})),outputsData:t.outputsData,witnesses:t.witnesses}}(e.rawTx),n=yield t.sendTransaction(r,"passthrough");return be(be({},e),{},{txid:n})}catch(u){var o=u||{},i=o.errorCode,a=`${null!=i?i:""} ${o.message}`;throw new w.OneKeyInternalError(a)}}));return function(t){return e.apply(this,arguments)}}(),n.getTransactionStatuses=function(){var e=(0,i.default)((function*(e){var t=yield this.getClient(),r=new(h())(yield t.getTipBlockNumber(),16),n=new Map;for(var o of e){var i=yield t.getTransaction(o),a=g.TransactionStatus.PENDING;if(i.txStatus.blockHash){var u=yield t.getHeader(i.txStatus.blockHash,"0x1"),c=r.minus(new(h())(u.number,16)).isGreaterThanOrEqualTo(U);"committed"===i.txStatus.status&&c&&(a=g.TransactionStatus.CONFIRM_AND_SUCCESS)}n.set(o,a)}return e.map((function(e){return n.get(e)}))}));return function(t){return e.apply(this,arguments)}}(),n.fetchOnChainHistory=function(){var e=(0,i.default)((function*(e){var t=this,r=e.localHistory,n=void 0===r?[]:r,o=yield this.getNetwork(),a=yield this.getDbAccount(),u=yield this.getClient(),c=a.address,s=yield this.getTransactionCollector(c),d=yield function(e){return me.apply(this,arguments)}({limit:10,transactionCollector:s}),l=yield function(e){return xe.apply(this,arguments)}({client:u,transferHistoryArray:d}),f=H(yield this.getNetworkChainId()),p=new(h())(yield u.getTipBlockNumber(),16),y=l.map(function(){var e=(0,i.default)((function*(e){try{var r,i=n.find((function(t){return t.decodedTx.txid===e.txWithStatus.transaction.hash}));if(i&&i.decodedTx.isFinal)return null;var u,c,s=e.txWithStatus,d=s.txStatus.status,l=s.transaction.hash,y=e.txBlockHeader,v=y.timestamp,w=y.number,g=e.txSkeleton,x=g.inputs,I=g.outputs,T=l,b=new(h())(v,16).toString(),E=yield t.engine.getNativeTokenInfo(t.networkId),O=Ie(Array.from(x),a.address,E,f),P=Ie(Array.from(I),a.address,E,f),k=O.find((function(e){return e.isMine})),A=P.filter((function(e){return!e.isMine})),C=P.filter((function(e){return e.isMine})),S=a.address,B=a.address,D="0",N="0";if(k){u=m.IDecodedTxDirection.OUT;var H=P.find((function(e){return!e.isMine}));B=H?H.address:a.address,D=A.filter((function(e){return e.address===B})).reduce((function(e,t){return e.plus(t.balance)}),new(h())(0)).toFixed(),N=new(h())(D).shiftedBy(-o.decimals).toFixed()}else{u=m.IDecodedTxDirection.IN;var R=O.find((function(e){return!e.isMine}));S=R?R.address:a.address,D=C.reduce((function(e,t){return e.plus(t.balance)}),new(h())(0)).toFixed(),N=new(h())(D).shiftedBy(-o.decimals).toFixed()}if(A&&A.length)c=(u===m.IDecodedTxDirection.OUT?A:C).map((function(e){return{type:m.IDecodedTxActionType.NATIVE_TRANSFER,direction:u,nativeTransfer:{tokenInfo:E,utxoFrom:O,utxoTo:P,from:S,to:e.address,amount:e.balance,amountValue:e.balanceValue,extraInfo:null}}}));else c=[{type:m.IDecodedTxActionType.NATIVE_TRANSFER,direction:u,nativeTransfer:{tokenInfo:E,utxoFrom:O,utxoTo:P,from:S,to:B,amount:D,amountValue:N,extraInfo:null}}];var F=x.reduce((function(e,t){return e.plus(new(h())(t.cellOutput.capacity,16))}),new(h())(0)),K=I.reduce((function(e,t){return e.plus(new(h())(t.cellOutput.capacity,16))}),new(h())(0)),M=F.minus(K).shiftedBy(-o.decimals).toFixed(),j=p.minus(new(h())(w,16)).isGreaterThanOrEqualTo(U),L={txid:null!=T?T:"",owner:a.address,signer:a.address,nonce:0,actions:c,status:"committed"===d&&j?m.IDecodedTxStatus.Confirmed:m.IDecodedTxStatus.Pending,networkId:t.networkId,accountId:t.accountId,extraInfo:null,totalFeeInNative:M};return L.updatedAt="undefined"!==typeof b?parseInt(b):Date.now(),L.createdAt=null!=(r=null==i?void 0:i.decodedTx.createdAt)?r:L.updatedAt,L.isFinal=L.status===m.IDecodedTxStatus.Confirmed,yield t.buildHistoryTx({decodedTx:L,historyTxToMerge:i})}catch(_){return console.error(_),Promise.resolve(null)}}));return function(t){return e.apply(this,arguments)}}());return(yield Promise.all(y)).filter(Boolean)}));return function(t){return e.apply(this,arguments)}}(),n.validateAddress=function(){var e=(0,i.default)((function*(e){return function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).config,r=void 0===t?void 0:t;try{return(0,l.parseAddress)(e,{config:r}),!0}catch(n){return!1}}(e,{config:H(yield this.getNetworkChainId())})?Promise.resolve(e):Promise.reject(new w.InvalidAddress)}));return function(t){return e.apply(this,arguments)}}(),n.validateWatchingCredential=function(){var e=(0,i.default)((function*(e){var t=this;return this.validateAddress(e).then((function(e){return t.settings.watchingAccountEnabled&&!!e})).catch((function(){return!1}))}));return function(t){return e.apply(this,arguments)}}(),n.isHexPrivateKey=function(e){return/^(0x)?[0-9a-zA-Z]{64}$/.test(e)},n.validateImportedCredential=function(){var e=(0,i.default)((function*(e){return Promise.resolve(this.settings.importedAccountEnabled&&this.isHexPrivateKey(e))}));return function(t){return e.apply(this,arguments)}}(),(0,a.default)(r)}(I.VaultBase)},65147:(e,t,r)=>{r.r(t),r.d(t,{KeyringBase:()=>s,KeyringBaseMock:()=>d});var n=r(34795),o=r(87371),i=r(45754),a=r(11987),u=r(95058);function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,a.default)(this,r)}}var s=function(e){(0,i.default)(r,e);var t=c(r);function r(e){var r;return(r=t.call(this,e.options)).vault=e,r}return r.prototype.addressFromBase=function(){var e=(0,n.default)((function*(e){return this.vault.addressFromBase(e)}));return function(t){return e.apply(this,arguments)}}(),(0,o.default)(r)}(r(14540).VaultContext),d=function(e){(0,i.default)(r,e);var t=c(r);function r(){return t.apply(this,arguments)}return(0,o.default)(r)}(s)},17391:(e,t,r)=>{r.r(t),r.d(t,{KeyringHardwareBase:()=>l});var n=r(34795),o=r(87371),i=r(45754),a=r(11987),u=r(95058),c=r(99075),s=r(14817);function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,a.default)(this,r)}}var l=function(e){(0,i.default)(a,e);var t=d(a);function a(){return t.apply(this,arguments)}var u=a.prototype;return u.getHardwareInfo=function(){var e=(0,n.default)((function*(){var e,t,r,n=yield this.engine.getHWDeviceByWalletId(this.vault.walletId);return{connectId:null!=(e=null==n?void 0:n.mac)?e:"",deviceId:null!=(t=null==n?void 0:n.deviceId)?t:"",deviceType:null!=(r=null==n?void 0:n.deviceType)?r:""}}));return function(){return e.apply(this,arguments)}}(),u.getWalletPassphraseState=function(){var e=(0,n.default)((function*(){var e=yield this.engine.getWallet(this.vault.walletId);return{passphraseState:null==e?void 0:e.passphraseState,useEmptyPassphrase:!(0,s.isPassphraseWallet)(e)}}));return function(){return e.apply(this,arguments)}}(),u.getHardwareSDKInstance=function(){var e=(0,n.default)((function*(){var e,t,n,o,i;return null!=(i=yield null==(e=r.g)||null==(t=e.$backgroundApiProxy)||null==(n=t.backgroundApi)||null==(o=n.serviceHardware)||null==o.getSDKInstance?void 0:o.getSDKInstance())?i:c.HardwareSDK}));return function(){return e.apply(this,arguments)}}(),u.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},(0,o.default)(a)}(r(65147).KeyringBase)},10887:(e,t,r)=>{r.r(t),r.d(t,{KeyringHdBase:()=>h});var n=r(56666),o=r(34795),i=r(87371),a=r(45754),u=r(11987),c=r(95058),s=r(5851),d=r(40915);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,c.default)(e);if(t){var o=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}var h=function(e){(0,a.default)(r,e);var t=p(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.getPrivateKeys=function(){var e=(0,o.default)((function*(e,t){var r=(yield this.getDbAccount()).path.split("/"),n=t||[r.pop()],o=r.join("/"),i=(yield this.engine.dbApi.getCredential(this.walletId,e)).seed;if("undefined"===typeof i)throw new d.OneKeyInternalError("Unable to get credential.");var a=(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).curve;return(0,s.batchGetPrivateKeys)(a,i,e,o,n).reduce((function(e,t){var r;return f(f({},e),{},((r={})[t.path]=t.extendedKey.key,r))}),{})}));return function(t,r){return e.apply(this,arguments)}}(),n.getAddress=function(){throw new Error("Method not implemented.")},n.batchGetAddress=function(){throw new Error("Method not implemented.")},n.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},(0,i.default)(r)}(r(80306).KeyringSoftwareBase)},55942:(e,t,r)=>{r.r(t),r.d(t,{KeyringImportedBase:()=>d});var n=r(34795),o=r(87371),i=r(45754),a=r(11987),u=r(95058),c=r(40915);function s(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,a.default)(this,r)}}var d=function(e){(0,i.default)(r,e);var t=s(r);function r(){return t.apply(this,arguments)}var a=r.prototype;return a.getPrivateKeys=function(){var e=(0,n.default)((function*(e,t){if("undefined"!==typeof t)throw new c.NotImplemented("Getting private keys from extended private key");var r=(yield this.engine.dbApi.getCredential(this.accountId,e)).privateKey;if("undefined"===typeof r)throw new c.OneKeyInternalError("Unable to get credential.");return{"":r}}));return function(t,r){return e.apply(this,arguments)}}(),a.getAddress=function(){throw new Error("Method not implemented.")},a.batchGetAddress=function(){throw new Error("Method not implemented.")},a.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},(0,o.default)(r)}(r(80306).KeyringSoftwareBase)},80306:(e,t,r)=>{r.r(t),r.d(t,{KeyringSoftwareBase:()=>y});var n=r(96234),o=r(56666),i=r(34795),a=r(87371),u=r(45754),c=r(11987),s=r(95058),d=r(42547),l=r(40915);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.default)(e);if(t){var o=(0,s.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}var y=function(e){(0,u.default)(r,e);var t=h(r);function r(){return t.apply(this,arguments)}var o=r.prototype;return o.signTransaction=function(){var e=(0,i.default)((function*(e,t){var r=t.password;if("undefined"===typeof r)throw new l.OneKeyInternalError("Software signing requires a password.");var n=yield this.getSigners(r,e.inputs.map((function(e){return e.address})));return d.default.engine.info("signTransaction",this.networkId,e),p(p({},yield this.engine.providerManager.signTransaction(this.networkId,e,n)),{},{encodedTx:e.encodedTx})}));return function(t,r){return e.apply(this,arguments)}}(),o.signMessage=function(){var e=(0,i.default)((function*(e,t){var r=this,o=t.password;if("undefined"===typeof o)throw new l.OneKeyInternalError("Software signing requires a password.");var i=yield this.getDbAccount(),a=Object.values(yield this.getSigners(o,[i.address])),u=(0,n.default)(a,1)[0];return d.default.engine.info("signMessage",this.networkId,e),Promise.all(e.map((function(e){return r.engine.providerManager.signMessage(r.networkId,e,u)})))}));return function(t,r){return e.apply(this,arguments)}}(),o.getAddress=function(){throw new Error("Method not implemented.")},o.batchGetAddress=function(){throw new Error("Method not implemented.")},o.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},(0,a.default)(r)}(r(65147).KeyringBase)},1625:(e,t,r)=>{r.r(t),r.d(t,{KeyringWatchingBase:()=>d});var n=r(34795),o=r(87371),i=r(45754),a=r(11987),u=r(95058),c=r(40915);function s(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,a.default)(this,r)}}var d=function(e){(0,i.default)(r,e);var t=s(r);function r(){return t.apply(this,arguments)}var a=r.prototype;return a.signTransaction=function(){var e=(0,n.default)((function*(e,t){throw new c.OneKeyInternalError("signTransaction is not supported for watching accounts")}));return function(t,r){return e.apply(this,arguments)}}(),a.signMessage=function(){var e=(0,n.default)((function*(e,t){throw new c.OneKeyInternalError("signMessage is not supported for watching accounts")}));return function(t,r){return e.apply(this,arguments)}}(),a.getAddress=function(){throw new Error("Method not implemented.")},a.batchGetAddress=function(){throw new Error("Method not implemented.")},a.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},(0,o.default)(r)}(r(65147).KeyringBase)},53546:(e,t,r)=>{r.r(t),r.d(t,{convertDeviceError:()=>u});var n=r(3599),o=r(2478),i=r(42547);r(13208);function a(e,t){return"string"!==typeof t?null:e===n.HardwareErrorCode.DeviceInitializeFailed&&t.includes("ECONNABORTED")?new o.ConnectTimeoutError({message:t}):t.includes("Bridge network error")?new o.BridgeNetworkError({message:t}):null}function u(e){var t,r=e||{},u=r.code,c=r.error,s=r.message,d=null!=(t=null!=c?c:s)?t:"Unknown error";if(a(u,d))return a(u,d);switch(i.default.hardwareSDK.info("Device Utils Convert Device Error:",u,d),u){case n.HardwareErrorCode.UnknownError:return new o.UnknownHardwareError(e);case n.HardwareErrorCode.DeviceFwException:return new o.FirmwareVersionTooLow(e);case n.HardwareErrorCode.DeviceUnexpectedMode:return"string"===typeof d&&-1!==d.indexOf("ui-device_bootloader_mode")?new o.NotInBootLoaderMode(e):new o.UnknownHardwareError(e);case n.HardwareErrorCode.DeviceCheckDeviceIdError:return new o.DeviceNotSame(e);case n.HardwareErrorCode.DeviceNotFound:return new o.DeviceNotFind(e);case n.HardwareErrorCode.DeviceUnexpectedBootloaderMode:return new o.NotInBootLoaderMode(e);case n.HardwareErrorCode.DeviceInterruptedFromOutside:case n.HardwareErrorCode.DeviceInterruptedFromUser:return new o.UserCancelFromOutside(e);case n.HardwareErrorCode.DeviceNotSupportPassphrase:return new o.NotSupportPassphraseError(e);case n.HardwareErrorCode.IFrameLoadFail:return new o.InitIframeLoadFail(e);case n.HardwareErrorCode.IframeTimeout:return new o.InitIframeTimeout(e);case n.HardwareErrorCode.FirmwareUpdateDownloadFailed:return new o.FirmwareDownloadFailed(e);case n.HardwareErrorCode.FirmwareUpdateManuallyEnterBoot:return new o.FirmwareUpdateManuallyEnterBoot(e);case n.HardwareErrorCode.FirmwareUpdateAutoEnterBootFailure:return new o.FirmwareUpdateAutoEnterBootFailure(e);case n.HardwareErrorCode.FirmwareUpdateLimitOneDevice:return new o.FirmwareUpdateLimitOneDevice(e);case n.HardwareErrorCode.CallMethodNeedUpgradeFirmware:return new o.FirmwareVersionTooLow(e);case n.HardwareErrorCode.NewFirmwareUnRelease:return new o.NewFirmwareUnRelease(e);case n.HardwareErrorCode.NewFirmwareForceUpdate:return new o.NewFirmwareForceUpdate(e);case n.HardwareErrorCode.NetworkError:return new o.NetworkError(e);case n.HardwareErrorCode.BlePermissionError:return new o.NeedBluetoothTurnedOn(e);case n.HardwareErrorCode.BleLocationError:return new o.NeedBluetoothPermissions({message:d});case n.HardwareErrorCode.BleLocationServicesDisabled:return new o.BleLocationServiceError({message:d});case n.HardwareErrorCode.BleDeviceNotBonded:return new o.DeviceNotBonded(e);case n.HardwareErrorCode.BleDeviceBondError:return new o.DeviceBondError(e);case n.HardwareErrorCode.BleWriteCharacteristicError:return new o.BleWriteCharacteristicError(e);case n.HardwareErrorCode.BleScanError:return new o.BleScanError({message:d});case n.HardwareErrorCode.BleAlreadyConnected:return new o.BleAlreadyConnectedError(e);case n.HardwareErrorCode.RuntimeError:return-1!==d.indexOf("EIP712 blind sign is disabled")?new o.OpenBlindSign(e):-1!==d.indexOf("Unknown message")||-1!==d.indexOf("Failure_UnexpectedMessage")?new o.UnknownMethod(e):new o.UnknownHardwareError(e);case n.HardwareErrorCode.PinInvalid:return new o.InvalidPIN(e);case n.HardwareErrorCode.DeviceCheckPassphraseStateError:return new o.InvalidPassphrase(e);case n.HardwareErrorCode.DeviceOpenedPassphrase:return new o.DeviceOpenedPassphrase(e);case n.HardwareErrorCode.DeviceNotOpenedPassphrase:return new o.DeviceNotOpenedPassphrase(e);case n.HardwareErrorCode.PinCancelled:case n.HardwareErrorCode.ActionCancelled:return new o.UserCancel(e);case n.HardwareErrorCode.BridgeNotInstalled:case o.CustomOneKeyHardwareError.NeedOneKeyBridge:return new o.NeedOneKeyBridge(e);case n.HardwareErrorCode.BridgeNetworkError:return new o.BridgeNetworkError(e);case n.HardwareErrorCode.BridgeTimeoutError:return new o.BridgeTimeoutError(e);case n.HardwareErrorCode.PollingTimeout:return new o.ConnectTimeoutError(e);case n.HardwareErrorCode.PollingStop:return new o.ConnectPollingStopError(e);case n.HardwareErrorCode.BlindSignDisabled:return new o.OpenBlindSign(e);case n.HardwareErrorCode.FileAlreadyExists:return new o.FileAlreadyExistError(e);case n.HardwareErrorCode.CheckDownloadFileError:return new o.IncompleteFileError(e);case n.HardwareErrorCode.NotInSigningMode:return new o.NotInSigningModeError(e);case n.HardwareErrorCode.DataOverload:return new o.DeviceDataOverload(e);default:return new o.UnknownHardwareError(e)}}}}]);